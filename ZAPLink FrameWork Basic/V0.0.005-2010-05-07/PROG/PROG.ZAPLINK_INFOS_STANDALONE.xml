<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="DD721F199F2690FD75E70173690D8A93" CODE_SIGNATURE="4F0765461BDF6BC79503E30F0C3B5263" CONNECTOR="AAAD0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_INFOS_STANDALONE" TYPE="PROG" VERSION="1.0">
 <DIRECTORY DEVCLASS="ZAPLINK-FRAMEWORK-CORE" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA EDTX="X" VARCL="X" SUBC="1" RSTAT="T" RMAND="200" RLOAD="E" UCCHECK="X"/>
  <SOURCE>`
*&amp;---------------------------------------------------------------------*
*&amp; Report  ZAPLINK_INFOS
*&amp;
*&amp;---------------------------------------------------------------------*
*&amp;
*&amp;
*&amp;---------------------------------------------------------------------*

REPORT  zaplink_infos MESSAGE-ID zaplink_cx.
TYPE-POOLS:ABAP,ICON,RPYTY,SEDI,SEEX,SEOF,SEOK,SEOO,SEOP,SEOR,SEOS,SEOT,SEOX,SLIS,SMODI,STSTC.
CLASS ZAPLINK_BADI DEFINITION DEFERRED.
CLASS ZAPLINK_BADI_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_CLAS_DATA DEFINITION DEFERRED.
INTERFACE ZAPLINK_CNX_EXT_CLEANER DEFERRED.
INTERFACE ZAPLINK_CNX_EXT_CODE_SIGNATURE DEFERRED.
CLASS ZAPLINK_COMPONENT DEFINITION DEFERRED.
CLASS ZAPLINK_COMPONENT_4INST DEFINITION DEFERRED.
INTERFACE ZAPLINK_CONNECTOR DEFERRED.
CLASS ZAPLINK_CONNECTORS DEFINITION DEFERRED.
CLASS ZAPLINK_CONNECTORS_4INST DEFINITION DEFERRED.
CLASS ZAPLINK_CONNECTOR_ DEFINITION DEFERRED.
CLASS ZAPLINK_CONTAINER DEFINITION DEFERRED.
CLASS ZAPLINK_CONTAINER_4INST DEFINITION DEFERRED.
CLASS ZAPLINK_CX DEFINITION DEFERRED.
CLASS ZAPLINK_CX_COMPONENT DEFINITION DEFERRED.
CLASS ZAPLINK_CX_CONNECTOR DEFINITION DEFERRED.
CLASS ZAPLINK_CX_CONTAINER DEFINITION DEFERRED.
CLASS ZAPLINK_CX_FILE DEFINITION DEFERRED.
CLASS ZAPLINK_CX_LIST DEFINITION DEFERRED.
CLASS ZAPLINK_CX_OPTIONS DEFINITION DEFERRED.
CLASS ZAPLINK_CX_OPT_DEVCLASS DEFINITION DEFERRED.
INTERFACE ZAPLINK_DATATYPES DEFERRED.
CLASS ZAPLINK_DEPENDENCIES_ANALYSER DEFINITION DEFERRED.
CLASS ZAPLINK_DEVC_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_DEVC_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_DICTIONARY DEFINITION DEFERRED.
CLASS ZAPLINK_DOCUMENTATION DEFINITION DEFERRED.
CLASS ZAPLINK_DOCV_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_DOMA_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_DTEL_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_EASYXML DEFINITION DEFERRED.
CLASS ZAPLINK_EASYXML_4CNX DEFINITION DEFERRED.
CLASS ZAPLINK_ENQU_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_EXCC_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_FILE DEFINITION DEFERRED.
CLASS ZAPLINK_FUGR_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_FUNCTION_GROUP DEFINITION DEFERRED.
CLASS ZAPLINK_INFOS DEFINITION DEFERRED.
CLASS ZAPLINK_INTF_DATA DEFINITION DEFERRED.
INTERFACE ZAPLINK_KERNEL_TYPES DEFERRED.
CLASS ZAPLINK_LIST DEFINITION DEFERRED.
CLASS ZAPLINK_MENUPAINTER_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_MESSAGE DEFINITION DEFERRED.
CLASS ZAPLINK_MESSAGE_COLLECTOR DEFINITION DEFERRED.
CLASS ZAPLINK_MSAG_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_OBJECT DEFINITION DEFERRED.
CLASS ZAPLINK_OBJECT_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_OPTIONS DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_BASE DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_DEVCLASS DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_DIRECTORY DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_TRANSPORT_REQUEST DEFINITION DEFERRED.
CLASS ZAPLINK_OS_COMMAND DEFINITION DEFERRED.
CLASS ZAPLINK_PACKAGE DEFINITION DEFERRED.
CLASS ZAPLINK_PINF_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_PINF_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_PROGRAM DEFINITION DEFERRED.
CLASS ZAPLINK_PROG_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_RAW_BASE DEFINITION DEFERRED.
CLASS ZAPLINK_RAW_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_SHLP_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_SXCI_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_SXSD_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_TABL_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_TOOLS DEFINITION DEFERRED.
CLASS ZAPLINK_TRANSACTION DEFINITION DEFERRED.
CLASS ZAPLINK_TRAN_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_TTYP_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_TYPE_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_VIEW_DATA DEFINITION DEFERRED.
INTERFACE ZAPLINK_DATATYPES.
  type-pools ABAP .
  types TD_FRAMEWORKVER type STRING .
  types TD_WITH_SUBCOMP type ABAP_BOOL .
  types TD_TYPEORDER type I .
  types TD_ORDERKIND type CHAR1 .
  types TD_CHECKSUM type MD5_FIELDS-HASH .
  types TD_SUBSTITUTIONKIND type CHAR1 .
  types:
    BEGIN OF ts_directory,
      korrnum TYPE tadir-korrnum,
      srcsystem TYPE tadir-srcsystem,
      author TYPE tadir-author,
      srcdep TYPE tadir-srcdep,
      devclass TYPE tadir-devclass,
      genflag TYPE tadir-genflag,
      edtflag TYPE tadir-edtflag,
      masterlang TYPE tadir-masterlang,
      paknocheck TYPE tadir-paknocheck,
      objstablty TYPE tadir-objstablty,
      component TYPE tadir-component,
      crelease TYPE tadir-crelease,
      translttxt TYPE tadir-translttxt,
      trkorr TYPE e070-trkorr,
    END OF ts_directory .
  types TD_CONNUUID type GUID_16 .
  types TD_TYPE_AS_TEXT type KO100-TEXT .
  types TD_COMPTEXT type KO100-TEXT .
  types TD_CONTNAME type STRING .
  types TD_CONTVER type STRING .
  types TD_FILENAME type STRING .
  types TD_FILETYPE type CHAR1 .
  types TD_TRANSPORT_REQUEST type E070-TRKORR .
  types TD_ABAPSOURCE type STRING .
  types:
    BEGIN OF ts_sourceasstruc,
      _ TYPE td_abapsource,
    END OF ts_sourceasstruc .
  types TD_PROGNAME type PROGRAMM .
  types TT_ABAPRAWSOURCE type RSWSOURCET .
  types TO_XML type ref to IF_IXML_DOCUMENT .
  types TD_LIGHT type ICON_L4 .
  types TD_SEL_ACTION type CHAR1 .
  types TD_CONNVER type STRING .
  types TD_EXISTS type ABAP_BOOL .
  types TD_CLASSNAME type SEOCLSNAME .
  types TD_COMPEXISTS type TD_EXISTS .
  types TD_CONNCLASS type TD_CLASSNAME .
  types TD_CONNEXISTS type TD_EXISTS .
  types TD_DEVCLASS type TADIR-DEVCLASS .
  types TD_OBJ_TYPE type ABAP_ABSTYPENAME .
  types TD_COMPNAME type STRING .
  types TD_COMPTYPE type TADIR-OBJECT .
  types:
    BEGIN OF ts_compkey,
      type TYPE td_comptype,
      name TYPE td_compname,
    END OF ts_compkey .
  types:
    tt_compkeys TYPE STANDARD TABLE OF ts_compkey WITH DEFAULT KEY .
  types:
    tr_tr TYPE RANGE OF td_transport_request .
  types:
    tr_packages TYPE RANGE OF tadir-devclass .
  types:
    tr_comptype TYPE RANGE OF td_comptype .
  types:
    tr_compname TYPE RANGE OF tadir-obj_name .
  types:
    tr_author TYPE RANGE OF tadir-author .
  types:
    tr_srcsystem TYPE RANGE OF tadir-srcsystem .
  types TD_SOFTCOMP type TDEVC-DLVUNIT .
  types:
    tr_dlvunit TYPE RANGE OF tdevc-dlvunit .
  types:
    BEGIN OF ts_base_attributs,
        name     TYPE td_compname,
        class    TYPE td_connclass,
        devclass TYPE td_devclass,
        version  TYPE td_connver,
      END OF ts_base_attributs .
  types:
    BEGIN OF ts_conn_class,
      uuid      TYPE td_connuuid,
      classname TYPE td_connclass,
      devclass  TYPE td_devclass,
      END OF ts_conn_class .
  types:
    tt_conn_classes TYPE SORTED TABLE OF ts_conn_class WITH UNIQUE KEY uuid .
  types:
    BEGIN OF ts_conn_def,
          object        TYPE ko100-object,
          text          TYPE ko100-text,
          default_class TYPE td_connclass,
          classes       TYPE tt_conn_classes,
        END OF ts_conn_def .
  types:
    tt_typelist TYPE SORTED TABLE OF ts_conn_def WITH UNIQUE KEY object .
  types:
    BEGIN OF ts_type,
      type TYPE td_comptype,
    END OF ts_type .
  types:
    tt_types TYPE SORTED TABLE OF ts_type WITH UNIQUE KEY type .
  types TD_LANG type SPRAS .
  types TD_TXTP_TEXT type TEXTPOOLTX .
  types TD_TXTP_LEN type TEXTPOOLLN .
  types TD_TXTP_KIND type TEXTPOOLID .
  types TD_TXTP_ID type TEXTPOOLKY .
  types:
    BEGIN OF ts_txtp_text,
        langu   TYPE td_lang,
        entry   TYPE td_txtp_text,
        length  TYPE td_txtp_len,
      END OF ts_txtp_text .
  types:
    tt_txtp_texts TYPE SORTED TABLE OF ts_txtp_text WITH UNIQUE KEY langu .
  types:
    BEGIN OF ts_txtp_textpool,
        id    TYPE  td_txtp_kind,
        key   TYPE  td_txtp_id,
        texts TYPE  tt_txtp_texts,
      END OF ts_txtp_textpool .
  types:
    tt_txtp_textpools TYPE SORTED TABLE OF ts_txtp_textpool WITH UNIQUE KEY id KEY .
  types:
    BEGIN OF ts_conndata,
      zsl_name      TYPE td_compname,         &quot; component name
      zsl_connector TYPE td_connclass,        &quot; Connector class name
      zsl_version   TYPE td_connver,          &quot; Connector version
    END OF ts_conndata .
  types:
    BEGIN OF ts_contdata,
          name TYPE td_contname,
        END OF ts_contdata .
  types TD_DOC_ID type DOKU_ID .
  types:
    tt_rawtext TYPE STANDARD TABLE OF tline WITH DEFAULT KEY .
  types:
    BEGIN OF ts_head,   &quot; from DOKHL
        application TYPE tdobject,
        id          TYPE doku_id,
        object      TYPE doku_obj,
        langu       TYPE doku_langu,
        masterlang  TYPE dokil-masterlang,
        typ         TYPE doku_typ,
        dokform     TYPE tdformnew,
        dokstyle    TYPE tdstyle,
        selfdef     TYPE dokil-selfdef,
      END OF ts_head .
  types:
    BEGIN OF ts_lang.   &quot; from DOKHL
  INCLUDE TYPE thead AS head.
  TYPES:
      state       TYPE dokhl-dokstate,
      _           TYPE string,      &quot; Long Text
    END OF ts_lang .
  types:
    BEGIN OF ts_text,
      langu      TYPE spras,
      short_txt  TYPE string,
      long_txt   TYPE ts_lang,
    END OF ts_text .
  types:
    tt_texts TYPE SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  types:
    BEGIN OF ts_doc.
  INCLUDE TYPE ts_head AS hdr.
  TYPES:
      texts TYPE SORTED TABLE OF ts_lang WITH UNIQUE KEY tdspras,
    END OF ts_doc .
  types:
    tt_docs TYPE STANDARD TABLE OF ts_doc WITH DEFAULT KEY .
  types:
    tr_docid TYPE RANGE OF td_doc_id .
  types:
    BEGIN OF ts_component,
          type TYPE td_comptype,
          name TYPE td_compname,
        END OF ts_component .
  types:
    BEGIN OF ts_field.
  INCLUDE TYPE rpy_dyfatc AS hdr.     &quot; dyfatc_tab
  TYPES:
      texts TYPE tt_texts,
    END OF ts_field .
  types:
    tt_fields TYPE SORTED TABLE OF ts_field WITH NON-UNIQUE KEY name .
  types:
    BEGIN OF ts_dynp_cont.
  INCLUDE TYPE rpy_dycatt AS hdr.       &quot; dycatt_tab
  TYPES:
      fields  TYPE tt_fields,
    END OF ts_dynp_cont .
  types:
    tt_dynp_containers TYPE SORTED TABLE OF ts_dynp_cont WITH NON-UNIQUE KEY name .
  types:
    tt_flow_logic TYPE STANDARD TABLE OF rpy_dyflow WITH DEFAULT KEY .
  types:
    tt_matchcodes TYPE STANDARD TABLE OF rpy_dypara WITH DEFAULT KEY .
  types:
    tt_dyntexts TYPE SORTED TABLE OF d020t WITH UNIQUE KEY lang .
  types:
    BEGIN OF ts_dynpro.
  INCLUDE TYPE rpy_dyhead AS hdr.
  TYPES:
      texts      TYPE tt_dyntexts,
      flow_logic TYPE ts_sourceasstruc,
      matchcodes TYPE tt_matchcodes,
      containers TYPE tt_dynp_containers,
    END OF ts_dynpro .
  types:
    tt_dynpros TYPE SORTED TABLE OF ts_dynpro WITH UNIQUE KEY screen .
  constants:
    BEGIN OF exists,
      exists     TYPE td_exists VALUE abap_true,
      not_exists TYPE td_exists VALUE abap_false,
    END OF exists .
  constants:
    BEGIN OF textpool_kinds,
      prog_title  TYPE td_txtp_kind VALUE &apos;R&apos;, &quot; R - Program title
      list_title  TYPE td_txtp_kind VALUE &apos;T&apos;, &quot; T - List Title: Titlebar
      list_header TYPE td_txtp_kind VALUE &apos;H&apos;, &quot; H 001 to 004 List header: Column headings
      text_symbol TYPE td_txtp_kind VALUE &apos;I&apos;, &quot; I Text symbol identifier Text symbol text
      parameters  TYPE td_txtp_kind VALUE &apos;S&apos;, &quot; S Name of a parameter or selection criterion Selection text
    END OF textpool_kinds .
*  class CL_ABAP_CHAR_UTILITIES definition load .
  constants LINE_SEPARATOR type ABAP_CHAR1 value CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT
  constants BALLOG_OBJECT type BALOBJ_D value &apos;ZAPLINK&apos;. &quot;#EC NOTEXT
  constants COMP_NODENAME type STRING value &apos;ZL_OBJECT&apos;. &quot;#EC NOTEXT
  constants EXT_SEP type C value &apos;.&apos;. &quot;#EC NOTEXT
  constants FILE_EXT type STRING value &apos;xml&apos;. &quot;#EC NOTEXT
  constants FRAMEWORK_VERSION type TD_FRAMEWORKVER value &apos;0.0.005&apos;. &quot;#EC NOTEXT
endinterface.
class ZAPLINK_RAW_DATA definition
  abstract
  create public .
public section.
*  interface ZAPLINK_DATATYPES load .
  data _DEPENDENCIES type ZAPLINK_DATATYPES=&gt;TT_COMPKEYS .
  data _CODE_SIGNATURE type ZAPLINK_DATATYPES=&gt;TD_CHECKSUM .
protected section.
private section.
endclass. &quot;ZAPLINK_RAW_DATA definition
class ZAPLINK_TOOLS definition
  create public .
public section.
  type-pools SEDI .
  type-pools SMODI .
  interfaces ZAPLINK_DATATYPES .
  aliases COMP_NODENAME
    for ZAPLINK_DATATYPES~COMP_NODENAME .
  aliases EXISTS
    for ZAPLINK_DATATYPES~EXISTS .
  aliases EXT_SEP
    for ZAPLINK_DATATYPES~EXT_SEP .
  aliases FILE_EXT
    for ZAPLINK_DATATYPES~FILE_EXT .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TEXTPOOL_KINDS
    for ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  aliases TD_CLASSNAME
    for ZAPLINK_DATATYPES~TD_CLASSNAME .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTEXT
    for ZAPLINK_DATATYPES~TD_COMPTEXT .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_CONTNAME
    for ZAPLINK_DATATYPES~TD_CONTNAME .
  aliases TD_CONTVER
    for ZAPLINK_DATATYPES~TD_CONTVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_FILENAME
    for ZAPLINK_DATATYPES~TD_FILENAME .
  aliases TD_FILETYPE
    for ZAPLINK_DATATYPES~TD_FILETYPE .
  aliases TD_LANG
    for ZAPLINK_DATATYPES~TD_LANG .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_ORDERKIND
    for ZAPLINK_DATATYPES~TD_ORDERKIND .
  aliases TD_PROGNAME
    for ZAPLINK_DATATYPES~TD_PROGNAME .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  aliases TD_TRANSPORT_REQUEST
    for ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .
  aliases TD_TXTP_ID
    for ZAPLINK_DATATYPES~TD_TXTP_ID .
  aliases TD_TXTP_KIND
    for ZAPLINK_DATATYPES~TD_TXTP_KIND .
  aliases TD_TXTP_LEN
    for ZAPLINK_DATATYPES~TD_TXTP_LEN .
  aliases TD_TXTP_TEXT
    for ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  aliases TD_TYPEORDER
    for ZAPLINK_DATATYPES~TD_TYPEORDER .
  aliases TD_TYPE_AS_TEXT
    for ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  aliases TD_WITH_SUBCOMP
    for ZAPLINK_DATATYPES~TD_WITH_SUBCOMP .
  aliases TO_XML
    for ZAPLINK_DATATYPES~TO_XML .
  aliases TR_AUTHOR
    for ZAPLINK_DATATYPES~TR_AUTHOR .
  aliases TR_COMPNAME
    for ZAPLINK_DATATYPES~TR_COMPNAME .
  aliases TR_COMPTYPE
    for ZAPLINK_DATATYPES~TR_COMPTYPE .
  aliases TR_DLVUNIT
    for ZAPLINK_DATATYPES~TR_DLVUNIT .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TR_SRCSYSTEM
    for ZAPLINK_DATATYPES~TR_SRCSYSTEM .
  aliases TR_TR
    for ZAPLINK_DATATYPES~TR_TR .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_COMPONENT
    for ZAPLINK_DATATYPES~TS_COMPONENT .
  aliases TS_CONNDATA
    for ZAPLINK_DATATYPES~TS_CONNDATA .
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TS_CONTDATA
    for ZAPLINK_DATATYPES~TS_CONTDATA .
  aliases TS_DIRECTORY
    for ZAPLINK_DATATYPES~TS_DIRECTORY .
  aliases TS_DOC
    for ZAPLINK_DATATYPES~TS_DOC .
  aliases TS_HEAD
    for ZAPLINK_DATATYPES~TS_HEAD .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TS_TXTP_TEXT
    for ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  aliases TS_TXTP_TEXTPOOL
    for ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  aliases TS_TYPE
    for ZAPLINK_DATATYPES~TS_TYPE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  aliases TT_CONN_CLASSES
    for ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_RAWTEXT
    for ZAPLINK_DATATYPES~TT_RAWTEXT .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  class-methods GET_KEYS_FROM_TR
    importing
      !TR type TR_TR
    returning
      value(RESULT) type TT_COMPKEYS .
  class-methods GET_KEYS_FROM_PACKAGE
    importing
      !PACKAGES type TR_PACKAGES
      !EXT type ABAP_BOOL default ABAP_TRUE
    returning
      value(RESULT) type TT_COMPKEYS .
  class-methods GET_KEYS_FROM_TADIR
    importing
      !SRCSYSTEM type TR_SRCSYSTEM optional
      !TYPE type TR_COMPTYPE optional
      !NAME type TR_COMPNAME optional
      !PACKAGES type TR_PACKAGES optional
      !EXT type ABAP_BOOL default ABAP_TRUE
      !AUTHOR type TR_AUTHOR optional
    returning
      value(RESULT) type TT_COMPKEYS .
  class-methods CONV_ABAP_LINE
    importing
      !SOURCE type STRING
    returning
      value(TARGET) type STRING .
  class-methods CALCULATE_MD5_HASH
    importing
      !STRING type STRING
    returning
      value(RESULT) type TD_CHECKSUM .
  class-methods TABLE_2_STRING
    importing
      !SOURCE type STANDARD TABLE
    returning
      value(RESULT) type STRING .
  class-methods PRETTY_PRINTER
    importing
      !INDENT type ABAP_BOOL optional
    changing
      !TABLE type STANDARD TABLE .
  class-methods CONDENSE_ABAP_SOURCE
    changing
      !TABLE type STANDARD TABLE .
  class-methods CONV_TABLE_2UPCASE
    changing
      !TABLE type STANDARD TABLE .
  class-methods CLEAN_ABAP_STRING
    importing
      !DATA type STRING
    returning
      value(RESULT) type STRING .
  class-methods INVERSE_TABLE_ORDER
    changing
      !MY_TABLE type STANDARD TABLE .
protected section.
  types:
    TT_E071 type STANDARD TABLE OF e071 with DEFAULT KEY .
  class-methods CONV_LIMU_2_R3TR
    importing
      !E071 type TT_E071
    returning
      value(RESULT) type TT_COMPKEYS .
private section.
endclass. &quot;ZAPLINK_TOOLS definition
class ZAPLINK_CX definition
  inheriting from CX_STATIC_CHECK
  create public
  FRIENDS ZAPLINK_CX .
public section.
  type-pools ICON .
  types TO_EXCEPTION type ref to ZAPLINK_CX .
  types TO_ROOT_EXCEPTION type ref to CX_ROOT .
  types:
    BEGIN OF ts_cx,
      class TYPE seoclsname,
    END OF ts_cx .
  types:
    tt_cx_list TYPE HASHED TABLE OF ts_cx WITH UNIQUE key class .
  types:
    BEGIN OF ts_source_def,
        type_txt TYPE euobjt-singular,
        name TYPE seu_objkey,
        str type string,
      END OF ts_source_def .
  types E_TXT_ID type SOTR_CONC .
  types O_MSG_COLL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types:
    BEGIN OF ts_source_pos,
        program_name  TYPE  syrepid,
        include_name  TYPE  syrepid,
        source_line   TYPE  i,
      END OF ts_source_pos .
  constants BAL_LOG type SOTR_CONC value &apos;8A01044B27B3115BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX type SOTR_CONC value &apos;8901044B27B3115BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants SYSTEM_ERROR type SOTR_CONC value &apos;367A594B811A1F5EE1000000AC120173&apos;. &quot;#EC NOTEXT
  data MESSAGES type O_MSG_COLL .
  data OBJECT type BALOBJ_D .
  data SUBOBJECT type BALSUBOBJ .
  data PREV_CX type ref to ZAPLINK_CX .
  data EXT_ID type BALNREXT .
  data CX_NAME type STRING .
  class-data _CX_LIST type TT_CX_LIST .
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional .
  methods UPDATE .
  class-methods CREATE_FROM_APPLICATION_LOG
    importing
      !CX_NAME type STRING optional
      !MESSAGE_COLLECTOR type O_MSG_COLL
      !TEXTID type E_TXT_ID default BAL_LOG
      !PREV_CX type ref to ZAPLINK_CX optional
    returning
      value(RESULT) type ref to ZAPLINK_CX
    raising
      ZAPLINK_CX .
  methods WRITE .
  methods GET_SOURCE_POSITION_AS_STRING
    returning
      value(STR) type STRING .
  class-methods SOURCE_POSITION_AS_STRING
    importing
      !EXCEPTION type ref to CX_ROOT
    returning
      value(STR) type STRING .
  class-methods CREATE_FROM_MF_CX
    importing
      !FUNCNAME type RS38L-NAME
      value(SUBRC) type SY-SUBRC
      !CLASSNAME type STRING optional
      !TEXTID type SOTR_CONC default SYSTEM_ERROR
    returning
      value(RESULT) type ref to ZAPLINK_CX
    raising
      ZAPLINK_CX .
  class-methods CREATE_FROM_SYMSG
    importing
      !CLASSNAME type STRING optional
      !TEXTID type SOTR_CONC default SYSTEM_ERROR
    returning
      value(RESULT) type ref to ZAPLINK_CX
    raising
      ZAPLINK_CX .
protected section.
  class-methods CONV_PROGNAME
    importing
      !OBJECT_NAME type SEU_OBJKEY
      !CONTEXT type SEU_OBJKEY optional
    returning
      value(SOURCE) type TS_SOURCE_DEF .
  class-methods _CREATE_CX
    importing
      !CX_NAME type STRING optional
      !TEXTID type SOTR_CONC
    returning
      value(RESULT) type ref to ZAPLINK_CX
    raising
      ZAPLINK_CX .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_CX definition
class ZAPLINK_DEVC_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_PACKAGE .
public section.
  types:
    tt_acls TYPE STANDARD TABLE OF pkgpermdat WITH NON-UNIQUE DEFAULT KEY .
  types TO_RAW type ref to ZAPLINK_RAW .
  types:
    BEGIN OF ts_interface,
        zl_object TYPE to_raw,
      END OF ts_interface .
  types:
    tt_interfaces TYPE STANDARD TABLE OF ts_interface WITH NON-UNIQUE DEFAULT KEY .
  types:
    BEGIN OF ts_package,
        zl_object TYPE to_raw,
      END OF ts_package .
  types:
    tt_packages TYPE STANDARD TABLE OF ts_package WITH NON-UNIQUE DEFAULT KEY .
  data A0_MAINDATA type SCOMPKDTLN .
  data INTERFACES type TT_INTERFACES .
  data PACKAGES type TT_PACKAGES .
  data IF type ref to IF_PACKAGE .
  data ACLS type TT_ACLS .
protected section.
private section.
endclass. &quot;ZAPLINK_DEVC_DATA definition
class ZAPLINK_DOCV_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DOCUMENTATION .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TS_HEAD
    for ZAPLINK_DATATYPES~TS_HEAD .
  types:
    tt_text TYPE STANDARD TABLE OF tline WITH DEFAULT KEY .
  types:
    begin of ts_text,
        Langu type sy-langu,
        _     type string,      &quot; Text
      end of ts_text .
  types:
    tt_texts type SORTED TABLE OF ts_text with UNIQUE key langu .
  types:
    tt_rawtext TYPE STANDARD TABLE OF tline WITH DEFAULT KEY .
  data A0_MAINDATA type TS_HEAD .
  data TEXTS type TT_TEXTS .
protected section.
  aliases TS_DOC
    for ZAPLINK_DATATYPES~TS_DOC .
  methods FROM_DATA
    importing
      !FM_DATA type TS_DOC .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_DOC .
private section.
endclass. &quot;ZAPLINK_DOCV_DATA definition
class ZAPLINK_DOMA_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd07v TYPE STANDARD TABLE OF dd07v WITH DEFAULT KEY .
  types:
    tt_dd07t TYPE SORTED TABLE OF dd07t WITH UNIQUE KEY valpos ddlanguage .
  types:
    tt_dd01t TYPE SORTED TABLE OF dd01t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
                header        TYPE dd01v,
                texts         TYPE tt_dd01t,
                docs          TYPE tt_docs,
                values        TYPE tt_dd07v,
                values_texts  TYPE tt_dd07t,
              END OF ts_fm_data .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd01v AS hdr.
    TYPES:
      END OF ts_maindata .
  types:
    BEGIN OF ts_value.
    INCLUDE TYPE dd07v AS main.
    TYPES:
        texts TYPE tt_texts,
      END OF ts_value .
  types:
    tt_values TYPE SORTED TABLE OF ts_value WITH UNIQUE KEY valpos .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data VALUES type TT_VALUES .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;DO&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_DOMA_DATA definition
class ZAPLINK_DTEL_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd04t TYPE SORTED TABLE OF dd04t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
        header        TYPE dd04v,
        param         TYPE tpara,
        texts         TYPE tt_dd04t,
        docs          TYPE tt_docs,
      END OF ts_fm_data .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd04v AS hdr.
    INCLUDE TYPE tpara AS param.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;DE&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_DTEL_DATA definition
class ZAPLINK_ENQU_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd26e TYPE STANDARD TABLE OF dd26e WITH DEFAULT KEY .
  types:
    tt_dd27p TYPE STANDARD TABLE OF dd27p WITH DEFAULT KEY .
  types:
    tt_dd25t TYPE SORTED TABLE OF dd25t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
          header        TYPE dd25v,
          texts         TYPE tt_dd25t,
          docs          TYPE tt_docs,
          tables        TYPE tt_dd26e,
          fields        TYPE tt_dd27p,
        END OF ts_fm_data .
  types:
    tt_fields TYPE SORTED TABLE OF dd53d WITH UNIQUE KEY viewfield .
  types:
    tt_tables TYPE SORTED TABLE OF dd26e WITH UNIQUE KEY tabpos .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd25v AS hdr.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data FIELDS type TT_FIELDS .
  data TABLES type TT_TABLES .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;TT&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_ENQU_DATA definition
class ZAPLINK_EXCC_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_OS_COMMAND .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE SXPGCOLIST.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
protected section.
private section.
endclass. &quot;ZAPLINK_EXCC_DATA definition
class ZAPLINK_FUGR_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_FUNCTION_GROUP .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_DYNPROS
    for ZAPLINK_DATATYPES~TT_DYNPROS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  class-methods CLASS_CONSTRUCTOR .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  types:
    BEGIN OF ts_doc_param,
      func  TYPE rs38l_fnam,
      param TYPE rs38l_par_,
    END OF ts_doc_param .
  types T_RAW type RSWSOURCET .
  types TO_MENUPAINTER type ref to ZAPLINK_MENUPAINTER_DATA .
  types:
    tt_tlibt TYPE SORTED TABLE OF tlibt WITH UNIQUE KEY spras .
  types:
    tt_tftit TYPE SORTED TABLE OF tftit WITH UNIQUE KEY funcname spras .
  types:
    tt_funct TYPE SORTED TABLE OF funct WITH UNIQUE KEY funcname parameter kind spras .
  types:
    tt_rsimp TYPE STANDARD TABLE OF rsimp WITH DEFAULT KEY .
  types:
    tt_rscha TYPE STANDARD TABLE OF rscha WITH DEFAULT KEY .
  types:
    tt_rsexp TYPE STANDARD TABLE OF rsexp WITH DEFAULT KEY .
  types:
    tt_rstbl TYPE STANDARD TABLE OF rstbl WITH DEFAULT KEY .
  types:
    tt_rsexc TYPE STANDARD TABLE OF rsexc WITH DEFAULT KEY .
  types:
    BEGIN OF ts_source,
            _ TYPE string,
          END OF ts_source .
  types TD_INCLUDENAME type D010INC-INCLUDE .
  types:
    BEGIN OF ts_include,
      name   TYPE td_includename,
      source TYPE ts_source,
    END OF ts_include .
  types:
    tt_includes TYPE SORTED TABLE OF ts_include WITH UNIQUE KEY name .
  types:
    BEGIN OF ts_rawinclude,
      name   TYPE td_includename,
      source TYPE tt_abaprawsource,
    END OF ts_rawinclude .
  types:
    tt_rawincludes TYPE STANDARD TABLE OF ts_rawinclude WITH NON-UNIQUE KEY name .
  types:
    BEGIN OF ts_func,
                header          TYPE rs38l,
                import_p        TYPE tt_rsimp,
                changing_p      TYPE tt_rscha,
                export_p        TYPE tt_rsexp,
                tables          TYPE tt_rstbl,
                exceptions      TYPE tt_rsexc,
                source          TYPE tt_abaprawsource,
      END OF ts_func .
  types:
    tt_funcs TYPE SORTED TABLE OF ts_func WITH UNIQUE KEY header-name .
  types:
    BEGIN OF ts_fm_data,
                header          TYPE tlibg,
                texts           TYPE tt_tlibt,
                docs            TYPE tt_docs,
                textspool       TYPE tt_txtp_textpools,
                dynpros         TYPE tt_dynpros,
                menupainter     TYPE to_menupainter,
                includes        TYPE tt_rawincludes,
                functions       TYPE tt_funcs,
                function_texts  TYPE tt_tftit,
                param_texts     TYPE tt_funct,
              END OF ts_fm_data .
  types:
    BEGIN OF ts_maindata.
  INCLUDE TYPE tlibg as hdr.
  TYPES:
      texts       TYPE tt_texts,
    END OF ts_maindata .
  types:
    BEGIN OF ts_textpool,
          id    TYPE  textpoolid,
          key   TYPE  textpoolky,
          texts TYPE  tt_texts,
        END OF ts_textpool .
  types:
    tt_textpools TYPE SORTED TABLE OF ts_textpool WITH UNIQUE KEY id KEY .
  types TD_PARAMKIND type KIND .
  types:
    BEGIN OF ts_param,
      kind TYPE td_paramkind.
  INCLUDE TYPE rsimp AS hdr.
  TYPES:
      texts       TYPE tt_texts,
    END OF ts_param .
  types:
    tt_params TYPE SORTED TABLE OF ts_param WITH UNIQUE KEY parameter .
  types:
    BEGIN OF ts_excep.
  INCLUDE TYPE rsexc AS hdr.
  TYPES:
      texts       TYPE tt_texts,
    END OF ts_excep .
  types:
    tt_exceptions TYPE SORTED TABLE OF ts_excep WITH UNIQUE KEY exception .
  types:
    BEGIN OF ts_function,
      name        TYPE rs38l-name,
      global      TYPE rs38l-global,
      remote      TYPE rs38l-remote,
      utask       TYPE rs38l-utask,
      texts       TYPE tt_texts,
      parameters  TYPE tt_params,
      exceptions  TYPE tt_exceptions,
      source      TYPE ts_source,
    END OF ts_function .
  types:
    tt_functions TYPE SORTED TABLE OF ts_function WITH UNIQUE KEY name .
  constants:
    BEGIN OF parameter_kinds,
      importing   TYPE td_paramkind VALUE &apos;I&apos;,
      changing    TYPE td_paramkind VALUE &apos;C&apos;,
      exporting   TYPE td_paramkind VALUE &apos;E&apos;,
      table       TYPE td_paramkind VALUE &apos;T&apos;,
    END OF parameter_kinds .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTSPOOL type TT_TXTP_TEXTPOOLS .
  data SOURCE type TS_SOURCE .
  data DYNPROS type TT_DYNPROS .
  data MENUPAINTER type TO_MENUPAINTER .
  data FUNCTIONS type TT_FUNCTIONS .
  data INCLUDES type TT_INCLUDES .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
private section.
  constants:
    BEGIN OF markups,
      area TYPE string VALUE &apos;[FUNCTIONGROUP NAME]&apos;,
    END OF markups .
  constants:
    BEGIN OF suffixes,
      top TYPE rs38l-suffix VALUE &apos;TOP&apos;,
    END OF suffixes .
  constants:
    BEGIN OF DOC_IDS,
      group     TYPE td_doc_id VALUE &apos;RE&apos;,    &quot; Report
      function  TYPE td_doc_id VALUE &apos;FU&apos;,
    END OF DOC_IDS .
  class-data:
    BEGIN OF R_DOC_IDS,
      group    TYPE TR_DOCID,
      function TYPE TR_DOCID,
    END OF R_DOC_IDS .
endclass. &quot;ZAPLINK_FUGR_DATA definition
INTERFACE ZAPLINK_KERNEL_TYPES.
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  types TO_CONTAINER type ref to ZAPLINK_CONTAINER .
  types TO_FILE type ref to ZAPLINK_FILE .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_MSG_COLL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types TO_OPTIONS type ref to ZAPLINK_OPTIONS .
  types TO_OPT_DEVCLASS type ref to ZAPLINK_OPT_DEVCLASS .
  types TO_RAW type ref to ZAPLINK_RAW .
  types TO_RAW_BASE type ref to ZAPLINK_RAW_BASE .
  constants BALLOG_OBJECT type BALOBJ_D value &apos;ZAPLINK&apos;. &quot;#EC NOTEXT
endinterface.
class ZAPLINK_MENUPAINTER_DATA definition
  create public
  FRIENDS ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    BEGIN OF ts_mp_text,
          langu TYPE rsmptexts-sprsl,
          text  TYPE rsmptexts-text,
        END OF ts_mp_text .
  types:
    tt_mp_texts TYPE SORTED TABLE OF ts_mp_text WITH UNIQUE KEY langu .
  types:
    BEGIN OF ts_mp_ftext,
          langu TYPE rsmptexts-sprsl,
          text  TYPE rsmptexts-text,
          icon  TYPE rsmptexts-text,
          info  TYPE rsmptexts-text,
        END OF ts_mp_ftext .
  types:
    tt_mp_ftexts TYPE SORTED TABLE OF ts_mp_ftext WITH UNIQUE KEY langu .
  types:
    tt_funcs TYPE SORTED TABLE OF gui_func WITH UNIQUE KEY table_line .
  types:
    BEGIN OF ts_status.
    INCLUDE TYPE rsmpe_sta AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
        functions TYPE tt_funcs,
      END OF ts_status .
  types:
    tt_status TYPE SORTED TABLE OF ts_status WITH UNIQUE KEY code .
  types:
    BEGIN OF ts_function.
    INCLUDE TYPE rsmpe_fun AS hdr.
    TYPES:
        texts         TYPE tt_mp_ftexts,
      END OF ts_function .
  types:
    tt_functions TYPE SORTED TABLE OF ts_function WITH UNIQUE KEY code textno .
  types:
    tt_menu_details TYPE SORTED TABLE OF rsmpe_men WITH UNIQUE KEY no .
  types:
    BEGIN OF ts_menu.
    INCLUDE TYPE rsmpe_mnl AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_menu_details,
      END OF ts_menu .
  types:
    tt_menus TYPE SORTED TABLE OF ts_menu WITH UNIQUE KEY code .
  types:
    tt_bar_details TYPE SORTED TABLE OF rsmpe_act WITH UNIQUE KEY no .
  types:
    BEGIN OF ts_bar.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_bar_details,
      END OF ts_bar .
  types:
    tt_bars TYPE SORTED TABLE OF ts_bar WITH UNIQUE KEY obj_code .
  types:
    tt_button_details TYPE SORTED TABLE OF rsmpe_but WITH UNIQUE KEY no .
  types:
    BEGIN OF ts_button.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_button_details,
      END OF ts_button .
  types:
    tt_buttons TYPE SORTED TABLE OF ts_button WITH UNIQUE KEY sub_code .
  types:
    tt_keyssettings TYPE SORTED TABLE OF rsmpe_pfk WITH UNIQUE KEY pfno .
  types:
    BEGIN OF ts_keyboard.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        keys         TYPE tt_keyssettings,
        pushbuttons  TYPE tt_buttons,
      END OF ts_keyboard .
  types:
    tt_keyboards TYPE SORTED TABLE OF ts_keyboard WITH UNIQUE KEY obj_code .
  types:
    BEGIN OF ts_attribute.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
      END OF ts_attribute .
  types:
    tt_attributes TYPE SORTED TABLE OF ts_attribute WITH UNIQUE KEY obj_type obj_code sub_code .
  types:
    BEGIN OF ts_title.
    INCLUDE TYPE rsmpe_tit AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
      END OF ts_title .
  types:
    tt_titles TYPE SORTED TABLE OF ts_title WITH UNIQUE KEY code .
  types:
    tt_ffuncs TYPE SORTED TABLE OF rsmpe_buts WITH UNIQUE KEY obj_code sub_code .
  types:
    tt_stat TYPE STANDARD TABLE OF rsmpe_stat WITH DEFAULT KEY .
  types:
    tt_funt TYPE STANDARD TABLE OF rsmpe_funt WITH DEFAULT KEY .
  types:
    tt_men TYPE STANDARD TABLE OF rsmpe_men WITH DEFAULT KEY .
  types:
    tt_mnlt TYPE STANDARD TABLE OF rsmpe_mnlt WITH DEFAULT KEY .
  types:
    tt_act TYPE STANDARD TABLE OF rsmpe_act WITH DEFAULT KEY .
  types:
    tt_but TYPE STANDARD TABLE OF rsmpe_but WITH DEFAULT KEY .
  types:
    tt_pfk TYPE STANDARD TABLE OF rsmpe_pfk WITH DEFAULT KEY .
  types:
    tt_staf TYPE STANDARD TABLE OF rsmpe_staf WITH DEFAULT KEY .
  types:
    tt_atrt TYPE STANDARD TABLE OF rsmpe_atrt WITH DEFAULT KEY .
  types:
    tt_titt TYPE STANDARD TABLE OF rsmpe_titt WITH DEFAULT KEY .
  types:
    tt_buts TYPE STANDARD TABLE OF rsmpe_buts WITH DEFAULT KEY .
  types:
    tt_stexts TYPE SORTED TABLE OF rsmptexts WITH UNIQUE KEY obj_type obj_code sub_code texttype sprsl .
  types:
    BEGIN OF ts_fm_data,
          header        TYPE rsmpe_adm,
          status        TYPE tt_stat,
          functions     TYPE tt_funt,
          menus_det     TYPE tt_men,
          menus         TYPE tt_mnlt,
          bars_det      TYPE tt_act,
          buttons_det   TYPE tt_but,
          keyboards     TYPE tt_pfk,
          stat_funcs    TYPE tt_staf,
          attributes    TYPE tt_atrt,
          titles        TYPE tt_titt,
          ffuncs        TYPE tt_buts,
          texts         TYPE tt_stexts,
        END OF ts_fm_data .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;DO&apos;,
    END OF doc_ids .
  constants:
    BEGIN OF obj_types,   &quot; FROM Include RSMPECON
      menu      TYPE mp_o_type VALUE &apos;M&apos;,
      function  TYPE mp_o_type VALUE &apos;F&apos;,
      title     TYPE mp_o_type VALUE &apos;T&apos;,
      menu_bar  TYPE mp_o_type VALUE &apos;A&apos;,
      key_set   TYPE mp_o_type VALUE &apos;P&apos;,  &quot; Function Key Setting
      button    TYPE mp_o_type VALUE &apos;B&apos;,  &quot; Pushbutton settings
      status    TYPE mp_o_type VALUE &apos;C&apos;,
      separator TYPE mp_o_type VALUE &apos;S&apos;,
      icon      TYPE mp_o_type VALUE &apos;I&apos;,
      program   TYPE mp_o_type VALUE &apos;D&apos;,
      dynpro    TYPE mp_o_type VALUE &apos;E&apos;,
      text      TYPE mp_o_type VALUE &apos;Z&apos;,
      context   TYPE mp_o_type VALUE &apos;X&apos;,
      symbolbar TYPE mp_o_type VALUE &apos;Y&apos;,
    END OF obj_types .
  constants:
    BEGIN OF text_types,
      object      TYPE mp_txttype VALUE &apos;M&apos;,
      icon        TYPE mp_txttype VALUE &apos;I&apos;,
      quick_info  TYPE mp_txttype VALUE &apos;Q&apos;,
      tech_info   TYPE mp_txttype VALUE &apos;T&apos;,  &quot; Technical Information
    END OF text_types .
  data BAR type GUI_FUNC .
  data MENU type GUI_FUNC .
  data FUNCTION type GUI_FUNC .
  data DEFAULT_BAR type GUI_FUNC .
  data DEFAULT_FUNCTION type GUI_FUNC .
  data MASTER_LANG type SPRSL .
  data STATUS type TT_STATUS .
  data MENU_LIST type TT_MENUS .
  data MENU_BARS type TT_BARS .
  data KEY_SETTINGS type TT_KEYBOARDS .
  data FUNCTIONS type TT_FUNCTIONS .
  data TITLES type TT_TITLES .
private section.
  class-methods GET_TEXTS
    importing
      !TEXTS type TT_STEXTS
      !OBJ_TYPE type RSMPTEXTS-OBJ_TYPE
      !OBJ_CODE type RSMPTEXTS-OBJ_CODE
      !SUB_CODE type CLIKE
      !TEXTTYPE type RSMPTEXTS-TEXTTYPE
    returning
      value(RESULT) type TT_MP_TEXTS .
  class-methods GET_FUNC_TEXTS
    importing
      !TEXTS type TT_STEXTS
      !OBJ_CODE type RSMPTEXTS-OBJ_CODE
      !SUB_CODE type CLIKE
    returning
      value(RESULT) type TT_MP_FTEXTS .
  class-methods SET_TEXTS
    importing
      !OBJ_TYPE type RSMPTEXTS-OBJ_TYPE
      !OBJ_CODE type RSMPTEXTS-OBJ_CODE
      !SUB_CODE type CLIKE
      !TEXTTYPE type RSMPTEXTS-TEXTTYPE
      value(TEXTS) type TT_MP_TEXTS
    changing
      !RESULT type TT_STEXTS .
  class-methods SET_FUNC_TEXTS
    importing
      !OBJ_CODE type RSMPTEXTS-OBJ_CODE
      !SUB_CODE type CLIKE
      !TEXTS type TT_MP_FTEXTS
    changing
      !RESULT type TT_STEXTS .
endclass. &quot;ZAPLINK_MENUPAINTER_DATA definition
class ZAPLINK_MSAG_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_MESSAGE .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE t100a.
    TYPES:
      END OF ts_maindata .
  types:
    BEGIN OF ts_text,
          langu      TYPE spras,
          short_txt  TYPE string,
          long_txt   TYPE ts_lang,
        END OF ts_text .
  types:
    tt_texts TYPE SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  types:
    BEGIN OF ts_msgtext,
          msgnr       TYPE msgnr,
          name        TYPE syuname,
          datum       TYPE sydatum,
          selfdef     TYPE doku_selfd,
          application TYPE tdobject,
          typ         TYPE doku_typ,
          dokform     TYPE tdformnew,
          dokstyle    TYPE tdstyle,
          texts       TYPE tt_texts,
        END OF ts_msgtext .
  types:
    tt_msgtexts TYPE SORTED TABLE OF ts_msgtext WITH UNIQUE KEY msgnr .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data MESSAGES type TT_MSGTEXTS .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
private section.
endclass. &quot;ZAPLINK_MSAG_DATA definition
class ZAPLINK_OPT_BASE definition
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases BALLOG_OBJECT
    for ZAPLINK_DATATYPES~BALLOG_OBJECT .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  aliases TD_TRANSPORT_REQUEST
    for ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .
  aliases TS_DIRECTORY
    for ZAPLINK_DATATYPES~TS_DIRECTORY .
  types TO_COMPONENT type ref to ZAPLINK_RAW_BASE .
protected section.
private section.
endclass. &quot;ZAPLINK_OPT_BASE definition
class ZAPLINK_PINF_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_PACKAGE .
public section.
  types:
    TT_ELEMENTS TYPE STANDARD TABLE OF scomeldtln WITH NON-UNIQUE DEFAULT KEY .
  types:
    tt_acls     TYPE STANDARD TABLE OF scomaclstr WITH NON-UNIQUE DEFAULT KEY .
  data A0_MAINDATA type SCOMPIDTLN .
  data ACLS type TT_ACLS .
  data ELEMENTS type TT_ELEMENTS .
  data IF type ref to IF_PACKAGE_INTERFACE .
protected section.
private section.
endclass. &quot;ZAPLINK_PINF_DATA definition
class ZAPLINK_PROG_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_PROGRAM .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  aliases TS_SOURCEASSTRUC
    for ZAPLINK_DATATYPES~TS_SOURCEASSTRUC .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_DYNPROS
    for ZAPLINK_DATATYPES~TT_DYNPROS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  class-methods CLASS_CONSTRUCTOR .
protected section.
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  types TO_MENUPAINTER type ref to ZAPLINK_MENUPAINTER_DATA .
  types:
    tt_trdirti TYPE SORTED TABLE OF trdirti WITH UNIQUE KEY sprsl .
  types:
    BEGIN OF ts_fm_data,
      header          TYPE progdir,
      texts           TYPE tt_trdirti,
      docs            TYPE tt_docs,
      textspool       TYPE tt_txtp_textpools,
      dynpros         TYPE tt_dynpros,
      menupainter     TYPE to_menupainter,
      source          TYPE td_abapsource,
    END OF ts_fm_data .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE progdir.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data DOCUMENTATION_OFF type TT_DOCS .
  data TEXTSPOOL type TT_TXTP_TEXTPOOLS .
  data SOURCE type TS_SOURCEASSTRUC .
  data DYNPROS type TT_DYNPROS .
  data MENUPAINTER type TO_MENUPAINTER .
  data TEXTS type TT_TEXTS .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
private section.
  constants:
    BEGIN OF DOC_IDS,
      Prog      TYPE td_doc_id VALUE &apos;RE&apos;,    &quot; Report
    END OF DOC_IDS .
  class-data:
    BEGIN OF R_DOC_IDS,
      prog     TYPE TR_DOCID,
    END OF R_DOC_IDS .
endclass. &quot;ZAPLINK_PROG_DATA definition
class ZAPLINK_SHLP_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types TO_ME type ref to ZAPLINK_SHLP_DATA .
  types:
    tt_dd31v TYPE STANDARD TABLE OF dd31v WITH DEFAULT KEY .
  types:
    tt_dd32p TYPE STANDARD TABLE OF dd32p WITH DEFAULT KEY .
  types:
    tt_dd33v TYPE STANDARD TABLE OF dd33v WITH DEFAULT KEY .
  types:
    tt_dd30t TYPE SORTED TABLE OF dd30t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
        header        TYPE dd30v,
        texts         TYPE tt_dd30t,
        docs          TYPE tt_docs,
        fields        TYPE tt_dd32p,
        sub_sh        TYPE tt_dd31v,
        ssh_params    TYPE tt_dd33v,
      END OF ts_fm_data .
  types:
    tt_fields TYPE SORTED TABLE OF dd32p WITH UNIQUE KEY fieldname .
  types:
    tt_params TYPE SORTED TABLE OF dd33v WITH UNIQUE KEY subfield .
  types:
    BEGIN OF ts_sub_sh.
    INCLUDE TYPE dd31v AS hdr.
    TYPES:
        params        TYPE tt_params,
        zl_object     TYPE to_me,
      END OF ts_sub_sh .
  types:
    tt_sub_sh TYPE SORTED TABLE OF ts_sub_sh WITH UNIQUE KEY shposition .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd30v AS hdr.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data PARAMS type TT_FIELDS .
  data SUB_SEARCH_HELPS type TT_SUB_SH .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;TT&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_SHLP_DATA definition
class ZAPLINK_TABL_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd03p TYPE STANDARD TABLE OF dd03p WITH DEFAULT KEY .
  types:
    tt_dd05m TYPE STANDARD TABLE OF dd05m WITH DEFAULT KEY .
  types:
    tt_dd08v TYPE STANDARD TABLE OF dd08v WITH DEFAULT KEY .
  types:
    tt_dd12v TYPE STANDARD TABLE OF dd12v WITH DEFAULT KEY .
  types:
    tt_dd17v TYPE STANDARD TABLE OF dd17v WITH DEFAULT KEY .
  types:
    tt_dd35v TYPE STANDARD TABLE OF dd35v WITH DEFAULT KEY .
  types:
    tt_dd36m TYPE STANDARD TABLE OF dd36m WITH DEFAULT KEY .
  types:
    tt_dd02t TYPE SORTED TABLE OF dd02t WITH UNIQUE KEY ddlanguage .
  types:
    tt_dd03t TYPE SORTED TABLE OF dd03t WITH UNIQUE KEY fieldname ddlanguage .
  types:
    BEGIN OF ts_fm_data,
              header        TYPE dd02v,
              tech          TYPE dd09v,
              texts         TYPE tt_dd02t,
              docs          TYPE tt_docs,
              fields        TYPE tt_dd03p,
              fields_texts  TYPE tt_dd03t,
              forein_keys   TYPE tt_dd08v,      &quot; Header
              fk_fields     TYPE tt_dd05m,
              indexes       TYPE tt_dd12v,
              idx_fields    TYPE tt_dd17v,
              search_helps  TYPE tt_dd35v,
              sh_fields     TYPE tt_dd36m,
            END OF ts_fm_data .
  types:
    BEGIN OF ts_search_help.
    INCLUDE TYPE dd35v AS hdr.
    TYPES:
        fields TYPE SORTED TABLE OF dd36m WITH UNIQUE KEY shlpfield,
      END OF ts_search_help .
  types:
    BEGIN OF ts_forein_key.
    INCLUDE TYPE dd08v AS hdr.
    TYPES:
        fields TYPE SORTED TABLE OF dd05m WITH UNIQUE KEY primpos,
      END OF ts_forein_key .
  types:
    BEGIN OF ts_field.
    INCLUDE TYPE dd03p AS hdr.
    TYPES:
        texts       TYPE tt_texts,
        search_help TYPE ts_search_help,
        forein_key  TYPE ts_forein_key,
      END OF ts_field .
  types:
    tt_fields TYPE SORTED TABLE OF ts_field WITH UNIQUE KEY position .
  types:
    BEGIN OF ts_index.
    INCLUDE TYPE dd12v AS hdr.
    TYPES:
        fields TYPE SORTED TABLE OF dd17v WITH UNIQUE KEY position,
      END OF ts_index .
  types:
    tt_indexes TYPE SORTED TABLE OF ts_index WITH UNIQUE KEY indexname .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd02v AS hdr.
    TYPES:
        technical_settings TYPE dd09v,
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data FIELDS type TT_FIELDS .
  data INDEXES type TT_INDEXES .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;TB&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_TABL_DATA definition
class ZAPLINK_TTYP_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd42v TYPE STANDARD TABLE OF dd42v WITH DEFAULT KEY .
  types:
    tt_dd40t TYPE SORTED TABLE OF dd40t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
      header        TYPE dd40v,
      texts         TYPE tt_dd40t,
      keys          TYPE tt_dd42v,
      docs          type tt_docs,
    END OF ts_fm_data .
  types:
    tt_keys type SORTED TABLE OF dd42v with UNIQUE key KEYFDPOS .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd40v AS hdr.
    TYPES:
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data KEYS type TT_KEYS .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;TT&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_TTYP_DATA definition
class ZAPLINK_TYPE_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  final
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  types:
    BEGIN OF ts_data,
        name      TYPE typegroup,
        lang      TYPE langu,
        text      TYPE ddtext,
        devclass  TYPE devclass,
        uccheck   TYPE uccheck,
      END OF ts_data .
  types:
    tt_abapsource type standard table of ABAPSOURCE with DEFAULT KEY .
  types:
    tt_string type standard table of ABAPSOURCE with DEFAULT KEY .
  data A0_MAINDATA type TS_DATA .
  data SOURCE type STRING read-only .
  methods SET_SOURCE
    importing
      !SOURCE type STANDARD TABLE .
  methods GET_SOURCE
    returning
      value(SOURCE) type TT_ABAPSOURCE .
protected section.
private section.
endclass. &quot;ZAPLINK_TYPE_DATA definition
class ZAPLINK_VIEW_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_DICTIONARY
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types:
    tt_dd26v TYPE STANDARD TABLE OF dd26v WITH DEFAULT KEY .
  types:
    tt_dd27p TYPE STANDARD TABLE OF dd27p WITH DEFAULT KEY .
  types:
    tt_dd28j TYPE STANDARD TABLE OF dd28j WITH DEFAULT KEY .
  types:
    tt_dd28v TYPE STANDARD TABLE OF dd28v WITH DEFAULT KEY .
  types:
    tt_dd25t TYPE SORTED TABLE OF dd25t WITH UNIQUE KEY ddlanguage .
  types:
    BEGIN OF ts_fm_data,
            header        TYPE dd25v,
            tech          TYPE dd09v,
            texts         TYPE tt_dd25t,
            docs          TYPE tt_docs,
            tables        TYPE tt_dd26v,
            fields        TYPE tt_dd27p,
            joins         TYPE tt_dd28j,
            wheres        TYPE tt_dd28v,
          END OF ts_fm_data .
  types:
    tt_tables TYPE SORTED TABLE OF dd26v WITH UNIQUE KEY tabpos .
  types:
    tt_fields TYPE SORTED TABLE OF dd27p WITH UNIQUE KEY objpos .
  types:
    tt_joins TYPE STANDARD TABLE OF dd28j WITH DEFAULT KEY .
  types:
    tt_wheres TYPE SORTED TABLE OF dd28v WITH UNIQUE KEY position .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE dd25v AS hdr.
    TYPES:
        technical_settings TYPE dd09v,
      END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data TABLES type TT_TABLES .
  data FIELDS type TT_FIELDS .
  data INNER_JOIN type TT_JOINS .
  data CONDITIONS type TT_WHERES .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  class-data R_DOC_IDS type TR_DOCID .
  constants:
    BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;VW&apos;,
    END OF doc_ids .
private section.
endclass. &quot;ZAPLINK_VIEW_DATA definition
class ZAPLINK_CX_COMPONENT definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  constants ZAPLINK_CX_COMPONENT type SOTR_CONC value &apos;5A3F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants TWICE_CLASS type SOTR_CONC value &apos;C1E6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_TYPE type SOTR_CONC value &apos;C0E6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_SUBCOMPONENTS type SOTR_CONC value &apos;583F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_MSG_COLL type SOTR_CONC value &apos;BFE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_EXCEPTION type SOTR_CONC value &apos;BCE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_CONNECTOR type SOTR_CONC value &apos;BEE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_CLASS type SOTR_CONC value &apos;BDE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  data NAME type TD_COMPNAME .
  data TYPE type TD_COMPTYPE .
  data CONNCLASS type TD_CONNCLASS .
  data OBJTYPE type TD_OBJ_TYPE .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !NAME type TD_COMPNAME optional
      !TYPE type TD_COMPTYPE optional
      !CONNCLASS type TD_CONNCLASS optional
      !OBJTYPE type TD_OBJ_TYPE optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_COMPONENT definition
class ZAPLINK_CX_CONNECTOR definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  constants FILE_ERROR type SOTR_CONC value &apos;EEE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants NOT_AUTHORIZED type SOTR_CONC value &apos;ECE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants NOT_FOUND type SOTR_CONC value &apos;F33F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants OBJECT_LOCKED type SOTR_CONC value &apos;F23F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_CONNECTOR type SOTR_CONC value &apos;EBE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants TWICE_CLASS type SOTR_CONC value &apos;A8A50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_TYPE type SOTR_CONC value &apos;A9A50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_CONNECTOR type SOTR_CONC value &apos;ADA50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_UUID type SOTR_CONC value &apos;11A70A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_XML type SOTR_CONC value &apos;3FAE0C4BB69DC72BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants UNSUPORTED_VERSION type SOTR_CONC value &apos;F6B50C4BB69DC72BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants TYPE_NOT_SUPPORTED type SOTR_CONC value &apos;7877604B1E06A869E1000000AC120173&apos;. &quot;#EC NOTEXT
  constants TWICE_UUID type SOTR_CONC value &apos;4A1F684B5215E22AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants XML_ERROR type SOTR_CONC value &apos;F8B7C44B357AEB67E1000000AC120173&apos;. &quot;#EC NOTEXT
  data NAME type TD_COMPNAME value &apos;[NAME]&apos;. &quot;#EC NOTEXT .
  data TYPE type TD_COMPTYPE value &apos;[TY]&apos;. &quot;#EC NOTEXT .
  data DEVCLASS type TD_DEVCLASS value &apos;[DEVCLASS]&apos;. &quot;#EC NOTEXT .
  data CONNCLASS type TD_CONNCLASS value &apos;[CONNCLASS]&apos;. &quot;#EC NOTEXT .
  data CONNUUID type TD_CONNUUID value &apos;00000000000000000000000000000000&apos;. &quot;#EC NOTEXT .
  data NODE_NAME type STRING value &apos;[NODE_NAME]&apos;. &quot;#EC NOTEXT .
  data CONN_VER type TD_CONNVER value &apos;[CONN_VER]&apos;. &quot;#EC NOTEXT .
  data OTHERCLASS type TD_CONNCLASS value &apos;[OTHERCLASS]&apos;. &quot;#EC NOTEXT .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !NAME type TD_COMPNAME default &apos;[NAME]&apos;
      !TYPE type TD_COMPTYPE default &apos;[TY]&apos;
      !DEVCLASS type TD_DEVCLASS default &apos;[DEVCLASS]&apos;
      !CONNCLASS type TD_CONNCLASS default &apos;[CONNCLASS]&apos;
      !CONNUUID type TD_CONNUUID default &apos;00000000000000000000000000000000&apos;
      !NODE_NAME type STRING default &apos;[NODE_NAME]&apos;
      !CONN_VER type TD_CONNVER default &apos;[CONN_VER]&apos;
      !OTHERCLASS type TD_CONNCLASS default &apos;[OTHERCLASS]&apos; .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_CONNECTOR definition
class ZAPLINK_CX_CONTAINER definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  constants ADD_COMP_FAILED type SOTR_CONC value &apos;FCE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ADD_FAILED type SOTR_CONC value &apos;FDE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants CIRCULAR_DEPENDENCIES type SOTR_CONC value &apos;4B5EA04BC24EA448E1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_CONTAINER type SOTR_CONC value &apos;FBE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  data NAME type ZAPLINK_CX_COMPONENT=&gt;TD_COMPNAME .
  data TYPE type ZAPLINK_CX_COMPONENT=&gt;TD_COMPTYPE .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !NAME type ZAPLINK_CX_COMPONENT=&gt;TD_COMPNAME optional
      !TYPE type ZAPLINK_CX_COMPONENT=&gt;TD_COMPTYPE optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_CONTAINER definition
class ZAPLINK_CX_FILE definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  types T_FILENAME type STRING .
  types T_FILETYPE type CHAR1 .
  constants DIALOG_CANCELED type SOTR_CONC value &apos;18E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_FILEKIND type SOTR_CONC value &apos;19E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_FILENAME type SOTR_CONC value &apos;1AE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_FILETYPE type SOTR_CONC value &apos;1BE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants LOAD_ERROR type SOTR_CONC value &apos;1CE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants MISSING_FILENAME type SOTR_CONC value &apos;17E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants SAVE_ERROR type SOTR_CONC value &apos;1DE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_FILE type SOTR_CONC value &apos;16E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  data FILENAME type T_FILENAME .
  data FILETYPE type T_FILETYPE .
  data FILEKIND type T_FILETYPE .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !FILENAME type T_FILENAME optional
      !FILETYPE type T_FILETYPE optional
      !FILEKIND type T_FILETYPE optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_FILE definition
class ZAPLINK_CX_LIST definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  constants ALREADY_EXISTS type SOTR_CONC value &apos;91E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants FAILED type SOTR_CONC value &apos;90E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants INVALID_ACTION type SOTR_CONC value &apos;8EE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ITERATOR_NOT_INITIALIZE type SOTR_CONC value &apos;8FE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants NOT_FOUND type SOTR_CONC value &apos;92E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_LIST type SOTR_CONC value &apos;A2E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  data NAME type TD_COMPNAME .
  data TYPE type TD_COMPTYPE .
  data CONNCLASS type TD_CONNCLASS .
  data SEL_ACTION type TD_SEL_ACTION .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !NAME type TD_COMPNAME optional
      !TYPE type TD_COMPTYPE optional
      !CONNCLASS type TD_CONNCLASS optional
      !SEL_ACTION type TD_SEL_ACTION optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_LIST definition
class ZAPLINK_CX_OPTIONS definition
  inheriting from ZAPLINK_CX
  create public .
public section.
  constants DIALOG_CANCELED type SOTR_CONC value &apos;D8E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_OPTIONS type SOTR_CONC value &apos;D7E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_OPTIONS definition
class ZAPLINK_CX_OPT_DEVCLASS definition
  inheriting from ZAPLINK_CX_OPTIONS
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  constants INVALID_SUBSTITUTIONKIND type SOTR_CONC value &apos;4F40F14A7D29EF55E1000000AC12017F&apos;. &quot;#EC NOTEXT
  constants ZAPLINK_CX_OPT_DEVCLASS type SOTR_CONC value &apos;803BF14A7D29EF55E1000000AC12017F&apos;. &quot;#EC NOTEXT
  constants MISSING_DEVCLASS type SOTR_CONC value &apos;D335F14A4B29F055E1000000AC12017F&apos;. &quot;#EC NOTEXT
  data SUBSTKIND type TD_SUBSTITUTIONKIND .
  data DEVCLASS type TD_DEVCLASS .
  methods CONSTRUCTOR
    importing
      !TEXTID like TEXTID optional
      !PREVIOUS like PREVIOUS optional
      !MESSAGES type O_MSG_COLL optional
      !OBJECT type BALOBJ_D optional
      !SUBOBJECT type BALSUBOBJ optional
      !PREV_CX type ref to ZAPLINK_CX optional
      !EXT_ID type BALNREXT optional
      !CX_NAME type STRING optional
      !_CX_LIST type TT_CX_LIST optional
      !SUBSTKIND type TD_SUBSTITUTIONKIND optional
      !DEVCLASS type TD_DEVCLASS optional .
protected section.
private section.
endclass. &quot;ZAPLINK_CX_OPT_DEVCLASS definition
class ZAPLINK_FILE definition
  create public .
public section.
  types T_FILENAME type ZAPLINK_CX_FILE=&gt;T_FILENAME .
  types T_FILETYPE type ZAPLINK_CX_FILE=&gt;T_FILETYPE .
  constants C_FT_LOCAL type T_FILETYPE value &apos;L&apos;. &quot;#EC NOTEXT
  constants C_FT_SERVER type T_FILETYPE value &apos;S&apos;. &quot;#EC NOTEXT
  constants:
    BEGIN OF filetypes,
        local     TYPE t_filetype VALUE &apos;L&apos;,                &quot;#EC NOTEXT
        server    TYPE t_filetype VALUE &apos;S&apos;,                &quot;#EC NOTEXT
      END OF filetypes .
  methods GET_FILENAME
    returning
      value(RESULT) type T_FILENAME
    raising
      ZAPLINK_CX_FILE .
  methods GET_FILETYPE
    returning
      value(RESULT) type T_FILETYPE
    raising
      ZAPLINK_CX_FILE .
  methods SET_FILENAME
    importing
      !DATA type T_FILENAME
    raising
      ZAPLINK_CX_FILE .
  methods SET_FILETYPE
    importing
      !DATA type T_FILETYPE
    raising
      ZAPLINK_CX_FILE .
  methods GET_FILECONTENT
    returning
      value(RESULT) type STRING
    raising
      ZAPLINK_CX_FILE .
  methods SET_FILECONTENT
    importing
      !DATA type STRING
    raising
      ZAPLINK_CX_FILE .
  methods SAVE
    raising
      ZAPLINK_CX_FILE .
  methods LOAD
    raising
      ZAPLINK_CX_FILE .
  methods SAVE_DIALOG
    importing
      !FILENAME type T_FILENAME optional
    raising
      ZAPLINK_CX_FILE .
  methods LOAD_DIALOG
    importing
      !FILENAME type T_FILENAME optional
    raising
      ZAPLINK_CX_FILE .
  methods FILE_EXISTS
    returning
      value(RESULT) type ABAP_BOOL .
protected section.
  types T_CONTENT type STRING .
  data _FILENAME type T_FILENAME .
  data _FILETYPE type T_FILETYPE .
  data _CONTENT type T_CONTENT .
private section.
endclass. &quot;ZAPLINK_FILE definition
class ZAPLINK_MESSAGE_COLLECTOR definition
  create public .
public section.
  type-pools ABAP .
  types:
    t_msg TYPE STANDARD TABLE OF bal_s_msg WITH NON-UNIQUE DEFAULT KEY .
  data OBJECT type BALOBJ_D read-only .
  data MD_EXTNUMBER type BALNREXT read-only .
  data MD_LEVEL type BALLEVEL read-only .
  data SUBOBJECT type BALSUBOBJ read-only .
  data EXT_ID type BALNREXT read-only .
  constants:
    begin of ACTIONS,
      CREATE    type BU_AKTYP value &apos;01&apos;, &quot;#EC NOTEXT
      CHANGE    type BU_AKTYP value &apos;02&apos;, &quot;#EC NOTEXT
      DISPLAY   type BU_AKTYP value &apos;03&apos;, &quot;#EC NOTEXT
    end of ACTIONS .
  data MSGID type SYMSGID .
  constants:
    BEGIN OF probcl,
        very_imp    TYPE balprobcl VALUE &apos;1&apos;,               &quot;#EC NOTEXT
        important   TYPE balprobcl VALUE &apos;2&apos;,               &quot;#EC NOTEXT
        medium      TYPE balprobcl VALUE &apos;3&apos;,               &quot;#EC NOTEXT
        for_info    TYPE balprobcl VALUE &apos;4&apos;,               &quot;#EC NOTEXT
        other       TYPE balprobcl VALUE space,
      END OF probcl .
  data MD_HANDLE type BALLOGHNDL read-only .
  methods ADD
    importing
      !IS_MESSAGE type BAL_S_MSG optional
      !ID_MSGTY type SYMSGTY optional
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO optional
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_MSGD1 type SYDATUM optional
      !ID_MSGD2 type SYDATUM optional
      !ID_MSGD3 type SYDATUM optional
      !ID_MSGD4 type SYDATUM optional
      !ID_DETLEVEL type BALLEVEL optional
      !IF_CUMULATE type ABAP_BOOL optional
      !ID_PROBCLASS type BALPROBCL optional
      !ID_INDEX type NUMERIC optional
      !ID_SUBLOG type BALLOGHNDL optional
    exporting
      value(ES_MESSAGE) type BAL_S_MSG .
  methods ADD_ABEND
    importing
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  methods ADD_ERROR
    importing
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  methods ADD_EXCEPTION
    importing
      !EXCEPTION type ref to CX_ROOT
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  methods ADD_FROM_BAPI
    importing
      !IT_BAPIRET type BAPIRETTAB optional
      !IS_BAPIRET type BAPIRET2 optional
      !IF_CUMULATE type ABAP_BOOL optional
    exporting
      !EF_ADD_ERROR type ABAP_BOOL
      !EF_ADD_WARNING type ABAP_BOOL .
  methods ADD_FROM_INSTANCE
    importing
      !IO_MSGLIST type ref to ZAPLINK_MESSAGE_COLLECTOR
      !IF_ADD_AS_SUBNODE type ABAP_BOOL default ABAP_FALSE
      !IF_CUMULATE type ABAP_BOOL optional .
  methods ADD_INFO
    importing
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  methods ADD_SUCCESS
    importing
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  methods ADD_SYMSG
    importing
      !ID_MSGTY type SYMSGTY default SY-MSGTY
      !ID_DETLEVEL type BALLEVEL optional
      !IF_CUMULATE type ABAP_BOOL optional
      !ID_PROBCLASS type BALPROBCL optional
      !ID_INDEX type NUMERIC optional
    exporting
      value(ES_MESSAGE) type BAL_S_MSG .
  methods ADD_WARNING
    importing
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
  class-methods AS_CHAR
    importing
      !ID_DATE type SYDATUM
    returning
      value(RD_DATE) type CHAR10 .
  methods CHANGE_MSG_TYPE
    importing
      !ID_MSGTY_SRC type SYMSGTY optional
      !ID_MSGTY_TRG type SYMSGTY
    returning
      value(RD_CHANGED) type I .
  methods CHECK_CUSTO
    importing
      !ID_OBJECT type BALOBJ_D
      !ID_SUBOBJECT type BALSUBOBJ
    exceptions
      ERROR .
  methods CLEAR .
  class-methods CONVERT_DATE_TO_STRING
    importing
      !ID_DATE type SYDATUM
    exporting
      !ED_DATE_STRING type CSEQUENCE .
  methods COUNT
    returning
      value(RD_COUNT) type I .
  methods DELETE_MESSAGE
    importing
      !ID_MSGNUMBER type BALMNR
    exceptions
      NOT_FOUND .
  methods FREE .
  methods GET_FIRST_MESSAGE
    importing
      !ID_MSGTY type SYMSGTY default &apos;I&apos;
      !IF_OR_HIGHER type ABAP_BOOL default ABAP_TRUE
    exporting
      !ES_MESSAGE type BAL_S_MSG
    exceptions
      NOT_FOUND .
  methods GET_HANDLE
    returning
      value(RD_HANDLE) type BALLOGHNDL .
  methods GET_LAST_MESSAGE
    importing
      !ID_MSGTY type SYMSGTY default &apos;I&apos;
      !IF_OR_HIGHER type ABAP_BOOL default ABAP_TRUE
    exporting
      !ES_MESSAGE type BAL_S_MSG
    exceptions
      NOT_FOUND .
  methods GET_LIST
    returning
      value(ET_LIST) type T_MSG .
  methods GET_LIST_AS_BAPIRET
    returning
      value(ET_LIST) type BAPIRETTAB .
  class-methods GET_REF_TYPE
    importing
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR
    returning
      value(REF_TYPE) type ref to CL_ABAP_TYPEDESCR .
  methods GET_STATISTICS
    returning
      value(RS_STATISTICS) type BAL_S_SCNT .
  methods GET_STATISTICS_AS_TEXT
    importing
      !IF_OUTPUT_E_MESSAGES type ABAP_BOOL default ABAP_TRUE
      !IF_OUTPUT_W_MESSAGES type ABAP_BOOL default ABAP_TRUE
      !IF_OUTPUT_I_MESSAGES type ABAP_BOOL default ABAP_FALSE
      !IF_OUTPUT_HIGHEST_ONLY type ABAP_BOOL default ABAP_TRUE
    exporting
      value(ED_TEXT) type CSEQUENCE .
  methods HAS_MESSAGES_OF_MSGT
    importing
      !ID_MSGTY type SYMSGTY
      !IF_OR_HIGHER type ABAP_BOOL default ABAP_TRUE
    returning
      value(RF_EXISTS) type ABAP_BOOL .
  methods INIT
    importing
      !ID_OBJECT type BALOBJ_D
      !ID_SUBOBJECT type BALSUBOBJ
      !ID_EXTNUMBER type BALNREXT optional
      !AUTO_UPD_CUSTO type FLAG default ABAP_FALSE
      !ID_ACTIVITY type BU_AKTYP default ACTIONS-CREATE
    exceptions
      ERROR .
  methods INIT_BY_HANDLE
    importing
      !ID_HANDLE type BALLOGHNDL
    exceptions
      ERROR .
  methods INSERT
    importing
      !ID_INSERT_INDEX type I
      !IF_SET_FOLLOWING_AS_SUBNODE type ABAP_BOOL default ABAP_FALSE
      !IS_MESSAGE type BAL_S_MSG optional
      !ID_MSGTY type SYMSGTY optional
      !ID_MSGID type SYMSGID optional
      !ID_MSGNO type SYMSGNO optional
      !ID_MSGV1 type CLIKE optional
      !ID_MSGV2 type CLIKE optional
      !ID_MSGV3 type CLIKE optional
      !ID_MSGV4 type CLIKE optional
      !ID_MSGD1 type SYDATUM optional
      !ID_MSGD2 type SYDATUM optional
      !ID_MSGD3 type SYDATUM optional
      !ID_MSGD4 type SYDATUM optional
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional
      !ID_INDEX type NUMERIC optional
    exporting
      value(ES_MESSAGE) type BAL_S_MSG .
  class-methods IS_DATE_INITIAL
    importing
      !ID_DATE type SY-DATUM
    returning
      value(RF_INITIAL) type ABAP_BOOL .
  methods IS_EMPTY
    returning
      value(RF_EMPTY) type ABAP_BOOL .
  class-methods NEW
    returning
      value(OBJ) type ref to ZAPLINK_MESSAGE_COLLECTOR .
  methods RAISE_FIRST_MESSAGE
    importing
      !ID_MSGTY type SYMSGTY default &apos;E&apos;
      !IF_OR_HIGHER type ABAP_BOOL default ABAP_TRUE
    exceptions
      FIRST_MESSAGE .
  methods RAISE_ON_ERROR
    raising
      ZAPLINK_CX .
  methods SET_DETAIL_LEVEL
    importing
      !ID_ABSOLUTE type BALLEVEL optional
      !ID_RELATIVE type INT4 optional .
  methods SET_EXTNUMBER
    importing
      !ID_EXTNUMBER type BALNREXT .
  methods STORE
    importing
      !IF_IN_UPDATE_TASK type ABAP_BOOL default ABAP_FALSE
    exceptions
      ERROR .
  methods WRITE
    importing
      !_OFFSET type STRING optional .
protected section.
  types:
    BEGIN OF msg_x .
    INCLUDE TYPE bal_s_msg AS msg.
TYPES:
    msgnumber TYPE balmnr,
  END OF msg_x .
  types:
    t_msg_x TYPE STANDARD TABLE OF msg_x WITH NON-UNIQUE DEFAULT KEY .
  constants MC_MIN_LEVEL type N value &apos;1&apos;. &quot;#EC NOTEXT
  constants MC_MAX_LEVEL type N value &apos;9&apos;. &quot;#EC NOTEXT
  data MS_LOG type BAL_S_LOG .
  data MR_SUP_CALLSTACK type ref to SYS_CALLS .
  data MD_SUP_COUNT type SYTABIX .
  data MT_SUP_MSG type T_MSG_X .
  data MF_LOG_NOT_STORED type ABAP_BOOL value ABAP_FALSE. &quot;#EC NOTEXT .
  methods GET_LIST_X
    importing
      !ID_MSGTY type SYMSGTY default &apos;I&apos;
    exporting
      !ET_LIST_X type T_MSG_X .
  methods GET_MSG_FILTER
    importing
      value(ID_MSGTY) type SYMSGTY default &apos;I&apos;
      value(IF_OR_HIGHER) type ABAP_BOOL default ABAP_TRUE
    exporting
      !ES_MSG_FILTER type BAL_S_MFIL .
  methods _ADD_ZL_CX
    importing
      !EXCEPTION type ref to ZAPLINK_CX
      !ID_DETLEVEL type BALLEVEL optional
      !ID_PROBCLASS type BALPROBCL optional .
private section.
endclass. &quot;ZAPLINK_MESSAGE_COLLECTOR definition
class ZAPLINK_OPT_DEVCLASS definition
  inheriting from ZAPLINK_OPT_BASE
  create public .
public section.
  constants:
    BEGIN OF substitutionkinds,
        use_container  TYPE td_substitutionkind VALUE &apos;C&apos;,    &quot; Keep dev class in XML file
        no_overwrite   TYPE td_substitutionkind VALUE &apos;N&apos;,    &quot; No overwrite : Use existing devclass, otherwise use container devclass otherwise use local otherwise let user choose
        keep_existing  TYPE td_substitutionkind VALUE &apos;K&apos;,    &quot; Use devclass define in component
        local          TYPE td_substitutionkind VALUE &apos;L&apos;,    &quot; Devclass = $TMP
        fixed          TYPE td_substitutionkind VALUE &apos;F&apos;,    &quot; Assign allways the same specified devclass
      END OF substitutionkinds .
  methods CONSTRUCTOR .
  methods GET_SUBSTITUTIONKIND
    returning
      value(RESULT) type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SET_SUBSTITUTIONKIND
    importing
      !DATA type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods GET_DEVCLASS
    returning
      value(RESULT) type TD_DEVCLASS
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SET_DEVCLASS
    importing
      !DATA type TD_DEVCLASS
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SUBSTITUTE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type TD_DEVCLASS
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
protected section.
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_EXCEPTION type ref to ZAPLINK_CX_OPT_DEVCLASS .
  data _SUBSTITUTION type TD_SUBSTITUTIONKIND .
  data _DEVCLASS type TD_DEVCLASS .
  methods GET_EXISTING
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type TD_DEVCLASS
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods DO_EXISTS
    importing
      !DATA type TD_DEVCLASS
    returning
      value(RESULT) type TD_EXISTS
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
private section.
  constants LOCAL_DEVCLASS type TD_DEVCLASS value &apos;$TMP&apos;. &quot;#EC NOTEXT
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_OPT_DEVCLASS definition
class ZAPLINK_OPT_TRANSPORT_REQUEST definition
  inheriting from ZAPLINK_OPT_BASE
  create public .
public section.
  constants:
    BEGIN OF substitutionkinds,
        fixed             TYPE td_substitutionkind VALUE &apos;F&apos;,    &quot; Assign allways the same specified devclass
        same_as_container TYPE td_substitutionkind VALUE &apos;K&apos;,    &quot; Keep the same scheme as in container
        user              TYPE td_substitutionkind VALUE &apos;U&apos;,    &quot; let user select a transport request for all component
        input             TYPE td_substitutionkind VALUE &apos;I&apos;,    &quot; let user select a transport request for each component
        custom            TYPE td_substitutionkind VALUE &apos;X&apos;,    &quot; user define
      END OF substitutionkinds .
  methods CONSTRUCTOR .
  methods GET_SUBSTITUTIONKIND
    returning
      value(RESULT) type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SET_SUBSTITUTIONKIND
    importing
      !DATA type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods GET_TRANSPORT_REQUEST
    returning
      value(RESULT) type TD_TRANSPORT_REQUEST
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SET_TRANSPORT_REQUEST
    importing
      !DATA type TD_TRANSPORT_REQUEST
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
  methods SUBSTITUTE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type TD_TRANSPORT_REQUEST
    raising
      ZAPLINK_CX_OPT_DEVCLASS .
protected section.
  data _SUBSTITUTION type TD_SUBSTITUTIONKIND .
  data _TRANSPORT_REQUEST type TD_TRANSPORT_REQUEST .
private section.
  types:
    BEGIN OF ts_tr_substit,
     xml_tr TYPE td_transport_request,
     sap_tr TYPE td_transport_request,
   END OF ts_tr_substit .
  types:
    tt_tr_substits TYPE SORTED TABLE OF ts_tr_substit WITH UNIQUE KEY xml_tr .
  data _TR_MAPPING type TT_TR_SUBSTITS .
  data _USER_INPUT type TD_TRANSPORT_REQUEST .
endclass. &quot;ZAPLINK_OPT_TRANSPORT_REQUEST definition
INTERFACE ZAPLINK_CNX_EXT_CLEANER.
  type-pools ABAP .
  types TO_RAW type ref to ZAPLINK_RAW .
  methods ANONYMIZE
    importing
      !OBJECT type TO_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods UNANONYMIZE
    importing
      !OBJECT type TO_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
endinterface.
INTERFACE ZAPLINK_CNX_EXT_CODE_SIGNATURE.
  type-pools ABAP .
  interfaces ZAPLINK_DATATYPES .
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  methods GET_SIGNATURE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type TD_CHECKSUM
    raising
      ZAPLINK_CX_CONNECTOR .
endinterface.
class ZAPLINK_COMPONENT definition
  create public
  FRIENDS ZAPLINK_LIST .
public section.
  type-pools ABAP .
  interfaces ZAPLINK_DATATYPES .
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_WITH_SUBCOMP
    for ZAPLINK_DATATYPES~TD_WITH_SUBCOMP .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_COMPONENT
    for ZAPLINK_DATATYPES~TS_COMPONENT .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_CONN_EXCEPTION type ref to ZAPLINK_CX_CONNECTOR .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_EXCEPTION type ref to ZAPLINK_CX_COMPONENT .
  types TO_MSG_COLL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  types TO_ME type ref to ZAPLINK_COMPONENT .
  constants:
    BEGIN OF connexists,
          exists     TYPE td_connexists VALUE ZAPLINK_DATATYPES~EXISTS-exists,
          not_exists TYPE td_connexists VALUE ZAPLINK_DATATYPES~EXISTS-not_exists,
        END OF connexists .
  methods GET_TYPE
    returning
      value(RESULT) type TD_COMPTYPE
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_TYPE
    importing
      !DATA type TD_COMPTYPE
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_WITH_SUBCOMP
    returning
      value(RESULT) type TD_WITH_SUBCOMP
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_WITH_SUBCOMP
    importing
      !DATA type TD_WITH_SUBCOMP
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_DEVCLASS
    returning
      value(RESULT) type TD_DEVCLASS
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_DEVCLASS
    importing
      !DATA type TD_DEVCLASS
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_NAME
    returning
      value(RESULT) type TD_COMPNAME
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_NAME
    importing
      !DATA type ANY
    raising
      ZAPLINK_CX_COMPONENT .
  methods EXISTS
    returning
      value(RESULT) type TD_COMPEXISTS
    raising
      ZAPLINK_CX_COMPONENT .
  methods CONNECTOR_EXISTS
    returning
      value(RESULT) type TD_CONNEXISTS
    raising
      ZAPLINK_CX_COMPONENT .
  methods CONNECTOR
    returning
      value(RESULT) type TO_CONNECTOR
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_CONNUUID
    returning
      value(RESULT) type TD_CONNUUID
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_CONNUUID
    importing
      !DATA type TD_CONNUUID
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_KEY
    returning
      value(RESULT) type TS_COMPONENT
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_EXCEPTION
    returning
      value(RESULT) type TO_ROOT_EXCEPTION
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_EXCEPTION
    importing
      !DATA type TO_ROOT_EXCEPTION
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_MSG_COLL
    returning
      value(RESULT) type TO_MSG_COLL
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_MSG_COLL
    importing
      !DATA type TO_MSG_COLL
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_SUBCOMPONENTS
    returning
      value(RESULT) type TO_LIST
    raising
      ZAPLINK_CX_COMPONENT .
  methods SET_SUBCOMPONENTS
    importing
      !DATA type TO_LIST
    raising
      ZAPLINK_CX_COMPONENT .
  methods GET_CHECKSUM
    returning
      value(RESULT) type TD_CHECKSUM .
  methods SET_CHECKSUM
    importing
      !DATA type TD_CHECKSUM .
  methods GET_CODE_SIGNATURE
    returning
      value(RESULT) type TD_CHECKSUM .
  methods SET_CODE_SIGNATURE
    importing
      !DATA type TD_CHECKSUM .
  methods CLONE
    returning
      value(RESULT) type TO_ME .
  methods REFRESH
    raising
      ZAPLINK_CX_COMPONENT .
protected section.
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types:
    BEGIN OF ts_conndata,
          uuid      type td_connuuid,
          exists    TYPE td_connexists,
          o_conn    TYPE to_connector,
        END OF ts_conndata .
  types:
    BEGIN OF ts_class.
INCLUDE TYPE ts_conn_class.
TYPES:
    types TYPE tt_types,   &quot; supported_types
  END OF ts_class .
  types:
    tt_classes TYPE SORTED TABLE OF ts_class WITH UNIQUE KEY classname .
  types:
    tt_saptypes TYPE HASHED TABLE OF ko100 WITH UNIQUE KEY object .
  data NAME type TD_COMPNAME .
  data TYPE type TD_COMPTYPE .
  data _CONNECTOR type TS_CONNDATA .
  data _EXISTS type TD_COMPEXISTS .
  data _EXCEPTION type TO_CONN_EXCEPTION .
  data _MSG_COLL type TO_MSG_COLL .
  class-data _CLASSES type TT_CLASSES .
  data _DEVCLASS type TD_DEVCLASS .
  constants LOCAL_DEVCLASS type TD_DEVCLASS value &apos;$LOCAL$&apos;. &quot;#EC NOTEXT
  data _SUBCOMPONENTS type TO_LIST .
  data WITH_SUBCOMP type TD_WITH_SUBCOMP value ABAP_TRUE. &quot;#EC NOTEXT .
  data _CHECKSUM type TD_CHECKSUM .
  data _CODE_SIGNATURE type TD_CHECKSUM .
  methods _GET_KEY
    returning
      value(RESULT) type TS_COMPKEY .
  class-methods CREATE_NEW
    importing
      !KEY type TS_COMPKEY
    returning
      value(RESULT) type TO_ME
    raising
      ZAPLINK_CX_COMPONENT .
  methods _SET_KEY
    importing
      value(DATA) type TS_COMPKEY
    raising
      ZAPLINK_CX_COMPONENT .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
  methods ON_CHANGE_CLEAR .
  methods ON_CHANGE_UPDATE
    raising
      ZAPLINK_CX_COMPONENT .
endclass. &quot;ZAPLINK_COMPONENT definition
INTERFACE ZAPLINK_CONNECTOR.
  type-pools ABAP .
  interfaces ZAPLINK_DATATYPES .
  aliases BALLOG_OBJECT
    for ZAPLINK_DATATYPES~BALLOG_OBJECT .
  aliases COMP_NODENAME
    for ZAPLINK_DATATYPES~COMP_NODENAME .
  aliases EXISTS
    for ZAPLINK_DATATYPES~EXISTS .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TO_XML
    for ZAPLINK_DATATYPES~TO_XML .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  aliases TS_CONNDATA
    for ZAPLINK_DATATYPES~TS_CONNDATA .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types TO_EZ_XML type ref to ZAPLINK_EASYXML_4CNX .
  types TO_OPTIONS type ref to ZAPLINK_OPTIONS .
  types TO_RAW type ref to ZAPLINK_RAW .
  types TO_RAW_BASE type ref to ZAPLINK_RAW_BASE .
  types TO_RAW_DATA type ref to ZAPLINK_RAW_DATA .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  types TO_MSG_COLL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  data SUPPORTED_TYPES type TT_TYPES read-only .
  data APPLICATION_LOG type TO_MSG_COLL read-only .
  data VERSION type TD_CONNVER read-only .
  data OPTIONS type TO_OPTIONS .
  data UUID type TD_CONNUUID read-only .
  methods DO_EXISTS
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(EXISTS) type TD_COMPEXISTS
    raising
      ZAPLINK_CX_CONNECTOR .
  methods GET_VALUES
    importing
      !TYPE type TD_COMPTYPE
    changing
      !NAME type TD_COMPNAME
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP
    importing
      !OBJECT type TO_XML
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_FROM_SAP
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_XML
    raising
      ZAPLINK_CX_CONNECTOR .
  methods DELETE_FROM_SAP
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_CONNECTOR .
  methods WRITE_TO_SAP
    importing
      !OBJECT type TO_RAW
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods READ_FROM_SAP
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CREATE_NEW_RAW
    importing
      !TYPE type TD_COMPTYPE
    returning
      value(OBJECT) type TO_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IS_SUPPORTED_VERSION
    importing
      !VERSION type TD_CONNVER
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_CONNECTOR .
endinterface.
class ZAPLINK_CONNECTORS definition
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTEXT
    for ZAPLINK_DATATYPES~TD_COMPTEXT .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_FILENAME
    for ZAPLINK_DATATYPES~TD_FILENAME .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_TYPEORDER
    for ZAPLINK_DATATYPES~TD_TYPEORDER .
  aliases TD_TYPE_AS_TEXT
    for ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types TO_RAW_BASE type ref to ZAPLINK_RAW_BASE .
  types TO_MSG_COLL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  types:
    BEGIN OF ts_component,
          type TYPE td_comptype,
          name TYPE td_compname,
        END OF ts_component .
  constants:
    BEGIN OF exists,
          exists     TYPE td_connexists VALUE ZAPLINK_DATATYPES~EXISTS-exists,
          not_exists TYPE td_connexists VALUE ZAPLINK_DATATYPES~EXISTS-not_exists,
        END OF exists .
  class-data SUPPORTED_TYPES type TT_TYPES read-only .
  class-methods CLASS_CONSTRUCTOR .
  class-methods ADD_LOCAL_CONNECTOR
    importing
      !LOCAL_CLASS type TD_CONNCLASS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods DO_EXISTS
    importing
      !TYPE type TD_COMPTYPE
    returning
      value(RESULT) type TD_CONNEXISTS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods CREATE_CONNECTOR
    importing
      !TYPE type TD_COMPTYPE optional
      !CONNUUID type TD_CONNUUID optional
    returning
      value(RESULT) type TO_CONNECTOR
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods GET_VALUES
    changing
      !TYPE type TD_COMPTYPE
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods NODE_2_RAW
    importing
      !NODE type ref to IF_IXML_NODE
    returning
      value(RESULT) type TO_RAW_BASE
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods GET_TYPEORDER
    importing
      !DATA type TD_COMPTYPE
    returning
      value(RESULT) type TD_TYPEORDER .
  class-methods TYPE2TEXT
    importing
      !DATA type TD_COMPTYPE
    returning
      value(RESULT) type TD_TYPE_AS_TEXT .
  class-methods GET_CLASSNAME
    importing
      !O_CONN type TO_CONNECTOR
    returning
      value(RESULT) type TD_CONNCLASS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods CLEAR_CONNECTORS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods RESET_CONNECTORS
    raising
      ZAPLINK_CX_CONNECTOR .
protected section.
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TT_TYPELIST
    for ZAPLINK_DATATYPES~TT_TYPELIST .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_EXCEPTION type ref to ZAPLINK_CX_CONNECTOR .
  types:
    BEGIN OF ts_conndata,
          exists TYPE td_connexists,
          classname TYPE td_connclass,
          o_conn TYPE to_connector,
        END OF ts_conndata .
  types:
    BEGIN OF ts_class.
  INCLUDE TYPE ts_conn_class.
  TYPES:
      types TYPE tt_types,   &quot; supported_types
    END OF ts_class .
  types:
    tt_classes TYPE SORTED TABLE OF ts_class WITH UNIQUE KEY uuid .
  types:
    BEGIN OF ts_saptypes.
  INCLUDE TYPE ko100 AS hdr.
  TYPES:
      order TYPE td_typeorder,     &quot; order of prefered load
    END OF ts_saptypes .
  types:
    tt_saptypes TYPE HASHED TABLE OF ts_saptypes WITH UNIQUE KEY object .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  class-data TYPE_LIST type TT_TYPELIST .
  class-data SAPTYPES type TT_SAPTYPES .
  class-data _MSG_COLL type TO_MSG_COLL .
  class-data _CLASSES type TT_CLASSES .
  constants LOCAL_DEVCLASS type TD_DEVCLASS value &apos;$LOCAL$&apos;. &quot;#EC NOTEXT
  class-methods _SEARCH_CONNECTOR
    importing
      !TYPE type TD_COMPTYPE
    returning
      value(RESULT) type TS_CONN_DEF
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods GET_CONNECTORLIST
    returning
      value(RESULT) type TO_LIST .
  class-methods _ADD_CONNECTOR
    importing
      !CLASS type TD_CONNCLASS
      !DEVCLASS type TD_DEVCLASS optional
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods _UPDATE_DEF_CLASS
    raising
      ZAPLINK_CX_CONNECTOR .
private section.
  types:
    BEGIN OF ts_value,
           object TYPE td_comptype,
           text   TYPE td_comptext,
         END OF ts_value .
  types:
    tt_values TYPE STANDARD TABLE OF ts_value WITH DEFAULT KEY .
  class-data O_MYCX type TO_EXCEPTION .
  class-data VALUE_TABLE type TT_VALUES .
  class-data XMLENGINE type ref to IF_IXML .
  constants MAX_ORDER type TD_TYPEORDER value &apos;999999&apos;. &quot;#EC NOTEXT
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_CONNECTORS definition
class ZAPLINK_CONTAINER_4INST definition
  create public .
public section.
  type-pools ABAP .
  interfaces ZAPLINK_DATATYPES .
  aliases BALLOG_OBJECT
    for ZAPLINK_DATATYPES~BALLOG_OBJECT .
  aliases COMP_NODENAME
    for ZAPLINK_DATATYPES~COMP_NODENAME .
  aliases EXISTS
    for ZAPLINK_DATATYPES~EXISTS .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TEXTPOOL_KINDS
    for ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  aliases TD_CLASSNAME
    for ZAPLINK_DATATYPES~TD_CLASSNAME .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTEXT
    for ZAPLINK_DATATYPES~TD_COMPTEXT .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_CONTNAME
    for ZAPLINK_DATATYPES~TD_CONTNAME .
  aliases TD_CONTVER
    for ZAPLINK_DATATYPES~TD_CONTVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_FILENAME
    for ZAPLINK_DATATYPES~TD_FILENAME .
  aliases TD_FILETYPE
    for ZAPLINK_DATATYPES~TD_FILETYPE .
  aliases TD_LANG
    for ZAPLINK_DATATYPES~TD_LANG .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_ORDERKIND
    for ZAPLINK_DATATYPES~TD_ORDERKIND .
  aliases TD_PROGNAME
    for ZAPLINK_DATATYPES~TD_PROGNAME .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  aliases TD_TRANSPORT_REQUEST
    for ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .
  aliases TD_TXTP_ID
    for ZAPLINK_DATATYPES~TD_TXTP_ID .
  aliases TD_TXTP_KIND
    for ZAPLINK_DATATYPES~TD_TXTP_KIND .
  aliases TD_TXTP_LEN
    for ZAPLINK_DATATYPES~TD_TXTP_LEN .
  aliases TD_TXTP_TEXT
    for ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  aliases TD_TYPEORDER
    for ZAPLINK_DATATYPES~TD_TYPEORDER .
  aliases TD_TYPE_AS_TEXT
    for ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  aliases TO_XML
    for ZAPLINK_DATATYPES~TO_XML .
  aliases TR_DLVUNIT
    for ZAPLINK_DATATYPES~TR_DLVUNIT .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TR_TR
    for ZAPLINK_DATATYPES~TR_TR .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_COMPONENT
    for ZAPLINK_DATATYPES~TS_COMPONENT .
  aliases TS_CONNDATA
    for ZAPLINK_DATATYPES~TS_CONNDATA .
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TS_CONTDATA
    for ZAPLINK_DATATYPES~TS_CONTDATA .
  aliases TS_DIRECTORY
    for ZAPLINK_DATATYPES~TS_DIRECTORY .
  aliases TS_DOC
    for ZAPLINK_DATATYPES~TS_DOC .
  aliases TS_HEAD
    for ZAPLINK_DATATYPES~TS_HEAD .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TS_TXTP_TEXT
    for ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  aliases TS_TXTP_TEXTPOOL
    for ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  aliases TS_TYPE
    for ZAPLINK_DATATYPES~TS_TYPE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  aliases TT_CONN_CLASSES
    for ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_RAWTEXT
    for ZAPLINK_DATATYPES~TT_RAWTEXT .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types TO_RAW_BASE type ref to ZAPLINK_RAW_BASE .
  types TO_EXCEPTION type ref to ZAPLINK_CX_CONTAINER .
  types TO_OPTIONS type ref to ZAPLINK_OPTIONS .
  types TO_RAW type ref to ZAPLINK_RAW .
  types TO_LOG type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  types TO_FILE type ref to ZAPLINK_FILE .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  constants TN_CONTAINER_ROOT type STRING value &apos;CONTAINER&apos;. &quot;#EC NOTEXT
  data FILE type TO_FILE .
  data LOG type TO_LOG read-only .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CONTAINER&apos;. &quot;#EC NOTEXT
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR
    importing
      !O_FILE type TO_FILE .
  methods LOAD_FROM_FILE
    importing
      !O_FILE type TO_FILE optional
    raising
      ZAPLINK_CX_CONTAINER .
  methods TRANSPORT_TO_SAP
    importing
      !OBJECT_LIST type TO_LIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_CONTENT
    returning
      value(RESULT) type TO_LIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_OPTIONS
    returning
      value(RESULT) type TO_OPTIONS
    raising
      ZAPLINK_CX_CONTAINER .
  methods UNINSTALL_FROM_SAP
    importing
      !OBJECT_LIST type TO_LIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods SET_OPTIONS
    importing
      !DATA type TO_OPTIONS
    raising
      ZAPLINK_CX_CONTAINER .
protected section.
  types:
    BEGIN OF ts_nodeindex,
      key   TYPE ref to zaplink_component,
      node  TYPE REF TO if_ixml_node,
    END OF ts_nodeindex .
  types:
    tt_nodeindex type SORTED TABLE OF ts_nodeindex with UNIQUE key key .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  data XMLDATA type ref to IF_IXML_DOCUMENT .
  data _OPTIONS type TO_OPTIONS .
  class-data XMLENGINE type ref to IF_IXML .
  data _COMPLIST type TO_LIST .
  data _NODEINDEX type TT_NODEINDEX .
  methods _FIND_COMPONENT_NODE
    importing
      !COMPONENT type TO_COMPONENT
      !SUB_COMP type TO_COMPONENT optional
    returning
      value(NODE) type ref to IF_IXML_NODE
    raising
      ZAPLINK_CX_CONTAINER .
  methods _UPDATE_COMPONENTSLIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_ROOT
    returning
      value(ROOT) type ref to IF_IXML_NODE .
  methods _IS_SUBCOMPONENT
    importing
      !NODE type ref to IF_IXML_NODE
    returning
      value(RESULT) type ABAP_BOOL .
  methods _SEARCH_COMPONENTS
    importing
      !NODE type ref to IF_IXML_NODE
    raising
      ZAPLINK_CX_CONTAINER .
  methods _ADD_TO_COMPONENTSLIST
    importing
      !NODE type ref to IF_IXML_NODE
    raising
      ZAPLINK_CX_CONTAINER .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  data O_CURSOR type ref to IF_IXML_NODE .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_CONTAINER_4INST definition
class ZAPLINK_EASYXML definition
  create public .
public section.
  type-pools ABAP .
  types TO_LOG type ref to ZAPLINK_MESSAGE_COLLECTOR .
  data APPLICATION_LOG type TO_LOG read-only .
  methods ADD_ANY
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !NAME type STRING optional
      !ANY type ANY
      !XMLDOC type ref to IF_IXML_DOCUMENT
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR optional .
  methods ANY2XML
    importing
      !ANY type ANY
      !TYPE type STRING
      !ATTRIBUTS type ANY optional
    returning
      value(XMLDOC) type ref to IF_IXML_DOCUMENT
    raising
      ZAPLINK_CX .
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR .
  methods GET_ATTRIBUTS
    importing
      !XMLDOC type ref to IF_IXML_DOCUMENT
    changing
      !ATTRIBUTS type ANY
    raising
      ZAPLINK_CX .
  class-methods GET_REF_TYPE
    importing
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR
    returning
      value(REF_TYPE) type ref to CL_ABAP_TYPEDESCR .
  class-methods NODE2STRING
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
    returning
      value(STRING) type STRING .
  methods RESET .
  methods XML2ANY
    importing
      !XMLDOC type ref to IF_IXML_DOCUMENT
    changing
      !ANY type ANY
      !ATTRIBUTS type ANY optional
    raising
      ZAPLINK_CX .
  methods _XML2ANY
    importing
      !XML type ref to IF_IXML_NODE
    changing
      !ANY type ANY .
protected section.
  types TO_EXCEPTION type ref to ZAPLINK_CX .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  data IXML type ref to IF_IXML .
  methods ADD_OBJECT
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !NAME type STRING optional
      !OBJECT type ref to OBJECT
      !XMLDOC type ref to IF_IXML_DOCUMENT
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR optional .
  methods ADD_STRUCTURE
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !NAME type STRING optional
      !STRUCTURE type DATA
      !XMLDOC type ref to IF_IXML_DOCUMENT .
  methods ADD_TABLE
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !NAME type STRING optional
      !TABLE type ANY TABLE
      !XMLDOC type ref to IF_IXML_DOCUMENT .
  methods ELEM_2_STRING
    importing
      !ANY type ANY
      !TYPE_DESC type ref to CL_ABAP_TYPEDESCR optional
    returning
      value(STRING) type STRING .
  class-methods IS_SIMPLE_TYPE_KIND
    importing
      !TYPE_KIND type ABAP_TYPEKIND
    returning
      value(RESULT) type ABAP_BOOL .
  methods READ_ANY
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR optional
    changing
      !ANY type ANY .
  methods READ_OBJECT
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
      !TYPEDESC type ref to CL_ABAP_TYPEDESCR optional
    changing
      !OBJECT type ref to OBJECT .
  methods READ_STRUCTURE
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
    changing
      !STRUCTURE type DATA .
  methods READ_TABLE
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
    changing
      !TABLE type ANY TABLE .
  methods STACK
    importing
      !ITEM type STRING .
  methods STACK_DESCR
    importing
      !DESC type ref to CL_ABAP_TYPEDESCR .
  methods STRING_2_ELEM
    importing
      !TYPE_DESC type ref to CL_ABAP_TYPEDESCR optional
      value(STRING) type STRING
    changing
      !ANY type ANY .
  methods UNSTACK .
  methods GET_NODE_TEXT
    importing
      !XML_NODE type ref to IF_IXML_ELEMENT
    returning
      value(RESULT) type STRING .
  class-methods NODE_IS_NOT_TYPE
    importing
      !NODE type ref to IF_IXML_NODE
      !TYPE type I
    returning
      value(RESULT) type ABAP_BOOL .
  class-methods NODE_IS_TYPE
    importing
      !NODE type ref to IF_IXML_NODE
      !TYPE type I
    returning
      value(RESULT) type ABAP_BOOL .
private section.
  types:
    BEGIN OF ts_ele,
    select    TYPE flag,
    elem_type TYPE trobjtype,
    elem_key  TYPE elemgenkey,
    td_pack   TYPE devclass,
    elem_pack TYPE devclass,
  END OF ts_ele .
  types:
    tt_ele TYPE STANDARD TABLE OF ts_ele WITH NON-UNIQUE DEFAULT KEY .
  types:
    BEGIN OF ts_itf_el,
    interface TYPE REF TO if_package_interface,
    elements  TYPE STANDARD TABLE OF scomeldtln WITH NON-UNIQUE DEFAULT KEY, &quot;SCOMELDATA,
    acls      TYPE STANDARD TABLE OF scomaclstr WITH NON-UNIQUE DEFAULT KEY, &quot;SCOMACLTAB,
  END OF ts_itf_el .
  types:
    tt_itf_el TYPE STANDARD TABLE OF ts_itf_el WITH NON-UNIQUE DEFAULT KEY .
  types:
    tt_context TYPE STANDARD TABLE OF string WITH DEFAULT KEY .
  constants TN_NAME_OFF type STRING value &apos;ZSL_NAME&apos;. &quot;#EC NOTEXT
  constants TN_VERSION_OFF type STRING value &apos;ZSLPI_VER&apos;. &quot;#EC NOTEXT
  constants EN_LINE type STRING value &apos;ITEM&apos;. &quot;#EC NOTEXT
  constants MSGID type SYMSGID value &apos;ZAPLINK_EASYXML&apos;. &quot;#EC NOTEXT
  data O_MYCX type TO_EXCEPTION .
  data BAL_LEVEL type BALLEVEL .
  data RC type I .
  data CRC type STRING .
  constants SELF_FIELDNAME type STRING value &apos;_&apos;. &quot;#EC NOTEXT
  data CONTEXT type TT_CONTEXT .
  constants ISSUE46_PREFIX type ABAP_CHAR1 value &apos;_&apos;. &quot;#EC NOTEXT
  class-data ISSUE46_REGEX type STRING .
  constants PROTECTION_CHAR type ABAP_CHAR1 value &apos;`&apos;. &quot;#EC NOTEXT
  class-data:
    char_to_protect TYPE RANGE OF ABAP_CHAR1 .
  class-methods PROTECT_STRING
    importing
      !STRING type STRING
    returning
      value(RESULT) type STRING .
  class-methods UNPROTECT_STRING
    importing
      !STRING type STRING
    returning
      value(RESULT) type STRING .
endclass. &quot;ZAPLINK_EASYXML definition
class ZAPLINK_LIST definition
  create public .
public section.
  type-pools ABAP .
  type-pools SLIS .
  interfaces ZAPLINK_DATATYPES .
  aliases TD_ORDERKIND
    for ZAPLINK_DATATYPES~TD_ORDERKIND .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  types TO_ME type ref to ZAPLINK_LIST .
  constants:
    BEGIN OF sel_actions,
      export    TYPE td_sel_action VALUE &apos;E&apos;,
      import    TYPE td_sel_action VALUE &apos;I&apos;,
      uninstall TYPE td_sel_action VALUE &apos;U&apos;,
    END OF sel_actions .
  data ORDER_KIND type ABAP_BOOL .
  data DISPLAY_PROGRESS type ABAP_BOOL .
  constants:
    begin of ORDER_KINDS,
      no_order  type td_orderkind value space,
      install   type td_orderkind value &apos;B&apos;,  &quot; Bottom up
      uninstall type td_orderkind value &apos;T&apos;,  &quot; Top down
    end of ORDER_KINDS .
  methods ADD
    importing
      !COMP type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods ADD_KEYS
    importing
      !DATA type TT_COMPKEYS
    raising
      ZAPLINK_CX_LIST .
  methods ADD_LIST
    importing
      !DATA type TO_ME
    raising
      ZAPLINK_CX_LIST .
  methods CHANGE_SELECTION
    raising
      ZAPLINK_CX_LIST .
  class-methods CLASS_CONSTRUCTOR .
  methods CLEAR
    raising
      ZAPLINK_CX_LIST .
  methods CLONE
    returning
      value(RESULT) type TO_ME
    raising
      ZAPLINK_CX_LIST .
  methods DISPLAY
    raising
      ZAPLINK_CX_LIST .
  methods GET_COUNT
    importing
      !IS_SELECTED type ABAP_BOOL optional
    returning
      value(RESULT) type I .
  methods GET_NEXT
    returning
      value(RESULT) type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods GET_KEYS
    returning
      value(RESULT) type TT_COMPKEYS
    raising
      ZAPLINK_CX_LIST .
  methods HAS_ANY
    importing
      !LIST type TO_ME
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_LIST .
  methods INIT_ITER
    raising
      ZAPLINK_CX_LIST .
  methods INIT_SEL_ITER
    raising
      ZAPLINK_CX_LIST .
  methods IS_EMPTY
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_LIST .
  methods IS_INCLUDED
    importing
      !LIST type TO_ME
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_LIST .
  methods IS_SELECTED
    importing
      !COMP type TO_COMPONENT
    returning
      value(RESULT) type ABAP_BOOL
    raising
      ZAPLINK_CX_LIST .
  methods KEEP_COMMUN_LIST
    importing
      !DATA type TO_ME .
  methods REMOVE
    importing
      !COMP type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods REMOVE_LIST
    importing
      !DATA type TO_ME
    raising
      ZAPLINK_CX_LIST .
  methods SEARCH
    importing
      !COMP type TO_COMPONENT
    returning
      value(RESULT) type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods SELECT
    importing
      !COMP type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods SELECT_ALL
    raising
      ZAPLINK_CX_LIST .
  methods SELECT_DEFAULT
    importing
      !SEL_ACTION type TD_SEL_ACTION
    raising
      ZAPLINK_CX_LIST .
  methods UNSELECT
    importing
      !COMP type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
protected section.
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_TYPE_AS_TEXT
    for ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  types:
    BEGIN OF ts_cursor,
    key      TYPE ts_compkey,
    o_comp   TYPE to_component,
    order    TYPE i,
  END OF ts_cursor .
  types:
    tt_cursors TYPE STANDARD TABLE OF ts_cursor WITH DEFAULT KEY .
  types:
    BEGIN OF ts_complist,
    key      TYPE ts_compkey,
    o_comp   TYPE to_component,
    selected TYPE abap_bool,
  END OF ts_complist .
  types:
    tt_complist TYPE SORTED TABLE OF ts_complist WITH UNIQUE KEY KEY .
  types:
    BEGIN OF ts_allcomplist,
    key      TYPE ts_compkey,
    o_comp   TYPE to_component,
    as_sub   TYPE abap_bool,
  END OF ts_allcomplist .
  types:
    tt_allcomplist TYPE SORTED TABLE OF ts_allcomplist WITH NON-UNIQUE KEY KEY .
  types TD_ALVID type GUID_16 .
  types:
    BEGIN OF ts_alv_conf,
        fields TYPE slis_t_fieldcat_alv,
        layout TYPE slis_layout_alv,
      END OF ts_alv_conf .
  types:
    BEGIN OF ts_alv_confs,
      simple TYPE ts_alv_conf,
      hierar TYPE ts_alv_conf,
      END OF ts_alv_confs .
  types:
    BEGIN OF ts_alv,
      type       TYPE td_comptype,
      typ_txt    TYPE td_type_as_text,
      name       TYPE td_compname,
      connector  TYPE td_light, &quot;type pools ICON
      status     TYPE td_light, &quot;type pools ICON
      msg        TYPE string,
      devclass   TYPE tadir-devclass,
      srcsystem  TYPE tadir-srcsystem,
      checksum   TYPE td_checksum,
      code_signature  TYPE td_checksum,
      select     TYPE flag,
      id         TYPE td_alvid,
      expand     TYPE flag,
  END OF ts_alv .
  types:
    tt_alv TYPE STANDARD TABLE OF ts_alv WITH DEFAULT KEY .
  types:
    BEGIN OF td_alv,
      headers TYPE tt_alv,
      items   TYPE tt_alv,
    END OF td_alv .
  constants:
    BEGIN OF lights,
      no       TYPE td_light VALUE icon_light_out,
      red      TYPE td_light VALUE icon_red_light,
      yellow   TYPE td_light VALUE icon_yellow_light,
      green    TYPE td_light VALUE icon_green_light,
    END OF lights .
  class-data ALV_CONF type TS_ALV_CONFS .
  data _ALLCOMP type TT_ALLCOMPLIST .
  data _INDEX type TT_COMPLIST .
  methods COMP_TO_ALV
    importing
      !O_COMP type TO_COMPONENT
      !SELECTED type ABAP_BOOL
    returning
      value(RESULT) type TS_ALV
    raising
      ZAPLINK_CX_LIST .
  methods CONV_TO_ALV
    importing
      !W_ITEM type ABAP_BOOL optional
    returning
      value(RESULT) type TD_ALV
    raising
      ZAPLINK_CX_LIST .
  methods SEARCH_INDEX
    importing
      !COMP type TO_COMPONENT
    returning
      value(RESULT) type TS_COMPLIST .
  methods SELECT_EXPORT
    raising
      ZAPLINK_CX_LIST .
  methods SELECT_IMPORT
    raising
      ZAPLINK_CX_LIST .
  methods UPDATE_FROM_ALV
    importing
      !DATA type TD_ALV
    raising
      ZAPLINK_CX_LIST .
  methods _ADD_SUBCOMP
    importing
      !DATA type TO_COMPONENT
    raising
      ZAPLINK_CX_LIST .
  methods _SELECT
    importing
      !COMP type TO_COMPONENT
      !VALUE type ABAP_BOOL
    raising
      ZAPLINK_CX_LIST .
private section.
  types TD_ITERATOR_TYPE type CHAR1 .
  types TO_EXCEPTION type ref to ZAPLINK_CX_LIST .
  constants:
    BEGIN OF iterator_types,
      all       TYPE td_iterator_type VALUE &apos;A&apos;,
      selected  TYPE td_iterator_type VALUE &apos;S&apos;,
    END OF iterator_types .
  data O_EXCEPTION type TO_EXCEPTION .
  data _ITERATOR_COUNT type SY-TABIX .
  data _ITERATOR_TABIX type SY-TABIX .
  data _ITERATOR_TYPE type TD_ITERATOR_TYPE .
  constants:
    BEGIN OF alv_h_tables,
      header    TYPE slis_tabname VALUE &apos;HDR&apos;,
      item      TYPE slis_tabname VALUE &apos;ITM&apos;,
    END OF alv_h_tables .
  data T_CURSORS type TT_CURSORS .
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_LIST definition
class ZAPLINK_OBJECT_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create protected
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_OBJECT .
public section.
  type-pools ABAP .
  type-pools SEOF .
  type-pools SEOK .
  type-pools SEOO .
  type-pools SEOR .
  type-pools SEOS .
  type-pools SEOT .
  interfaces ZAPLINK_DATATYPES .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TS_SOURCEASSTRUC
    for ZAPLINK_DATATYPES~TS_SOURCEASSTRUC .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_DYNPROS
    for ZAPLINK_DATATYPES~TT_DYNPROS .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  types TO_MENUPAINTER type ref to ZAPLINK_MENUPAINTER_DATA .
  types:
    BEGIN OF ts_deferred,                   &quot; used to handle
              classes TYPE seot_clsdeferrds_w,      &quot; class * definition load
              interfaces TYPE seot_intdeferrds_r,   &quot; interface * load
            END OF ts_deferred .
  types:
    tt_seoclasstx TYPE STANDARD TABLE OF seoclasstx WITH DEFAULT KEY .
  types:
    BEGIN OF ts_seoclasstx.
    INCLUDE TYPE seoclasstx AS main.
    TYPES:
        documentation  TYPE ts_lang,
      END OF ts_seoclasstx .
  types:
    tt_seoclasstx_s TYPE SORTED TABLE OF ts_seoclasstx WITH UNIQUE KEY langu .
  types:
    tt_seocompotx TYPE STANDARD TABLE OF seocompotx WITH DEFAULT KEY .
  types:
    tt_seocompotx_s TYPE SORTED TABLE OF seocompotx WITH UNIQUE KEY cmpname langu .
  types:
    BEGIN OF ts_seocompotx.
    INCLUDE TYPE seocompotx AS main.
    TYPES:
        documentation  TYPE ts_lang,
      END OF ts_seocompotx .
  types:
    tt_seocompotx_l TYPE SORTED TABLE OF ts_seocompotx WITH UNIQUE KEY langu .
  types:
    tt_seosubcotx TYPE STANDARD TABLE OF seosubcotx WITH DEFAULT KEY .
  types:
    tt_seosubcotx_s TYPE SORTED TABLE OF seosubcotx WITH UNIQUE KEY cmpname sconame langu .
  types:
    tt_seosubcotx_l TYPE SORTED TABLE OF seosubcotx WITH UNIQUE KEY langu .
  types:
    BEGIN OF ts_includes,
                    classpool     TYPE program,
                    pubsec        TYPE program,
                    prisec        TYPE program,
                    prosec        TYPE program,
                    cl            TYPE program,
                    ccimp         TYPE program,
                    ccdef         TYPE program,
                    ccmac         TYPE program,
                    interfacepool TYPE program,
                    intfsec       TYPE program,
                    methods       TYPE seop_methods_w_include,
                  END OF ts_includes .
  types:
    tt_sotr_texts TYPE SORTED TABLE OF sotr_text WITH UNIQUE KEY langu object .
  types:
    tt_sotr_textus TYPE STANDARD TABLE OF sotr_textu WITH DEFAULT KEY .
  types:
    BEGIN OF ts_cx_text,
        cmpname   TYPE seoo_attribute_r-cmpname.
    INCLUDE TYPE sotr_head AS hdr.
    TYPES:
        lhdr      TYPE sotr_headu,
        texts     TYPE tt_sotr_texts,
        longtexts TYPE tt_sotr_textus,
      END OF ts_cx_text .
  types:
    tt_cx_texts TYPE SORTED TABLE OF ts_cx_text WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF t_fm_data,
        class TYPE  vseoclass,
        interface TYPE  vseointerf,
        attributes  TYPE  seoo_attributes_r,
        methods TYPE  seoo_methods_r,
        events  TYPE  seoo_events_r,
        types TYPE  seoo_types_r,
        parameters  TYPE  seos_parameters_r,
        exceps  TYPE  seos_exceptions_r,
        implementings TYPE  seor_implementings_r,
        inheritance TYPE  vseoextend,
        redefinitions TYPE  seor_redefinitions_r,
        impl_details  TYPE  seor_redefinitions_r,
        friendships TYPE  seof_friendships_r,
        typeusages TYPE  seot_typepusages_r,
        clsdeferrds TYPE  seot_clsdeferrds_r,
        intdeferrds TYPE  seot_intdeferrds_r,
        comprisings TYPE  seor_comprisings_r,
        explore_inheritance TYPE  seok_cls_typeinfos,
        explore_implementings TYPE  seok_int_typeinfos,
        explore_comprisings TYPE  seok_int_typeinfos,
        aliases TYPE  seoo_aliases_r,
        enhancement_methods TYPE  enhmeth_tabheader,
        enhancement_attributes  TYPE  enhclasstabattrib,
        enhancement_events  TYPE  enhclasstabevent,
        enhancement_implementings TYPE  enhclasstabimplementing,
        enhancement_comprisings TYPE  enhclasstabintfcompri,
        class_desc  TYPE tt_seoclasstx,
        component_desc  TYPE  tt_seocompotx,
        subcomponent_desc TYPE  tt_seosubcotx,
        includes TYPE ts_includes,
        method_sources TYPE seo_method_source_table,
        textspool   TYPE tt_txtp_textpools,
        locals_def  TYPE  rswsourcet,
        locals_imp  TYPE  rswsourcet,
        locals_mac  TYPE  rswsourcet,
        exceptions_texts TYPE tt_cx_texts,
        dynpros     TYPE tt_dynpros,
        menupainter TYPE to_menupainter,
        documentation TYPE tt_docs,
      END OF t_fm_data .
  types:
    BEGIN OF ts_param_data.
    INCLUDE TYPE seos_parameter_r AS hdr.
    TYPES:
        texts   TYPE tt_seosubcotx_l,
      END OF ts_param_data .
  types:
    tt_parameters TYPE SORTED TABLE OF ts_param_data WITH UNIQUE KEY sconame .
  types:
    BEGIN OF ts_excep_data.
    INCLUDE TYPE seos_exception_r AS hdr.
    TYPES:
        texts   TYPE tt_seosubcotx_l,
      END OF ts_excep_data .
  types:
    tt_exceptions TYPE SORTED TABLE OF ts_excep_data WITH UNIQUE KEY sconame .
  types:
    BEGIN OF ts_event_data.
    INCLUDE TYPE seoo_event_r AS hdr.
    TYPES:
        texts         TYPE tt_seocompotx_l,
        parameters    TYPE tt_parameters,
      END OF ts_event_data .
  types:
    tt_events TYPE SORTED TABLE OF ts_event_data WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_meth_data.
    INCLUDE TYPE seoo_method_r AS hdr.
    TYPES:
        texts         TYPE tt_seocompotx_l,
        parameters    TYPE tt_parameters,
        exceptions    TYPE tt_exceptions,
        source        TYPE ts_sourceasstruc,
      END OF ts_meth_data .
  types:
    tt_methods TYPE SORTED TABLE OF ts_meth_data WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_alias_data.
    INCLUDE TYPE seoo_alias_r AS hdr.
    TYPES:
        texts   TYPE tt_seocompotx_l,
      END OF ts_alias_data .
  types:
    tt_alias TYPE SORTED TABLE OF ts_alias_data WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_attr_data.
    INCLUDE TYPE seoo_attribute_r AS hdr.
    TYPES:
        texts   TYPE tt_seocompotx_l,
        _       TYPE td_abapsource,
      END OF ts_attr_data .
  types:
    tt_attributs TYPE SORTED TABLE OF ts_attr_data WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_type_data.
    INCLUDE TYPE seoo_type_r AS hdr.
    TYPES:
        texts   TYPE tt_seocompotx_l,
        _       TYPE td_abapsource,
      END OF ts_type_data .
  types:
    tt_types TYPE SORTED TABLE OF ts_type_data WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_tgrp_data.
    INCLUDE TYPE seot_typepusage_r AS hdr.
    TYPES:
        defered TYPE seot_clsdeferrd_r,
        itf_def TYPE seot_intdeferrd_r,
      END OF ts_tgrp_data .
  types:
    tt_typegroups TYPE SORTED TABLE OF ts_tgrp_data WITH UNIQUE KEY typegroup .
  types:
    BEGIN OF ts_redef_data.
    INCLUDE TYPE seoredef AS hdr.
    TYPES:
        source        TYPE ts_sourceasstruc,
      END OF ts_redef_data .
  types:
    tt_comp_impl TYPE SORTED TABLE OF ts_redef_data WITH UNIQUE KEY mtdname .
  types:
    BEGIN OF ts_interface.
    INCLUDE TYPE seor_implementing_r AS hdr.  &quot; Mthodes redfinies par relation d&apos;hritage
    TYPES:
        components TYPE tt_comp_impl,   &quot; Interface public attribute default value &amp; Method implementation
      END OF ts_interface .
  types:
    tt_interfaces TYPE SORTED TABLE OF ts_interface WITH UNIQUE KEY refclsname .
  types:
    BEGIN OF ts_sources,
                  classpool   TYPE  ts_sourceasstruc,
                  local_types TYPE  ts_sourceasstruc,
                  local_imp   TYPE  ts_sourceasstruc,
                  macros      TYPE  ts_sourceasstruc,
                  public      TYPE  ts_sourceasstruc,
                  private     TYPE  ts_sourceasstruc,
                  protected   TYPE  ts_sourceasstruc,
                END OF ts_sources .
  data ALIASES type TT_ALIAS .
  data ATTRIBUTS type TT_ATTRIBUTS .
  data DOCUMENTATION type TT_DOCS .
  data EVENTS type TT_EVENTS .
  data INTERFACES type TT_INTERFACES .
  data METHODS type TT_METHODS .
  data TYPEGROUPS type TT_TYPEGROUPS .
  data TYPES type TT_TYPES .
  data DEFERRED type TS_DEFERRED .
  class-methods CLASS_CONSTRUCTOR .
  methods FROM_DATA
    importing
      !FM_DATA type T_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type T_FM_DATA .
  methods COMPLETE_DATA
    changing
      !FM_DATA type T_FM_DATA .
  methods ANONYMIZE .
  methods UNANONYMIZE .
protected section.
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  types:
    BEGIN OF ts_doc_key,                                    &quot; equiv DOKU_OBJ = CHAR 60
      name       TYPE seoclsname,                           &quot; CHAR 30
      other(30)  TYPE c,
    END OF ts_doc_key .
  types:
    BEGIN OF ts_component,
      cmpname TYPE seoo_method_r-cmpname,
    END OF ts_component .
  types:
    tt_components TYPE SORTED TABLE OF ts_component WITH UNIQUE KEY cmpname .
  types TO_EXCEPTION type ref to ZAPLINK_CX_CONNECTOR .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  data COMPONENTS type TT_COMPONENTS .
  data OBJ_NAME type SEOCLSNAME .
  data OBJ_VERSION type SEOVERSION .
  data OBJ_LANGU type SYLANGU .
  constants:
    BEGIN OF Object_types,                                  &quot;#EC NOTEXT
      class        TYPE td_comptype VALUE &apos;CLAS&apos;,
      interface    TYPE td_comptype VALUE &apos;INTF&apos;,
    END OF Object_types .
  constants LINE_SEPARATOR type ABAP_CHAR1 value CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT
  constants METHOD_SEPARATOR type ABAP_CHAR1 value &apos;~&apos;. &quot;#EC NOTEXT
  class-data:
    begin of R_DOC_IDS,
      class       type TR_DOCID,
      interface   type TR_DOCID,
    end of R_DOC_IDS .
  constants:
    BEGIN OF doc_ids,
      begin of class,
        header    TYPE td_doc_id VALUE &apos;CL&apos;,
        attribute TYPE td_doc_id VALUE &apos;CA&apos;,
        method    TYPE td_doc_id VALUE &apos;CO&apos;,
        event     TYPE td_doc_id VALUE &apos;CE&apos;,
        type      TYPE td_doc_id VALUE &apos;CT&apos;,
      end of class,
      begin of interface,
        header    TYPE td_doc_id VALUE &apos;IF&apos;,
        attribute TYPE td_doc_id VALUE &apos;IA&apos;,
        method    TYPE td_doc_id VALUE &apos;IO&apos;,
        event     TYPE td_doc_id VALUE &apos;IE&apos;,
        type      TYPE td_doc_id VALUE &apos;IT&apos;,   &quot; does not exists yet
      end of interface,
    END OF doc_ids .
  data OBJ_TYPE type TD_COMPTYPE .
  methods FD_PARAMETERS
    importing
      !FM_DATA type T_FM_DATA
      !COMPONENT type SEOCMPNAME
    returning
      value(PARAMETERS) type TT_PARAMETERS .
  methods FD_EXCEPTIONS
    importing
      !FM_DATA type T_FM_DATA
      !COMPONENT type SEOCMPNAME
    returning
      value(EXCEPTIONS) type TT_EXCEPTIONS .
  methods FD_SUBC_DESC
    importing
      !DESCRIPTIONS type TT_SEOSUBCOTX
      !SUB_COMPONENT type SEOSCONAME
      !COMPONENT type SEOCMPNAME
    returning
      value(TEXTS) type TT_SEOSUBCOTX_L .
  methods FD_COMP_DESC
    importing
      !DESCRIPTIONS type TT_SEOCOMPOTX
      !COMPONENT type SEOCMPNAME
      !ID type DOKU_ID
      !DOCUMENTATION type TT_DOCS
    returning
      value(TEXTS) type TT_SEOCOMPOTX_L .
  methods TD_SUBC_DESC
    importing
      !SUB_COMPONENT type SEOSCONAME
      !COMPONENT type SEOCMPNAME
      !TEXTS type TT_SEOSUBCOTX_L
    changing
      !DESCRIPTIONS type TT_SEOSUBCOTX .
  methods TD_COMP_DESC
    importing
      !COMPONENT type SEOCMPNAME
      !TEXTS type TT_SEOCOMPOTX_L
      !ID type DOKU_ID
    changing
      !DOCUMENTATION type TT_DOCS
      !DESCRIPTIONS type TT_SEOCOMPOTX .
  methods TD_PARAMETERS
    importing
      !COMPONENT type SEOCMPNAME
      !PARAMETERS type TT_PARAMETERS
    changing
      !FM_DATA type T_FM_DATA .
  methods TD_EXCEPTIONS
    importing
      !COMPONENT type SEOCMPNAME
      !EXCEPTION type TT_EXCEPTIONS
    changing
      !FM_DATA type T_FM_DATA .
  methods TD_TEXT
    importing
      !CLASSNAME type SEOCLSNAME
      !TEXTS type TT_SEOCLASSTX_S
      !ID type DOKU_ID
    changing
      !DOCUMENTATION type TT_DOCS
      !DESCRIPTIONS type TT_SEOCLASSTX .
  methods FD_TEXT
    importing
      !DESCRIPTIONS type TT_SEOCLASSTX
      !CLASSNAME type SEOCLSNAME
      !ID type DOKU_ID
      !DOCUMENTATION type TT_DOCS
    returning
      value(TEXTS) type TT_SEOCLASSTX_S .
  methods CLEAR_TAGS .
  methods FIX_INCLUDED_TYPE_POOL
    importing
      !SOURCECODE type TT_ABAPRAWSOURCE
      !TYPEPOOLS type SEOT_TYPEPUSAGES_R
      !PUBLIC type ABAP_BOOL optional
    exporting
      !NEW_SOURCECODE type TT_ABAPRAWSOURCE
      !NEW_TYPEPOOLS type SEOT_TYPEPUSAGES_R .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_OBJECT_DATA definition
class ZAPLINK_OPTIONS definition
  create public .
public section.
  types TO_DEVCLASS type ref to ZAPLINK_OPT_DEVCLASS .
  types TO_DIRECTORY type ref to ZAPLINK_OPT_DIRECTORY .
  data DEVCLASS type TO_DEVCLASS read-only .
  data DIRECTORY type TO_DIRECTORY read-only .
  methods CONSTRUCTOR .
  methods GET_DEVCLASS
    returning
      value(RESULT) type TO_DEVCLASS
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_DEVCLASS
    importing
      !DATA type TO_DEVCLASS
    raising
      ZAPLINK_CX_OPTIONS .
  methods GET_DIRECTORY
    returning
      value(RESULT) type TO_DIRECTORY
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_DIRECTORY
    importing
      !DATA type TO_DIRECTORY
    raising
      ZAPLINK_CX_OPTIONS .
protected section.
private section.
endclass. &quot;ZAPLINK_OPTIONS definition
class ZAPLINK_OPT_DIRECTORY definition
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases BALLOG_OBJECT
    for ZAPLINK_DATATYPES~BALLOG_OBJECT .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  aliases TS_DIRECTORY
    for ZAPLINK_DATATYPES~TS_DIRECTORY .
  types TO_DEVCLASS type ref to ZAPLINK_OPT_DEVCLASS .
  types TO_EXCEPTION type ref to ZAPLINK_CX_OPTIONS .
  types TO_LOG type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_TR type ref to ZAPLINK_OPT_TRANSPORT_REQUEST .
  types TO_COMPONENT type ref to ZAPLINK_RAW_BASE .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;DIRECTORY&apos;. &quot;#EC NOTEXT
  constants:
    BEGIN OF substitutionkinds,
        fixed          TYPE td_substitutionkind VALUE &apos;F&apos;,    &quot; Assign allways the same specified devclass
        keep_container TYPE td_substitutionkind VALUE &apos;K&apos;,    &quot; Keep dev class in XML file
        use_component  TYPE td_substitutionkind VALUE &apos;C&apos;,    &quot; Use devclass define in component
        local          TYPE td_substitutionkind VALUE &apos;L&apos;,    &quot; Devclass = $TMP
      END OF substitutionkinds .
  data O_LOG type TO_LOG read-only .
  methods CONSTRUCTOR .
  methods GET_SUBSTITUTIONKIND_OFF
    returning
      value(RESULT) type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_SUBSTITUTIONKIND_OFF
    importing
      !DATA type TD_SUBSTITUTIONKIND
    raising
      ZAPLINK_CX_OPTIONS .
  methods GET_DEVCLASS
    returning
      value(RESULT) type TO_DEVCLASS
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_DEVCLASS
    importing
      !DATA type TO_DEVCLASS
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_DIRECTORY
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(RESULT) type TS_DIRECTORY
    raising
      ZAPLINK_CX_OPTIONS .
  methods GET_TRANSPORT_REQUEST
    returning
      value(RESULT) type TO_TR
    raising
      ZAPLINK_CX_OPTIONS .
  methods SET_TRANSPORT_REQUEST
    importing
      !DATA type TO_TR
    raising
      ZAPLINK_CX_OPTIONS .
protected section.
  data _SUBSTITUTION type TD_SUBSTITUTIONKIND .
  data _DEVCLASS type TO_DEVCLASS .
  data _TR type TO_TR .
  data O_MYCX type TO_EXCEPTION .
private section.
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_OPT_DIRECTORY definition
class ZAPLINK_RAW_BASE definition
  create public
  FRIENDS ZAPLINK_CONTAINER_4INST
                 ZAPLINK_EASYXML .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases BALLOG_OBJECT
    for ZAPLINK_DATATYPES~BALLOG_OBJECT .
  aliases COMP_NODENAME
    for ZAPLINK_DATATYPES~COMP_NODENAME .
  aliases EXISTS
    for ZAPLINK_DATATYPES~EXISTS .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TEXTPOOL_KINDS
    for ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TD_CHECKSUM
    for ZAPLINK_DATATYPES~TD_CHECKSUM .
  aliases TD_CLASSNAME
    for ZAPLINK_DATATYPES~TD_CLASSNAME .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTEXT
    for ZAPLINK_DATATYPES~TD_COMPTEXT .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_CONTNAME
    for ZAPLINK_DATATYPES~TD_CONTNAME .
  aliases TD_CONTVER
    for ZAPLINK_DATATYPES~TD_CONTVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_FILENAME
    for ZAPLINK_DATATYPES~TD_FILENAME .
  aliases TD_FILETYPE
    for ZAPLINK_DATATYPES~TD_FILETYPE .
  aliases TD_LANG
    for ZAPLINK_DATATYPES~TD_LANG .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_PROGNAME
    for ZAPLINK_DATATYPES~TD_PROGNAME .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TD_SUBSTITUTIONKIND
    for ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  aliases TD_TRANSPORT_REQUEST
    for ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .
  aliases TD_TXTP_ID
    for ZAPLINK_DATATYPES~TD_TXTP_ID .
  aliases TD_TXTP_KIND
    for ZAPLINK_DATATYPES~TD_TXTP_KIND .
  aliases TD_TXTP_LEN
    for ZAPLINK_DATATYPES~TD_TXTP_LEN .
  aliases TD_TXTP_TEXT
    for ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  aliases TD_TYPE_AS_TEXT
    for ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  aliases TO_XML
    for ZAPLINK_DATATYPES~TO_XML .
  aliases TR_DLVUNIT
    for ZAPLINK_DATATYPES~TR_DLVUNIT .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TR_TR
    for ZAPLINK_DATATYPES~TR_TR .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_CONNDATA
    for ZAPLINK_DATATYPES~TS_CONNDATA .
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TS_CONTDATA
    for ZAPLINK_DATATYPES~TS_CONTDATA .
  aliases TS_DIRECTORY
    for ZAPLINK_DATATYPES~TS_DIRECTORY .
  aliases TS_DOC
    for ZAPLINK_DATATYPES~TS_DOC .
  aliases TS_HEAD
    for ZAPLINK_DATATYPES~TS_HEAD .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TS_TXTP_TEXT
    for ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  aliases TS_TXTP_TEXTPOOL
    for ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  aliases TS_TYPE
    for ZAPLINK_DATATYPES~TS_TYPE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  aliases TT_CONN_CLASSES
    for ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_RAWTEXT
    for ZAPLINK_DATATYPES~TT_RAWTEXT .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  types TO_EZ_XML type ref to ZAPLINK_EASYXML .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  data TYPE type TD_COMPTYPE .
  data NAME type TD_COMPNAME .
  data CONNECTOR type TD_CONNUUID .
  data VERSION type TD_CONNVER .
  data DIRECTORY type TS_DIRECTORY read-only .
  data DEPENDENCIES type TT_COMPKEYS .
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR
    importing
      !O_COMP type TO_COMPONENT optional .
  methods UPDATE_CONNECTOR_DATA
    importing
      !O_CONNECTOR type TO_CONNECTOR .
  methods SET_COMPONENT
    importing
      !O_COMP type TO_COMPONENT
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_COMPONENT
    returning
      value(O_COMP) type TO_COMPONENT
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_TYPE
    returning
      value(RESULT) type TD_COMPTYPE
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_NAME
    returning
      value(RESULT) type TD_COMPNAME
    raising
      ZAPLINK_CX_CONTAINER .
  methods GET_CHECKSUM
    returning
      value(RESULT) type TD_CHECKSUM
    raising
      ZAPLINK_CX_CONTAINER .
  methods SET_CHECKSUM .
  methods ANONYMIZE
    raising
      ZAPLINK_CX_CONTAINER .
  methods UNANONYMIZE
    raising
      ZAPLINK_CX_CONTAINER .
protected section.
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_EXCEPTION type ref to ZAPLINK_CX_CONTAINER .
  data CHECKSUM type TD_CHECKSUM .
  data CODE_SIGNATURE type TD_CHECKSUM .
  methods CONV_TO_XML
    returning
      value(RESULT) type TO_XML .
  class-methods XML_2_STRING
    importing
      !O_XML type TO_XML
    returning
      value(RESULT) type STRING .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
  class-data XMLENGINE type ref to IF_IXML .
  methods REFRESH_DIRECTORY
    raising
      ZAPLINK_CX_CONTAINER .
endclass. &quot;ZAPLINK_RAW_BASE definition
class ZAPLINK_CONNECTOR_ definition
  abstract
  create public .
public section.
  type-pools RPYTY .
  interfaces ZAPLINK_CNX_EXT_CLEANER .
  interfaces ZAPLINK_CNX_EXT_CODE_SIGNATURE .
  interfaces ZAPLINK_CONNECTOR
      abstract methods CREATE_NEW_RAW
                       DELETE_FROM_SAP
                       DO_EXISTS
                       IS_SUPPORTED_VERSION
                       READ_FROM_SAP
                       WRITE_TO_SAP .
  interfaces ZAPLINK_DATATYPES .
  aliases APPLICATION_LOG
    for ZAPLINK_CONNECTOR~APPLICATION_LOG .
  aliases BALLOG_OBJECT
    for ZAPLINK_CONNECTOR~BALLOG_OBJECT .
  aliases COMP_NODENAME
    for ZAPLINK_CONNECTOR~COMP_NODENAME .
  aliases EXISTS
    for ZAPLINK_CONNECTOR~EXISTS .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases OPTIONS
    for ZAPLINK_CONNECTOR~OPTIONS .
  aliases SUPPORTED_TYPES
    for ZAPLINK_CONNECTOR~SUPPORTED_TYPES .
  aliases TEXTPOOL_KINDS
    for ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  aliases UUID
    for ZAPLINK_CONNECTOR~UUID .
  aliases VERSION
    for ZAPLINK_CONNECTOR~VERSION .
  aliases ANONYMIZE
    for ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE .
  aliases CREATE_NEW_RAW
    for ZAPLINK_CONNECTOR~CREATE_NEW_RAW .
  aliases DELETE_FROM_SAP
    for ZAPLINK_CONNECTOR~DELETE_FROM_SAP .
  aliases DO_EXISTS
    for ZAPLINK_CONNECTOR~DO_EXISTS .
  aliases EXPORT_FROM_SAP
    for ZAPLINK_CONNECTOR~EXPORT_FROM_SAP .
  aliases GET_VALUES
    for ZAPLINK_CONNECTOR~GET_VALUES .
  aliases IMPORT_TO_SAP
    for ZAPLINK_CONNECTOR~IMPORT_TO_SAP .
  aliases IS_SUPPORTED_VERSION
    for ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION .
  aliases READ_FROM_SAP
    for ZAPLINK_CONNECTOR~READ_FROM_SAP .
  aliases UNANONYMIZE
    for ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE .
  aliases WRITE_TO_SAP
    for ZAPLINK_CONNECTOR~WRITE_TO_SAP .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TD_CLASSNAME
    for ZAPLINK_DATATYPES~TD_CLASSNAME .
  aliases TD_COMPEXISTS
    for ZAPLINK_CONNECTOR~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_CONNECTOR~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_CONNECTOR~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_CONNECTOR~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_CONNECTOR~TD_CONNEXISTS .
  aliases TD_CONNUUID
    for ZAPLINK_CONNECTOR~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_CONNECTOR~TD_CONNVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_DOC_ID
    for ZAPLINK_DATATYPES~TD_DOC_ID .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_LANG
    for ZAPLINK_DATATYPES~TD_LANG .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_PROGNAME
    for ZAPLINK_DATATYPES~TD_PROGNAME .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TD_TXTP_ID
    for ZAPLINK_DATATYPES~TD_TXTP_ID .
  aliases TD_TXTP_KIND
    for ZAPLINK_DATATYPES~TD_TXTP_KIND .
  aliases TD_TXTP_LEN
    for ZAPLINK_DATATYPES~TD_TXTP_LEN .
  aliases TD_TXTP_TEXT
    for ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  aliases TD_WITH_SUBCOMP
    for ZAPLINK_DATATYPES~TD_WITH_SUBCOMP .
  aliases TO_COMPONENT
    for ZAPLINK_CONNECTOR~TO_COMPONENT .
  aliases TO_CONNECTOR
    for ZAPLINK_CONNECTOR~TO_CONNECTOR .
  aliases TO_EZ_XML
    for ZAPLINK_CONNECTOR~TO_EZ_XML .
  aliases TO_LIST
    for ZAPLINK_CONNECTOR~TO_LIST .
  aliases TO_MSG_COLL
    for ZAPLINK_CONNECTOR~TO_MSG_COLL .
  aliases TO_OPTIONS
    for ZAPLINK_CONNECTOR~TO_OPTIONS .
  aliases TO_RAW
    for ZAPLINK_CONNECTOR~TO_RAW .
  aliases TO_RAW_BASE
    for ZAPLINK_CONNECTOR~TO_RAW_BASE .
  aliases TO_RAW_DATA
    for ZAPLINK_CONNECTOR~TO_RAW_DATA .
  aliases TO_XML
    for ZAPLINK_CONNECTOR~TO_XML .
  aliases TR_DLVUNIT
    for ZAPLINK_DATATYPES~TR_DLVUNIT .
  aliases TR_DOCID
    for ZAPLINK_DATATYPES~TR_DOCID .
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TR_TR
    for ZAPLINK_DATATYPES~TR_TR .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_CONNECTOR~TS_BASE_ATTRIBUTS .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_CONNDATA
    for ZAPLINK_CONNECTOR~TS_CONNDATA .
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TS_DOC
    for ZAPLINK_DATATYPES~TS_DOC .
  aliases TS_HEAD
    for ZAPLINK_DATATYPES~TS_HEAD .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TS_TXTP_TEXT
    for ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  aliases TS_TXTP_TEXTPOOL
    for ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  aliases TS_TYPE
    for ZAPLINK_DATATYPES~TS_TYPE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  aliases TT_CONN_CLASSES
    for ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_DYNPROS
    for ZAPLINK_DATATYPES~TT_DYNPROS .
  aliases TT_RAWTEXT
    for ZAPLINK_DATATYPES~TT_RAWTEXT .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  aliases TT_TYPES
    for ZAPLINK_CONNECTOR~TT_TYPES .
  types TO_MENUPAINTER type ref to ZAPLINK_MENUPAINTER_DATA .
  class-methods CLASS_CONSTRUCTOR .
  class-methods GET_TYPE_FROM_XML
    importing
      !OBJECT type TO_XML
    returning
      value(RESULT) type TD_COMPTYPE
    raising
      ZAPLINK_CX_CONNECTOR .
protected section.
  aliases TT_FLOW_LOGIC
    for ZAPLINK_DATATYPES~TT_FLOW_LOGIC .
  types TO_ROOT_EXCEPTION type ref to ZAPLINK_CX .
  types TO_EXCEPTION type ref to ZAPLINK_CX_CONNECTOR .
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
  methods SET_BASE_ATTRIBUTS
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(ATTRIBUTS) type TS_BASE_ATTRIBUTS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods GET_PROG_SOURCE
    importing
      !PROGRAM type TD_PROGNAME
    returning
      value(RESULT) type TD_ABAPSOURCE .
  class-methods GET_PROG_RAWSOURCE
    importing
      !PROGRAM type TD_PROGNAME
    returning
      value(RESULT) type TT_ABAPRAWSOURCE .
  class-methods CONV_ABAP_RAW2SOURCE
    importing
      !RAW type TT_ABAPRAWSOURCE
    returning
      value(RESULT) type TD_ABAPSOURCE .
  class-methods CONV_ABAP_SOURCE2RAW
    importing
      !SOURCE type TD_ABAPSOURCE
    returning
      value(RESULT) type TT_ABAPRAWSOURCE .
  class-methods SET_PROG_RAWSOURCE
    importing
      !PROGRAM type TD_PROGNAME
      !RAW type TT_ABAPRAWSOURCE .
  class-methods SET_PROG_SOURCE
    importing
      !PROGRAM type TD_PROGNAME
      !SOURCE type TD_ABAPSOURCE .
  class-methods GET_PROG_TEXTPOOL
    importing
      !PROGRAM type TD_PROGNAME
    returning
      value(RESULT) type TT_TXTP_TEXTPOOLS .
  class-methods SET_PROG_TEXTPOOL
    importing
      !PROGRAM type TD_PROGNAME
      !TEXTPOOL type TT_TXTP_TEXTPOOLS .
  methods GET_DYNPROS
    importing
      !PROGRAM type TD_PROGNAME
    returning
      value(RESULT) type TT_DYNPROS .
  methods SET_DYNPROS
    importing
      !PROGRAM type TD_PROGNAME
      value(DYNPROS) type TT_DYNPROS
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods CONV_FLOWLOGIC2ABAPSOURCE
    importing
      !RAW type TT_FLOW_LOGIC
    returning
      value(RESULT) type TD_ABAPSOURCE .
  class-methods CONV_ABAPSOURCE2FLOWLOGIC
    importing
      !SOURCE type TD_ABAPSOURCE
    returning
      value(RESULT) type TT_FLOW_LOGIC .
  class-methods GET_MENUS
    importing
      !PROGRAM type TD_PROGNAME
    returning
      value(RESULT) type TO_MENUPAINTER .
  class-methods SET_MENUS
    importing
      !PROGRAM type TD_PROGNAME
      !MENUS type TO_MENUPAINTER .
private section.
  types:
    tr_scrntype TYPE RANGE OF scrntype .
  class-data R_TEXT_FIELDS type TR_SCRNTYPE .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_COMMUN&apos;. &quot;#EC NOTEXT
endclass. &quot;ZAPLINK_CONNECTOR_ definition
class ZAPLINK_CONTAINER definition
  inheriting from ZAPLINK_CONTAINER_4INST
  create public .
public section.
  types T_XML type STRING .
  constants VERSION type TD_CONTVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  class-methods CLASS_CONSTRUCTOR .
  class-methods CREATE_NEW
    importing
      !O_FILE type TO_FILE
      !DATA type TS_CONTDATA
    returning
      value(RESULT) type ref to ZAPLINK_CONTAINER
    raising
      ZAPLINK_CX_CONTAINER .
  methods SAVE_TO_FILE
    importing
      value(O_FILE) type TO_FILE optional
    raising
      ZAPLINK_CX_CONTAINER .
  methods ADD_COMPONENTS
    importing
      !OBJECT_LIST type TO_LIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods REMOVE_COMPONENTS
    importing
      !OBJECT_LIST type TO_LIST
    raising
      ZAPLINK_CX_CONTAINER .
  methods COMPACT
    raising
      ZAPLINK_CX_CONTAINER .
protected section.
  types:
    BEGIN OF ts_contdata_full.
  INCLUDE TYPE ts_contdata AS public.
  TYPES:
      version  TYPE td_contver,
      class    TYPE td_connclass,
    END OF ts_contdata_full .
  data DATA type TS_CONTDATA_FULL .
  methods _ADD_COMPONENT
    importing
      !COMPONENT type TO_COMPONENT
    raising
      ZAPLINK_CX_CONTAINER .
  methods _REMOVE_COMPONENT
    importing
      !COMPONENT type TO_COMPONENT
    raising
      ZAPLINK_CX_CONTAINER .
  methods _UPDATE_HEADER
    raising
      ZAPLINK_CX_CONTAINER .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
endclass. &quot;ZAPLINK_CONTAINER definition
class ZAPLINK_DOCUMENTATION definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  types TO_LOG type ref to ZAPLINK_MESSAGE_COLLECTOR .
  constants NODE_NAME type STRING value &apos;DOCS&apos;. &quot;#EC NOTEXT
  class-data LOG type TO_MSG_COLL .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_DOCUMENTATION&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  class-methods GET_SINGLE
    importing
      !IDS type TD_DOC_ID
      !OBJECT type DOKU_OBJ
    returning
      value(RESULT) type TS_DOC .
  class-methods GET
    importing
      !IDS type TR_DOCID
      !OBJECT type DOKU_OBJ
    returning
      value(T_DOCS) type TT_DOCS .
  class-methods SET
    importing
      !T_DOCS type TT_DOCS .
  class-methods GET_AS_XML_OFF
    importing
      !IDS type TR_DOCID
      !OBJECT type DOKU_OBJ
    returning
      value(XMLDOC) type ref to IF_IXML_DOCUMENT
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods SET_AS_XML_OFF
    importing
      !XML type ref to IF_IXML_ELEMENT .
  class-methods SET_SINGLE
    importing
      !DATA type TS_DOC .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_DOC type ref to ZAPLINK_DOCV_DATA .
  types:
    BEGIN OF ts_name_mask,
      ID      TYPE DOKIL-ID,
      OBJECT  TYPE DOKIL-OBJECT,
    END OF ts_name_mask .
private section.
  constants:
    BEGIN OF supportedtypes,                                  &quot;#EC NOTEXT
      general           TYPE td_comptype VALUE &apos;DOCT&apos;,    &quot; General Text
      Indep             TYPE td_comptype VALUE &apos;DOCV&apos;,    &quot; Documentation (Independent)
    END OF supportedtypes .
  constants _UUID type TD_CONNUUID value &apos;3D34954BEABE5F12E1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  class-methods RESET .
  class-methods RAW2STRING
    importing
      !RAW type TT_RAWTEXT
    returning
      value(STRING) type STRING .
  class-methods STRING2RAW
    importing
      !STRING type STRING
    returning
      value(RAW) type TT_RAWTEXT .
  class-methods DOCU_GET
    importing
      !DOCU type DOKIL
    exporting
      !HEAD type TS_HEAD
      !LANG type TS_LANG
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods NAME_2_MASK
    importing
      !TYPE type TD_COMPTYPE
      !NAME type TD_COMPNAME
    returning
      value(RESULT) type TS_NAME_MASK .
endclass. &quot;ZAPLINK_DOCUMENTATION definition
class ZAPLINK_EASYXML_4CNX definition
  inheriting from ZAPLINK_EASYXML
  create public .
public section.
protected section.
  methods READ_OBJECT
    redefinition .
private section.
  types TO_RAW_BASE type ref to ZAPLINK_RAW_BASE .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
endclass. &quot;ZAPLINK_EASYXML_4CNX definition
class ZAPLINK_FUNCTION_GROUP definition
  inheriting from ZAPLINK_CONNECTOR_
  create public
  FRIENDS ZAPLINK_FUGR_DATA .
public section.
  type-pools ABAP .
  types T_RAW type RSWSOURCET .
  types:
    begin of ts_text,
      langu   type SPRAS,
      ENTRY   type TEXTPOOLTX,
      LENGTH  type TEXTPOOLLN,
    end of ts_text .
  types TD_FUNCTIONGROUP_NAME type TLIBG-AREA .
  types:
    tt_texts type SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  types:
    begin of ts_textpool,
      ID    type  TEXTPOOLID,
      KEY   type  TEXTPOOLKY,
      texts type  tt_texts,
    end of ts_textpool .
  types:
    TT_TEXTPOOLs type SORTED TABLE OF ts_textpool WITH UNIQUE key ID KEY .
  types TS_SOURCE type STRING .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_FUNCTION_GROUP&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods GET_GROUP_SIGNATURE
    importing
      !GROUP_NAME type TD_FUNCTIONGROUP_NAME
    returning
      value(RESULT) type ZAPLINK_DATATYPES~TD_CHECKSUM .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_GROUP type ref to ZAPLINK_FUGR_DATA .
private section.
  types:
    BEGIN OF ts_prog_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_prog_attr .
*  class ZAPLINK_FUGR_DATA definition load .
  types TT_INCLUDES type ZAPLINK_FUGR_DATA=&gt;TT_RAWINCLUDES .
  types:
    TT_RS38L_INCL type STANDARD TABLE OF rs38l_incl with DEFAULT KEY .
  types TD_INCLUDENAME type ZAPLINK_FUGR_DATA=&gt;TD_INCLUDENAME .
  types TS_FM_DATA type ZAPLINK_FUGR_DATA=&gt;TS_FM_DATA .
  constants ST_FUNCTION_GROUP type TD_COMPTYPE value &apos;FUGR&apos;. &quot;#EC NOTEXT
  constants _UUID type TD_CONNUUID value &apos;F1838F4B202C2806E1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants C_MAINPROG_PREFIX type TRDIR-NAME value &apos;SAPL&apos;. &quot;#EC NOTEXT
  class-methods GET_ALL_INCLUDES
    importing
      !NAME type TD_FUNCTIONGROUP_NAME
      !WITH_CODE type ABAP_BOOL optional
    returning
      value(RESULTS) type TT_INCLUDES .
  class-methods GET_MAINPROGRAM
    importing
      !NAME type RS38L-AREA
    returning
      value(RESULT) type TRDIR-NAME .
endclass. &quot;ZAPLINK_FUNCTION_GROUP definition
class ZAPLINK_MESSAGE definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  types TD_RAW____ type RSWSOURCET .
  types:
    begin of ts_text,
      langu   type SPRAS,
      ENTRY   type TEXTPOOLTX,
      LENGTH  type TEXTPOOLLN,
    end of ts_text .
  types:
    tt_texts type SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  types:
    begin of ts_textpool,
      ID    type  TEXTPOOLID,
      KEY   type  TEXTPOOLKY,
      texts type  tt_texts,
    end of ts_textpool .
  types:
    TT_TEXTPOOLs type SORTED TABLE OF ts_textpool WITH UNIQUE key ID KEY .
  types TS_SOURCE type STRING .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_MESSAGE&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_DATA type ref to ZAPLINK_MSAG_DATA .
private section.
  types:
    BEGIN OF ts_prog_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_prog_attr .
  constants ST_MSGCLASS type TD_COMPTYPE value &apos;MSAG&apos;. &quot;#EC NOTEXT
  class-data R_DOC_ID type TR_DOCID .
  constants _UUID type TD_CONNUUID value &apos;1FAC0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants C_MSG_ID type TD_DOC_ID value &apos;NA&apos;. &quot;#EC NOTEXT
endclass. &quot;ZAPLINK_MESSAGE definition
class ZAPLINK_OS_COMMAND definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  types:
    begin of TS_OS_CMD_KEY,
      name     type SXPGCOSTAB-name,
      OPSYSTEM type SXPGCOSTAB-OPSYSTEM,
    end of TS_OS_CMD_KEY .
  constants FIELD_SEPARATOR type ABAP_CHAR1 value &apos;~&apos;. &quot;#EC NOTEXT
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_OS_COMMAND&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  class-methods COMP_TO_KEY
    importing
      !DATA type TD_COMPNAME
    returning
      value(RESULT) type TS_OS_CMD_KEY .
  class-methods KEY_TO_COMP
    importing
      value(DATA) type TS_OS_CMD_KEY
    returning
      value(RESULT) type TD_COMPNAME .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_DATA type ref to ZAPLINK_EXCC_DATA .
private section.
  constants ST_OS_CMD type TD_COMPTYPE value &apos;EXCC&apos;. &quot;#EC NOTEXT
  class-data R_DOC_ID type TR_DOCID .
  constants _UUID type TD_CONNUUID value &apos;DF0813D1BA8C0EF1BEAE000C291B645B&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants C_MSG_ID type TD_DOC_ID value &apos;NA&apos;. &quot;#EC NOTEXT
endclass. &quot;ZAPLINK_OS_COMMAND definition
class ZAPLINK_PROGRAM definition
  inheriting from ZAPLINK_CONNECTOR_
  final
  create public .
public section.
  types T_RAW type RSWSOURCET .
  types:
    begin of ts_text,
      langu   type SPRAS,
      ENTRY   type TEXTPOOLTX,
      LENGTH  type TEXTPOOLLN,
    end of ts_text .
  types:
    tt_texts type SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  types:
    begin of ts_textpool,
      ID    type  TEXTPOOLID,
      KEY   type  TEXTPOOLKY,
      texts type  tt_texts,
    end of ts_textpool .
  types:
    TT_TEXTPOOLs type SORTED TABLE OF ts_textpool WITH UNIQUE key ID KEY .
  types TS_SOURCE type STRING .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_PROGRAM&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  methods GET_PROGRAM_SIGNATURE
    importing
      !PROGRAM_NAME type TD_PROGNAME
    returning
      value(RESULT) type ZAPLINK_DATATYPES~TD_CHECKSUM .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_PROGRAM type ref to ZAPLINK_PROG_DATA .
private section.
  types:
    BEGIN OF ts_prog_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_prog_attr .
*  class ZAPLINK_PROG_DATA definition load .
  types TS_FM_DATA type ZAPLINK_PROG_DATA=&gt;TS_FM_DATA .
  constants ST_PROGRAM type TD_COMPTYPE value &apos;PROG&apos;. &quot;#EC NOTEXT
  class-data R_DOC_ID type TR_DOCID .
  constants _UUID type TD_CONNUUID value &apos;AAAD0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
endclass. &quot;ZAPLINK_PROGRAM definition
class ZAPLINK_RAW definition
  inheriting from ZAPLINK_RAW_BASE
  create public
  FRIENDS ZAPLINK_CONNECTOR
                 ZAPLINK_CONTAINER_4INST
                 ZAPLINK_EASYXML .
public section.
  types TO_RAW_DATA type ref to ZAPLINK_RAW_DATA .
  data RAW type TO_RAW_DATA .
  methods CONSTRUCTOR
    importing
      !O_COMP type TO_COMPONENT optional .
  methods UPDATE_CONNECTOR_DATA
    redefinition .
protected section.
private section.
endclass. &quot;ZAPLINK_RAW definition
class ZAPLINK_BADI definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  type-pools SEEX .
  constants ST_BADI_DEF type TD_COMPTYPE value &apos;SXSD&apos;. &quot;#EC NOTEXT
  constants ST_BADI_IMPL type TD_COMPTYPE value &apos;SXCI&apos;. &quot;#EC NOTEXT
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_BADI&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
private section.
  types:
    BEGIN OF ts_doc_key,                                    &quot; equiv DOKU_OBJ = CHAR 60
      simg(4)    TYPE c,     &quot;SIMG
      name       TYPE rsexscrn-exit_name,                   &quot; CHAR 30
    END OF ts_doc_key .
  types:
    BEGIN OF ts_clas_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_clas_attr .
  types TO_BADI_DEF type ref to ZAPLINK_SXSD_DATA .
  types TO_BADI_IMPL type ref to ZAPLINK_SXCI_DATA .
  class-data R_DOC_ID_DEFINITION type TR_DOCID .
  constants T_BADI_ITF type TD_COMPTYPE value &apos;INTF&apos;. &quot;#EC NOTEXT
  constants T_BADI_IMPL type TD_COMPTYPE value &apos;CLAS&apos;. &quot;#EC NOTEXT
  class-data R_DOC_ID_IMPLEMENTATION type TR_DOCID .
  constants _UUID type TD_CONNUUID value &apos;5DAA0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  class-methods CREATE_DOC_KEY
    returning
      value(DOC_KEY) type TS_DOC_KEY .
  class-methods DO_EXISTS_IMPL
    importing
      !NAME type RSEXSCRN-IMP_NAME
    returning
      value(_EXISTS) type TD_COMPEXISTS .
  methods EXPORT_FROM_SAP_DEF
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(O_DATA) type TO_BADI_DEF
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_FROM_SAP_IMPL
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(O_DATA) type TO_BADI_IMPL
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP_DEF
    importing
      !O_DATA type TO_BADI_DEF
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP_IMPL
    importing
      !O_DATA type TO_BADI_IMPL
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
endclass. &quot;ZAPLINK_BADI definition
class ZAPLINK_BADI_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create protected
  FRIENDS ZAPLINK_BADI
                 ZAPLINK_EASYXML .
public section.
  type-pools SEEX .
  interfaces ZAPLINK_DATATYPES .
  interfaces ZAPLINK_KERNEL_TYPES .
  aliases EXISTS
    for ZAPLINK_DATATYPES~EXISTS .
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TEXTPOOL_KINDS
    for ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  aliases TD_ABAPSOURCE
    for ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  aliases TD_CLASSNAME
    for ZAPLINK_DATATYPES~TD_CLASSNAME .
  aliases TD_COMPEXISTS
    for ZAPLINK_DATATYPES~TD_COMPEXISTS .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TD_COMPTYPE
    for ZAPLINK_DATATYPES~TD_COMPTYPE .
  aliases TD_CONNCLASS
    for ZAPLINK_DATATYPES~TD_CONNCLASS .
  aliases TD_CONNEXISTS
    for ZAPLINK_DATATYPES~TD_CONNEXISTS .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_EXISTS
    for ZAPLINK_DATATYPES~TD_EXISTS .
  aliases TD_LANG
    for ZAPLINK_DATATYPES~TD_LANG .
  aliases TD_LIGHT
    for ZAPLINK_DATATYPES~TD_LIGHT .
  aliases TD_OBJ_TYPE
    for ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  aliases TD_PROGNAME
    for ZAPLINK_DATATYPES~TD_PROGNAME .
  aliases TD_SEL_ACTION
    for ZAPLINK_DATATYPES~TD_SEL_ACTION .
  aliases TD_TXTP_ID
    for ZAPLINK_DATATYPES~TD_TXTP_ID .
  aliases TD_TXTP_KIND
    for ZAPLINK_DATATYPES~TD_TXTP_KIND .
  aliases TD_TXTP_LEN
    for ZAPLINK_DATATYPES~TD_TXTP_LEN .
  aliases TD_TXTP_TEXT
    for ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  aliases TO_RAW
    for ZAPLINK_KERNEL_TYPES~TO_RAW .
  aliases TO_XML
    for ZAPLINK_DATATYPES~TO_XML .
  aliases TR_DLVUNIT
    for ZAPLINK_DATATYPES~TR_DLVUNIT .
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TR_TR
    for ZAPLINK_DATATYPES~TR_TR .
  aliases TS_BASE_ATTRIBUTS
    for ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TS_CONN_CLASS
    for ZAPLINK_DATATYPES~TS_CONN_CLASS .
  aliases TS_CONN_DEF
    for ZAPLINK_DATATYPES~TS_CONN_DEF .
  aliases TS_TXTP_TEXT
    for ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  aliases TS_TXTP_TEXTPOOL
    for ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  aliases TS_TYPE
    for ZAPLINK_DATATYPES~TS_TYPE .
  aliases TT_ABAPRAWSOURCE
    for ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  aliases TT_CONN_CLASSES
    for ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  aliases TT_DOCS
    for ZAPLINK_DATATYPES~TT_DOCS .
  aliases TT_TXTP_TEXTPOOLS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  aliases TT_TXTP_TEXTS
    for ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
*  interface ZAPLINK_CONNECTOR load .
  types TO_RAW2 type ZAPLINK_CONNECTOR=&gt;TO_RAW .
  types:
    tt_functions TYPE SORTED TABLE OF seex_fcode_struct WITH UNIQUE KEY gui_prog gui_code .
  types:
    tt_controls TYPE SORTED TABLE OF seex_coco_struct WITH UNIQUE KEY coco_outer node_id .
  types:
    tt_screens TYPE SORTED TABLE OF seex_screen_struct WITH UNIQUE KEY scr_a_prog scr_a_num scr_a_sscr .
  types:
    tt_tables TYPE SORTED TABLE OF seex_table_struct WITH UNIQUE KEY tabname .
  types:
    BEGIN OF t_fm_data,
          mast_langu      TYPE  sy-langu,
          fcodes          TYPE  seex_fcode_table,
          cocos           TYPE  seex_coco_table,
          intas           TYPE  seex_table_table,
          scrns           TYPE  seex_screen_table,
          definition      TYPE  badi_data,
          inactive_tabstrips  TYPE  seex_inactive_tabstrips,
          ext_clname      TYPE  seoclsname,
          filter_obj      TYPE REF TO cl_badi_flt_struct,
          methods     TYPE  seex_mtd_table,
          implementation  TYPE impl_data,
          impl_w_filter   TYPE flt_ext,  &quot; Filter active
          filter_datatype TYPE rollname,
          filter_values   TYPE SEEX_FILTER_TABLE,    &quot;REF TO cl_badi_flt_values_alv,
        END OF t_fm_data .
  data FUNCTIONS_CODES type TT_FUNCTIONS .
  data CONTROLS_COMPOSITES type TT_CONTROLS .
  data SUBSCREENS type TT_SCREENS .
  data TABLES type TT_TABLES .
  data DOCUMENTATION type TT_DOCS .
  methods FROM_DATA
    importing
      !FM_DATA type T_FM_DATA .
  methods TO_DATA
    returning
      value(FM_DATA) type T_FM_DATA .
protected section.
  data DEF_NAME type EXIT_DEF .
private section.
endclass. &quot;ZAPLINK_BADI_DATA definition
class ZAPLINK_CLAS_DATA definition
  inheriting from ZAPLINK_OBJECT_DATA
  final
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_OBJECT .
public section.
  type-pools SEOF .
  type-pools SEOK .
  type-pools SEOO .
  type-pools SEOR .
  type-pools SEOS .
  type-pools SEOT .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
  types TO_MSG_COL type ref to ZAPLINK_MESSAGE_COLLECTOR .
  types:
    BEGIN OF ts_exception_text,
        cmpname   TYPE seoo_attribute_r-cmpname,      &quot; Issue 62 : Reorg Exception text
        editorder TYPE seoo_attribute_r-editorder,    &quot; Issue 71 : Keep SOTR Attribut order
        texts     TYPE tt_texts,
      END OF ts_exception_text .
  types:
    tt_exceptions_texts TYPE SORTED TABLE OF ts_exception_text WITH UNIQUE KEY cmpname .
  types:
    BEGIN OF ts_locals,
          types           TYPE ts_sourceasstruc,
          implementations TYPE ts_sourceasstruc,
          macros          TYPE ts_sourceasstruc,
        END OF ts_locals .
  types:
    BEGIN OF ts_redefinition.
    INCLUDE TYPE seoredef AS hdr.  &quot; Mthodes redfinies par relation d&apos;hritage
    TYPES:
        source  TYPE ts_sourceasstruc,
      END OF ts_redefinition .
  types:
    tt_redefinitions TYPE SORTED TABLE OF ts_redefinition WITH UNIQUE KEY mtdname .
  types:
    tt_friends    TYPE SORTED TABLE OF seofriends WITH UNIQUE KEY refclsname friendtype .
  types:
    BEGIN OF ts_class_data.
    INCLUDE TYPE vseoclass AS hdr.
    TYPES:
        inheritance TYPE vseoextend,
        texts       TYPE tt_seoclasstx_s,
        textpool    TYPE tt_txtp_textpools,
        sources     TYPE ts_sources,
      END OF ts_class_data .
  data A0_MAINDATA type TS_CLASS_DATA .
  data FRIENDS type TT_FRIENDS .
  data REDEFINITIONS type TT_REDEFINITIONS .
  data LOCAL type TS_LOCALS .
  data EXCEPTIONS_TEXTS type TT_EXCEPTIONS_TEXTS .
  data TEXTSPOOL type TT_TXTP_TEXTPOOLS .
  data DYNPROS type TT_DYNPROS .
  events MY_EVENT2 .
  class-methods UPDATE_CONCEPT
    importing
      !MSG_COL type TO_MSG_COL
    changing
      !FM_DATA type T_FM_DATA
    raising
      ZAPLINK_CX_CONNECTOR .
  methods ANONYMIZE
    redefinition .
  methods COMPLETE_DATA
    redefinition .
  methods FROM_DATA
    redefinition .
  methods TO_DATA
    redefinition .
protected section.
  data MENUPAINTER type TO_MENUPAINTER .
private section.
  class-data O_MYCX type TO_EXCEPTION .
  class-data O_CX type TO_ROOT_EXCEPTION .
  class-methods GET_SOURCE
    importing
      !PROGRAM type PROGRAMM
    returning
      value(SOURCE) type TD_ABAPSOURCE .
  class-methods VALUE2SOTR
    importing
      !DATA type SEOVALUE
    returning
      value(RESULT) type SOTR_CONC .
  class-methods SOTR2VALUE
    importing
      !DATA type SOTR_CONC
    returning
      value(RESULT) type SEOVALUE .
endclass. &quot;ZAPLINK_CLAS_DATA definition
class ZAPLINK_COMPONENT_4INST definition
  inheriting from ZAPLINK_COMPONENT
  create protected
  FRIENDS ZAPLINK_INFOS .
public section.
protected section.
private section.
endclass. &quot;ZAPLINK_COMPONENT_4INST definition
class ZAPLINK_CONNECTORS_4INST definition
  inheriting from ZAPLINK_CONNECTORS
  create protected
  FRIENDS ZAPLINK_INFOS .
public section.
protected section.
private section.
endclass. &quot;ZAPLINK_CONNECTORS_4INST definition
class ZAPLINK_DEPENDENCIES_ANALYSER definition
  create public .
public section.
  type-pools ABAP .
  type-pools SEOP .
  interfaces ZAPLINK_DATATYPES .
  interfaces ZAPLINK_KERNEL_TYPES .
  aliases TD_DEVCLASS
    for ZAPLINK_DATATYPES~TD_DEVCLASS .
  aliases TD_SOFTCOMP
    for ZAPLINK_DATATYPES~TD_SOFTCOMP .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  types TD_CLASSTYPE type CHAR01 .
  types:
    tr_packages TYPE RANGE OF tdevc-devclass .
  types:
    tr_dlvunit TYPE RANGE OF tdevc-dlvunit .
  types TD_NAME type SEOCLSNAME .
  types TD_SOURCECODE type SEOP_SOURCE_STRING .
  types:
    BEGIN OF ts_source,
        name  TYPE td_name,
        type  TYPE td_classtype,    &quot; 0 Class 1 interface
        def   TYPE td_sourcecode,
        macro TYPE td_sourcecode,
        impl  TYPE td_sourcecode,
      END OF ts_source .
  types:
    tt_sources TYPE SORTED TABLE OF ts_source WITH UNIQUE KEY name .
  types:
    BEGIN OF ts_list,
        name      TYPE td_name,
      END OF ts_list .
  types:
    BEGIN OF ts_req_object,
        ori_name  TYPE td_name,
        name      TYPE td_name,
        type      TYPE td_classtype,    &quot; 0 Class 1 interface
        full_def  TYPE flag,          &quot; Full definition required
        source    TYPE string,
      END OF ts_req_object .
  types:
    tt_req_objects TYPE STANDARD TABLE OF ts_req_object WITH NON-UNIQUE KEY name .
  types:
    BEGIN OF ts_order.
    INCLUDE TYPE ts_list.
    TYPES:
      type    TYPE td_classtype,    &quot; 0 Class 1 interface
      defered TYPE flag,          &quot; &apos;X&apos; if defered load required
    END OF ts_order .
  types:
    tt_list TYPE STANDARD TABLE OF ts_order WITH DEFAULT KEY .
  types:
    BEGIN OF ts_context,
          context   TYPE string,
          type      TYPE td_classtype,    &quot; 0 Class 1 interface
          full_def  TYPE flag,          &quot; Full definition required
        END OF ts_context .
  types:
    tt_context TYPE STANDARD TABLE OF ts_context WITH DEFAULT KEY .
  types:
    tt_order TYPE STANDARD TABLE OF ts_order WITH NON-UNIQUE KEY name .
  types:
    BEGIN OF ts_typegroup,
              name TYPE seotpuname,
            END OF ts_typegroup .
  types:
    tt_typegroups TYPE STANDARD TABLE OF ts_typegroup WITH DEFAULT KEY .
  types:
    BEGIN OF ts_comp.
    INCLUDE TYPE ts_compkey AS hdr.
    TYPES:
        devclass TYPE td_devclass,
        softcomp TYPE td_softcomp,
      END OF ts_comp .
  types:
    tt_comps type SORTED TABLE OF ts_comp with UNIQUE KEY type name .
  types TD_MESSAGE type SEOCLASSDF-MSG_ID .
  types:
    BEGIN OF ts_message,
              name TYPE td_message,
            END OF ts_message .
  types:
    tt_message_ids TYPE STANDARD TABLE OF ts_message WITH DEFAULT KEY .
  data CLASSES type TT_SOURCES read-only .
  data ORDER type TT_ORDER read-only .
  constants:
    BEGIN OF typetype,
            like    TYPE seotyptype VALUE &apos;0&apos;, &quot;#EC NOTEXT      Attribute reference (LIKE)
            type    TYPE seotyptype VALUE &apos;1&apos;, &quot;#EC NOTEXT      Type reference (TYPE)
            otype   TYPE seotyptype VALUE &apos;2&apos;, &quot;#EC NOTEXT      Object (TYPE)
            ref     TYPE seotyptype VALUE &apos;3&apos;, &quot;#EC NOTEXT      Object reference (TYPE REF TO)
            code    TYPE seotyptype VALUE &apos;4&apos;, &quot;#EC NOTEXT      See coding
          END OF typetype .
  constants:
    BEGIN OF objtype,
            class             TYPE td_classtype VALUE &apos;0&apos;, &quot;#EC NOTEXT      Object Type : Class
            exception_class   TYPE td_classtype VALUE &apos;5&apos;, &quot;#EC NOTEXT      Local Object type : Exception_Class
            interface         TYPE td_classtype VALUE &apos;1&apos;, &quot;#EC NOTEXT      Object Type : Interface
          END OF objtype .
  data TYPEGROUPS type TT_TYPEGROUPS .
  class-data SOFTCOMPONENTS type TR_DLVUNIT read-only .
  data INCLUDES type TD_SOURCECODE .
  data PACKAGES type TR_PACKAGES .
  data MESSAGES type TT_MESSAGE_IDS read-only .
  data NEW_ORDER type TT_ORDER .
  data REMAIN_CLASSES type TT_SOURCES .
  data ALL_COMPONENTS type TT_COMPS read-only .
  methods ADD_OBJECT
    importing
      !NAME type TD_NAME
    exceptions
      FAILED
      EXISTS
      NOT_EXISTING .
  methods ADD_SOURCE
    importing
      !CODE type TD_SOURCECODE .
  class-methods CLASS_CONSTRUCTOR .
  class-methods CLEAN_CODE
    importing
      !CODE type TD_SOURCECODE
    returning
      value(RESULT) type TD_SOURCECODE .
  methods ADD_DEFERED_OK
    returning
      value(RESULT) type ABAP_BOOL .
  methods ADD_WITHOUT_REQUIREMENTS
    returning
      value(RESULT) type ABAP_BOOL .
  methods RESOLVE .
  class-methods GET_SOURCE
    importing
      !NAME type TD_NAME
    returning
      value(CODES) type TS_SOURCE
    exceptions
      FAILED .
  class-methods SOURCE_2_STRING
    importing
      !DATA type TD_SOURCECODE
    returning
      value(RESULT) type STRING .
protected section.
  aliases LINE_SEPARATOR
    for ZAPLINK_DATATYPES~LINE_SEPARATOR .
  aliases TD_COMPNAME
    for ZAPLINK_DATATYPES~TD_COMPNAME .
  aliases TO_COMPONENT
    for ZAPLINK_KERNEL_TYPES~TO_COMPONENT .
  aliases TO_RAW
    for ZAPLINK_KERNEL_TYPES~TO_RAW .
  types:
    tt_classlist TYPE SORTED TABLE OF ts_list WITH UNIQUE KEY name .
  types TO_CLASS type ref to ZAPLINK_CLAS_DATA .
  types TO_OBJECT type ref to ZAPLINK_OBJECT .
  types TO_INTERFACE type ref to ZAPLINK_INTF_DATA .
  data DEFERRED_DECLARATION type TT_CLASSLIST .
  methods ADD_ATTRIBUTS
    importing
      !ATTRIBUTS type ZAPLINK_OBJECT_DATA=&gt;TT_ATTRIBUTS
    exceptions
      FAILED .
  methods IS_EXCLUDED_CLASS
    importing
      !NAME type TD_NAME
      !TYPE type TADIR-OBJECT optional
    returning
      value(RESULT) type ABAP_BOOL .
  methods ADD_CLASS_DEP
    importing
      !NAME type TD_NAME
      !FULL type ABAP_BOOL default ABAP_FALSE
    exceptions
      FAILED
      EXISTS
      NOT_EXISTING .
  methods ADD_DEFERRED_CODE
    importing
      !TYPE type TD_CLASSTYPE
      !NAME type TD_NAME
    changing
      !ABAPCODE type TD_SOURCECODE .
  methods ADD_INTERFACES
    importing
      !INTERFACES type ZAPLINK_OBJECT_DATA=&gt;TT_INTERFACES
    exceptions
      FAILED .
  methods ADD_INTERFACE_DEP
    importing
      !NAME type TD_NAME
      !FULL type ABAP_BOOL default ABAP_FALSE
    exceptions
      FAILED
      EXISTS
      NOT_EXISTING .
  methods ADD_METHODS
    importing
      !METHODS type ZAPLINK_OBJECT_DATA=&gt;TT_METHODS
    exceptions
      FAILED .
  methods ADD_METHOD_SOURCE
    importing
      !CODE type STRING .
  methods ADD_OBJECT_TO_LIST
    importing
      !NAME type TD_NAME
      !FULL type ABAP_BOOL default ABAP_FALSE
      !SOURCE type STRING .
  methods ADD_TYPES
    importing
      !TYPES type ZAPLINK_OBJECT_DATA=&gt;TT_TYPES
    exceptions
      FAILED .
  methods ANALYSE_METHOD_SOURCE
    importing
      !CODE type STRING
    returning
      value(OBJECTS_LIST) type TD_SOURCECODE .
  methods APPEND_MESSAGE
    importing
      !DATA type TD_MESSAGE .
  methods APPEND_TYPEGROUPS
    importing
      !TYPEGROUPS type ZAPLINK_OBJECT_DATA=&gt;TT_TYPEGROUPS .
  class-methods CONVERT_LINE
    importing
      !SOURCE type STRING
    returning
      value(TARGET) type STRING .
  class-methods CONVERT_SOURCE
    importing
      !SOURCECODE type TD_SOURCECODE
    returning
      value(TARGETCODE) type TD_SOURCECODE .
  class-methods CONVERT_SOURCE_UPCASE
    importing
      !SOURCECODE type TD_SOURCECODE
    returning
      value(TARGETCODE) type TD_SOURCECODE .
  class-methods EXTRACT_STRINGS
    importing
      !FORWARD type FLAG optional
      !SEARCH_TERM type STRING
      !CODE type STRING
    preferred parameter FORWARD
    returning
      value(RESULTS) type TD_SOURCECODE .
  class-methods GET_CLASS_SOURCE
    importing
      !NAME type TD_NAME
    returning
      value(CODES) type TS_SOURCE
    exceptions
      FAILED .
  class-methods GET_INTERFACE_SOURCE
    importing
      !NAME type TD_NAME
    returning
      value(CODES) type TS_SOURCE
    exceptions
      FAILED .
  methods HANDLE_CONTEXT
    exceptions
      FAILED .
  methods PROCESS_TYPE
    importing
      !TYPE type SEOTYPTYPE
      !NAME type RS38L_TYP
      !SOURCE type STRING optional .
  class-methods REMOVE_DEF_LOAD
    changing
      !CODES type TS_SOURCE .
  methods SEARCH_FOR_INCLUDE
    changing
      !CODES type TS_SOURCE .
  methods STACK
    importing
      !CONTEXT type ANY
      !TYPE type TD_CLASSTYPE optional
      !FULL type ABAP_BOOL default ABAP_FALSE .
  methods UNSTACK .
  methods _CLEAN_UP .
  class-methods INVERSE_ORDER
    changing
      !ORDER type STANDARD TABLE .
private section.
  class-data O_OBJECT type TO_OBJECT .
  data CONTEXT type TT_CONTEXT .
  data CIRCULAR_REF_ON type TD_NAME .
  data CIRCULAR_CONTEXT type TT_CONTEXT .
  data REQUIRED_OBJECTS type TT_REQ_OBJECTS .
  data CURRENT_COMP type TD_NAME .
  data EXCLUDED_CLASSES type TT_CLASSLIST .
  data REQUIREMENTS type TT_REQ_OBJECTS .
  data S_COMP type TS_COMP .
  methods ADD_SOURCE_TO_LIST
    importing
      !CODE type STRING
      !SOURCE type STRING .
  methods DO_CLASS
    importing
      !NAME type TD_NAME
    exceptions
      FAILED .
  methods DO_OBJECT_LIST
    importing
      !NAME type TD_NAME .
  methods INSERT_ORDER
    importing
      !S_ORDER type TS_ORDER
      value(CONTEXT) type TT_CONTEXT .
endclass. &quot;ZAPLINK_DEPENDENCIES_ANALYSER definition
class ZAPLINK_DEVC_RAW definition
  inheriting from ZAPLINK_RAW
  create public
  FRIENDS ZAPLINK_EASYXML .
public section.
  methods CONSTRUCTOR
    importing
      !O_COMP type TO_COMPONENT optional .
protected section.
private section.
endclass. &quot;ZAPLINK_DEVC_RAW definition
class ZAPLINK_DICTIONARY definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  types TD_TYPEGROUP type TYPEGROUP .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_DICTIONARY&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods GET_TYPEGROUP_SIGNATURE
    importing
      !TYPE_GROUP type TD_TYPEGROUP
    returning
      value(RESULT) type ZAPLINK_DATATYPES~TD_CHECKSUM
    raising
      ZAPLINK_CX_CONNECTOR .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_TYPEGROUP type ref to ZAPLINK_TYPE_DATA .
  types TO_DOMAIN type ref to ZAPLINK_DOMA_DATA .
  types TO_DATA_ELEMENT type ref to ZAPLINK_DTEL_DATA .
  types TO_VIEW type ref to ZAPLINK_VIEW_DATA .
  types TO_TABLE type ref to ZAPLINK_TABL_DATA .
  types TO_TABLE_TYPE type ref to ZAPLINK_TTYP_DATA .
  types TO_SEARCH_HELP type ref to ZAPLINK_SHLP_DATA .
  types TO_LOCK_OBJECT type ref to ZAPLINK_ENQU_DATA .
private section.
  constants _UUID type TD_CONNUUID value &apos;5079624B82531D63E1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants:
    BEGIN OF supportedtypes,                                  &quot;#EC NOTEXT
      type_group        TYPE td_comptype VALUE &apos;TYPE&apos;,
      domain            TYPE td_comptype VALUE &apos;DOMA&apos;,
      data_element      TYPE td_comptype VALUE &apos;DTEL&apos;,
      table_type        TYPE td_comptype VALUE &apos;TTYP&apos;,
      search_help       TYPE td_comptype VALUE &apos;SHLP&apos;,
      mactchcode_id     TYPE td_comptype VALUE &apos;MCID&apos;,
      lock_object       TYPE td_comptype VALUE &apos;ENQU&apos;,
      matchcode_obj     TYPE td_comptype VALUE &apos;MCOB&apos;,
      table_index       TYPE td_comptype VALUE &apos;INDX&apos;,     &quot; N  Table Index
      ext_index         TYPE td_comptype VALUE &apos;XINX&apos;,     &quot; O  Extention Index MF INTERN_TRANSL_EUTYPE
      table             TYPE td_comptype VALUE &apos;TABL&apos;,
      view              TYPE td_comptype VALUE &apos;VIEW&apos;,
      t_cluster_pool    TYPE td_comptype VALUE &apos;SQLT&apos;,
    END OF supportedtypes .
  constants:
    BEGIN OF dd_eu_type,          &quot; Domain DDEUTYPE
      table_type        TYPE ddeutype VALUE &apos;A&apos;,     &quot; A  Table Type
      domain            TYPE ddeutype VALUE &apos;D&apos;,     &quot; D  Domain
      data_element      TYPE ddeutype VALUE &apos;E&apos;,     &quot; E  Data Element
      table_field       TYPE ddeutype VALUE &apos;F&apos;,     &quot; F  Table Field
      type_group        TYPE ddeutype VALUE &apos;G&apos;,     &quot; G  Type Group
      search_help       TYPE ddeutype VALUE &apos;H&apos;,     &quot; H  Search Help
      mactchcode_id     TYPE ddeutype VALUE &apos;I&apos;,     &quot; I  Matchcode ID
      lock_object       TYPE ddeutype VALUE &apos;L&apos;,     &quot; L  Lock Object
      matchcode_obj     TYPE ddeutype VALUE &apos;M&apos;,     &quot; M  Matchcode Object
      table_index       TYPE ddeutype VALUE &apos;N&apos;,     &quot; N  Table Index
      ext_index         TYPE ddeutype VALUE &apos;N&apos;,     &quot; O  Extention Index MF INTERN_TRANSL_EUTYPE
      internal_struct   TYPE ddeutype VALUE &apos;S&apos;,     &quot; S  Internal Structure
      transp_table      TYPE ddeutype VALUE &apos;T&apos;,     &quot; T  Transparent Table
      structure         TYPE ddeutype VALUE &apos;U&apos;,     &quot; U  Table/Structure
      view              TYPE ddeutype VALUE &apos;V&apos;,     &quot; V  View
      table_pool        TYPE ddeutype VALUE &apos;X&apos;,     &quot; X  Table Pool
      table_cluster     TYPE ddeutype VALUE &apos;Y&apos;,     &quot; Y  Table Cluster
      t_cluster_pool    TYPE ddeutype VALUE &apos;Z&apos;,     &quot; Z  Table cluster/pool
    END OF dd_eu_type .
  class-methods GET_TYPE_GROUP
    importing
      !TYPE_GROUP type TD_TYPEGROUP
    returning
      value(RESULT) type ref to CL_WB_SOURCE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_TYPE_GROUP
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_TYPEGROUP
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TYPE_GROUP
    importing
      !O_DATA type TO_TYPEGROUP
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_DOMAIN
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_DOMAIN
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_DOMAIN
    importing
      !O_DATA type TO_DOMAIN
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_DATA_ELEMENT
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_DATA_ELEMENT
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_DATA_ELEMENT
    importing
      !O_DATA type TO_DATA_ELEMENT
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_VIEW
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_VIEW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_VIEW
    importing
      !O_DATA type TO_VIEW
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_TABLE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_TABLE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TABLE
    importing
      !O_DATA type TO_TABLE
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_TABLE_TYPE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_TABLE_TYPE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TABLE_TYPE
    importing
      !O_DATA type TO_TABLE_TYPE
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_SEARCH_HELP
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_SEARCH_HELP
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_SEARCH_HELP
    importing
      !O_DATA type TO_SEARCH_HELP
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_LOCK_OBJECT
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_LOCK_OBJECT
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_LOCK_OBJECT
    importing
      !O_DATA type TO_LOCK_OBJECT
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
endclass. &quot;ZAPLINK_DICTIONARY definition
class ZAPLINK_INTF_DATA definition
  inheriting from ZAPLINK_OBJECT_DATA
  final
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_OBJECT .
public section.
  type-pools SEOF .
  type-pools SEOK .
  type-pools SEOO .
  type-pools SEOR .
  type-pools SEOS .
  type-pools SEOT .
  types:
    BEGIN OF ts_main_data.
    INCLUDE TYPE vseointerf AS hdr.
    TYPES:
        texts       TYPE tt_seoclasstx_s,
        textpool    TYPE tt_txtp_textpools,
      END OF ts_main_data .
  data A0_MAINDATA type TS_MAIN_DATA .
  methods ANONYMIZE
    redefinition .
  methods COMPLETE_DATA
    redefinition .
  methods FROM_DATA
    redefinition .
  methods TO_DATA
    redefinition .
protected section.
private section.
endclass. &quot;ZAPLINK_INTF_DATA definition
class ZAPLINK_OBJECT definition
  inheriting from ZAPLINK_CONNECTOR_
  create public
  FRIENDS ZAPLINK_OBJECT_DATA .
public section.
  type-pools ABAP .
  type-pools SEOF .
  type-pools SEOK .
  type-pools SEOP .
  type-pools SEOR .
  type-pools SEOS .
  type-pools SEOT .
  type-pools SEOX .
  types TD_SOURCECODE type SEOP_SOURCE_STRING .
  class-methods GET_INTERFACE_SIGNATURE
    importing
      !INTERFACE_NAME type SEOCLSKEY
    returning
      value(RESULT) type ZAPLINK_DATATYPES~TD_CHECKSUM
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods GET_CLASS_SIGNATURE
    importing
      !CLASS_NAME type SEOCLSKEY
    returning
      value(RESULT) type ZAPLINK_DATATYPES~TD_CHECKSUM
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CONSTRUCTOR .
  class-methods GET_INTERFACE_GLOBALSOURCE
    importing
      !INTERFACE_NAME type SEOCLSKEY
    returning
      value(RESULT) type TD_SOURCECODE
    exceptions
      NOT_A_CLASS
      FAILED .
  class-methods GET_CLASS_GLOBALSOURCE
    importing
      !CLASS_NAME type SEOCLSKEY
    returning
      value(RESULT) type TD_SOURCECODE
    exceptions
      NOT_A_CLASS .
  class-methods GET_INCLUDES
    importing
      !CLSNAME type SEOCLSNAME
    returning
      value(INCLUDES) type ZAPLINK_OBJECT_DATA=&gt;TS_INCLUDES .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types T_FM_DATA type ZAPLINK_OBJECT_DATA=&gt;T_FM_DATA .
  types TO_CLASS type ref to ZAPLINK_CLAS_DATA .
  types TO_INTERFACE type ref to ZAPLINK_INTF_DATA .
  methods SEARCH_TYPE_POOL
    importing
      !SOURCECODE type TT_ABAPRAWSOURCE
      !TYPEPOOLS type SEOT_TYPEPUSAGES_R
      !PUBLIC type ABAP_BOOL optional
    exporting
      !NEW_SOURCECODE type TT_ABAPRAWSOURCE
      !NEW_TYPEPOOLS type SEOT_TYPEPUSAGES_R .
  methods IMPORT_TO_SAP_CLASS
    importing
      !O_DATA type TO_CLASS
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_FROM_SAP_CLASS
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_CLASS
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_FROM_SAP_INTERFACE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP_INTERFACE
    importing
      !O_DATA type TO_INTERFACE
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CHECK_CLAS_SECTIONS
    importing
      !CLASS type T_FM_DATA
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CHECK_INTF_SECTION
    importing
      !INTERFACE type T_FM_DATA
    raising
      ZAPLINK_CX_CONNECTOR .
private section.
  types:
    BEGIN OF ts_bapi_data,
    class                       TYPE  vseoclass,
    attributes                  TYPE  seoo_attributes_r,
    methods                     TYPE  seoo_methods_r,
    events                      TYPE  seoo_events_r,
    types                       TYPE  seoo_types_r,
    parameters                  TYPE  seos_parameters_r,
    exceps                      TYPE  seos_exceptions_r,
    implementings               TYPE  seor_implementings_r,
    inheritance                 TYPE  vseoextend,
    redefinitions               TYPE  seor_redefinitions_r,
    impl_details                TYPE  seor_redefinitions_r,
    friendships                 TYPE  seof_friendships_r,
    typepusages                 TYPE  seot_typepusages_r,
    clsdeferrds                 TYPE  seot_clsdeferrds_r,
    intdeferrds                 TYPE  seot_intdeferrds_r,
    explore_inheritance         TYPE  seok_cls_typeinfos,
    explore_implementings       TYPE  seok_int_typeinfos,
    aliases                     TYPE  seoo_aliases_r,
    enhancement_methods         TYPE  enhmeth_tabheader,
    enhancement_attributes      TYPE  enhclasstabattrib,
    enhancement_events          TYPE  enhclasstabevent,
    enhancement_implementings   TYPE enhclasstabimplementing,
  END OF ts_bapi_data .
  types:
    BEGIN OF ts_clas_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_clas_attr .
  constants _UUID type TD_CONNUUID value &apos;39AC0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.01&apos;. &quot;#EC NOTEXT
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_OBJECT&apos;. &quot;#EC NOTEXT
  class-methods GET_CLASS_GLOBALSOURCE_
    importing
      !CLASS_NAME type SEOCLSKEY
    returning
      value(RESULT) type TD_SOURCECODE .
  methods LOAD_CLAS
    importing
      !CLASSKEY type SEOCLSKEY
    changing
      !_D type T_FM_DATA
    raising
      ZAPLINK_CX_CONNECTOR .
endclass. &quot;ZAPLINK_OBJECT definition
class ZAPLINK_PACKAGE definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  type-pools ABAP .
  type-pools SEOF .
  type-pools SEOK .
  type-pools SEOP .
  type-pools SEOR .
  type-pools SEOS .
  type-pools SEOT .
  type-pools SEOX .
  type-pools SLIS .
  data TRANSPORT_REQUEST type E070-TRKORR .
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_PACKAGE type ref to ZAPLINK_DEVC_DATA .
  types TO_INTERFACE type ref to ZAPLINK_PINF_DATA .
  types TD_PACKAGE type DEVCLASS .
  types TD_INTERFACE type SCOMIFNAM .
  types TO_PACKAGE_RAW type ref to ZAPLINK_DEVC_RAW .
  types TO_INTERFACE_RAW type ref to ZAPLINK_PINF_RAW .
  methods ANONYMIZE_INTERFACE
    importing
      !OBJECT type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods ANONYMIZE_PACKAGE
    importing
      !OBJECT type TO_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CONV_PACKAGE_RAW
    importing
      !PACKAGE type ref to IF_PACKAGE
      !SUBCOMPONENTS type TO_LIST
    returning
      value(O_DATA) type TO_PACKAGE_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods UNANONYMIZE_INTERFACE
    importing
      !OBJECT type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods UNANONYMIZE_PACKAGE
    importing
      !OBJECT type TO_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
private section.
  types:
    BEGIN OF ts_ele,
    select    TYPE flag,
    elem_type TYPE trobjtype,
    elem_key  TYPE elemgenkey,
    td_pack   TYPE devclass,
    elem_pack TYPE devclass,
  END OF ts_ele .
  types:
    tt_ele TYPE STANDARD TABLE OF ts_ele WITH NON-UNIQUE DEFAULT KEY .
  types:
    BEGIN OF ts_doc_key,                                    &quot; equiv DOKU_OBJ = CHAR 60
    name       TYPE seoclsname,                             &quot; CHAR 30
    other(30)  TYPE c,
  END OF ts_doc_key .
  types:
    BEGIN OF ts_clas_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_clas_attr .
  constants ST_PACKAGE type TD_COMPTYPE value &apos;DEVC&apos;. &quot;#EC NOTEXT
  constants ST_INTERFACE type TD_COMPTYPE value &apos;PINF&apos;. &quot;#EC NOTEXT
  class-data CAT_ELE type SLIS_T_FIELDCAT_ALV .
  class-data CAT_LAYOUT type SLIS_LAYOUT_ALV .
  constants _UUID type TD_CONNUUID value &apos;29AD0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_PACKAGE&apos;. &quot;#EC NOTEXT
  methods ADD_ELEMENTS_LIST
    importing
      !INTERFACE type TO_INTERFACE
      !ASK_USER type FLAG optional
      !ADD_REMAIN type FLAG default &apos;X&apos;
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods BUILD_ERROR_MSG
    importing
      !ELEMENTS type SCOMELDATA
    returning
      value(ERRORMSG) type STRING .
  methods CHANGE_TADIR
    changing
      !ALV_DATA type TT_ELE .
  methods CONV_INTERFACE
    importing
      !INTERFACE type ref to IF_PACKAGE_INTERFACE
      !SUBCOMPONENTS type TO_LIST
    returning
      value(O_DATA) type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CONV_INTERFACE_RAW
    importing
      !INTERFACE type ref to IF_PACKAGE_INTERFACE
      !SUBCOMPONENTS type TO_LIST
    returning
      value(O_DATA) type TO_INTERFACE_RAW
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CONV_PACKAGE
    importing
      !PACKAGE type ref to IF_PACKAGE
      !SUBCOMPONENTS type TO_LIST
      !WITH_SUBCOMP type TD_WITH_SUBCOMP default ABAP_TRUE
    returning
      value(O_DATA) type TO_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CREATE_INTERFACE
    importing
      !OVERWRITE type FLAG
      !INTERFACE type TO_INTERFACE
      !COMPONENTS type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods CREATE_PACKAGE
    importing
      !OVERWRITE type FLAG
      !PACKAGE type TO_PACKAGE
      !COMPONENTS type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods ELEMENTS2ALV
    importing
      !ELEMENTS type SCOMELDATA
    returning
      value(ALV_DATA) type TT_ELE .
  methods EXPORT_FROM_SAP_INTERFACE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods EXPORT_FROM_SAP_PACKAGE
    importing
      !COMPONENT type TO_COMPONENT
    returning
      value(OBJECT) type TO_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP_INTERFACE
    importing
      !O_DATA type TO_INTERFACE
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods IMPORT_TO_SAP_PACKAGE
    importing
      !O_DATA type TO_PACKAGE
    returning
      value(COMPONENTS) type TO_LIST
    raising
      ZAPLINK_CX_CONNECTOR .
  methods LOAD_DEVC
    importing
      !KEY type TD_PACKAGE
    returning
      value(OBJ) type ref to IF_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods LOAD_INTF
    importing
      !KEY type TD_INTERFACE
    returning
      value(OBJ) type ref to IF_PACKAGE_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods SET_INTERFACE_ATTRIB
    importing
      !INTERFACE type TO_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods SET_PACKAGE_ATTRIB
    importing
      !PACKAGE type TO_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  class-methods UPDATE_INTERFACE
    importing
      !DATA type SCOMPIDTLN
    changing
      !INTERFACE type ref to IF_PACKAGE_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods UPDATE_PACKAGE
    importing
      !DATA type SCOMPKDTLN
    changing
      !PACKAGE type ref to IF_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods _DELETE_DEVC
    importing
      !PACKAGE type ref to IF_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods _DELETE_ELEMENTS
    importing
      !PACKAGE type ref to IF_PACKAGE
    raising
      ZAPLINK_CX_CONNECTOR .
  methods _DELETE_INTF
    importing
      !INTERFACE type ref to IF_PACKAGE_INTERFACE
    raising
      ZAPLINK_CX_CONNECTOR .
endclass. &quot;ZAPLINK_PACKAGE definition
class ZAPLINK_PINF_RAW definition
  inheriting from ZAPLINK_RAW
  create public
  FRIENDS ZAPLINK_EASYXML .
public section.
  methods CONSTRUCTOR
    importing
      !O_COMP type TO_COMPONENT optional .
protected section.
private section.
endclass. &quot;ZAPLINK_PINF_RAW definition
class ZAPLINK_TRANSACTION definition
  inheriting from ZAPLINK_CONNECTOR_
  create public .
public section.
  types:
    begin of ts_text,
      langu   type SPRAS,
      ENTRY   type TEXTPOOLTX,
      LENGTH  type TEXTPOOLLN,
    end of ts_text .
  types:
    tt_texts type SORTED TABLE OF ts_text WITH UNIQUE KEY langu .
  constants BALLOG_SUBOBJECT type BALSUBOBJ value &apos;CNX_TRANSACTION&apos;. &quot;#EC NOTEXT
  methods CONSTRUCTOR .
  class-methods CLASS_CONSTRUCTOR .
  methods ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE
    redefinition .
  methods ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE
    redefinition .
  methods ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    redefinition .
  methods ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~DO_EXISTS
    redefinition .
  methods ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    redefinition .
  methods ZAPLINK_CONNECTOR~READ_FROM_SAP
    redefinition .
  methods ZAPLINK_CONNECTOR~WRITE_TO_SAP
    redefinition .
protected section.
  types TO_DATA type ref to ZAPLINK_TRAN_DATA .
private section.
  constants ST_TRANSACTION type TD_COMPTYPE value &apos;TRAN&apos;. &quot;#EC NOTEXT
  class-data R_DOC_ID type TR_DOCID .
  constants _UUID type TD_CONNUUID value &apos;A816684B5215E22AE1000000AC120173&apos;. &quot;#EC NOTEXT
  constants _VER type TD_CONNVER value &apos;1.0&apos;. &quot;#EC NOTEXT
  constants C_MSG_ID type TD_DOC_ID value &apos;NA&apos;. &quot;#EC NOTEXT
  constants:
    BEGIN OF t_component,
      program TYPE td_comptype VALUE &apos;PROG&apos;,
      object TYPE td_comptype VALUE &apos;CLAS&apos;,
      transaction TYPE td_comptype VALUE st_transaction,
      functionpool TYPE td_comptype VALUE &apos;FUGR&apos;,
    END OF t_component .
  constants:
    BEGIN OF transaction_types,   &quot; FROM LSEUKTOP(93)
      transaction  TYPE x VALUE &apos;00&apos;,               &quot; Transaktion         T
      menu         TYPE x VALUE &apos;01&apos;,               &quot; Bereichsmen        M
      parameter    TYPE x VALUE &apos;02&apos;,               &quot; Parametertrans.     P
      program      TYPE x VALUE &apos;80&apos;,               &quot; Report              R
      prog_variant TYPE x VALUE &apos;10&apos;,               &quot; Report  with Variant
      object       TYPE x VALUE &apos;08&apos;,               &quot; Transactional object
      check        TYPE x VALUE &apos;04&apos;,               &quot; With autjority check
      enqueue      TYPE x VALUE &apos;20&apos;,                       &quot; With SM01
    END OF transaction_types .
endclass. &quot;ZAPLINK_TRANSACTION definition
class ZAPLINK_TRAN_DATA definition
  inheriting from ZAPLINK_RAW_DATA
  create public
  FRIENDS ZAPLINK_EASYXML
                 ZAPLINK_TRANSACTION .
public section.
  type-pools STSTC .
  interfaces ZAPLINK_DATATYPES .
  aliases TS_LANG
    for ZAPLINK_DATATYPES~TS_LANG .
  aliases TT_TEXTS
    for ZAPLINK_DATATYPES~TT_TEXTS .
*  interface ZAPLINK_CONNECTOR load .
  types TO_RAW type ZAPLINK_CONNECTOR=&gt;TO_RAW .
  types:
    begin of TS_SUB_OBJ,
      ZL_OBJECT Type  TO_RAW,
    end of TS_SUB_OBJ .
  types:
    tt_doc_usr TYPE STANDARD TABLE OF rpy_objtab WITH DEFAULT KEY .
  types:
    tt_doc_tech TYPE STANDARD TABLE OF tline WITH DEFAULT KEY .
  types:
    tt_params TYPE STANDARD TABLE OF rsparam WITH DEFAULT KEY .
  types:
    tt_values TYPE SORTED TABLE OF tstca WITH UNIQUE KEY objct field .
  types:
    tt_tstct TYPE SORTED TABLE OF tstct WITH UNIQUE KEY sprsl .
  types:
    BEGIN OF ts_fm_data,
          tstc        TYPE tstc,
          tstct       TYPE tt_tstct,
          tstcc       TYPE tstcc,
          tstca       TYPE tt_values,
          rsstcd      TYPE rsstcd,
          gui_inh     TYPE s_gui_inhe,  &quot; (SAPLSEUK)G_GUI_INHE
          t_doc_user  TYPE tt_doc_usr,
          t_doc_tech  TYPE tt_doc_tech,
          t_params    TYPE tt_params,
        END OF ts_fm_data .
  types:
    BEGIN OF ts_maindata.
    INCLUDE TYPE tstc.
    INCLUDE TYPE rsstcd.
    TYPES:
      gui_inh   TYPE s_gui_inhe,
      s_webgui  TYPE tstcc-s_webgui,
      s_win32   TYPE tstcc-s_win32,
      s_platin  TYPE tstcc-s_platin,
      s_service TYPE tstcc-s_service,
      s_pervas  TYPE tstcc-s_pervas,
    END OF ts_maindata .
  types:
    BEGIN OF ts_authority,
          object TYPE tstca-objct,
          values TYPE tt_values,
        END OF ts_authority .
  constants:
    BEGIN OF tran_types,
             dialog  TYPE sychar01 VALUE ststc_c_type_dialog,
             report  TYPE sychar01 VALUE ststc_c_type_report,
             param   TYPE sychar01 VALUE ststc_c_type_parameters,
             variant TYPE sychar01 VALUE ststc_c_type_variant,
             object  TYPE sychar01 VALUE ststc_c_type_object,    &quot; Not supported yet
           END OF tran_types .
  data A0_MAINDATA type TS_MAINDATA .
  data TEXTS type TT_TEXTS .
  data AUTHORIZATION type TS_AUTHORITY .
  data PARAMETERS type TT_PARAMS .
  data ZL_OBJECT type TO_RAW .
  methods FROM_DATA
    importing
      !FM_DATA type TS_FM_DATA .
  methods DATA_2_TYPE
    importing
      !FM_DATA type TS_FM_DATA
    returning
      value(RESULT) type RGLIF-DOCUTYPE .
  methods TO_DATA
    returning
      value(FM_DATA) type TS_FM_DATA .
protected section.
  data TRANSACTION type TS_SUB_OBJ .
  data PROGRAM type TS_SUB_OBJ .
  data OBJECT type TS_SUB_OBJ .
private section.
  constants:
    begin of tran_kinds,
       Trans_d type TSTC-cinfo value &apos;00&apos;,
       report  type TSTC-cinfo value &apos;80&apos;,
       param   type TSTC-cinfo value &apos;02&apos;,
       variant type TSTC-cinfo value &apos;10&apos;,    &quot; Variant mask with report
       Object  type TSTC-cinfo value &apos;08&apos;,    &quot; Not supported yet
     end of tran_kinds .
endclass. &quot;ZAPLINK_TRAN_DATA definition
class ZAPLINK_INFOS definition
  final
  create public .
public section.
  interfaces ZAPLINK_DATATYPES .
  aliases FRAMEWORK_VERSION
    for ZAPLINK_DATATYPES~FRAMEWORK_VERSION .
  aliases TD_CONNUUID
    for ZAPLINK_DATATYPES~TD_CONNUUID .
  aliases TD_CONNVER
    for ZAPLINK_DATATYPES~TD_CONNVER .
  aliases TD_FRAMEWORKVER
    for ZAPLINK_DATATYPES~TD_FRAMEWORKVER .
  aliases TS_COMPKEY
    for ZAPLINK_DATATYPES~TS_COMPKEY .
  aliases TT_TYPES
    for ZAPLINK_DATATYPES~TT_TYPES .
  types:
    BEGIN OF ts_zl_comp.
    INCLUDE TYPE ts_compkey AS hdr.
    TYPES:
         devclass         TYPE string,
         signature        TYPE string,
         raw_data_type    TYPE abap_bool,        &quot; component that can&apos;t be removed
       END OF ts_zl_comp .
  types:
    tt_zl_comps TYPE SORTED TABLE OF ts_zl_comp WITH UNIQUE KEY type name .
  types:
    BEGIN OF ts_zl_cnx,
          uuid               TYPE td_connuuid.
    INCLUDE TYPE ts_zl_comp.
    TYPES:
          version            TYPE td_connver,
          supported_types    TYPE tt_types,
          _components        TYPE tt_zl_comps,
        END OF ts_zl_cnx .
  types:
    tt_zl_cnx TYPE SORTED TABLE OF ts_zl_cnx WITH UNIQUE KEY uuid .
  types:
    BEGIN OF ts_comp_detail.
    INCLUDE TYPE spam_cvers AS hdr.
    TYPES:
         level        TYPE spam_fpdef-version,
         high_package TYPE pat03-patch,
         high_spp     TYPE pat03-patch,
         spp_level    TYPE spam_fpdef-version,
         state        TYPE comp_state,
         active       TYPE spam_cvers-comp_type,
         patchable    TYPE spam_cvers-comp_type,
       END OF ts_comp_detail .
  types:
    tt_hot_pack TYPE STANDARD TABLE OF pat03 WITH DEFAULT KEY .
  types:
    tt_comps TYPE STANDARD TABLE OF ts_comp_detail WITH DEFAULT KEY .
  types:
    BEGIN OF ts_status_info,
                    sap_ver              TYPE string,
                    os                   TYPE string,
                    machine_type         TYPE string,
                    unicode              TYPE string,
                    db_sys               TYPE string,
                    db_release           TYPE string,
                    db_lib               TYPE string,
                    kernel               TYPE string,
                    abap_ver             TYPE string,
                    cua_ver              TYPE string,
                  END OF ts_status_info .
  types:
    BEGIN OF ts_sap,
            status TYPE ts_status_info,
            _hot_packages TYPE tt_hot_pack,
            _components TYPE tt_comps,
          END OF  ts_sap .
  types:
    BEGIN OF ts_zl,
            framework_version TYPE td_frameworkver,
            components TYPE tt_zl_comps,
            connectors TYPE tt_zl_cnx,
          END OF  ts_zl .
  data SAP type TS_SAP read-only .
  data ZAPLINK type TS_ZL read-only .
  data O_CX type ref to ZAPLINK_CX .
  data O_MYCX type ref to ZAPLINK_CX .
  class-methods CLASS_CONSTRUCTOR .
  methods CONSTRUCTOR .
protected section.
  aliases TR_PACKAGES
    for ZAPLINK_DATATYPES~TR_PACKAGES .
  aliases TS_COMPONENT
    for ZAPLINK_DATATYPES~TS_COMPONENT .
  aliases TT_COMPKEYS
    for ZAPLINK_DATATYPES~TT_COMPKEYS .
  types TO_LIST type ref to ZAPLINK_LIST .
  types TO_CONNECTOR type ref to ZAPLINK_CONNECTOR .
  types TO_COMPONENT type ref to ZAPLINK_COMPONENT .
  types TI_CODE_SIGNATURE type ref to ZAPLINK_CNX_EXT_CODE_SIGNATURE .
  types TO_GENERATOR type ref to ZAPLINK_DEPENDENCIES_ANALYSER .
  types TO_RAW type ref to ZAPLINK_RAW .
*  class ZAPLINK_DEPENDENCIES_ANALYSER definition load .
  types TD_CLASSNAME type ZAPLINK_DEPENDENCIES_ANALYSER=&gt;TD_NAME .
  class-data CNX_PACKAGES type TR_PACKAGES .
  methods GET_SAP_DATA .
  methods GET_ZL_DATA .
private section.
endclass. &quot;ZAPLINK_INFOS definition
class ZAPLINK_SXCI_DATA definition
  inheriting from ZAPLINK_BADI_DATA
  create public
  FRIENDS ZAPLINK_BADI
                 ZAPLINK_EASYXML .
public section.
  type-pools SEEX .
  types:
    BEGIN OF ts_maindata.
  INCLUDE TYPE impl_data AS main.
  TYPES:
      mast_langu  TYPE  sy-langu,
    END OF ts_maindata .
  types:
    BEGIN OF ts_filter,
      enhanceable TYPE rsexscrn-flt_ext,
      datatype TYPE rsexscrn-flt_type,
      values TYPE seex_filter_table,
    END OF ts_filter .
  data A0_MAINDATA type TS_MAINDATA .
  data FILTER type TS_FILTER .
  data IMPLEMENTATION type TO_RAW .
  methods FROM_DATA
    redefinition .
  methods TO_DATA
    redefinition .
protected section.
private section.
endclass. &quot;ZAPLINK_SXCI_DATA definition
class ZAPLINK_SXSD_DATA definition
  inheriting from ZAPLINK_BADI_DATA
  create public
  FRIENDS ZAPLINK_BADI
                 ZAPLINK_EASYXML .
public section.
  type-pools SEEX .
  types:
    BEGIN OF ts_maindata.
  INCLUDE TYPE badi_data AS main.
  TYPES:
      mast_langu  TYPE  sy-langu,
      ext_clname  TYPE  seoclsname,
    END OF ts_maindata .
  data A0_MAINDATA type TS_MAINDATA .
  data INTERFACE type TO_RAW .
  methods CONSTRUCTOR .
  methods FROM_DATA
    redefinition .
  methods TO_DATA
    redefinition .
protected section.
private section.
endclass. &quot;ZAPLINK_SXSD_DATA definition
*---------------------------------------------------------------------*
*  Include           ZAPLINK_MACROS
*---------------------------------------------------------------------*
* Contains macros uses in framework objects
*---------------------------------------------------------------------*
* Macro for raising exception from symsg
DEFINE mac_raise_symsg.
  try.
      o_mycx ?= zaplink_cx=&gt;create_from_symsg( classname = &amp;1 &quot; &apos;ZAPLINK_CX_CONNECTOR&apos;
                                               textid    = &amp;2 ). &quot; zaplink_cx_connector=&gt;system_error
    catch zaplink_cx into o_cx.
      raise exception o_cx.
  endtry.
  raise exception o_mycx.
END-OF-DEFINITION.
* Raise CNX exception : Type not supported
DEFINE mac_raise_type_not_supported.
* Type &apos;&amp;TYPE&amp;&apos; is not supported by this connector &apos;&amp;CONNCLASS&amp;&apos;
  raise exception type zaplink_cx_connector
    exporting
      textid = zaplink_cx_connector=&gt;type_not_supported
      type   = &amp;2
      connclass = &amp;1.
END-OF-DEFINITION.
* Create a ZAPLink Cascade exception
DEFINE mac_cascade_raise.
* Exception &apos;&amp;CX_NAME&amp;&apos; has occured
  create object &amp;1
    exporting
      textid  = zaplink_cx=&gt;system_error
      prev_cx = &amp;2.
  &amp;1-&gt;update( ).
  raise exception &amp;1.
END-OF-DEFINITION.
* Create a Cascade exception
DEFINE mac_cascade_raise_root.
* Exception &apos;&amp;CX_NAME&amp;&apos; has occured
  create object &amp;1
    exporting
      textid   = zaplink_cx=&gt;system_error
      previous = &amp;2.
  &amp;1-&gt;update( ).
  raise exception &amp;1.
END-OF-DEFINITION.
* Create a Cascade exception
DEFINE mac_cascade_raise_root.
* Exception &apos;&amp;CX_NAME&amp;&apos; has occured
  create object &amp;1
    exporting
      textid   = zaplink_cx=&gt;system_error
      previous = &amp;2.
  &amp;1-&gt;update( ).
  raise exception &amp;1.
END-OF-DEFINITION.
* Add application logs if message present
DEFINE mac_add_log.
  if &amp;1 is bound and &amp;2 is bound.             &quot; for security
    if &amp;1-&gt;has_messages_of_msgt( id_msgty = &amp;3 ) = abap_true.
      &amp;2-&gt;add_from_instance( io_msglist = &amp;1
                      if_add_as_subnode = abap_true ).
    endif.
  endif.
END-OF-DEFINITION.
* Create application_log
* &amp;1 Aplication log
* &amp;2 Sub_object
* &amp;3 Ext number
DEFINE mac_create_log.
  if not &amp;1 is bound. create object &amp;1. endif.
  if &amp;1-&gt;get_handle( ) is initial.
    call method &amp;1-&gt;init
      exporting
        id_object      = zaplink_datatypes=&gt;ballog_object
        id_subobject   = &amp;2
        id_extnumber   = &amp;3
        auto_upd_custo = abap_true
        id_activity    = zaplink_message_collector=&gt;actions-create
      exceptions
        error          = 1
        others         = 2.
    if sy-subrc &lt;&gt; 0.
      message id sy-msgid type &apos;I&apos; number sy-msgno with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    endif.
  endif.
END-OF-DEFINITION.
DEFINE mac_add_mf_and_raise.
  o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &amp;1
                                              subrc = &amp;2
                                          classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
  application_log-&gt;add_symsg( ).
  application_log-&gt;add_exception( o_mycx ).
  raise exception o_mycx.
END-OF-DEFINITION.
* Default catch : Catch and raise component exception or cascade any other ZAPLINK exception
DEFINE mac_def_catch.
  catch &amp;1 into o_mycx.
    raise exception o_mycx.
  catch zaplink_cx into o_cx.
    mac_cascade_raise o_mycx o_cx.
END-OF-DEFINITION.
class ZAPLINK_RAW_DATA implementation.
endclass. &quot;ZAPLINK_RAW_DATA implementation
class ZAPLINK_TOOLS implementation.
method CONV_LIMU_2_R3TR.
  DATA _objlist LIKE LINE OF result.
  data w_tadir TYPE tadir.
  FIELD-SYMBOLS &lt;limu&gt; LIKE LINE OF e071.
  LOOP AT e071 ASSIGNING &lt;limu&gt;.
    CLEAR: _objlist.
    IF &lt;limu&gt;-pgmid = &apos;R3TR&apos;.
      _objlist-type = &lt;limu&gt;-object.
      _objlist-name = &lt;limu&gt;-obj_name.
    ELSE.
      CALL FUNCTION &apos;TR_CHECK_TYPE&apos;
        EXPORTING
          wi_e071                              = &lt;limu&gt;
        IMPORTING
          we_tadir                             = w_tadir.
      _objlist-type = w_tadir-object.
      _objlist-name = w_tadir-obj_name.
    ENDIF.
    IF _objlist IS NOT INITIAL. APPEND _objlist TO result. ENDIF.
  ENDLOOP.
  SORT result BY type name.
  DELETE ADJACENT DUPLICATES FROM result COMPARING type name.
endmethod.
METHOD get_keys_from_package.
  result = get_keys_from_tadir( packages = packages   ext = ext ).
ENDMETHOD.
METHOD get_keys_from_tr.
  DATA objlist TYPE tt_e071.
  DATA r_trs   TYPE tr_tr.
  SELECT trkorr trkorr trkorr
      FROM e070
      INTO TABLE r_trs
      WHERE trkorr IN tr.
  SELECT trkorr trkorr trkorr
      FROM e070
      APPENDING TABLE r_trs
      WHERE strkorr IN tr
        AND ( trstatus = &apos;D&apos;    &quot; Modifiable
           OR trstatus = &apos;O&apos;    &quot; Release started
           OR trstatus = &apos;L&apos; ). &quot; Modifiable locked
  SORT r_trs BY low.
  DELETE ADJACENT DUPLICATES FROM r_trs COMPARING low.
  IF NOT r_trs IS INITIAL.
    SELECT *
      FROM  e071
      INTO TABLE objlist
      FOR ALL ENTRIES IN r_trs
      WHERE  trkorr = r_trs-low.
    result = conv_limu_2_r3tr( objlist ).
  ENDIF.
ENDMETHOD.
METHOD get_keys_from_tadir.
  TYPES tt_pack TYPE STANDARD TABLE OF tdevc-devclass.
  DATA r_exclu TYPE tr_packages.
  DATA t_devc  TYPE tt_pack.
  DATA t_level TYPE tt_pack.
  IF packages IS INITIAL.
    CHECK srcsystem IS NOT INITIAL OR type IS NOT INITIAL OR name IS NOT INITIAL OR author IS NOT INITIAL. &quot; to prevent extracting all tadir
    SELECT object obj_name
      INTO TABLE result
      FROM tadir
      WHERE srcsystem IN srcsystem
        AND object IN type
        AND obj_name IN name
        AND author IN author.
    EXIT.
  ENDIF.
  r_exclu = packages.
  DELETE r_exclu WHERE sign &lt;&gt; &apos;E&apos;. &quot; Keep only Devcclass to remove
  SELECT devclass
      FROM tdevc
      INTO TABLE t_devc
      WHERE devclass IN packages.
  IF ext = abap_true.
    t_level = t_devc .
    WHILE NOT t_level[] IS INITIAL.
      SORT t_level.
      DELETE ADJACENT DUPLICATES FROM t_level.
      SELECT devclass
          FROM tdevc
          INTO TABLE t_level
             FOR ALL ENTRIES IN t_level
          WHERE parentcl = t_level-table_line.
      APPEND LINES OF t_level TO t_devc.
    ENDWHILE.
    IF NOT r_exclu IS INITIAL.
      DELETE t_devc WHERE NOT table_line IN r_exclu.
    ENDIF.
  ENDIF.
  SORT t_devc.
  DELETE ADJACENT DUPLICATES FROM t_devc.
  IF NOT t_devc IS INITIAL.
    SELECT object obj_name
      INTO TABLE result
      FROM tadir
        FOR ALL ENTRIES IN t_devc
      WHERE devclass = t_devc-table_line
        AND srcsystem IN srcsystem
        AND object IN type
        AND obj_name IN name
        AND author IN author.
  ENDIF.
ENDMETHOD.
method CONV_ABAP_LINE.
  target = source.
  REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;horizontal_tab IN target WITH ` `.
endmethod.
METHOD calculate_md5_hash.
  DATA _len            TYPE i.
  DATA _md5            TYPE md5_fields-hash.
  _len = STRLEN( string ).
  CALL FUNCTION &apos;MD5_CALCULATE_HASH_FOR_CHAR&apos;
    EXPORTING
      data                 = string
      length               = _len
    IMPORTING
      hash                 = _md5
    EXCEPTIONS
      no_data              = 1
      internal_error       = 2
      OTHERS               = 3.
  IF sy-subrc = 0.    result = _md5.    ENDIF.
ENDMETHOD.
METHOD table_2_string.
  DATA s TYPE string.
  CHECK NOT source IS INITIAL.
  LOOP AT source INTO s.
    CONCATENATE result cl_abap_char_utilities=&gt;newline s INTO result.
  ENDLOOP.
  SHIFT result LEFT BY 1 PLACES.
ENDMETHOD.
method CONDENSE_ABAP_SOURCE.
  FIELD-SYMBOLS &lt;l&gt; type any.
  LOOP AT table ASSIGNING &lt;l&gt;.
    IF &lt;l&gt; IS INITIAL. DELETE table. CONTINUE. ENDIF.  &quot; Condense
    IF &lt;l&gt;(1) = &apos;*&apos;.   DELETE table. CONTINUE. ENDIF.  &quot; Condense
    &lt;l&gt; = conv_abap_line( &lt;l&gt; ).   CONDENSE &lt;l&gt;.
    IF &lt;l&gt;(1) = &apos;&quot;&apos;.   DELETE table. CONTINUE. ENDIF.  &quot; commented line like :     &quot; comment
  ENDLOOP.
endmethod.
method CONV_TABLE_2UPCASE.
  FIELD-SYMBOLS &lt;l&gt; type any.
  LOOP AT table ASSIGNING &lt;l&gt;.    TRANSLATE &lt;l&gt; TO UPPER CASE.  ENDLOOP.    &quot;#EC SYNTCHAR
endmethod.
METHOD clean_abap_string.
  CHECK NOT data IS INITIAL.    result = data.
  REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;newline IN result WITH ``.
  REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;cr_lf IN result WITH ``.
  REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;form_feed IN result WITH ``.
ENDMETHOD.
METHOD inverse_table_order.
  DATA x TYPE i.
  FIELD-SYMBOLS &lt;o&gt; TYPE ANY.
  CHECK NOT my_table IS INITIAL.
  x = LINES( my_table ) + 1.
  LOOP AT my_table ASSIGNING &lt;o&gt;.
    IF sy-tabix &gt;= x.   EXIT.   ENDIF.
    INSERT &lt;o&gt; INTO my_table INDEX x.
  ENDLOOP.
  SUBTRACT 1 FROM x.    CHECK x &gt; 0.   DELETE my_table FROM 1 TO x.
ENDMETHOD.
METHOD pretty_printer.
  FIELD-SYMBOLS &lt;a&gt;   TYPE ANY.
  DATA d_remotedata   TYPE string.
  DATA v_extend_mod   TYPE char255.
  DATA v_komprmode(1) TYPE c VALUE &apos;0&apos;.
  DATA v_edit_control TYPE c.
  DATA v_status_flag  TYPE char255.
  DATA v_convert_mode TYPE rseumod.
  DATA v_source_id    TYPE sy-repid.
  DATA v_overflow_area TYPE char255.
  DATA v_content_fill TYPE sy-index.
  DATA v_msg          TYPE char255.
  DATA v_incl         TYPE char255.
  DATA v_row          TYPE char255.
  DATA v_col          TYPE char255.
  DATA v_wrd(30)      TYPE c.
  DATA v_scanned      TYPE char255.
  DATA t_mod_tab      TYPE smodi_mod_tab.
  DATA t_lineindex    TYPE STANDARD TABLE OF edlineindx.
  DATA t_tk           TYPE sedi_tk.
  DATA t_stm          TYPE STANDARD TABLE OF sstmnt.
  DATA t_dummy        TYPE STANDARD TABLE OF string.
  DEFINE mac_assign.
    d_remotedata = &amp;1.
    assign (d_remotedata) to &lt;a&gt;.
    if sy-subrc = 0. &lt;a&gt; = &amp;2. endif.
  END-OF-DEFINITION.
  CALL FUNCTION &apos;CONVERT_EDITOR_SOURCE&apos;
    EXPORTING
      convert_mode        = v_convert_mode
      source_id           = v_source_id
      extend_mod          = v_extend_mod
      komprmode           = v_komprmode
      edit_control        = v_edit_control
      status_flag         = v_status_flag
    TABLES
      content             = t_dummy
      tk                  = t_tk
      stm                 = t_stm
      lineindex           = t_lineindex
      mod_tab             = t_mod_tab
    CHANGING
      overflow_area       = v_overflow_area
      content_fill        = v_content_fill
      msg                 = v_msg
      incl                = v_incl
      row                 = v_row
      col                 = v_col
      wrd                 = v_wrd
      scanned             = v_scanned.
  IF indent &lt;&gt; abap_true.   v_convert_mode-indent = &apos;0&apos;.    ENDIF.
  mac_assign &apos;(SAPLLOCAL_EDT1)RSEUMOD-STYLE&apos; abap_true.   &quot; Change code to ....
  mac_assign &apos;(SAPLLOCAL_EDT1)RSEUMOD-LOWERCASE&apos; space.   &quot; UPPER CASE
  mac_assign &apos;(SAPLLOCAL_EDT1)EDIT-APP_ABAP&apos; abap_true.   &quot; ABAP Editor
  mac_assign &apos;(SAPLLOCAL_EDT1)EDIT-LINE_SIZE&apos; swbse_c_max_line_width.       &quot; Line Size
  CALL FUNCTION &apos;CONVERT_EDITOR_SOURCE&apos;
    EXPORTING
      convert_mode        = v_convert_mode
      source_id           = v_source_id
      extend_mod          = v_extend_mod
      komprmode           = v_komprmode
      edit_control        = v_edit_control
      status_flag         = v_status_flag
    TABLES
      content             = table
      tk                  = t_tk
      stm                 = t_stm
      lineindex           = t_lineindex
      mod_tab             = t_mod_tab
    CHANGING
      overflow_area       = v_overflow_area
      content_fill        = v_content_fill
      msg                 = v_msg
      incl                = v_incl
      row                 = v_row
      col                 = v_col
      wrd                 = v_wrd
      scanned             = v_scanned.
ENDMETHOD.
endclass. &quot;ZAPLINK_TOOLS implementation
class ZAPLINK_CX implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX .
 ENDIF.
me-&gt;MESSAGES = MESSAGES .
me-&gt;OBJECT = OBJECT .
me-&gt;SUBOBJECT = SUBOBJECT .
me-&gt;PREV_CX = PREV_CX .
me-&gt;EXT_ID = EXT_ID .
me-&gt;CX_NAME = CX_NAME .
me-&gt;_CX_LIST = _CX_LIST .
endmethod.
method CONV_PROGNAME.
  DATA p_wb_request TYPE REF TO cl_wb_request.
  DATA p_ex_request TYPE REF TO cl_wb_request.
  DATA p_wb_source_req_dispatcher TYPE REF TO cl_wb_source_req_dispatcher.
  DATA kind TYPE  seoclsname.
  CREATE OBJECT p_wb_source_req_dispatcher.
  CREATE OBJECT p_wb_request
    EXPORTING
      p_object_type                = &apos;P&apos;
      p_object_name                = object_name
      p_operation                  = &apos;DISPLAY&apos;
    EXCEPTIONS
      illegal_object_type          = 1
      illegal_operation            = 2
      illegal_new_window_parameter = 3
      OTHERS                       = 4.
  IF sy-subrc &lt;&gt; 0.
    source-str = source-name = object_name.
    EXIT.
  ENDIF.
  CALL METHOD p_wb_source_req_dispatcher-&gt;if_wb_decision_class~get_tool_for_request
    EXPORTING
      p_wb_request            = p_wb_request
    IMPORTING
      p_execution_request     = p_ex_request
      p_toolname              = kind
    EXCEPTIONS
      no_tool_found           = 1
      object_not_found        = 2
      operation_not_supported = 3
      OTHERS                  = 4.
  IF sy-subrc &lt;&gt; 0.
    source-str = source-name = object_name.
    EXIT.
  ENDIF.
  IF NOT p_ex_request IS BOUND.
    p_ex_request = p_wb_request.
  ENDIF.
  source-name = p_ex_request-&gt;object_name.
  IF NOT context IS INITIAL.
    REPLACE FIRST OCCURRENCE OF context IN source-name WITH ` `.
    CONDENSE source-name.
  ENDIF.
  SELECT SINGLE singular INTO source-type_txt
    FROM euobjt
    WHERE spras = sy-langu
      AND type = p_ex_request-&gt;object_type.
  IF sy-subrc &lt;&gt; 0.
    SELECT SINGLE singular INTO source-type_txt
      FROM euobjt
      WHERE spras = &apos;E&apos;
        AND type = p_ex_request-&gt;object_type.
    IF sy-subrc &lt;&gt; 0.
      SELECT SINGLE singular INTO source-type_txt
        FROM euobjt
        WHERE type = p_ex_request-&gt;object_type.
    ENDIF.
  ENDIF.
  IF sy-subrc = 0.
    CONCATENATE source-type_txt source-name INTO source-str SEPARATED BY space.
  ELSE.
    source-str = source-name.
  ENDIF.
endmethod.
method GET_SOURCE_POSITION_AS_STRING.
str = source_position_as_string( me ).
endmethod.
method SOURCE_POSITION_AS_STRING.
DATA _pos TYPE ts_source_pos.
  DATA _key TYPE seu_objkey.
  DATA _prog TYPE ts_source_def.
  DATA _include TYPE ts_source_def.
  CALL METHOD exception-&gt;get_source_position
    IMPORTING
      program_name = _pos-program_name
      include_name = _pos-include_name
      source_line  = _pos-source_line.
  _key = _pos-program_name. _prog = conv_progname( _key ).
  _key = _pos-include_name. _include = conv_progname( object_name = _key
                                                          context = _prog-name ).
  MESSAGE i000 WITH _prog-str _include-str _pos-source_line INTO str.
endmethod.
method UPDATE.
  IF messages IS BOUND.
    object = messages-&gt;object.
    subobject = messages-&gt;subobject.
    ext_id = messages-&gt;ext_id.
    messages-&gt;STORE( ).
  ENDIF.
  DATA desc TYPE REF TO cl_abap_objectdescr.
  IF cx_name IS INITIAL AND prev_cx IS BOUND.
    desc ?= cl_abap_objectdescr=&gt;describe_by_object_ref( prev_cx ).
    cx_name = desc-&gt;absolute_name.
  ELSEIF cx_name IS INITIAL AND previous IS BOUND.
    desc ?= cl_abap_objectdescr=&gt;describe_by_object_ref( previous ).
    cx_name = desc-&gt;absolute_name.
  ENDIF.
endmethod.
method WRITE.
  DATA _exceptions TYPE STANDARD TABLE OF string.
  DATA _msg TYPE string.
  DATA _pos TYPE string.
  DATA _cx TYPE REF TO zaplink_cx.
  DATA _order TYPE STANDARD TABLE OF string.
  DATA _offset TYPE string.
  DATA _messages TYPE bapirettab.
  DATA _light TYPE icon_d.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF _exceptions.
  _cx = me.
  WHILE _cx IS BOUND.
    _msg = _cx-&gt;get_text( ).
    _pos = _cx-&gt;get_source_position_as_string( ).
    CONCATENATE _msg _pos INTO _msg SEPARATED BY space.
    APPEND _msg TO _exceptions.
    _cx = _cx-&gt;prev_cx.
  ENDWHILE.
  LOOP AT _exceptions ASSIGNING &lt;e&gt;.
    INSERT &lt;e&gt; INTO _order INDEX 1.
  ENDLOOP.
  FREE _exceptions.
  LOOP AT _order ASSIGNING &lt;e&gt;.
    IF sy-tabix = 1.
      WRITE:/ icon_message_critical_small AS ICON, &lt;e&gt;.
    ELSE.
      CONCATENATE ` ` _offset INTO _offset.
      WRITE:/ _offset, icon_arrow_right AS ICON, &lt;e&gt;.
    ENDIF.
  ENDLOOP.
  IF me-&gt;messages IS BOUND.
    CONCATENATE ` ` _offset INTO _offset.
    messages-&gt;write( _offset ).
  ENDIF.
endmethod.
method CREATE_FROM_MF_CX.
CONSTANTS c_cx_kind TYPE funct-kind VALUE &apos;X&apos;. &quot; Exception
  data _FUNCNAME      TYPE RS38L-NAME.
  DATA lt_ptfdir      TYPE STANDARD TABLE OF tfdir WITH DEFAULT KEY.
  DATA lt_ptftit      TYPE STANDARD TABLE OF tftit WITH DEFAULT KEY.
  DATA lt_pfunct      TYPE STANDARD TABLE OF funct WITH DEFAULT KEY.
  DATA lt_penlfdir    TYPE STANDARD TABLE OF enlfdir WITH DEFAULT KEY.
  DATA lt_ptrdir      TYPE STANDARD TABLE OF trdir WITH DEFAULT KEY.
  DATA lt_pfupararef  TYPE STANDARD TABLE OF sfupararef WITH DEFAULT KEY.
  DATA lt_uincl       TYPE STANDARD TABLE OF abaptxt255 WITH DEFAULT KEY.
  DATA _cx            TYPE REF TO zaplink_cx.
  DATA _subrc         TYPE sy-subrc.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF lt_pfunct,
    &lt;p&gt; LIKE LINE OF lt_pfupararef.
  _FUNCNAME = FUNCNAME.
  TRANSLATE _funcname TO UPPER CASE.      &quot;#EC SYNTCHAR
  result = _CREATE_CX( cx_name = classname
                        textid = textid ).
  CALL FUNCTION &apos;FUNC_GET_OBJECT&apos;
    EXPORTING
      funcname                 = _funcname
    TABLES
      ptfdir                   = lt_ptfdir
      ptftit                   = lt_ptftit
      pfunct                   = lt_pfunct
      penlfdir                 = lt_penlfdir
      ptrdir                   = lt_ptrdir
      pfupararef               = lt_pfupararef
      uincl                    = lt_uincl
    EXCEPTIONS
      function_not_exist       = 1
      version_not_found        = 2
      OTHERS                   = 3.
  IF sy-subrc &lt;&gt; 0.
    _cx = create_from_mf_cx( funcname = &apos;FUNC_GET_OBJECT&apos;
                                subrc = sy-subrc ).
    result-&gt;prev_cx = _cx.
    result-&gt;textid = zaplink_cx=&gt;system_error.
    EXIT.
  ENDIF.
  DELETE lt_pfunct WHERE kind &lt;&gt; c_cx_kind.
  DELETE lt_pfupararef WHERE paramtype &lt;&gt; c_cx_kind.
  READ TABLE lt_pfupararef ASSIGNING &lt;p&gt;
       WITH KEY pposition = subrc.
  IF sy-subrc &lt;&gt; 0.
    _subrc = subrc - 1.
    READ TABLE lt_pfupararef ASSIGNING &lt;p&gt;
         WITH KEY pposition = subrc.
    if sy-subrc = 0.
      result-&gt;cx_name = &apos;OTHERS&apos;.
      exit.
    endif.
  ENDIF.
  IF NOT &lt;p&gt; IS ASSIGNED.
    RAISE EXCEPTION TYPE zaplink_cx
          EXPORTING textid = zaplink_cx=&gt;system_error.
  ENDIF.
  result-&gt;cx_name = &lt;p&gt;-parameter.
  READ TABLE lt_pfunct ASSIGNING &lt;t&gt;
       WITH KEY parameter = &lt;p&gt;-parameter
                    spras = sy-langu.
  IF &lt;t&gt; IS ASSIGNED. IF &lt;t&gt;-stext IS INITIAL.     UNASSIGN &lt;t&gt;.      ENDIF. ENDIF.
  IF NOT &lt;t&gt; IS ASSIGNED.
    READ TABLE lt_pfunct ASSIGNING &lt;t&gt;
         WITH KEY parameter = &lt;p&gt;-parameter
                      spras = &apos;E&apos;.
    IF &lt;t&gt; IS ASSIGNED. IF &lt;t&gt;-stext IS INITIAL.     UNASSIGN &lt;t&gt;.      ENDIF. ENDIF.
  ENDIF.
  IF NOT &lt;t&gt; IS ASSIGNED.
    READ TABLE lt_pfunct ASSIGNING &lt;t&gt;
         WITH KEY parameter = &lt;p&gt;-parameter.
    IF &lt;t&gt; IS ASSIGNED. IF &lt;t&gt;-stext IS INITIAL.     UNASSIGN &lt;t&gt;.      ENDIF. ENDIF.
  ENDIF.
  IF &lt;t&gt; IS ASSIGNED.
    CONCATENATE result-&gt;cx_name &apos;(&apos; &lt;t&gt;-stext &apos;)&apos; INTO result-&gt;cx_name.
  ENDIF.
endmethod.
METHOD class_constructor.
  DATA _exceptions TYPE REF TO CL_OO_CLASS_RELATIONS.
  DATA s_list      LIKE LINE OF _cx_list.
  DATA t_list      LIKE STANDARD TABLE OF s_list.
  FIELD-SYMBOLS:
    &lt;s_cl&gt; LIKE LINE OF _exceptions-&gt;subclasses.
  CLEAR _cx_list.
  CREATE OBJECT _exceptions
    EXPORTING
      clsname      = &apos;ZAPLINK_CX&apos;
     EXCEPTIONS
       is_interface = 1
       not_existing = 0  &quot; For installer ignore not existing class
       others       = 3.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
               WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.
  check _exceptions is bound.
  LOOP AT _exceptions-&gt;subclasses ASSIGNING &lt;s_cl&gt;
          WHERE state &lt;&gt; &apos;0&apos;      &quot; Only modeled
            AND version = &apos;1&apos;     &quot; Active
            .
    CLEAR s_list. s_list-class = &lt;s_cl&gt;-clsname. APPEND s_list TO t_list.
  ENDLOOP.
  SORT t_list BY class.
  DELETE ADJACENT DUPLICATES FROM t_list.
  _cx_list = t_list.
ENDMETHOD.
METHOD create_from_symsg.
  result = _create_cx( cx_name = classname
                        textid = textid ).
  MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
             WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4 INTO result-&gt;cx_name.
ENDMETHOD.
METHOD CREATE_FROM_APPLICATION_LOG.
  result = _CREATE_CX( cx_name = cx_name
                        textid = textid ).
  result-&gt;messages = message_collector.
  result-&gt;prev_cx = prev_cx.
  result-&gt;update( ).
ENDMETHOD.
METHOD _create_cx.
  DATA f_exists TYPE abap_bool.
  IF NOT cx_name IS INITIAL.
    READ TABLE _cx_list TRANSPORTING NO FIELDS
         WITH TABLE KEY class = cx_name.
    IF sy-subrc = 0.
      f_exists = abap_true.
    ELSE.
      f_exists = abap_false.
    ENDIF.
    TRY.
        CREATE OBJECT result type (cx_name)
          EXPORTING
            textid = textid.
      CATCH cx_root INTO o_cx.
        IF f_exists = abap_true.
          mac_cascade_raise_root o_mycx o_cx.
        ENDIF.
    ENDTRY.
  ENDIF.
  IF result IS NOT BOUND.
    CREATE OBJECT result
      EXPORTING
        textid = textid.
  ENDIF.
ENDMETHOD.
endclass. &quot;ZAPLINK_CX implementation
class ZAPLINK_DEVC_DATA implementation.
endclass. &quot;ZAPLINK_DEVC_DATA implementation
class ZAPLINK_DOCV_DATA implementation.
METHOD FROM_DATA.
  DATA s_text LIKE LINE OF texts.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF fm_data-texts.
  a0_maindata = fm_data-hdr.    a0_maindata-masterlang = a0_maindata-langu.   CLEAR a0_maindata-langu.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.   s_text-langu = &lt;t&gt;-tdspras.   s_text-_ = &lt;t&gt;-_.   INSERT s_text INTO TABLE texts.
  ENDLOOP.
ENDMETHOD.
METHOD TO_DATA.
  DATA s_text LIKE LINE OF fm_data-texts.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.
  fm_data-hdr = a0_maindata.    fm_data-hdr-langu = a0_maindata-masterlang. fm_data-hdr-masterlang = abap_true.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.   s_text-tdspras = &lt;t&gt;-langu.   s_text-_ = &lt;t&gt;-_.   INSERT s_text INTO TABLE fm_data-texts.
  ENDLOOP.
ENDMETHOD.
endclass. &quot;ZAPLINK_DOCV_DATA implementation
class ZAPLINK_DOMA_DATA implementation.
METHOD from_data.
  DATA s_value LIKE LINE OF values.
  DATA s_vtext LIKE LINE OF s_value-texts.
  DATA s_text  LIKE LINE OF texts.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;vt&gt; LIKE LINE OF fm_data-values_texts,
    &lt;t&gt; LIKE LINE OF fm_data-texts,
    &lt;v&gt; LIKE LINE OF fm_data-values.
  a0_maindata-hdr = fm_data-header.
  LOOP AT fm_data-values ASSIGNING &lt;v&gt;.
    CLEAR s_value. s_value-main = &lt;v&gt;. CLEAR s_value-domname.
    LOOP AT fm_data-values_texts ASSIGNING &lt;vt&gt;
      WHERE valpos = &lt;v&gt;-valpos.
      CLEAR s_vtext.
      s_vtext-langu = &lt;vt&gt;-ddlanguage.
      s_vtext-short_txt = &lt;vt&gt;-ddtext.
      INSERT s_vtext INTO TABLE s_value-texts.
    ENDLOOP.
    INSERT s_value INTO TABLE values.
  ENDLOOP.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-langu = &lt;t&gt;-ddlanguage.
    s_text-short_txt = &lt;t&gt;-ddtext.
    READ TABLE fm_data-docs ASSIGNING &lt;d&gt;
         WITH KEY id = doc_ids-header
              object = a0_maindata-domname.
    IF sy-subrc = 0.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.
        s_text-long_txt = &lt;dt&gt;.
        CLEAR s_text-long_txt-tdspras.
      ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_value LIKE LINE OF fm_data-values.
  DATA s_vtext LIKE LINE OF fm_data-values_texts.
  DATA s_text  LIKE LINE OF fm_data-texts.
  DATA s_doc   LIKE LINE OF fm_data-docs.
  DATA s_dtxt  LIKE LINE OF s_doc-texts.
  FIELD-SYMBOLS:
    &lt;v&gt; LIKE LINE OF values,
    &lt;t&gt; LIKE LINE OF texts,
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;vt&gt; LIKE LINE OF &lt;v&gt;-texts.
  fm_data-header = a0_maindata-hdr.
  LOOP AT values ASSIGNING &lt;v&gt;.
    CLEAR s_value. s_value = &lt;v&gt;-main. s_value-domname = fm_data-header-domname.
    INSERT s_value INTO TABLE fm_data-values.
    LOOP AT &lt;v&gt;-texts ASSIGNING &lt;vt&gt;.
      CLEAR s_vtext.
      MOVE-CORRESPONDING &lt;v&gt; TO s_vtext.
      s_vtext-domname = fm_data-header-domname.
      s_vtext-ddlanguage = &lt;vt&gt;-langu.
      s_vtext-as4local = &apos;A&apos;. &quot; Active
      s_vtext-valpos = &lt;v&gt;-valpos.
      s_vtext-as4vers = &apos;0000&apos;. &quot; Active
      s_vtext-ddtext = &lt;vt&gt;-short_txt.
      INSERT s_vtext INTO TABLE fm_data-values_texts.
    ENDLOOP.
  ENDLOOP.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-domname = fm_data-header-domname.
    s_text-ddlanguage = &lt;t&gt;-langu.
    s_text-as4local = &apos;A&apos;. &quot; Active
    s_text-as4vers = &apos;0000&apos;. &quot; Active
    s_text-ddtext = &lt;t&gt;-short_txt.
    INSERT s_text INTO TABLE fm_data-texts.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      IF fm_data-docs IS INITIAL.
        CLEAR s_doc.
        s_doc-application = &apos;DOKU&apos;.
        s_doc-id = doc_ids-header.
        s_doc-object = fm_data-header-domname.
        s_doc-langu = &lt;t&gt;-langu.
        s_doc-masterlang = abap_true.
        s_doc-typ = &apos;T&apos;.
        s_doc-dokform = &apos;S_DOCU_SHOW&apos;.
        s_doc-dokstyle = &apos;S_DOCUS1&apos;.
        INSERT s_doc INTO TABLE fm_data-docs.
      ENDIF.
      s_dtxt = &lt;t&gt;-long_txt.
      s_dtxt-tdspras = &lt;t&gt;-langu.
      INSERT s_dtxt INTO TABLE s_doc-texts.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD class_constructor.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
method ANONYMIZE.
  FIELD-SYMBOLS:
    &lt;t&gt; like LINE OF texts.
  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME.
  loop at texts ASSIGNING &lt;t&gt;.
    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.
  endloop.
endmethod.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_DOMA_DATA implementation
class ZAPLINK_DTEL_DATA implementation.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD FROM_DATA.
  DATA s_text  LIKE LINE OF texts.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt; LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.
  a0_maindata-param = fm_data-param.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-langu = &lt;t&gt;-ddlanguage.
    s_text-short_txt = &lt;t&gt;-ddtext.
    READ TABLE fm_data-docs ASSIGNING &lt;d&gt;
         WITH KEY id = doc_ids-header
              object = a0_maindata-rollname.
    IF sy-subrc = 0.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.
        s_text-long_txt = &lt;dt&gt;.
        CLEAR s_text-long_txt-tdspras.
      ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_text  LIKE LINE OF fm_data-texts.
  DATA s_doc   LIKE LINE OF fm_data-docs.
  DATA s_dtxt  LIKE LINE OF s_doc-texts.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;t&gt; LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-rollname = fm_data-header-rollname.
    s_text-ddlanguage = &lt;t&gt;-langu.
    s_text-as4local = &apos;A&apos;. &quot; Active
    s_text-as4vers = &apos;0000&apos;. &quot; Active
    s_text-ddtext = &lt;t&gt;-short_txt.
    INSERT s_text INTO TABLE fm_data-texts.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      IF fm_data-docs IS INITIAL.
        s_doc-application = &apos;DOKU&apos;.
        s_doc-id = doc_ids-header.
        s_doc-object = fm_data-header-rollname.
        s_doc-langu = &lt;t&gt;-langu.
        s_doc-masterlang = abap_true.
        s_doc-typ = &apos;T&apos;.
        s_doc-dokform = &apos;S_DOCU_SHOW&apos;.
        s_doc-dokstyle = &apos;S_DOCUS1&apos;.
        INSERT s_doc INTO TABLE fm_data-docs.
      ENDIF.
      READ TABLE fm_data-docs ASSIGNING &lt;d&gt; INDEX 1.
      s_dtxt = &lt;t&gt;-long_txt.
      s_dtxt-tdspras = &lt;t&gt;-langu.
      INSERT s_dtxt INTO TABLE &lt;d&gt;-texts.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
method ANONYMIZE.
  FIELD-SYMBOLS:
    &lt;t&gt; like LINE OF texts.
  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME.
  loop at texts ASSIGNING &lt;t&gt;.
    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.
  endloop.
endmethod.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_DTEL_DATA implementation
class ZAPLINK_ENQU_DATA implementation.
method ANONYMIZE.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA s_text    LIKE LINE OF texts.
  DATA s_field   LIKE LINE OF fields.
  DATA s_table   LIKE LINE OF tables.
  DATA t_docs    TYPE tt_docs.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;f&gt;  LIKE LINE OF fm_data-fields,
    &lt;ta&gt; LIKE LINE OF fm_data-tables,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.   CLEAR a0_maindata-ddtext.
  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-header
            object = a0_maindata-viewname.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;
          WHERE viewname = a0_maindata-viewname.
    CLEAR s_text.   s_text-langu = &lt;t&gt;-ddlanguage.    s_text-short_txt = &lt;t&gt;-ddtext.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.    s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_text.    s_text-langu = &lt;dt&gt;-tdspras.   s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    INSERT s_text INTO TABLE texts.
    ENDLOOP.
  ENDIF.
  LOOP AT fm_data-tables ASSIGNING &lt;ta&gt;
          WHERE viewname = a0_maindata-viewname.
    CLEAR s_table.   s_table = &lt;ta&gt;.   CLEAR: s_table-viewname, s_table-ddlanguage, s_table-fordir. &quot;, s_table-forfield.
    IF s_table-tabpos = &apos;0001&apos;.  CLEAR s_table-fortabname.  ENDIF.    &quot; Primary Table
    INSERT s_table INTO TABLE tables.
  ENDLOOP.
  LOOP AT fm_data-fields ASSIGNING &lt;f&gt;
          WHERE viewname = a0_maindata-viewname.
    CLEAR s_field.   MOVE-CORRESPONDING &lt;f&gt; TO s_field.   CLEAR: s_field-keyflag, s_field-rollnamevi, s_field-rollname, s_field-rollchange, s_field-datatype, s_field-flength, s_field-rdonly, s_field-ddtext.
    INSERT s_field INTO TABLE fields.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_txt      LIKE LINE OF fm_data-texts.
  DATA s_doc      LIKE LINE OF fm_data-docs.
  DATA s_doc_txt  LIKE LINE OF s_doc-texts.
  DATA s_field    LIKE LINE OF fm_data-fields.
  DATA s_table    LIKE LINE OF fm_data-tables.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;f&gt;  LIKE LINE OF fields,
    &lt;ta&gt; LIKE LINE OF tables,
    &lt;t&gt;  LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-header.   s_doc-object = fm_data-header-viewname.
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-viewname = fm_data-header-viewname.   s_txt-ddlanguage = &lt;t&gt;-langu.   s_txt-ddtext = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
  LOOP AT tables ASSIGNING &lt;ta&gt;.
    CLEAR s_table.   s_table = &lt;ta&gt;.   s_table-viewname = a0_maindata-viewname.
    IF s_table-tabpos = &apos;0001&apos;.  s_table-fortabname = s_table-tabname.  ENDIF.    &quot; Primary Table
    INSERT s_table INTO TABLE fm_data-tables.
  ENDLOOP.
  LOOP AT fields ASSIGNING &lt;f&gt;.
    CLEAR s_field.   s_field-objpos = sy-tabix.   MOVE-CORRESPONDING &lt;f&gt; TO s_field.   s_field-keyflag = abap_true.    s_field-viewname = a0_maindata-viewname.
    INSERT s_field INTO TABLE fm_data-fields.
  ENDLOOP.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_ENQU_DATA implementation
class ZAPLINK_EXCC_DATA implementation.
endclass. &quot;ZAPLINK_EXCC_DATA implementation
class ZAPLINK_FUGR_DATA implementation.
method ANONYMIZE.
endmethod.
METHOD from_data.
  DATA s_func    LIKE LINE OF functions.
  DATA s_txt     LIKE LINE OF a0_maindata-texts.
  DATA s_f_txt   LIKE LINE OF s_func-texts.
  DATA s_param   LIKE LINE OF s_func-parameters.
  DATA s_excep   LIKE LINE OF s_func-exceptions.
  DATA d_suffix  TYPE rs38l-suffix.
  DATA d_group   TYPE rs38l-area.
  DATA s_inc     LIKE LINE OF includes.
  DATA t_abapsrc TYPE tt_abaprawsource.
  DATA d_search  TYPE string.
  DATA d_replace TYPE string.
  DATA d_lcount  TYPE i.
  DATA d_doc     TYPE doku_obj.
  DATA d_doc_p   TYPE ts_doc_param.
  DATA t_docs    TYPE tt_docs.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt;  LIKE LINE OF fm_data-texts,
    &lt;ft&gt; LIKE LINE OF fm_data-function_texts,
    &lt;f&gt;  LIKE LINE OF fm_data-functions,
    &lt;i&gt;  LIKE LINE OF fm_data-includes,
    &lt;s&gt;  LIKE LINE OF &lt;i&gt;-source,
    &lt;im&gt; LIKE LINE OF &lt;f&gt;-import_p,
    &lt;ch&gt; LIKE LINE OF &lt;f&gt;-changing_p,
    &lt;ex&gt; LIKE LINE OF &lt;f&gt;-export_p,
    &lt;pa&gt; LIKE LINE OF s_func-parameters,
    &lt;pt&gt; LIKE LINE OF fm_data-param_texts,
    &lt;cx&gt; LIKE LINE OF &lt;f&gt;-exceptions,
    &lt;ta&gt; LIKE LINE OF &lt;f&gt;-tables.
  a0_maindata-hdr = fm_data-header.
  textspool = fm_data-textspool.
  dynpros = fm_data-dynpros.
  menupainter = fm_data-menupainter.
  d_doc = zaplink_function_group=&gt;get_mainprogram( fm_data-header-area ).
  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-group
            object = d_doc.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_txt.    s_txt-langu = &lt;t&gt;-spras.   s_txt-short_txt = &lt;t&gt;-areat.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_txt-langu.
      IF sy-subrc = 0.    s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_txt INTO TABLE a0_maindata-texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_txt.    s_txt-langu = &lt;dt&gt;-tdspras.   s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    INSERT s_txt INTO TABLE a0_maindata-texts.
    ENDLOOP.
  ENDIF.
  LOOP AT fm_data-includes ASSIGNING &lt;i&gt;.
    CLEAR s_inc.    s_inc-name = &lt;i&gt;-name.            t_abapsrc = &lt;i&gt;-source.
    CALL FUNCTION &apos;FUNCTION_INCLUDE_SPLIT&apos;
      IMPORTING
        group                              = d_group
        suffix                             = d_suffix
      CHANGING
        include                            = s_inc-name
      EXCEPTIONS
        include_not_exists                 = 1
        group_not_exists                   = 2
        no_selections                      = 3
        no_function_include                = 4
        no_function_pool                   = 5
        delimiter_wrong_position           = 6
        no_customer_function_group         = 7
        no_customer_function_include       = 8
        reserved_name_customer             = 9
        namespace_too_long                 = 10
        area_length_error                  = 11
        OTHERS                             = 12.
    IF sy-subrc = 0 AND d_group = a0_maindata-area.
      s_inc-name = d_suffix.
      IF s_inc-name = suffixes-top AND NOT &lt;i&gt;-source IS INITIAL.
        READ TABLE t_abapsrc ASSIGNING &lt;s&gt; INDEX 1.
        TRANSLATE &lt;s&gt; TO UPPER CASE.                      &quot;#EC SYNTCHAR
        IF &lt;s&gt; CP &apos;FUNCTION-POOL *&apos;.
          CONCATENATE space a0_maindata-area space INTO d_search.   TRANSLATE d_search TO UPPER CASE.
          CONCATENATE space markups-area space INTO d_replace.
          REPLACE FIRST OCCURRENCE OF d_search IN &lt;s&gt; WITH d_replace.
        ENDIF.
      ENDIF.
    ENDIF.
    s_inc-source-_ = zaplink_function_group=&gt;conv_abap_raw2source( t_abapsrc ).
    INSERT s_inc INTO TABLE includes.
  ENDLOOP.
  LOOP AT fm_data-functions ASSIGNING &lt;f&gt;.
    CLEAR s_func.   MOVE-CORRESPONDING &lt;f&gt;-header TO s_func.
    IF NOT &lt;f&gt;-source IS INITIAL.
      t_abapsrc = &lt;f&gt;-source.
      READ TABLE t_abapsrc ASSIGNING &lt;s&gt; INDEX 1.
      TRANSLATE &lt;s&gt; TO UPPER CASE.                        &quot;#EC SYNTCHAR
      IF &lt;s&gt; CP &apos;FUNCTION *.&apos;.    DELETE t_abapsrc INDEX 1.   ENDIF.
      d_lcount = LINES( t_abapsrc ).
      READ TABLE t_abapsrc ASSIGNING &lt;s&gt; INDEX d_lcount.
      TRANSLATE &lt;s&gt; TO UPPER CASE.                        &quot;#EC SYNTCHAR
      IF &lt;s&gt; CP &apos;ENDFUNCTION*.&apos;.    DELETE t_abapsrc INDEX d_lcount.   ENDIF.
      s_func-source-_ = zaplink_function_group=&gt;conv_abap_raw2source( t_abapsrc ).
    ENDIF.
    UNASSIGN &lt;d&gt;.
    READ TABLE t_docs ASSIGNING &lt;d&gt;
         WITH KEY id = doc_ids-function
              object = s_func-name.
    LOOP AT fm_data-function_texts ASSIGNING &lt;ft&gt;
            WHERE funcname = s_func-name.
      CLEAR s_f_txt.    s_f_txt-langu = &lt;ft&gt;-spras.   s_f_txt-short_txt = &lt;ft&gt;-stext.
      IF &lt;d&gt; IS ASSIGNED.
        READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
            WITH KEY tdspras = s_f_txt-langu.
        IF sy-subrc = 0.    s_f_txt-long_txt = &lt;dt&gt;.   CLEAR s_f_txt-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.   ENDIF.
      ENDIF.
      INSERT s_f_txt INTO TABLE s_func-texts.
    ENDLOOP.
    IF &lt;d&gt; IS ASSIGNED.
      LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
        CLEAR s_f_txt.    s_f_txt-langu = &lt;dt&gt;-tdspras.   s_f_txt-long_txt = &lt;dt&gt;.   CLEAR s_f_txt-long_txt-tdspras.    INSERT s_f_txt INTO TABLE s_func-texts.
      ENDLOOP.
    ENDIF.
    LOOP AT &lt;f&gt;-import_p ASSIGNING &lt;im&gt;.
      CLEAR s_param.    s_param-hdr = &lt;im&gt;.    s_param-kind = parameter_kinds-importing.   INSERT s_param INTO TABLE s_func-parameters.
    ENDLOOP.
    LOOP AT &lt;f&gt;-changing_p ASSIGNING &lt;ch&gt;.
      CLEAR s_param.    s_param-hdr = &lt;ch&gt;.    s_param-kind = parameter_kinds-changing.   INSERT s_param INTO TABLE s_func-parameters.
    ENDLOOP.
    LOOP AT &lt;f&gt;-export_p ASSIGNING &lt;ex&gt;.
      CLEAR s_param.    MOVE-CORRESPONDING &lt;ex&gt; TO s_param-hdr.    s_param-kind = parameter_kinds-exporting.   INSERT s_param INTO TABLE s_func-parameters.
    ENDLOOP.
    LOOP AT &lt;f&gt;-tables ASSIGNING &lt;ta&gt;.
      CLEAR s_param.    MOVE-CORRESPONDING &lt;ta&gt; TO s_param-hdr.    s_param-dbfield = &lt;ta&gt;-dbstruct.   s_param-kind = parameter_kinds-table.   INSERT s_param INTO TABLE s_func-parameters.
    ENDLOOP.
    d_doc_p-func = s_func-name.
    LOOP AT s_func-parameters ASSIGNING &lt;pa&gt;.
      d_doc_p-param = &lt;pa&gt;-parameter.   UNASSIGN &lt;d&gt;.
      READ TABLE t_docs ASSIGNING &lt;d&gt;
           WITH KEY id = doc_ids-function
                object = d_doc_p.
      LOOP AT fm_data-param_texts ASSIGNING &lt;pt&gt;
           WHERE funcname = s_func-name
             AND parameter = &lt;pa&gt;-parameter
             AND kind = &apos;P&apos;.
        CLEAR s_f_txt.    s_f_txt-langu = &lt;pt&gt;-spras.   s_f_txt-short_txt = &lt;pt&gt;-stext.
        IF &lt;d&gt; IS ASSIGNED.
          READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
              WITH KEY tdspras = s_f_txt-langu.
          IF sy-subrc = 0.    s_f_txt-long_txt = &lt;dt&gt;.   CLEAR s_f_txt-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.   ENDIF.
        ENDIF.
        INSERT s_f_txt INTO TABLE &lt;pa&gt;-texts.
      ENDLOOP.
      IF &lt;d&gt; IS ASSIGNED.
        LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
          CLEAR s_f_txt.    s_f_txt-langu = &lt;dt&gt;-tdspras.   s_f_txt-long_txt = &lt;dt&gt;.   CLEAR s_f_txt-long_txt-tdspras.    INSERT s_f_txt INTO TABLE &lt;pa&gt;-texts.
        ENDLOOP.
      ENDIF.
    ENDLOOP.
    LOOP AT &lt;f&gt;-exceptions ASSIGNING &lt;cx&gt;.
      CLEAR s_excep.    s_excep-hdr = &lt;cx&gt;.
      LOOP AT fm_data-param_texts ASSIGNING &lt;pt&gt;
           WHERE funcname = s_func-name
             AND parameter = &lt;cx&gt;-exception
             AND kind = &apos;X&apos;.
        CLEAR s_f_txt.    s_f_txt-langu = &lt;pt&gt;-spras.   s_f_txt-short_txt = &lt;pt&gt;-stext.    INSERT s_f_txt INTO TABLE s_excep-texts.
      ENDLOOP.
      INSERT s_excep INTO TABLE s_func-exceptions.
    ENDLOOP.
    INSERT s_func INTO TABLE functions.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_func    LIKE LINE OF fm_data-functions.
  DATA s_line    LIKE LINE OF s_func-source.
  DATA s_txt     LIKE LINE OF fm_data-texts.
  DATA s_f_txt   LIKE LINE OF fm_data-function_texts.
  DATA s_p_im    LIKE LINE OF s_func-import_p.
  DATA s_p_ch    LIKE LINE OF s_func-changing_p.
  DATA s_p_ex    LIKE LINE OF s_func-export_p.
  DATA s_p_ta    LIKE LINE OF s_func-tables.
  DATA s_p_txt   LIKE LINE OF fm_data-param_texts.
  DATA s_excep   LIKE LINE OF s_func-exceptions.
  DATA d_suffix  TYPE rs38l-suffix.
  DATA d_group   TYPE rs38l-area.
  DATA s_inc     LIKE LINE OF fm_data-includes.
  DATA d_search  TYPE string.
  DATA d_replace TYPE string.
  DATA d_lcount  TYPE i.
  DATA s_doc     LIKE LINE OF fm_data-docs.
  DATA s_doc_txt LIKE LINE OF s_doc-texts.
  DATA d_doc_p   TYPE ts_doc_param.
  FIELD-SYMBOLS:
    &lt;t&gt;  LIKE LINE OF a0_maindata-texts,
    &lt;i&gt;  LIKE LINE OF includes,
    &lt;f&gt;  LIKE LINE OF functions,
    &lt;ft&gt; LIKE LINE OF &lt;f&gt;-texts,
    &lt;s&gt;  LIKE LINE OF s_inc-source,
    &lt;pa&gt; LIKE LINE OF &lt;f&gt;-parameters,
    &lt;pt&gt; LIKE LINE OF &lt;pa&gt;-texts,
    &lt;cx&gt; LIKE LINE OF &lt;f&gt;-exceptions.
  fm_data-header = a0_maindata-hdr.
  fm_data-textspool = textspool.
  fm_data-dynpros = dynpros.
  fm_data-menupainter = menupainter.
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-group.   s_doc-object = zaplink_function_group=&gt;get_mainprogram( fm_data-header-area ).
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT a0_maindata-texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-spras = &lt;t&gt;-langu.   s_txt-areat = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
  LOOP AT includes ASSIGNING &lt;i&gt;.
    CLEAR s_inc.   d_suffix = s_inc-name = &lt;i&gt;-name.
    s_inc-source = zaplink_function_group=&gt;conv_abap_source2raw( &lt;i&gt;-source-_ ).
    IF d_suffix = s_inc-name.   &quot; include has been truncated
      CONCATENATE &apos;L&apos; a0_maindata-area d_suffix INTO s_inc-name.
      CALL FUNCTION &apos;FUNCTION_INCLUDE_SPLIT&apos;
        IMPORTING
          group                              = d_group
          suffix                             = d_suffix
        CHANGING
          include                            = s_inc-name
        EXCEPTIONS
          include_not_exists                 = 1
          group_not_exists                   = 2
          no_selections                      = 3
          no_function_include                = 4
          no_function_pool                   = 5
          delimiter_wrong_position           = 6
          no_customer_function_group         = 7
          no_customer_function_include       = 8
          reserved_name_customer             = 9
          namespace_too_long                 = 10
          area_length_error                  = 11
          OTHERS                             = 12.
      IF sy-subrc &lt;&gt; 0.
        MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
                WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
      ENDIF.
      IF d_group &lt;&gt; a0_maindata-area.   CONTINUE.   ENDIF.    &quot; Internal error
      IF d_suffix = suffixes-top AND NOT s_inc-source IS INITIAL.
        READ TABLE s_inc-source ASSIGNING &lt;s&gt; INDEX 1.
        TRANSLATE &lt;s&gt; TO UPPER CASE.                      &quot;#EC SYNTCHAR
        IF &lt;s&gt; CP &apos;FUNCTION-POOL *&apos;.
          CONCATENATE space markups-area space INTO d_search.   TRANSLATE d_search TO UPPER CASE.
          CONCATENATE space a0_maindata-area space INTO d_replace.
          REPLACE FIRST OCCURRENCE OF d_search IN &lt;s&gt; WITH d_replace.
        ENDIF.
      ENDIF.
    ENDIF.
    INSERT s_inc INTO TABLE fm_data-includes.
  ENDLOOP.
  LOOP AT functions ASSIGNING &lt;f&gt;.
    CLEAR s_func.   MOVE-CORRESPONDING &lt;f&gt; TO s_func-header.
    IF NOT &lt;f&gt;-source-_ IS INITIAL.
      s_func-source = zaplink_function_group=&gt;conv_abap_source2raw( &lt;f&gt;-source-_ ).
      READ TABLE s_func-source ASSIGNING &lt;s&gt; INDEX 1.   TRANSLATE &lt;s&gt; TO UPPER CASE. &quot;#EC SYNTCHAR
      IF NOT &lt;s&gt; CP &apos;FUNCTION *.&apos;.    CONCATENATE `FUNCTION ` &lt;f&gt;-name &apos;.&apos; INTO s_line.   INSERT s_line INTO s_func-source INDEX 1.   ENDIF.
      d_lcount = LINES( s_func-source ).    READ TABLE s_func-source ASSIGNING &lt;s&gt; INDEX d_lcount.    TRANSLATE &lt;s&gt; TO UPPER CASE. &quot;#EC SYNTCHAR
      IF NOT &lt;s&gt; CP &apos;ENDFUNCTION*.&apos;.    APPEND &apos;ENDFUNCTION.&apos; TO s_func-source.   ENDIF.
    ENDIF.
    CLEAR s_doc.    s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-function.   s_doc-object = &lt;f&gt;-name.
    s_doc-masterlang = abap_true.   s_doc-typ = &apos;T&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
    LOOP AT &lt;f&gt;-texts ASSIGNING &lt;ft&gt;.
      IF NOT &lt;ft&gt;-short_txt IS INITIAL.    CLEAR s_f_txt.    s_f_txt-spras = &lt;ft&gt;-langu.   s_f_txt-stext = &lt;ft&gt;-short_txt.   s_f_txt-funcname = &lt;f&gt;-name.   INSERT s_f_txt INTO TABLE fm_data-function_texts.    ENDIF.
      IF NOT &lt;ft&gt;-long_txt IS INITIAL.
        CLEAR s_doc_txt.    s_doc_txt = &lt;ft&gt;-long_txt.   s_doc_txt-tdspras = &lt;ft&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
        IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
      ENDIF.
    ENDLOOP.
    IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
    LOOP AT &lt;f&gt;-parameters ASSIGNING &lt;pa&gt;.
      CASE &lt;pa&gt;-kind.
        WHEN parameter_kinds-importing.
          CLEAR s_p_im.   s_p_im = &lt;pa&gt;-hdr.    INSERT s_p_im INTO TABLE s_func-import_p.
        WHEN parameter_kinds-changing.
          CLEAR s_p_ch.   s_p_ch = &lt;pa&gt;-hdr.    INSERT s_p_ch INTO TABLE s_func-changing_p.
        WHEN parameter_kinds-exporting.
          CLEAR s_p_ex.   MOVE-CORRESPONDING &lt;pa&gt;-hdr TO s_p_ex.    INSERT s_p_ex INTO TABLE s_func-export_p.
        WHEN parameter_kinds-table.
          CLEAR s_p_ta.   MOVE-CORRESPONDING &lt;pa&gt;-hdr TO s_p_ta.    s_p_ta-dbstruct = &lt;pa&gt;-dbfield.    INSERT s_p_ta INTO TABLE s_func-tables.
        WHEN OTHERS.
      ENDCASE.
      CLEAR: d_doc_p, s_doc.    d_doc_p-func = &lt;f&gt;-name.    d_doc_p-param = &lt;pa&gt;-parameter.    s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-function.
      s_doc-object = d_doc_p.   s_doc-masterlang = abap_true.   s_doc-typ = &apos;T&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
      LOOP AT &lt;pa&gt;-texts ASSIGNING &lt;pt&gt;.
        IF NOT &lt;pt&gt;-short_txt IS INITIAL.
          CLEAR s_p_txt. s_p_txt-spras = &lt;pt&gt;-langu. s_f_txt-stext = &lt;pt&gt;-short_txt. s_p_txt-funcname = &lt;f&gt;-name. s_p_txt-parameter = &lt;pa&gt;-parameter. s_p_txt-kind = &apos;P&apos;. INSERT s_p_txt INTO TABLE fm_data-param_texts.
        ENDIF.
        IF NOT &lt;pt&gt;-long_txt IS INITIAL.
          CLEAR s_doc_txt.    s_doc_txt = &lt;pt&gt;-long_txt.   s_doc_txt-tdspras = &lt;pt&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
          IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
        ENDIF.
      ENDLOOP.
      IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
    ENDLOOP.
    LOOP AT &lt;f&gt;-exceptions ASSIGNING &lt;cx&gt;.
      CLEAR s_excep.    s_excep = &lt;cx&gt;-hdr.
      LOOP AT &lt;cx&gt;-texts ASSIGNING &lt;pt&gt;.
        CLEAR s_p_txt.    s_p_txt-spras = &lt;pt&gt;-langu.   s_f_txt-stext = &lt;pt&gt;-short_txt.   s_p_txt-funcname = &lt;f&gt;-name.    s_p_txt-parameter = &lt;cx&gt;-exception.   s_p_txt-kind = &apos;X&apos;.    INSERT s_p_txt INTO TABLE fm_data-param_texts.
      ENDLOOP.
      INSERT s_excep INTO TABLE s_func-exceptions.
    ENDLOOP.
    INSERT s_func INTO TABLE fm_data-functions.
  ENDLOOP.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids-group.
  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-group.      APPEND _id TO r_doc_ids-group.
  _id-low = doc_ids-function.   APPEND _id TO r_doc_ids-function.
endmethod.
endclass. &quot;ZAPLINK_FUGR_DATA implementation
class ZAPLINK_MENUPAINTER_DATA implementation.
method ANONYMIZE.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA t_tmp   TYPE tt_atrt.
  DATA t_attr  TYPE SORTED TABLE OF rsmpe_atrt WITH UNIQUE KEY obj_code sub_code obj_type.
  DATA s_attr  LIKE LINE OF t_attr.
  DATA t_tmp_m TYPE tt_mnlt.
  DATA t_menus TYPE SORTED TABLE OF rsmpe_mnlt WITH UNIQUE KEY code.
  DATA s_mnu   LIKE LINE OF t_menus.
  DATA s_title LIKE LINE OF titles.
  DATA s_func  LIKE LINE OF functions.
  DATA s_statu LIKE LINE OF status.
  DATA s_s_fu  LIKE LINE OF s_statu-functions.
  DATA s_menu  LIKE LINE OF menu_list.
  DATA s_m_det LIKE LINE OF s_menu-composition.
  DATA s_bar   LIKE LINE OF menu_bars.
  DATA s_b_det LIKE LINE OF s_bar-composition.
  DATA s_key   LIKE LINE OF key_settings.
  DATA s_k_det LIKE LINE OF s_key-keys.
  DATA s_but   LIKE LINE OF s_key-pushbuttons.
  DATA s_u_det LIKE LINE OF s_but-composition.
  FIELD-SYMBOLS:
    &lt;k&gt;  LIKE LINE OF key_settings,
    &lt;at&gt; LIKE LINE OF fm_data-attributes,
    &lt;bd&gt; LIKE LINE OF fm_data-bars_det,
    &lt;kb&gt; LIKE LINE OF fm_data-keyboards,
    &lt;bu&gt; LIKE LINE OF fm_data-buttons_det,
    &lt;sf&gt; LIKE LINE OF fm_data-stat_funcs,
    &lt;st&gt; LIKE LINE OF fm_data-status,
    &lt;mn&gt; LIKE LINE OF fm_data-menus,
    &lt;md&gt; LIKE LINE OF fm_data-menus_det,
    &lt;fu&gt; LIKE LINE OF fm_data-functions,
    &lt;ti&gt; LIKE LINE OF fm_data-titles.
  bar = fm_data-header-actcode.
  menu = fm_data-header-mencode.
  function = fm_data-header-pfkcode.
  default_bar = fm_data-header-defaultact.
  default_function = fm_data-header-defaultpfk.
  master_lang = fm_data-header-mod_langu.
  LOOP AT fm_data-titles ASSIGNING &lt;ti&gt;.
    CLEAR s_title.
    MOVE-CORRESPONDING &lt;ti&gt; TO s_title-hdr.
    s_title-texts = get_texts( texts = fm_data-texts
                            obj_type = obj_types-title
                            obj_code = s_title-code
                            sub_code = space
                            texttype = text_types-tech_info ).
    INSERT s_title INTO TABLE titles.
  ENDLOOP.
  LOOP AT fm_data-functions ASSIGNING &lt;fu&gt;.
    CLEAR s_func.
    MOVE-CORRESPONDING &lt;fu&gt; TO s_func-hdr.
    s_func-texts = get_func_texts( texts = fm_data-texts
                                obj_code = s_func-code
                                sub_code = s_func-textno ).
    INSERT s_func INTO TABLE functions.
  ENDLOOP.
  t_tmp_m = fm_data-menus.
  SORT t_tmp_m                                   BY code.
  DELETE ADJACENT DUPLICATES FROM t_tmp_m COMPARING code.
  t_menus = t_tmp_m.
  LOOP AT fm_data-menus_det ASSIGNING &lt;md&gt;.
    READ TABLE t_menus TRANSPORTING NO FIELDS
         WITH TABLE KEY code = &lt;md&gt;-code.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_mnu.        s_mnu-code = &lt;md&gt;-code.
      INSERT s_mnu INTO TABLE t_menus.
    ENDIF.
  ENDLOOP.
  LOOP AT t_menus ASSIGNING &lt;mn&gt;.
    CLEAR s_menu.
    MOVE-CORRESPONDING &lt;mn&gt; TO s_menu-hdr.
    s_menu-texts = get_texts( texts = fm_data-texts
                           obj_type = obj_types-menu
                           obj_code = s_menu-code
                           sub_code = space
                           texttype = text_types-object ).
    LOOP AT fm_data-menus_det ASSIGNING &lt;md&gt;
            WHERE code = &lt;mn&gt;-code.
      CLEAR s_m_det.
      MOVE-CORRESPONDING &lt;md&gt; TO s_m_det.
      CLEAR: s_m_det-code.
      INSERT s_m_det INTO TABLE s_menu-composition.
    ENDLOOP.
    INSERT s_menu INTO TABLE menu_list.
  ENDLOOP.
  t_tmp = fm_data-attributes.
  SORT t_tmp                                   BY obj_code sub_code obj_type.
  DELETE ADJACENT DUPLICATES FROM t_tmp COMPARING obj_code sub_code obj_type.
  t_attr = t_tmp.
  LOOP AT fm_data-bars_det ASSIGNING &lt;bd&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;bd&gt;-code
                        sub_code = space
                        obj_type = obj_types-menu_bar.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-menu_bar.         s_attr-obj_code = &lt;bd&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.
  LOOP AT fm_data-keyboards ASSIGNING &lt;kb&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;kb&gt;-code
                        sub_code = space
                        obj_type = obj_types-key_set.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-key_set.         s_attr-obj_code = &lt;kb&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.
  LOOP AT fm_data-buttons_det ASSIGNING &lt;bu&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;bu&gt;-pfk_code
                        sub_code = &lt;bu&gt;-code
                        obj_type = obj_types-button.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-button.         s_attr-obj_code = &lt;bu&gt;-pfk_code.     s_attr-sub_code = &lt;bu&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.
  LOOP AT t_attr ASSIGNING &lt;at&gt;.
    CASE &lt;at&gt;-obj_type.
      WHEN obj_types-menu_bar.
        CLEAR s_bar.        MOVE-CORRESPONDING &lt;at&gt; TO s_bar-hdr.
        s_bar-texts = get_texts( texts = fm_data-texts
                              obj_type = obj_types-menu_bar
                              obj_code = s_bar-obj_code
                              sub_code = space
                              texttype = text_types-tech_info ).
        LOOP AT fm_data-bars_det ASSIGNING &lt;bd&gt;
                WHERE code = &lt;at&gt;-obj_code.
          CLEAR s_b_det.        MOVE-CORRESPONDING &lt;bd&gt; TO s_b_det.         CLEAR: s_b_det-code.
          INSERT s_b_det INTO TABLE s_bar-composition.
        ENDLOOP.
        CLEAR s_bar-obj_type.
        INSERT s_bar INTO TABLE menu_bars.
      WHEN obj_types-key_set.
        CLEAR s_key.          MOVE-CORRESPONDING &lt;at&gt; TO s_key-hdr.
        s_key-texts = get_texts( texts = fm_data-texts
                              obj_type = obj_types-key_set
                              obj_code = s_key-obj_code
                              sub_code = space
                              texttype = text_types-tech_info ).
        LOOP AT fm_data-keyboards ASSIGNING &lt;kb&gt;
                WHERE code = &lt;at&gt;-obj_code.
          CLEAR s_k_det.          MOVE-CORRESPONDING &lt;kb&gt; TO s_k_det.       CLEAR: s_k_det-code.
          INSERT s_k_det INTO TABLE s_key-keys.
        ENDLOOP.
        CLEAR s_key-obj_type.
        INSERT s_key INTO TABLE key_settings.
      WHEN obj_types-button.
        READ TABLE key_settings ASSIGNING &lt;k&gt;
             WITH TABLE KEY obj_code = &lt;at&gt;-obj_code.
        IF sy-subrc &lt;&gt; 0.
          WRITE:/ &apos;button without key&apos;, &lt;at&gt;-obj_code.
        ELSE.
          CLEAR s_but.        MOVE-CORRESPONDING &lt;at&gt; TO s_but-hdr.
          s_but-texts = get_texts( texts = fm_data-texts
                                obj_type = obj_types-button
                                obj_code = s_but-obj_code
                                sub_code = s_but-sub_code
                                texttype = text_types-tech_info ).
          LOOP AT fm_data-buttons_det ASSIGNING &lt;bu&gt;
                  WHERE pfk_code = &lt;at&gt;-obj_code
                    AND code = &lt;at&gt;-sub_code.
            CLEAR s_u_det.        MOVE-CORRESPONDING &lt;bu&gt; TO s_u_det.       CLEAR: s_u_det-pfk_code, s_u_det-code.
            INSERT s_u_det INTO TABLE s_but-composition.
          ENDLOOP.
          CLEAR: s_but-obj_type, s_but-obj_code.
          INSERT s_but INTO TABLE &lt;k&gt;-pushbuttons.
        ENDIF.
    ENDCASE.
  ENDLOOP.
  LOOP AT fm_data-status ASSIGNING &lt;st&gt;.
    CLEAR s_statu.     MOVE-CORRESPONDING &lt;st&gt; TO s_statu-hdr.
    s_statu-texts = get_texts( texts = fm_data-texts
                            obj_type = obj_types-status
                            obj_code = s_statu-code
                            sub_code = space
                            texttype = text_types-tech_info ).
    LOOP AT fm_data-stat_funcs ASSIGNING &lt;sf&gt;
            WHERE status = &lt;st&gt;-code.
      s_s_fu = &lt;sf&gt;-function.
      INSERT s_s_fu INTO TABLE s_statu-functions.
    ENDLOOP.
    INSERT s_statu INTO TABLE status.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_title LIKE LINE OF fm_data-titles.
  DATA s_func  LIKE LINE OF fm_data-functions.
  DATA s_statu LIKE LINE OF fm_data-status.
  DATA s_s_fu  LIKE LINE OF fm_data-stat_funcs.
  DATA s_menu  LIKE LINE OF fm_data-menus.
  DATA s_m_det LIKE LINE OF fm_data-menus_det.
  DATA s_attr  LIKE LINE OF fm_data-attributes.
  DATA s_b_det LIKE LINE OF fm_data-bars_det.
  DATA s_k_det LIKE LINE OF fm_data-keyboards.
  DATA s_but   LIKE LINE OF fm_data-buttons_det.
  FIELD-SYMBOLS:
    &lt;mb&gt; LIKE LINE OF menu_bars,
    &lt;bc&gt; LIKE LINE OF &lt;mb&gt;-composition,
    &lt;ks&gt; LIKE LINE OF key_settings,
    &lt;kk&gt; LIKE LINE OF &lt;ks&gt;-keys,
    &lt;pb&gt; LIKE LINE OF &lt;ks&gt;-pushbuttons,
    &lt;pc&gt; LIKE LINE OF &lt;pb&gt;-composition,
    &lt;st&gt; LIKE LINE OF status,
    &lt;sf&gt; LIKE LINE OF &lt;st&gt;-functions,
    &lt;mn&gt; LIKE LINE OF menu_list,
    &lt;md&gt; LIKE LINE OF &lt;mn&gt;-composition,
    &lt;fu&gt; LIKE LINE OF functions,
    &lt;ti&gt; LIKE LINE OF titles.
  fm_data-header-actcode = bar.
  fm_data-header-mencode = menu.
  fm_data-header-pfkcode = function.
  fm_data-header-defaultact = default_bar.
  fm_data-header-defaultpfk = default_function.
  fm_data-header-mod_langu = master_lang.
  LOOP AT titles ASSIGNING &lt;ti&gt;.
    CLEAR s_title.        MOVE-CORRESPONDING &lt;ti&gt;-hdr TO s_title.
    INSERT s_title INTO TABLE fm_data-titles.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-title
        obj_code = s_title-code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;ti&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
  ENDLOOP.
  LOOP AT functions ASSIGNING &lt;fu&gt;.
    CLEAR s_func.     MOVE-CORRESPONDING &lt;fu&gt;-hdr TO s_func.
    INSERT s_func INTO TABLE fm_data-functions.
    CALL METHOD set_func_texts
      EXPORTING
        obj_code = s_func-code
        sub_code = s_func-textno
        texts    = &lt;fu&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
  ENDLOOP.
  LOOP AT menu_list ASSIGNING &lt;mn&gt;.
    CLEAR s_menu.     MOVE-CORRESPONDING &lt;mn&gt;-hdr TO s_menu.
    INSERT s_menu INTO TABLE fm_data-menus.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-menu
        obj_code = s_menu-code
        sub_code = space
        texttype = text_types-object
        texts    = &lt;mn&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;mn&gt;-composition ASSIGNING &lt;md&gt;.
      CLEAR s_m_det.      MOVE-CORRESPONDING &lt;md&gt; TO s_m_det.       s_m_det-code = &lt;mn&gt;-code.
      INSERT s_m_det INTO TABLE fm_data-menus_det.
    ENDLOOP.
  ENDLOOP.
  LOOP AT menu_bars ASSIGNING &lt;mb&gt;.
    CLEAR s_attr.         MOVE-CORRESPONDING &lt;mb&gt;-hdr TO s_attr.    s_attr-obj_type = obj_types-menu_bar.
    INSERT s_attr INTO TABLE fm_data-attributes.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-menu_bar
        obj_code = s_attr-obj_code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;mb&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;mb&gt;-composition ASSIGNING &lt;bc&gt;.
      CLEAR s_b_det.      MOVE-CORRESPONDING &lt;bc&gt; TO s_b_det.       s_b_det-code = &lt;mb&gt;-obj_code.
      INSERT s_b_det INTO TABLE fm_data-bars_det.
    ENDLOOP.
  ENDLOOP.
  LOOP AT key_settings ASSIGNING &lt;ks&gt;.
    CLEAR s_attr.         MOVE-CORRESPONDING &lt;ks&gt;-hdr TO s_attr.    s_attr-obj_type = obj_types-key_set.
    INSERT s_attr INTO TABLE fm_data-attributes.
    LOOP AT &lt;ks&gt;-keys ASSIGNING &lt;kk&gt;.
      CLEAR s_k_det.      MOVE-CORRESPONDING &lt;kk&gt; TO s_k_det.       s_k_det-code = &lt;ks&gt;-obj_code.
      INSERT s_k_det INTO TABLE fm_data-keyboards.
    ENDLOOP.
    LOOP AT &lt;ks&gt;-pushbuttons ASSIGNING &lt;pb&gt;.
      CLEAR s_attr.       MOVE-CORRESPONDING &lt;pb&gt; TO s_attr.        s_attr-obj_type = obj_types-button.       s_attr-obj_code = &lt;ks&gt;-obj_code.
      INSERT s_attr INTO TABLE fm_data-attributes.
      CALL METHOD set_texts
        EXPORTING
          obj_type = obj_types-button
          obj_code = s_attr-obj_code
          sub_code = s_attr-sub_code
          texttype = text_types-tech_info
          texts    = &lt;pb&gt;-texts
        CHANGING
          RESULT   = fm_data-texts.
      LOOP AT &lt;pb&gt;-composition ASSIGNING &lt;pc&gt;.
        CLEAR s_but.      MOVE-CORRESPONDING &lt;pc&gt; TO s_but.         s_but-pfk_code = &lt;ks&gt;-obj_code.        s_but-code = &lt;pb&gt;-sub_code.
        INSERT s_but INTO TABLE fm_data-buttons_det.
      ENDLOOP.
    ENDLOOP.
  ENDLOOP.
  LOOP AT status ASSIGNING &lt;st&gt;.
    CLEAR s_statu.        MOVE-CORRESPONDING &lt;st&gt;-hdr TO s_statu.
    INSERT s_statu INTO TABLE fm_data-status.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-status
        obj_code = s_statu-code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;st&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;st&gt;-functions ASSIGNING &lt;sf&gt;.
      CLEAR s_s_fu.     s_s_fu-status = &lt;st&gt;-code.      s_s_fu-function = &lt;sf&gt;.
      INSERT s_s_fu INTO TABLE fm_data-stat_funcs.
    ENDLOOP.
  ENDLOOP.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
METHOD get_texts.
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.
  LOOP AT texts ASSIGNING &lt;t&gt;
       WHERE obj_type = obj_type
         AND obj_code = obj_code
         AND sub_code = sub_code
         AND texttype = texttype.
    s_txt-langu = &lt;t&gt;-sprsl.
    s_txt-text = &lt;t&gt;-text.
    INSERT s_txt INTO TABLE result.
  ENDLOOP.
ENDMETHOD.
METHOD get_func_texts.
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF result,
    &lt;t&gt; LIKE LINE OF texts.
  LOOP AT texts ASSIGNING &lt;t&gt;
       WHERE obj_type = obj_types-function
         AND obj_code = obj_code
         AND sub_code = sub_code.
    READ TABLE result ASSIGNING &lt;r&gt;
         WITH TABLE KEY langu = &lt;t&gt;-sprsl.
    IF sy-subrc &lt;&gt; 0.
      s_txt-langu = &lt;t&gt;-sprsl.
      INSERT s_txt INTO TABLE result.
      READ TABLE result ASSIGNING &lt;r&gt;
           WITH TABLE KEY langu = &lt;t&gt;-sprsl.
      IF sy-subrc &lt;&gt; 0.
      ENDIF.
    ENDIF.
    CASE &lt;t&gt;-texttype.
      WHEN text_types-object.
        &lt;r&gt;-text = &lt;t&gt;-text.
      WHEN text_types-icon.
        &lt;r&gt;-icon = &lt;t&gt;-text.
      WHEN text_types-quick_info.
        &lt;r&gt;-info = &lt;t&gt;-text.
      WHEN OTHERS.
    ENDCASE.
  ENDLOOP.
ENDMETHOD.
METHOD SET_TEXTS.
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    s_txt-obj_type = obj_type.
    s_txt-obj_code = obj_code.
    s_txt-sub_code = sub_code.
    s_txt-texttype = texttype.
    s_txt-sprsl = &lt;t&gt;-langu.
    s_txt-text = &lt;t&gt;-text.
    INSERT s_txt INTO TABLE result.
  ENDLOOP.
ENDMETHOD.
METHOD SET_FUNC_TEXTS.
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    clear s_txt.
    s_txt-obj_type = obj_types-function.
    s_txt-obj_code = obj_code.
    s_txt-sub_code = sub_code.
    s_txt-sprsl = &lt;t&gt;-langu.
    s_txt-texttype = text_types-object.     s_txt-text = &lt;t&gt;-text.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
    s_txt-texttype = text_types-icon.       s_txt-text = &lt;t&gt;-icon.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
    s_txt-texttype = text_types-quick_info. s_txt-text = &lt;t&gt;-info.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
  ENDLOOP.
ENDMETHOD.
endclass. &quot;ZAPLINK_MENUPAINTER_DATA implementation
class ZAPLINK_MSAG_DATA implementation.
METHOD anonymize.
  DATA s_msg LIKE LINE OF messages.
  CLEAR:
    a0_maindata-lastuser,
    a0_maindata-ldate,
    a0_maindata-ltime.
  MODIFY messages FROM s_msg TRANSPORTING name datum
         WHERE NOT msgnr IS INITIAL OR msgnr IS INITIAL.
ENDMETHOD.
METHOD unanonymize.
  DATA s_msg LIKE LINE OF messages.
  IF a0_maindata-respuser IS INITIAL. a0_maindata-respuser = sy-uname. ENDIF.
  s_msg-name = a0_maindata-respuser.
  MODIFY messages FROM s_msg TRANSPORTING name WHERE name IS INITIAL.
ENDMETHOD.
endclass. &quot;ZAPLINK_MSAG_DATA implementation
class ZAPLINK_OPT_BASE implementation.
endclass. &quot;ZAPLINK_OPT_BASE implementation
class ZAPLINK_PINF_DATA implementation.
endclass. &quot;ZAPLINK_PINF_DATA implementation
class ZAPLINK_PROG_DATA implementation.
METHOD anonymize.
  CLEAR: a0_maindata-cnam, a0_maindata-cdat, a0_maindata-unam, a0_maindata-udat, a0_maindata-sdate, a0_maindata-stime, a0_maindata-idate,
         a0_maindata-itime, a0_maindata-vern, a0_maindata-state. &quot; Issue 68.
ENDMETHOD.
METHOD from_data.
  DATA s_txt     LIKE LINE OF texts.
  DATA t_docs    TYPE tt_docs.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.
  a0_maindata = fm_data-header.
  textspool = fm_data-textspool.
  source-_ = fm_data-source.
  dynpros = fm_data-dynpros.
  menupainter = fm_data-menupainter.
  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-prog
            object = a0_maindata-name.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_txt.    s_txt-langu = &lt;t&gt;-sprsl.   s_txt-short_txt = &lt;t&gt;-text.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_txt-langu.
      IF sy-subrc = 0.    s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_txt INTO TABLE texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_txt.    s_txt-langu = &lt;dt&gt;-tdspras.   s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    INSERT s_txt INTO TABLE texts.
    ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD to_data.
  DATA s_txt     LIKE LINE OF fm_data-texts.
  DATA s_doc     LIKE LINE OF fm_data-docs.
  DATA s_doc_txt LIKE LINE OF s_doc-texts.
  FIELD-SYMBOLS:
    &lt;t&gt;  LIKE LINE OF texts.
  fm_data-header = a0_maindata.
  fm_data-textspool = textspool.
  fm_data-source = source-_.
  fm_data-dynpros = dynpros.
  fm_data-menupainter = menupainter.
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-prog.   s_doc-object = a0_maindata-name.
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-sprsl = &lt;t&gt;-langu.   s_txt-text = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
ENDMETHOD.
METHOD unanonymize.
  a0_maindata-cnam = sy-uname.
ENDMETHOD.
METHOD class_constructor.
  DATA _id LIKE LINE OF r_doc_ids-prog.
  _id-sign = &apos;I&apos;.   _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-prog.      APPEND _id TO r_doc_ids-prog.
ENDMETHOD.
endclass. &quot;ZAPLINK_PROG_DATA implementation
class ZAPLINK_SHLP_DATA implementation.
method ANONYMIZE.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA s_text    LIKE LINE OF texts.
  DATA s_param   LIKE LINE OF params.
  DATA s_ssh     LIKE LINE OF sub_search_helps.
  DATA s_sshp    LIKE LINE OF s_ssh-params.
  DATA t_docs    TYPE tt_docs.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;s&gt;  LIKE LINE OF fm_data-sub_sh,
    &lt;sp&gt; LIKE LINE OF fm_data-ssh_params,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.   CLEAR a0_maindata-ddtext.
  params = fm_data-fields.    MODIFY params FROM s_param TRANSPORTING shlpname WHERE table_line IS NOT INITIAL.
  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-header
            object = a0_maindata-shlpname.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;
          WHERE shlpname = a0_maindata-shlpname.
    CLEAR s_text.   s_text-langu = &lt;t&gt;-ddlanguage.    s_text-short_txt = &lt;t&gt;-ddtext.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.    s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_text.    s_text-langu = &lt;dt&gt;-tdspras.   s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    INSERT s_text INTO TABLE texts.
    ENDLOOP.
  ENDIF.
  LOOP AT fm_data-sub_sh ASSIGNING &lt;s&gt;
          WHERE shlpname = a0_maindata-shlpname.
    CLEAR s_ssh.   s_ssh-hdr = &lt;s&gt;.   CLEAR s_ssh-shlpname.
    IF s_ssh-viashlp = a0_maindata-shlpname.  CLEAR s_ssh-viashlp.  ENDIF.
    LOOP AT fm_data-ssh_params ASSIGNING &lt;sp&gt;
            WHERE shlpname = a0_maindata-shlpname
              AND subshlp = s_ssh-subshlp.
      CLEAR s_sshp.   s_sshp = &lt;sp&gt;.    CLEAR: s_sshp-shlpname, s_sshp-subshlp, s_sshp-valuedirec.    &quot;auto determinded
      INSERT s_sshp INTO TABLE s_ssh-params.
    ENDLOOP.
    DELETE s_ssh-params WHERE fieldname IS INITIAL.
    INSERT s_ssh INTO TABLE sub_search_helps.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_txt      LIKE LINE OF fm_data-texts.
  DATA s_field    LIKE LINE OF fm_data-fields.
  DATA s_doc      LIKE LINE OF fm_data-docs.
  DATA s_doc_txt  LIKE LINE OF s_doc-texts.
  DATA s_ssh      LIKE LINE OF fm_data-sub_sh.
  DATA s_sshp     LIKE LINE OF fm_data-ssh_params.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;s&gt;  LIKE LINE OF sub_search_helps,
    &lt;sp&gt; LIKE LINE OF &lt;s&gt;-params,
    &lt;t&gt;  LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  s_field-shlpname = fm_data-header-shlpname.   fm_data-fields = params.    MODIFY fm_data-fields FROM s_field TRANSPORTING shlpname WHERE table_line IS NOT INITIAL.
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-header.   s_doc-object = fm_data-header-shlpname.
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-shlpname = fm_data-header-shlpname.   s_txt-ddlanguage = &lt;t&gt;-langu.   s_txt-ddtext = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
  LOOP AT sub_search_helps ASSIGNING &lt;s&gt;.
    CLEAR s_ssh.   s_ssh = &lt;s&gt;-hdr.   s_ssh-shlpname = a0_maindata-shlpname.
    IF s_ssh-viashlp IS INITIAL.    s_ssh-viashlp = a0_maindata-shlpname.  ENDIF.
    INSERT s_ssh INTO TABLE fm_data-sub_sh.
    LOOP AT &lt;s&gt;-params ASSIGNING &lt;sp&gt;.
      CLEAR s_sshp.   s_sshp = &lt;sp&gt;.    s_sshp-shlpname = a0_maindata-shlpname.   s_sshp-subshlp = &lt;s&gt;-subshlp.
      INSERT s_sshp INTO TABLE fm_data-ssh_params.
    ENDLOOP.
  ENDLOOP.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_SHLP_DATA implementation
class ZAPLINK_TABL_DATA implementation.
method ANONYMIZE.
  FIELD-SYMBOLS:
    &lt;t&gt; like LINE OF texts.
  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME,
         a0_maindata-technical_settings-AS4USER, a0_maindata-technical_settings-AS4DATE, a0_maindata-technical_settings-AS4TIME.
  loop at texts ASSIGNING &lt;t&gt;.
    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.
  endloop.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA s_text  LIKE LINE OF texts.
  DATA s_field LIKE LINE OF fields.
  DATA s_sh_f  LIKE LINE OF s_field-search_help-fields.
  DATA s_fk_f  LIKE LINE OF s_field-forein_key-fields.
  DATA s_f_txt LIKE LINE OF s_field-texts.
  DATA s_index LIKE LINE OF indexes.
  DATA s_idx_f LIKE LINE OF s_index-fields.
  DATA d_str   TYPE string.
  FIELD-SYMBOLS:
    &lt;f&gt; LIKE LINE OF fm_data-fields,
    &lt;ft&gt; LIKE LINE OF fm_data-fields_texts,
    &lt;s&gt; LIKE LINE OF fm_data-search_helps,
    &lt;sf&gt; LIKE LINE OF fm_data-sh_fields,
    &lt;k&gt; LIKE LINE OF fm_data-forein_keys,
    &lt;ff&gt; LIKE LINE OF fm_data-fk_fields,
    &lt;i&gt; LIKE LINE OF fm_data-indexes,
    &lt;if&gt; LIKE LINE OF fm_data-idx_fields,
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt; LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.
  a0_maindata-technical_settings = fm_data-tech.
  CLEAR: a0_maindata-technical_settings-tabname,
         a0_maindata-technical_settings-as4local,
         a0_maindata-technical_settings-as4vers.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-langu = &lt;t&gt;-ddlanguage.
    s_text-short_txt = &lt;t&gt;-ddtext.
    READ TABLE fm_data-docs ASSIGNING &lt;d&gt;
         WITH KEY id = doc_ids-header
              object = a0_maindata-tabname.
    IF sy-subrc = 0.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.
        s_text-long_txt = &lt;dt&gt;.
        CLEAR s_text-long_txt-tdspras.
      ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  LOOP AT fm_data-fields ASSIGNING &lt;f&gt;
          WHERE tabname = a0_maindata-tabname.
    CLEAR s_field.      s_field-hdr = &lt;f&gt;.      CLEAR: s_field-tabname.
    LOOP AT fm_data-fields_texts ASSIGNING &lt;ft&gt;
            WHERE tabname = &lt;f&gt;-tabname
            AND fieldname = &lt;f&gt;-fieldname.
      CLEAR s_f_txt.
      s_f_txt-langu = &lt;ft&gt;-ddlanguage.
      s_f_txt-short_txt = &lt;ft&gt;-ddtext.
      INSERT s_f_txt INTO TABLE s_field-texts.
    ENDLOOP.
    LOOP AT fm_data-search_helps ASSIGNING &lt;s&gt;
            WHERE tabname = &lt;f&gt;-tabname
            AND fieldname = &lt;f&gt;-fieldname.
      IF s_field-search_help IS NOT INITIAL. sy-subrc = sy-tabix / 0. ENDIF.    &quot; should not append
      s_field-search_help-hdr = &lt;s&gt;.      CLEAR: s_field-search_help-tabname, s_field-search_help-fieldname.
      LOOP AT fm_data-sh_fields ASSIGNING &lt;sf&gt;
              WHERE tabname = &lt;s&gt;-tabname
              AND fieldname = &lt;s&gt;-fieldname
               AND shlpname = &lt;s&gt;-shlpname.
        CLEAR s_sh_f.     s_sh_f = &lt;sf&gt;.    CLEAR: s_sh_f-tabname, s_sh_f-fieldname, s_sh_f-shlpname.
        IF s_sh_f-shtable = a0_maindata-tabname.    CLEAR: s_sh_f-shtable.    IF s_sh_f-shfield = s_field-fieldname.    CLEAR: s_sh_f-shfield. ENDIF. ENDIF.
        INSERT s_sh_f INTO TABLE s_field-search_help-fields.
      ENDLOOP.
    ENDLOOP.
    LOOP AT fm_data-forein_keys ASSIGNING &lt;k&gt;
            WHERE tabname = &lt;f&gt;-tabname
            AND fieldname = &lt;f&gt;-fieldname.
      IF s_field-forein_key IS NOT INITIAL. sy-subrc = sy-tabix / 0. ENDIF.    &quot; should not append
      s_field-forein_key-hdr = &lt;k&gt;.      CLEAR: s_field-forein_key-tabname, s_field-forein_key-fieldname, s_field-checktable.
      LOOP AT fm_data-fk_fields ASSIGNING &lt;ff&gt;
              WHERE tabname = &lt;k&gt;-tabname
              AND fieldname = &lt;k&gt;-fieldname
             AND checktable = &lt;k&gt;-checktable.
        CLEAR s_fk_f.     s_fk_f = &lt;ff&gt;.    CLEAR: s_fk_f-tabname, s_fk_f-fieldname, s_fk_f-checktable.
        IF s_fk_f-fortable = a0_maindata-tabname.    CLEAR: s_fk_f-fortable.    IF s_fk_f-forkey = s_field-fieldname.    CLEAR: s_fk_f-forkey. ENDIF. ENDIF.
        INSERT s_fk_f INTO TABLE s_field-forein_key-fields.
      ENDLOOP.
    ENDLOOP.
    INSERT s_field INTO TABLE fields.
  ENDLOOP.
  LOOP AT fm_data-indexes ASSIGNING &lt;i&gt;
          WHERE sqltab = a0_maindata-tabname.
    CLEAR s_index.      s_index-hdr = &lt;i&gt;.      CLEAR: s_index-sqltab.
    CONCATENATE &lt;i&gt;-sqltab &apos;~&apos; &lt;i&gt;-indexname INTO d_str.
    IF d_str = s_index-dbindex. CLEAR s_index-dbindex. ENDIF.     &quot; clear default naming convention
    LOOP AT fm_data-idx_fields ASSIGNING &lt;if&gt;
            WHERE sqltab = &lt;i&gt;-sqltab
           AND indexname = &lt;i&gt;-indexname.
      CLEAR s_idx_f.    s_idx_f = &lt;if&gt;.       CLEAR: s_idx_f-sqltab, s_idx_f-indexname.
      INSERT s_idx_f INTO TABLE s_index-fields.
    ENDLOOP.
    INSERT s_index INTO TABLE indexes.
  ENDLOOP.
ENDMETHOD.
METHOD to_data.
  DATA s_text  LIKE LINE OF fm_data-texts.
  DATA s_doc   LIKE LINE OF fm_data-docs.
  DATA s_dtxt  LIKE LINE OF s_doc-texts.
  DATA s_index LIKE LINE OF fm_data-indexes.
  DATA s_idx_f LIKE LINE OF fm_data-idx_fields.
  DATA s_field LIKE LINE OF fm_data-fields.
  DATA s_f_txt LIKE LINE OF fm_data-fields_texts.
  DATA s_sh    LIKE LINE OF fm_data-search_helps.
  DATA s_sh_f  LIKE LINE OF fm_data-sh_fields.
  DATA s_fk    LIKE LINE OF fm_data-forein_keys.
  DATA s_fk_f  LIKE LINE OF fm_data-fk_fields.
  FIELD-SYMBOLS:
    &lt;i&gt;  LIKE LINE OF indexes,
    &lt;if&gt; LIKE LINE OF &lt;i&gt;-fields,
    &lt;f&gt;  LIKE LINE OF fields,
    &lt;ft&gt; LIKE LINE OF &lt;f&gt;-texts,
    &lt;sf&gt; LIKE LINE OF &lt;f&gt;-search_help-fields,
    &lt;ff&gt; LIKE LINE OF &lt;f&gt;-forein_key-fields,
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;t&gt;  LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  fm_data-tech = a0_maindata-technical_settings.
  fm_data-tech-tabname = fm_data-header-tabname.
  fm_data-tech-as4local = &apos;A&apos;.
  fm_data-tech-as4vers = &apos;0000&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-tabname = fm_data-header-tabname.
    s_text-ddlanguage = &lt;t&gt;-langu.
    s_text-as4local = &apos;A&apos;. &quot; Active
    s_text-as4vers = &apos;0000&apos;. &quot; Active
    s_text-ddtext = &lt;t&gt;-short_txt.
    INSERT s_text INTO TABLE fm_data-texts.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      IF fm_data-docs IS INITIAL.
        s_doc-application = &apos;DOKU&apos;.
        s_doc-id = doc_ids-header.
        s_doc-object = fm_data-header-tabname.
        s_doc-langu = &lt;t&gt;-langu.
        s_doc-masterlang = abap_true.
        s_doc-typ = &apos;E&apos;.
        s_doc-dokform = &apos;S_DOCU_SHOW&apos;.
        s_doc-dokstyle = &apos;S_DOCUS1&apos;.
        INSERT s_doc INTO TABLE fm_data-docs.
      ENDIF.
      READ TABLE fm_data-docs ASSIGNING &lt;d&gt; INDEX 1.
      s_dtxt = &lt;t&gt;-long_txt.
      s_dtxt-tdspras = &lt;t&gt;-langu.
      INSERT s_dtxt INTO TABLE &lt;d&gt;-texts.
    ENDIF.
  ENDLOOP.
  LOOP AT indexes ASSIGNING &lt;i&gt;.
    CLEAR s_index.      s_index = &lt;i&gt;-hdr.      s_index-sqltab = a0_maindata-tabname.
    IF s_index-dbindex IS INITIAL. CONCATENATE s_index-sqltab &apos;~&apos; s_index-indexname INTO s_index-dbindex. ENDIF.     &quot; retrieve default naming convention
    INSERT s_index INTO TABLE fm_data-indexes.
    LOOP AT &lt;i&gt;-fields ASSIGNING &lt;if&gt;.
      CLEAR s_idx_f.    s_idx_f = &lt;if&gt;.       s_idx_f-sqltab = s_index-sqltab. s_idx_f-indexname = s_index-indexname.
      INSERT s_idx_f INTO TABLE fm_data-idx_fields.
    ENDLOOP.
  ENDLOOP.
  LOOP AT fields ASSIGNING &lt;f&gt;.
    CLEAR s_field.      s_field = &lt;f&gt;-hdr.      s_field-tabname = a0_maindata-tabname.
    LOOP AT &lt;f&gt;-texts ASSIGNING &lt;ft&gt;.
      CLEAR s_f_txt.    s_f_txt-ddlanguage = &lt;ft&gt;-langu.    s_f_txt-ddtext = &lt;ft&gt;-short_txt.    s_f_txt-tabname = s_field-tabname.    s_f_txt-fieldname = s_field-fieldname.
      INSERT s_f_txt INTO TABLE fm_data-fields_texts.
    ENDLOOP.
    IF NOT &lt;f&gt;-search_help IS INITIAL.
      CLEAR s_sh.   s_sh = &lt;f&gt;-search_help-hdr.   s_sh-tabname = s_field-tabname.   s_sh-fieldname = s_field-fieldname.
      INSERT s_sh INTO TABLE fm_data-search_helps.
      LOOP AT &lt;f&gt;-search_help-fields ASSIGNING &lt;sf&gt;.
        CLEAR s_sh_f.     s_sh_f = &lt;sf&gt;.    s_sh_f-tabname = s_sh-tabname.    s_sh_f-fieldname = s_sh-fieldname.    s_sh_f-shlpname = s_sh-shlpname.
        IF s_sh_f-shtable IS INITIAL. s_sh_f-shtable = a0_maindata-tabname.    IF s_sh_f-shfield IS INITIAL. s_sh_f-shfield = &lt;f&gt;-fieldname.    ENDIF. ENDIF.
        INSERT s_sh_f INTO TABLE fm_data-sh_fields.
      ENDLOOP.
    ENDIF.
    IF NOT &lt;f&gt;-forein_key IS INITIAL.
      CLEAR s_fk.   s_fk = &lt;f&gt;-forein_key-hdr.   s_fk-tabname = s_field-tabname.   s_fk-fieldname = s_field-fieldname.
      INSERT s_fk INTO TABLE fm_data-forein_keys.
      s_field-checktable = s_fk-checktable.
      LOOP AT &lt;f&gt;-forein_key-fields ASSIGNING &lt;ff&gt;.
        CLEAR s_fk_f.     s_fk_f = &lt;ff&gt;.    s_fk_f-tabname = s_fk-tabname.   s_fk_f-fieldname = s_fk-fieldname.   s_fk_f-checktable = s_fk-checktable.
        IF s_fk_f-fortable IS INITIAL.    s_fk_f-fortable = a0_maindata-tabname.    IF s_fk_f-forkey IS INITIAL.  s_fk_f-forkey = s_field-fieldname.   ENDIF. ENDIF.
        INSERT s_fk_f INTO TABLE fm_data-fk_fields.
      ENDLOOP.
    ENDIF.
    INSERT s_field INTO TABLE fm_data-fields.
  ENDLOOP.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_TABL_DATA implementation
class ZAPLINK_TTYP_DATA implementation.
method ANONYMIZE.
  FIELD-SYMBOLS   &lt;t&gt; like LINE OF texts.
  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME.
  loop at texts ASSIGNING &lt;t&gt;.    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.    endloop.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA s_text    LIKE LINE OF texts.
  DATA s_key     LIKE LINE OF keys.
  DATA t_docs    TYPE tt_docs.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.   CLEAR a0_maindata-ddtext.
  keys = fm_data-keys.    MODIFY keys FROM s_key TRANSPORTING typename rowtypepos WHERE table_line IS NOT INITIAL.
  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-header
            object = a0_maindata-typename.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.   s_text-langu = &lt;t&gt;-ddlanguage.    s_text-short_txt = &lt;t&gt;-ddtext.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.    s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_text.    s_text-langu = &lt;dt&gt;-tdspras.   s_text-long_txt = &lt;dt&gt;.   CLEAR s_text-long_txt-tdspras.    INSERT s_text INTO TABLE texts.
    ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD to_data.
  DATA s_txt      LIKE LINE OF fm_data-texts.
  DATA s_key      LIKE LINE OF fm_data-keys.
  DATA s_doc      LIKE LINE OF fm_data-docs.
  DATA s_doc_txt  LIKE LINE OF s_doc-texts.
  FIELD-SYMBOLS:
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;t&gt;  LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  s_key-typename = fm_data-header-typename.   fm_data-keys = keys.    MODIFY fm_data-keys FROM s_key TRANSPORTING typename WHERE table_line IS NOT INITIAL.
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-header.   s_doc-object = fm_data-header-typename.
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-typename = fm_data-header-typename.   s_txt-ddlanguage = &lt;t&gt;-langu.   s_txt-ddtext = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_TTYP_DATA implementation
class ZAPLINK_TYPE_DATA implementation.
method GET_SOURCE.
SPLIT me-&gt;source AT cl_abap_char_utilities=&gt;newline
        INTO TABLE source.
endmethod.
METHOD set_source.
  me-&gt;source = zaplink_tools=&gt;table_2_string( source ).
ENDMETHOD.
endclass. &quot;ZAPLINK_TYPE_DATA implementation
class ZAPLINK_VIEW_DATA implementation.
method ANONYMIZE.
  FIELD-SYMBOLS:
    &lt;t&gt; like LINE OF texts.
  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME,
         a0_maindata-technical_settings-AS4USER, a0_maindata-technical_settings-AS4DATE, a0_maindata-technical_settings-AS4TIME.
  loop at texts ASSIGNING &lt;t&gt;.
    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.
  endloop.
endmethod.
METHOD CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_ids.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.
ENDMETHOD.
METHOD from_data.
  DATA s_text  LIKE LINE OF texts.
  DATA s_table LIKE LINE OF tables.
  DATA s_field LIKE LINE OF fields.
  DATA s_join  LIKE LINE OF inner_join.
  DATA s_where LIKE LINE OF conditions.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt; LIKE LINE OF fm_data-texts.
  a0_maindata-hdr = fm_data-header.
  a0_maindata-technical_settings = fm_data-tech.
  CLEAR: a0_maindata-technical_settings-tabname,
         a0_maindata-technical_settings-as4local,
         a0_maindata-technical_settings-as4vers.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-langu = &lt;t&gt;-ddlanguage.
    s_text-short_txt = &lt;t&gt;-ddtext.
    READ TABLE fm_data-docs ASSIGNING &lt;d&gt;
         WITH KEY id = doc_ids-header
              object = a0_maindata-viewname.
    IF sy-subrc = 0.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_text-langu.
      IF sy-subrc = 0.
        s_text-long_txt = &lt;dt&gt;.
        CLEAR s_text-long_txt-tdspras.
      ENDIF.
    ENDIF.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  tables = fm_data-tables.
  MODIFY tables FROM s_table TRANSPORTING viewname WHERE NOT viewname IS INITIAL.
  fields = fm_data-fields.
  MODIFY fields FROM s_field TRANSPORTING viewname WHERE NOT viewname IS INITIAL.
  inner_join = fm_data-joins.
  MODIFY inner_join FROM s_join TRANSPORTING viewname WHERE NOT viewname IS INITIAL.
  conditions = fm_data-wheres.
  MODIFY conditions FROM s_where TRANSPORTING condname WHERE NOT condname IS INITIAL.
ENDMETHOD.
METHOD to_data.
  DATA s_text  LIKE LINE OF fm_data-texts.
  DATA s_doc   LIKE LINE OF fm_data-docs.
  DATA s_dtxt  LIKE LINE OF s_doc-texts.
  DATA s_table LIKE LINE OF fm_data-tables.
  DATA s_field LIKE LINE OF fm_data-fields.
  DATA s_join  LIKE LINE OF fm_data-joins.
  DATA s_where LIKE LINE OF fm_data-wheres.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF fm_data-docs,
    &lt;t&gt; LIKE LINE OF texts.
  fm_data-header = a0_maindata-hdr.
  fm_data-tech = a0_maindata-technical_settings.
  fm_data-tech-tabname = a0_maindata-viewname.
  fm_data-tech-as4local = a0_maindata-as4local.
  fm_data-tech-as4vers = a0_maindata-as4vers.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-viewname = fm_data-header-viewname.
    s_text-ddlanguage = &lt;t&gt;-langu.
    s_text-as4local = &apos;A&apos;. &quot; Active
    s_text-as4vers = &apos;0000&apos;. &quot; Active
    s_text-ddtext = &lt;t&gt;-short_txt.
    INSERT s_text INTO TABLE fm_data-texts.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      IF fm_data-docs IS INITIAL.
        s_doc-application = &apos;DOKU&apos;.
        s_doc-id = doc_ids-header.
        s_doc-object = fm_data-header-viewname.
        s_doc-langu = &lt;t&gt;-langu.
        s_doc-masterlang = abap_true.
        s_doc-typ = &apos;E&apos;.
        s_doc-dokform = &apos;S_DOCU_SHOW&apos;.
        s_doc-dokstyle = &apos;S_DOCUS1&apos;.
        INSERT s_doc INTO TABLE fm_data-docs.
      ENDIF.
      READ TABLE fm_data-docs ASSIGNING &lt;d&gt; INDEX 1.
      s_dtxt = &lt;t&gt;-long_txt.
      s_dtxt-tdspras = &lt;t&gt;-langu.
      INSERT s_dtxt INTO TABLE &lt;d&gt;-texts.
    ENDIF.
  ENDLOOP.
  fm_data-tables = tables.        s_table-viewname = a0_maindata-viewname.
  MODIFY fm_data-tables FROM s_table TRANSPORTING viewname WHERE viewname &lt;&gt; s_table-viewname.
  fm_data-fields = fields.        s_field-viewname = a0_maindata-viewname.
  MODIFY fm_data-fields FROM s_field TRANSPORTING viewname WHERE viewname &lt;&gt; s_field-viewname.
  fm_data-joins = inner_join.     s_join-viewname = a0_maindata-viewname.
  MODIFY fm_data-joins FROM s_join TRANSPORTING viewname WHERE viewname &lt;&gt; s_join-viewname.
  fm_data-wheres = conditions.    s_where-condname = a0_maindata-viewname.
  MODIFY fm_data-wheres FROM s_where TRANSPORTING condname WHERE condname &lt;&gt; s_where-condname.
ENDMETHOD.
method UNANONYMIZE.
endmethod.
endclass. &quot;ZAPLINK_VIEW_DATA implementation
class ZAPLINK_CX_COMPONENT implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_COMPONENT .
 ENDIF.
me-&gt;NAME = NAME .
me-&gt;TYPE = TYPE .
me-&gt;CONNCLASS = CONNCLASS .
me-&gt;OBJTYPE = OBJTYPE .
endmethod.
endclass. &quot;ZAPLINK_CX_COMPONENT implementation
class ZAPLINK_CX_CONNECTOR implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_CONNECTOR .
 ENDIF.
me-&gt;NAME = NAME .
me-&gt;TYPE = TYPE .
me-&gt;DEVCLASS = DEVCLASS .
me-&gt;CONNCLASS = CONNCLASS .
me-&gt;CONNUUID = CONNUUID .
me-&gt;NODE_NAME = NODE_NAME .
me-&gt;CONN_VER = CONN_VER .
me-&gt;OTHERCLASS = OTHERCLASS .
endmethod.
endclass. &quot;ZAPLINK_CX_CONNECTOR implementation
class ZAPLINK_CX_CONTAINER implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_CONTAINER .
 ENDIF.
me-&gt;NAME = NAME .
me-&gt;TYPE = TYPE .
endmethod.
endclass. &quot;ZAPLINK_CX_CONTAINER implementation
class ZAPLINK_CX_FILE implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_FILE .
 ENDIF.
me-&gt;FILENAME = FILENAME .
me-&gt;FILETYPE = FILETYPE .
me-&gt;FILEKIND = FILEKIND .
endmethod.
endclass. &quot;ZAPLINK_CX_FILE implementation
class ZAPLINK_CX_LIST implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_LIST .
 ENDIF.
me-&gt;NAME = NAME .
me-&gt;TYPE = TYPE .
me-&gt;CONNCLASS = CONNCLASS .
me-&gt;SEL_ACTION = SEL_ACTION .
endmethod.
endclass. &quot;ZAPLINK_CX_LIST implementation
class ZAPLINK_CX_OPTIONS implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_OPTIONS .
 ENDIF.
endmethod.
endclass. &quot;ZAPLINK_CX_OPTIONS implementation
class ZAPLINK_CX_OPT_DEVCLASS implementation.
method CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
_CX_LIST = _CX_LIST
.
 IF textid IS INITIAL.
   me-&gt;textid = ZAPLINK_CX_OPT_DEVCLASS .
 ENDIF.
me-&gt;SUBSTKIND = SUBSTKIND .
me-&gt;DEVCLASS = DEVCLASS .
endmethod.
endclass. &quot;ZAPLINK_CX_OPT_DEVCLASS implementation
class ZAPLINK_FILE implementation.
method GET_FILECONTENT.
result = _content.
endmethod.
method GET_FILENAME.
result = _filename.
endmethod.
method GET_FILETYPE.
result = _filetype.
endmethod.
METHOD load.
  DATA tmptable TYPE table_of_strings.
  DATA cx_name TYPE string.
  DATA cx TYPE REF TO cx_root.
  DATA _cx TYPE REF TO zaplink_cx_file.
  DATA _str LIKE LINE OF tmptable.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF tmptable.
  IF _filetype = c_ft_local.
    CALL METHOD cl_gui_frontend_services=&gt;gui_upload
      EXPORTING
        filename                = _filename
      CHANGING
        data_tab                = tmptable
      EXCEPTIONS
        file_open_error         = 1
        file_read_error         = 2
        no_batch                = 3
        gui_refuse_filetransfer = 4
        invalid_type            = 5
        no_authority            = 6
        unknown_error           = 7
        bad_data_format         = 8
        header_not_allowed      = 9
        separator_not_allowed   = 10
        header_too_long         = 11
        unknown_dp_error        = 12
        access_denied           = 13
        dp_out_of_memory        = 14
        disk_full               = 15
        dp_timeout              = 16
        not_supported_by_gui    = 17
        error_no_gui            = 18
        OTHERS                  = 19.
    IF sy-subrc &lt;&gt; 0.
      CASE sy-subrc.
        WHEN &apos;1&apos;.
          cx_name = &apos;FILE_OPEN_ERROR&apos;.
        WHEN OTHERS.
          cx_name = &apos;OTHERS&apos;.
      ENDCASE.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;load_error
                    filename = _filename
                    filetype = _filetype
                     cx_name = cx_name.
    ENDIF.
  ELSEIF _filetype = c_ft_server.
    TRY.
        OPEN DATASET _filename FOR INPUT IN TEXT MODE ENCODING DEFAULT.
      CATCH cx_root INTO cx.
        CREATE OBJECT _cx
          EXPORTING
            textid   = zaplink_cx_file=&gt;load_error
            filename = _filename
            filetype = _filetype
            previous = cx.
        _cx-&gt;update( ).
        RAISE EXCEPTION _cx.
    ENDTRY.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;load_error
                    filename = _filename
                    filetype = _filetype
                     cx_name = &apos;OPEN DATASET&apos;.
    ENDIF.
    DO.
      TRY.
          READ DATASET _filename INTO _str.
        CATCH cx_root INTO cx.
          CREATE OBJECT _cx
            EXPORTING
              textid   = zaplink_cx_file=&gt;load_error
              filename = _filename
              filetype = _filetype
              previous = cx.
          _cx-&gt;update( ).
          RAISE EXCEPTION _cx.
      ENDTRY.
      IF sy-subrc &lt;&gt; 0.
        EXIT.
      ENDIF.
      APPEND _str TO tmptable.
    ENDDO.
    TRY.
        CLOSE DATASET _filename.
      CATCH cx_root INTO cx.
        CREATE OBJECT _cx
          EXPORTING
            textid   = zaplink_cx_file=&gt;load_error
            filename = _filename
            filetype = _filetype
            previous = cx.
        _cx-&gt;update( ).
        RAISE EXCEPTION _cx.
    ENDTRY.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;load_error
                    filename = _filename
                    filetype = _filetype
                     cx_name = &apos;CLOSE DATASET&apos;.
    ENDIF.
  ELSE.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                  filetype = _filetype.
  ENDIF.
  CLEAR _content.
  LOOP AT tmptable ASSIGNING &lt;s&gt;.
    CONCATENATE _content &lt;s&gt; cl_abap_char_utilities=&gt;newline
                INTO _content.
  ENDLOOP.
ENDMETHOD.
METHOD load_dialog.
  DATA ft TYPE filetable.
  DATA filecount TYPE i.
  DATA cx_name TYPE string.
  IF _filetype = c_ft_local.
    CALL METHOD cl_gui_frontend_services=&gt;file_open_dialog
      EXPORTING
        default_filename        = filename
      CHANGING
        file_table              = ft
        rc                      = filecount
      EXCEPTIONS
        file_open_dialog_failed = 1
        cntl_error              = 2
        error_no_gui            = 3
        not_supported_by_gui    = 4
        OTHERS                  = 5.
    IF sy-subrc &lt;&gt; 0 OR filecount &lt; 0.
      CASE sy-subrc.
        WHEN &apos;1&apos;.
          cx_name = &apos;file_open_dialog_failed&apos;.
        WHEN OTHERS.
          cx_name = &apos;OTHERS&apos;.
      ENDCASE.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;load_error
                    filename = filename
                    filetype = _filetype
                     cx_name = cx_name.
    ENDIF.
    IF filecount = 0 OR ft IS INITIAL.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;dialog_canceled
                    filename = filename
                    filetype = _filetype.
    ENDIF.
    READ TABLE ft INTO _filename INDEX 1.
  ELSEIF _filetype = c_ft_server.
  ELSE.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                  filetype = _filetype.
  ENDIF.
ENDMETHOD.
METHOD save.
  DATA tmptable  TYPE table_of_strings.
  DATA o_cx      TYPE REF TO cx_root.
  DATA o_cx_file TYPE REF TO zaplink_cx_file.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF tmptable.
  SPLIT _content AT cl_abap_char_utilities=&gt;newline
            INTO TABLE tmptable.
  IF _filetype = c_ft_local.
    IF _filename IS INITIAL.
      save_dialog( ).
    ELSE.
      CALL FUNCTION &apos;GUI_DOWNLOAD&apos;
        EXPORTING
          filename                        = _filename
          filetype                        = &apos;DAT&apos;
          show_transfer_status            = abap_false
        TABLES
          data_tab                        = tmptable
        EXCEPTIONS
          file_write_error                = 1
          no_batch                        = 2
          gui_refuse_filetransfer         = 3
          invalid_type                    = 4
          no_authority                    = 5
          unknown_error                   = 6
          header_not_allowed              = 7
          separator_not_allowed           = 8
          filesize_not_allowed            = 9
          header_too_long                 = 10
          dp_error_create                 = 11
          dp_error_send                   = 12
          dp_error_write                  = 13
          unknown_dp_error                = 14
          access_denied                   = 15
          dp_out_of_memory                = 16
          disk_full                       = 17
          dp_timeout                      = 18
          file_not_found                  = 19
          dataprovider_exception          = 20
          control_flush_error             = 21
          OTHERS                          = 22.
      IF sy-subrc &lt;&gt; 0.
        TRY.
            o_cx_file ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;GUI_DOWNLOAD&apos;
                                                           subrc = sy-subrc
                                                       classname = &apos;ZAPLINK_CX_FILE&apos;
                                                          textid = zaplink_cx_file=&gt;save_error ).
            o_cx_file-&gt;filename = _filename.
            o_cx_file-&gt;filetype = _filetype.
          CATCH cx_root INTO o_cx.
            CREATE OBJECT o_cx_file
              EXPORTING
                textid   = zaplink_cx_file=&gt;save_error
                filename = _filename
                filetype = _filetype
                previous = o_cx.
            o_cx_file-&gt;update( ).
            RAISE EXCEPTION o_cx_file.
        ENDTRY.
        RAISE EXCEPTION o_cx_file.
      ENDIF.
    ENDIF.
  ELSEIF _filetype = c_ft_server.
    TRY.
        OPEN DATASET _filename FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
      CATCH cx_root INTO o_cx.
        CREATE OBJECT o_cx_file
          EXPORTING
            textid   = zaplink_cx_file=&gt;save_error
            filename = _filename
            filetype = _filetype
            previous = o_cx.
        o_cx_file-&gt;update( ).
        RAISE EXCEPTION o_cx_file.
    ENDTRY.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;save_error
                    filename = _filename
                    filetype = _filetype
                     cx_name = &apos;OPEN DATASET&apos;.
    ENDIF.
    LOOP AT tmptable ASSIGNING &lt;s&gt;.
      TRY.
          TRANSFER &lt;s&gt; TO _filename.
        CATCH cx_root INTO o_cx.
          CREATE OBJECT o_cx_file
            EXPORTING
              textid   = zaplink_cx_file=&gt;save_error
              filename = _filename
              filetype = _filetype
              previous = o_cx.
          o_cx_file-&gt;update( ).
          RAISE EXCEPTION o_cx_file.
      ENDTRY.
    ENDLOOP.
    TRY.
        CLOSE DATASET _filename.
      CATCH cx_root INTO o_cx.
        CREATE OBJECT o_cx_file
          EXPORTING
            textid   = zaplink_cx_file=&gt;save_error
            filename = _filename
            filetype = _filetype
            previous = o_cx.
        o_cx_file-&gt;update( ).
        RAISE EXCEPTION o_cx_file.
    ENDTRY.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;save_error
                    filename = _filename
                    filetype = _filetype
                     cx_name = &apos;CLOSE DATASET&apos;.
    ENDIF.
  ELSE.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                  filetype = _filetype.
  ENDIF.
ENDMETHOD.
method SAVE_DIALOG.
DATA retfilename TYPE string.
  DATA retpath TYPE string.
  DATA retfullpath TYPE string.
  DATA retuseract TYPE i.
  IF filename IS INITIAL.
    retfilename = _filename.
  ELSE.
    retfilename = filename.
  ENDIF.
  IF _filetype = c_ft_local.
    CALL METHOD cl_gui_frontend_services=&gt;file_save_dialog
      EXPORTING
        default_file_name = retfilename
      CHANGING
        filename          = retfilename
        path              = retpath
        fullpath          = retfullpath
        user_action       = retuseract.
    IF retuseract &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;dialog_canceled
                    filename = filename
                    filetype = _filetype.
    ENDIF.
    _filename = retfullpath.    &quot; Issue 69
  ELSEIF _filetype = c_ft_server.
  ELSE.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                  filetype = _filetype.
  ENDIF.
endmethod.
method SET_FILECONTENT.
_content = data.
endmethod.
method SET_FILENAME.
IF data IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filename
                  filename = data
                  filetype = _filetype.
  ENDIF.
  IF NOT _filetype IS INITIAL.
  ENDIF.
  _filename = data.
endmethod.
method SET_FILETYPE.
IF data &lt;&gt; c_ft_local AND data &lt;&gt; c_ft_server.
    RAISE EXCEPTION TYPE zaplink_cx_file
          EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                  filetype = data.
  ENDIF.
  IF NOT _filename IS INITIAL.
  ENDIF.
  _filetype = data.
endmethod.
METHOD file_exists.
  DATA tmptable TYPE table_of_strings.
  DATA cx_name TYPE string.
  DATA cx TYPE REF TO cx_root.
  DATA _cx TYPE REF TO zaplink_cx_file.
  DATA _str LIKE LINE OF tmptable.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF tmptable.
  CASE _filetype.
    WHEN c_ft_local.
      CALL METHOD cl_gui_frontend_services=&gt;file_exist
        EXPORTING
          file                 = _filename
        RECEIVING
          result               = result
        EXCEPTIONS
          cntl_error           = 1
          error_no_gui         = 2
          wrong_parameter      = 3
          not_supported_by_gui = 4
          OTHERS               = 5.
      IF sy-subrc &lt;&gt; 0.
        CASE sy-subrc.
          WHEN &apos;1&apos;.
            cx_name = &apos;FILE_OPEN_ERROR&apos;.
          WHEN OTHERS.
            cx_name = &apos;OTHERS&apos;.
        ENDCASE.
        RAISE EXCEPTION TYPE zaplink_cx_file
              EXPORTING textid = zaplink_cx_file=&gt;load_error
                      filename = _filename
                      filetype = _filetype
                       cx_name = cx_name.
      ENDIF.
    WHEN c_ft_server.
      TRY.
          OPEN DATASET _filename FOR INPUT IN TEXT MODE ENCODING DEFAULT.
        CATCH cx_root INTO cx.
          CREATE OBJECT _cx
            EXPORTING
              textid   = zaplink_cx_file=&gt;load_error
              filename = _filename
              filetype = _filetype
              previous = cx.
          _cx-&gt;update( ).
          RAISE EXCEPTION _cx.
      ENDTRY.
      IF sy-subrc &lt;&gt; 0.
        result = abap_false.
        EXIT.
      ENDIF.
      result = abap_true.
      TRY.
          CLOSE DATASET _filename.
        CATCH cx_root INTO cx.
          EXIT.
      ENDTRY.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_file
            EXPORTING textid = zaplink_cx_file=&gt;invalid_filetype
                    filetype = _filetype.
  ENDCASE.
ENDMETHOD.
endclass. &quot;ZAPLINK_FILE implementation
class ZAPLINK_MESSAGE_COLLECTOR implementation.
DEFINE mac_symsg_send.
  message id sy-msgid type sy-msgty number sy-msgno
          with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
END-OF-DEFINITION.
DEFINE mac_symsg_send_as_type.
  message id sy-msgid type &amp;1 number sy-msgno
          display like sy-msgty
          with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
END-OF-DEFINITION.
DEFINE mac_symsg_raise.
  message id sy-msgid type sy-msgty number sy-msgno
          with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
          raising &amp;1.
END-OF-DEFINITION.
DEFINE mac_symsg_raise_as_type.
  message id sy-msgid type &amp;1 number sy-msgno
          with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
          raising &amp;2.
END-OF-DEFINITION.
DEFINE mac_symsg_raise_on_subrc.
  if sy-subrc = &amp;1.
    message id sy-msgid type sy-msgty number sy-msgno
            with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
            raising &amp;2.
  endif.
END-OF-DEFINITION.
DEFINE mac_symsg_into_text.
  message id sy-msgid type sy-msgty number sy-msgno
          with sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
          into &amp;1.
END-OF-DEFINITION.
DEFINE mac_symsg_set.
  sy-msgid = &amp;1.
  sy-msgty = &amp;2.
  sy-msgno = &amp;3.
  sy-msgv1 = &amp;4.
  sy-msgv2 = &amp;5.
  sy-msgv3 = &amp;6.
  sy-msgv4 = &amp;7.
END-OF-DEFINITION.
DEFINE mac_symsg_set_from_msg.
  sy-msgid = &amp;1-msgid.
  sy-msgty = &amp;1-msgty.
  sy-msgno = &amp;1-msgno.
  sy-msgv1 = &amp;1-msgv1.
  sy-msgv2 = &amp;1-msgv2.
  sy-msgv3 = &amp;1-msgv3.
  sy-msgv4 = &amp;1-msgv4.
END-OF-DEFINITION.
DEFINE mac_msg_set_from_symsg.
  &amp;1-msgid = sy-msgid.
  &amp;1-msgty = sy-msgty.
  &amp;1-msgno = sy-msgno.
  &amp;1-msgv1 = sy-msgv1.
  &amp;1-msgv2 = sy-msgv2.
  &amp;1-msgv3 = sy-msgv3.
  &amp;1-msgv4 = sy-msgv4.
END-OF-DEFINITION.
DEFINE mac_bapimsg_to_symsg.
  sy-msgty = &amp;1-type.
  sy-msgid = &amp;1-id.
  sy-msgno = &amp;1-number.
  sy-msgv1 = &amp;1-message_v1.
  sy-msgv2 = &amp;1-message_v2.
  sy-msgv3 = &amp;1-message_v3.
  sy-msgv4 = &amp;1-message_v4.
END-OF-DEFINITION.
DEFINE mac_msg_to_bapimsg.
  call function &apos;BALW_BAPIRETURN_GET2&apos;
    exporting
      type       = &amp;1-msgty
      cl         = &amp;1-msgid
      number     = &amp;1-msgno
      par1       = &amp;1-msgv1
      par2       = &amp;1-msgv2
      par3       = &amp;1-msgv3
      par4       = &amp;1-msgv4
    importing
      return     = &amp;2.
END-OF-DEFINITION.
DEFINE mac_msglist_add.
  call method &amp;1-&gt;add
    exporting
      id_msgty = &amp;2
      id_msgid = &amp;3
      id_msgno = &amp;4
      id_msgv1 = &amp;5
      id_msgv2 = &amp;6
      id_msgv3 = &amp;7
      id_msgv4 = &amp;8.
END-OF-DEFINITION.
DEFINE mac_symsg_format_out.
  write &amp;1 to &amp;2 left-justified.
  condense &amp;2.
END-OF-DEFINITION.
DEFINE mac_symsg_format_num.
  if &amp;1 is not initial.
    write &amp;1 to &amp;2 no-zero.
    condense &amp;2.
  else.
    clear &amp;2.
  endif.
END-OF-DEFINITION.
DEFINE mac_invalid_precondition.
  assert 0 = 1.
END-OF-DEFINITION.
DEFINE mac_invalid_postcondition.
  assert 0 = 1.
END-OF-DEFINITION.
DEFINE mac_assert_initial.
  assert fields &amp;1 condition &amp;1 is initial.
END-OF-DEFINITION.
DEFINE mac_assert_not_initial.
  assert &amp;1 is not initial.
END-OF-DEFINITION.
DEFINE mac_assert_ref.
  assert &amp;1 is bound.
END-OF-DEFINITION.
DEFINE mac_assert_subrc.
  assert fields sy-subrc condition sy-subrc = 0.
END-OF-DEFINITION.
DEFINE mac_switch_flag.
  if &amp;1 &lt;&gt; &apos; &apos;.
    &amp;1 = &apos; &apos;.
  else.
    &amp;1 = &apos;X&apos;.
  endif.
END-OF-DEFINITION.
DEFINE mac_clear_date_if_initial.
  if is_date_initial( &amp;1 ) = abap_true.
    clear &amp;1.
  endif.
END-OF-DEFINITION.
method ADD.
DATA:
    ls_message    TYPE bal_s_msg,
    ls_par        LIKE LINE OF ls_message-params-t_par,
    ld_parcontext TYPE balpval.
  DEFINE mac_append_par.
    if &amp;2 is not initial.
      ls_par-parname  = &amp;1.
      ls_par-parvalue = &amp;2.
      append ls_par to ls_message-params-t_par.
    endif.
  END-OF-DEFINITION.
  CLEAR es_message.
  IF is_message IS NOT INITIAL.
    ls_message = is_message.
  ELSE.
    ls_message-msgty = id_msgty.
    IF id_msgid IS INITIAL.
      ls_message-msgid = msgid.
    ELSE.
      ls_message-msgid = id_msgid.
    ENDIF.
    ls_message-msgno = id_msgno.
    IF id_msgv1 IS SUPPLIED.
      ls_message-msgv1 = id_msgv1.
    ELSEIF id_msgd1 IS SUPPLIED.
      CALL METHOD convert_date_to_string
        EXPORTING
          id_date        = id_msgd1
        IMPORTING
          ed_date_string = ls_message-msgv1.
    ENDIF.
    IF id_msgv2 IS SUPPLIED.
      ls_message-msgv2 = id_msgv2.
    ELSEIF id_msgd2 IS SUPPLIED.
      CALL METHOD convert_date_to_string
        EXPORTING
          id_date        = id_msgd2
        IMPORTING
          ed_date_string = ls_message-msgv2.
    ENDIF.
    IF id_msgv3 IS SUPPLIED.
      ls_message-msgv3 = id_msgv3.
    ELSEIF id_msgd3 IS SUPPLIED.
      CALL METHOD convert_date_to_string
        EXPORTING
          id_date        = id_msgd3
        IMPORTING
          ed_date_string = ls_message-msgv3.
    ENDIF.
    IF id_msgv4 IS SUPPLIED.
      ls_message-msgv4 = id_msgv4.
    ELSEIF id_msgd4 IS SUPPLIED.
      CALL METHOD convert_date_to_string
        EXPORTING
          id_date        = id_msgd4
        IMPORTING
          ed_date_string = ls_message-msgv4.
    ENDIF.
    ls_message-detlevel  = id_detlevel.
    ls_message-probclass = id_probclass.
  ENDIF.
  IF ( ls_message-msgty NA &apos;ISWEAX&apos; ) OR
     ( ls_message-msgid IS INITIAL  ).
    MESSAGE ID ls_message-msgid TYPE ls_message-msgty NUMBER ls_message-msgno
            WITH ls_message-msgv1 ls_message-msgv2 ls_message-msgv3 ls_message-msgv4.
  ENDIF.
  IF ls_message-detlevel NOT BETWEEN mc_min_level AND mc_max_level.
    ls_message-detlevel = md_level.
  ENDIF.
  IF ls_message-probclass IS INITIAL.
    CASE ls_message-msgty.
      WHEN &apos;I&apos; OR &apos;S&apos;.       ls_message-probclass = &apos;4&apos;.
      WHEN &apos;W&apos;.              ls_message-probclass = &apos;3&apos;.
      WHEN &apos;E&apos;.              ls_message-probclass = &apos;2&apos;.
      WHEN &apos;A&apos; OR &apos;X&apos;.       ls_message-probclass = &apos;1&apos;.
    ENDCASE.
  ENDIF.
  IF if_cumulate = abap_true.
    CALL FUNCTION &apos;BAL_LOG_MSG_CUMULATE&apos;
      EXPORTING
        i_log_handle         = md_handle
        i_s_msg              = ls_message
        i_compare_attributes = abap_true       &quot; compare attributes
        i_compare_context    = abap_true       &quot; and context
        i_compare_parameters = abap_false
      EXCEPTIONS
        log_not_found        = 1
        msg_inconsistent     = 2
        log_is_full          = 3
        OTHERS               = 4.
  ELSE.
    CALL FUNCTION &apos;BAL_LOG_MSG_ADD&apos;
      EXPORTING
        i_log_handle     = md_handle
        i_s_msg          = ls_message
      EXCEPTIONS
        log_not_found    = 1
        msg_inconsistent = 2
        log_is_full      = 3
        OTHERS           = 4.
  ENDIF.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_send_as_type &apos;A&apos;.
  ELSE.
    es_message = ls_message.
  ENDIF.
endmethod.
method ADD_ABEND.
DATA: _detlevel TYPE ballevel.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  CALL METHOD add
    EXPORTING
      id_msgty     = &apos;A&apos;
      id_msgid     = ID_MSGID
      id_msgno     = id_msgno
      id_msgv1     = id_msgv1
      id_msgv2     = id_msgv2
      id_msgv3     = id_msgv3
      id_msgv4     = id_msgv4
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
endmethod.
method ADD_ERROR.
DATA: _detlevel TYPE ballevel.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  CALL METHOD add
    EXPORTING
      id_msgty     = &apos;E&apos;
      id_msgid     = ID_MSGID
      id_msgno     = id_msgno
      id_msgv1     = id_msgv1
      id_msgv2     = id_msgv2
      id_msgv3     = id_msgv3
      id_msgv4     = id_msgv4
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
endmethod.
METHOD add_exception.
  DATA _detlevel  TYPE ballevel.
  DATA cx_text    TYPE string.
  DATA o_ref      TYPE REF TO cl_abap_refdescr.
  DATA o_obj      TYPE REF TO cl_abap_classdescr.
  DATA prog       TYPE syrepid.
  DATA include    TYPE syrepid.
  DATA line       TYPE i.
  DATA cx_src_pos TYPE string.
  DATA o_zl_cx    TYPE REF TO zaplink_cx.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  TRY.
      o_zl_cx ?= exception.
    CATCH cx_root.
  ENDTRY.
  IF o_zl_cx IS BOUND.
    CALL METHOD _add_zl_cx
      EXPORTING
        exception    = o_zl_cx
        id_detlevel  = id_detlevel
        id_probclass = id_probclass.
    EXIT.
  ENDIF.
  IF exception-&gt;previous IS BOUND.
    ADD 1 TO _detlevel.
    CALL METHOD add_exception
      EXPORTING
        exception    = exception-&gt;previous
        id_detlevel  = _detlevel
        id_probclass = id_probclass.
    SUBTRACT 1 FROM _detlevel.
  ENDIF.
  o_ref ?= cl_abap_classdescr=&gt;describe_by_data( p_data = exception ).
  o_obj ?= get_ref_type( o_ref ).
  CALL METHOD exception-&gt;get_source_position
    IMPORTING
      program_name = prog
      include_name = include
      source_line  = line.
  cx_src_pos = line.
  IF include IS INITIAL.
    CONCATENATE prog &apos; @&apos; cx_src_pos INTO cx_src_pos.
  ELSE.
    CONCATENATE include &apos;(&apos; prog &apos;) @&apos; cx_src_pos INTO cx_src_pos.
  ENDIF.
  cx_text = exception-&gt;if_message~get_text( ).
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE e002(zaplink_easyxml) WITH abap_true abap_true abap_true. ENDIF.
  SET EXTENDED CHECK ON.
  CALL METHOD add_error
    EXPORTING
      id_msgid     = &apos;ZAPLINK_EASYXML&apos;
      id_msgno     = &apos;002&apos;
      id_msgv1     = o_obj-&gt;absolute_name
      id_msgv2     = cx_text
      id_msgv3     = cx_src_pos
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
ENDMETHOD.
method ADD_FROM_BAPI.
FIELD-SYMBOLS:
    &lt;ls_bapiret&gt; LIKE is_bapiret.
  ef_add_error   = abap_false.
  ef_add_warning = abap_false.
  LOOP AT it_bapiret ASSIGNING &lt;ls_bapiret&gt;.
    CALL METHOD add
      EXPORTING
        id_msgty     = &lt;ls_bapiret&gt;-type
        id_msgid     = &lt;ls_bapiret&gt;-id
        id_msgno     = &lt;ls_bapiret&gt;-number
        id_msgv1     = &lt;ls_bapiret&gt;-message_v1
        id_msgv2     = &lt;ls_bapiret&gt;-message_v2
        id_msgv3     = &lt;ls_bapiret&gt;-message_v3
        id_msgv4     = &lt;ls_bapiret&gt;-message_v4
        if_cumulate  = if_cumulate.
    IF ( &lt;ls_bapiret&gt;-type = &apos;E&apos; ) OR
       ( &lt;ls_bapiret&gt;-type = &apos;A&apos; ).
      ef_add_error   = abap_true.
    ELSEIF ( &lt;ls_bapiret&gt;-type = &apos;W&apos; ).
      ef_add_warning = abap_true.
    ENDIF.
  ENDLOOP.
  IF is_bapiret IS NOT INITIAL.
    CALL METHOD add
      EXPORTING
        id_msgty     = is_bapiret-type
        id_msgid     = is_bapiret-id
        id_msgno     = is_bapiret-number
        id_msgv1     = is_bapiret-message_v1
        id_msgv2     = is_bapiret-message_v2
        id_msgv3     = is_bapiret-message_v3
        id_msgv4     = is_bapiret-message_v4
        if_cumulate  = if_cumulate.
    IF ( is_bapiret-type = &apos;E&apos; ) OR
       ( is_bapiret-type = &apos;A&apos; ).
      ef_add_error   = abap_true.
    ELSEIF ( is_bapiret-type = &apos;W&apos; ).
      ef_add_warning = abap_true.
    ENDIF.
  ENDIF.
endmethod.
method ADD_FROM_INSTANCE.
DATA:
    lt_msglist            TYPE t_msg,
    ls_msglist            TYPE BAL_S_MSG,
    ld_num_max_level      TYPE int1 VALUE mc_max_level,
    ld_num_detlevel_diff  TYPE int1,
    ld_num_detlevel_other TYPE int1,
    lf_cumulate           TYPE abap_bool.
  FIELD-SYMBOLS:
    &lt;ls_msglist&gt;          LIKE LINE OF lt_msglist.
  IF io_msglist IS NOT BOUND.
    mac_invalid_precondition.
  ENDIF.
  lt_msglist = io_msglist-&gt;get_list( ).
  CHECK lt_msglist IS NOT INITIAL.
  lf_cumulate = if_cumulate.
  IF if_add_as_subnode = abap_true.
    set_detail_level( id_relative = 1 ).
    lf_cumulate = abap_false.
  ENDIF.
  LOOP AT lt_msglist ASSIGNING &lt;ls_msglist&gt;.
    MOVE-CORRESPONDING &lt;ls_msglist&gt; TO ls_msglist.
    CLEAR:
      ls_msglist-time_stmp,
      ls_msglist-msg_count.
    IF ls_msglist-detlevel NOT BETWEEN mc_min_level AND mc_max_level.
      ls_msglist-detlevel = md_level.
    ELSEIF md_level = mc_min_level.
    ELSE.
      ld_num_detlevel_diff  = md_level - 1.
      ld_num_detlevel_other = ls_msglist-detlevel.
      ADD ld_num_detlevel_diff TO ld_num_detlevel_other.
      IF ld_num_detlevel_other &lt;= ld_num_max_level.
        ls_msglist-detlevel = ld_num_detlevel_other.
      ELSE.
        ls_msglist-detlevel = mc_max_level.
      ENDIF.
    ENDIF.
    add( is_message  = ls_msglist
         if_cumulate = lf_cumulate ).
  ENDLOOP.
  IF if_add_as_subnode = abap_true.
    set_detail_level( id_relative = -1 ).
  ENDIF.
endmethod.
method ADD_INFO.
DATA: _detlevel TYPE ballevel.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  CALL METHOD add
    EXPORTING
      id_msgty     = &apos;I&apos;
      id_msgid     = ID_MSGID
      id_msgno     = id_msgno
      id_msgv1     = id_msgv1
      id_msgv2     = id_msgv2
      id_msgv3     = id_msgv3
      id_msgv4     = id_msgv4
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
endmethod.
method ADD_SUCCESS.
DATA: _detlevel TYPE ballevel.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  CALL METHOD add
    EXPORTING
      id_msgty     = &apos;I&apos;
      id_msgid     = ID_MSGID
      id_msgno     = id_msgno
      id_msgv1     = id_msgv1
      id_msgv2     = id_msgv2
      id_msgv3     = id_msgv3
      id_msgv4     = id_msgv4
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
endmethod.
method ADD_SYMSG.
  DATA ls_symsg TYPE symsg.
  check not sy-msgid is INITIAL AND
        not sy-msgno is INITIAL.
  ls_symsg-msgty = id_msgty.
  ls_symsg-msgid = sy-msgid.
  ls_symsg-msgno = sy-msgno.
  ls_symsg-msgv1 = sy-msgv1.
  ls_symsg-msgv2 = sy-msgv2.
  ls_symsg-msgv3 = sy-msgv3.
  ls_symsg-msgv4 = sy-msgv4.
  CALL METHOD add
    EXPORTING
      id_msgty     = ls_symsg-msgty
      id_msgid     = ls_symsg-msgid
      id_msgno     = ls_symsg-msgno
      id_msgv1     = ls_symsg-msgv1
      id_msgv2     = ls_symsg-msgv2
      id_msgv3     = ls_symsg-msgv3
      id_msgv4     = ls_symsg-msgv4
      if_cumulate  = if_cumulate
      id_detlevel  = id_detlevel
      id_probclass = id_probclass
      id_index     = id_index
    IMPORTING
      es_message   = es_message.
endmethod.
method ADD_WARNING.
DATA: _detlevel TYPE ballevel.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  CALL METHOD add
    EXPORTING
      id_msgty     = &apos;W&apos;
      id_msgid     = ID_MSGID
      id_msgno     = id_msgno
      id_msgv1     = id_msgv1
      id_msgv2     = id_msgv2
      id_msgv3     = id_msgv3
      id_msgv4     = id_msgv4
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
endmethod.
method AS_CHAR.
  CALL FUNCTION &apos;CONVERT_DATE_TO_EXTERNAL&apos;
    EXPORTING
      date_internal            = id_date
    IMPORTING
      date_external            = rd_date
    EXCEPTIONS
      date_internal_is_invalid = 1
      OTHERS                   = 2.
  IF sy-subrc &lt;&gt; 0.
    CLEAR rd_date.
  ENDIF.
endmethod.
method CHANGE_MSG_TYPE.
DATA:
    lt_log_handle   TYPE bal_t_logh,
    lt_msg_handle   TYPE bal_t_msgh,
    ls_msg          TYPE bal_s_msg.
  FIELD-SYMBOLS:
    &lt;ls_msg_handle&gt; LIKE LINE OF lt_msg_handle.
  IF ( id_msgty_src NA &apos; AEISWX&apos; ) OR
     ( id_msgty_trg NA &apos;AEISWX&apos;  ).
    mac_invalid_precondition.
  ENDIF.
  CHECK id_msgty_src &lt;&gt; id_msgty_trg.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
    IMPORTING
      e_t_msg_handle = lt_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    RETURN.
  ENDIF.
  LOOP AT lt_msg_handle ASSIGNING &lt;ls_msg_handle&gt;.
    CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
      EXPORTING
        i_s_msg_handle = &lt;ls_msg_handle&gt;
      IMPORTING
        e_s_msg        = ls_msg
      EXCEPTIONS
        log_not_found  = 1
        msg_not_found  = 2
        OTHERS         = 3.
    IF sy-subrc = 0.
      IF ( id_msgty_src IS INITIAL     ) OR
         ( id_msgty_src = ls_msg-msgty ).
        ls_msg-msgty = id_msgty_trg.
        CALL FUNCTION &apos;BAL_LOG_MSG_CHANGE&apos;
          EXPORTING
            i_s_msg_handle = &lt;ls_msg_handle&gt;
            i_s_msg        = ls_msg
          EXCEPTIONS
            OTHERS         = 1.
        IF sy-subrc = 0.
          ADD 1 TO rd_changed.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDLOOP.
endmethod.
METHOD check_custo.
  DATA _commit  TYPE flag.
  DATA obj      TYPE balobj.
  DATA obj_t    TYPE balobjt.
  DATA sobj     TYPE balsub.
  DATA sobj_t   TYPE balsubt.
  DATA str      TYPE string.
  FIELD-SYMBOLS:
    &lt;t_balobj&gt; TYPE ANY,
    &lt;s_balobj&gt; TYPE ANY,
    &lt;t_balsub&gt; TYPE ANY,
    &lt;s_balsub&gt; TYPE ANY.
  obj-object = id_object.
  CALL FUNCTION &apos;BAL_OBJECT_SELECT&apos;
    EXPORTING
      i_object                      = id_object
   EXCEPTIONS
     object_not_found              = 1
     OTHERS                        = 2
            .
  IF sy-subrc &lt;&gt; 0.
    INSERT balobj FROM obj.
    obj_t-spras = sy-langu.
    obj_t-object = obj-object.
    obj_t-objtxt = &apos;Entry auto created by ZAPLINK_MESSAGE_COLLECTOR&apos;(blt).
    INSERT balobjt FROM obj_t.
    _commit = abap_true.
  ENDIF.
  sobj-object = obj-object.
  sobj-subobject = id_subobject.
  SELECT SINGLE * INTO sobj
    FROM balsub
    WHERE    object = sobj-object
      AND subobject = sobj-subobject.
  IF sy-subrc &lt;&gt; 0.
    INSERT balsub FROM sobj.
    sobj_t-spras = sy-langu.
    sobj_t-object = sobj-object.
    sobj_t-subobject = sobj-subobject.
    sobj_t-subobjtxt = &apos;Entry auto created by ZAPLINK_MESSAGE_COLLECTOR&apos;(blt).
    INSERT balsubt FROM sobj_t.
    _commit = abap_true.
  ENDIF.
  IF NOT _commit IS INITIAL.
    str = &apos;(SAPLSBAL_SERVICE)g_balobj[]&apos;.  ASSIGN (str) TO &lt;t_balobj&gt;.
    IF sy-subrc = 0. CLEAR &lt;t_balobj&gt;.  UNASSIGN &lt;t_balobj&gt;.  ENDIF.
    str = &apos;(SAPLSBAL_SERVICE)g_balobj&apos;.    ASSIGN (str) TO &lt;s_balobj&gt;.
    IF sy-subrc = 0. CLEAR &lt;s_balobj&gt;.  UNASSIGN &lt;s_balobj&gt;.  ENDIF.
    str = &apos;(SAPLSBAL_SERVICE)g_balsub[]&apos;.  ASSIGN (str) TO &lt;t_balsub&gt;.
    IF sy-subrc = 0. CLEAR &lt;t_balsub&gt;.  UNASSIGN &lt;t_balsub&gt;.  ENDIF.
    str = &apos;(SAPLSBAL_SERVICE)g_balsub&apos;.    ASSIGN (str) TO &lt;s_balsub&gt;.
    IF sy-subrc = 0. CLEAR &lt;s_balsub&gt;.  UNASSIGN &lt;s_balsub&gt;.  ENDIF.
    COMMIT WORK AND WAIT.
    CALL FUNCTION &apos;BAL_OBJECT_SELECT&apos;
      EXPORTING
        i_object                      = id_object
     EXCEPTIONS
       object_not_found              = 1
       OTHERS                        = 2
              .
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.
ENDMETHOD.
method CLEAR.
  CALL FUNCTION &apos;BAL_LOG_MSG_DELETE_ALL&apos;
    EXPORTING
      i_log_handle = md_handle
    EXCEPTIONS
      OTHERS       = 0.
  md_level = mc_min_level.
  CLEAR:
    md_sup_count,
    mt_sup_msg.
endmethod.
method CONVERT_DATE_TO_STRING.
  DATA:
    ld_date     TYPE sydatum,
    ld_char(10) TYPE c.
  ld_date = id_date.
  mac_clear_date_if_initial ld_date.
  ld_char = as_char( ld_date ).
  IF ld_char IS INITIAL.
    ld_date = &apos;11111111&apos;.
    ld_char = as_char( ld_date ).
    REPLACE &apos;1&apos; WITH &apos;0&apos; INTO ld_char.
  ENDIF.
  ed_date_string = ld_char.
endmethod.
method COUNT.
DATA:
    lt_log_handle TYPE bal_t_logh,
    lt_msg_handle TYPE bal_t_msgh.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
    IMPORTING
      e_t_msg_handle = lt_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc = 0.
    rd_count = lines( lt_msg_handle ).
  ELSE.
    rd_count = 0.
  ENDIF.
endmethod.
method DELETE_MESSAGE.
DATA:
    ls_msg_handle TYPE balmsghndl.
  ls_msg_handle-log_handle = md_handle.
  ls_msg_handle-msgnumber  = id_msgnumber.
  CALL FUNCTION &apos;BAL_LOG_MSG_DELETE&apos;
    EXPORTING
      i_s_msg_handle = ls_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      log_not_found  = 2
      OTHERS         = 3.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise not_found.
  ENDIF.
endmethod.
method FREE.
  IF mf_log_not_stored = abap_false.
    CALL FUNCTION &apos;BAL_LOG_REFRESH&apos;
    EXPORTING
      i_log_handle = md_handle
    EXCEPTIONS
      OTHERS       = 0.
  ENDIF.
  CLEAR md_handle.
  CLEAR ms_log.
endmethod.
method GET_FIRST_MESSAGE.
DATA:
    lt_log_handle TYPE bal_t_logh,
    lt_msg_handle TYPE bal_t_msgh,
    ls_msg_filter TYPE bal_s_mfil,
    ld_msg_handle TYPE balmsghndl,
    ls_msg        TYPE bal_s_msg.
  CLEAR es_message.
  IF id_msgty NA &apos;IWEA&apos;.
    mac_invalid_precondition.
  ENDIF.
  CALL METHOD get_msg_filter
    EXPORTING
      id_msgty      = id_msgty
      if_or_higher  = if_or_higher
    IMPORTING
      es_msg_filter = ls_msg_filter.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
      i_s_msg_filter = ls_msg_filter
    IMPORTING
      e_t_msg_handle = lt_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise not_found.
  ENDIF.
  READ TABLE lt_msg_handle INDEX 1 INTO ld_msg_handle.
  CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
    EXPORTING
      i_s_msg_handle = ld_msg_handle
    IMPORTING
      e_s_msg        = ls_msg
    EXCEPTIONS
      log_not_found  = 1
      msg_not_found  = 2
      OTHERS         = 3.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise not_found.
  ENDIF.
  es_message = ls_msg.
endmethod.
method GET_HANDLE.
  rd_handle = md_handle.
endmethod.
method GET_LAST_MESSAGE.
DATA:
    lt_log_handle TYPE bal_t_logh,
    lt_msg_handle TYPE bal_t_msgh,
    ls_msg_filter TYPE bal_s_mfil,
    ld_msg_handle TYPE balmsghndl,
    ls_msg        TYPE bal_s_msg,
    ld_count      TYPE i.
  CLEAR es_message.
  IF id_msgty NA &apos;IWEA&apos;.
    mac_invalid_precondition.
  ENDIF.
  CALL METHOD get_msg_filter
    EXPORTING
      id_msgty      = id_msgty
      if_or_higher  = if_or_higher
    IMPORTING
      es_msg_filter = ls_msg_filter.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
      i_s_msg_filter = ls_msg_filter
    IMPORTING
      e_t_msg_handle = lt_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise not_found.
  ENDIF.
  ld_count = lines( lt_msg_handle ).
  READ TABLE lt_msg_handle INDEX ld_count INTO ld_msg_handle.
  CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
    EXPORTING
      i_s_msg_handle = ld_msg_handle
    IMPORTING
      e_s_msg        = ls_msg
    EXCEPTIONS
      log_not_found  = 1
      msg_not_found  = 2
      OTHERS         = 3.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise not_found.
  ENDIF.
  es_message = ls_msg.
endmethod.
method GET_LIST.
DATA:
    lt_msglist_x   TYPE t_msg_x.
  FIELD-SYMBOLS:
    &lt;ls_msglist_x&gt; LIKE LINE OF lt_msglist_x.
  CLEAR et_list.
  CALL METHOD get_list_x
    IMPORTING
      et_list_x = lt_msglist_x.
  LOOP AT lt_msglist_x ASSIGNING &lt;ls_msglist_x&gt;.
    APPEND &lt;ls_msglist_x&gt;-msg TO et_list.
  ENDLOOP.
endmethod.
method GET_LIST_AS_BAPIRET.
DATA:
    lt_msglist_x  TYPE t_msg_x,
    ls_list       LIKE LINE OF et_list,
    ls_par        TYPE bal_s_par,
    ld_bapi_par   TYPE bapiret2-parameter,
    ld_bapi_field TYPE bapiret2-field,
    ld_bapi_row   TYPE bapiret2-row.
  FIELD-SYMBOLS:
    &lt;ls_msglist_x&gt; LIKE LINE OF lt_msglist_x.
  CLEAR et_list.
  CALL METHOD get_list_x
    IMPORTING
      et_list_x = lt_msglist_x.
  LOOP AT lt_msglist_x ASSIGNING &lt;ls_msglist_x&gt;.
    READ TABLE &lt;ls_msglist_x&gt;-params-t_par INTO ls_par
      WITH KEY parname = &apos;TABNAME&apos;.
    IF sy-subrc = 0.
      ld_bapi_par = ls_par-parvalue.
    ELSE.
      CLEAR ld_bapi_par.
    ENDIF.
    READ TABLE &lt;ls_msglist_x&gt;-params-t_par INTO ls_par
      WITH KEY parname = &apos;FIELDNAME&apos;.
    IF sy-subrc = 0.
      ld_bapi_field = ls_par-parvalue.
    ELSE.
      CLEAR ld_bapi_field.
    ENDIF.
    READ TABLE &lt;ls_msglist_x&gt;-params-t_par INTO ls_par
      WITH KEY parname = &apos;INDEX&apos;.
    IF sy-subrc = 0.
      ld_bapi_row = ls_par-parvalue.
    ELSE.
      ld_bapi_row = 0.
    ENDIF.
    CALL FUNCTION &apos;BALW_BAPIRETURN_GET2&apos;
      EXPORTING
        type       = &lt;ls_msglist_x&gt;-msgty
        cl         = &lt;ls_msglist_x&gt;-msgid
        number     = &lt;ls_msglist_x&gt;-msgno
        par1       = &lt;ls_msglist_x&gt;-msgv1
        par2       = &lt;ls_msglist_x&gt;-msgv2
        par3       = &lt;ls_msglist_x&gt;-msgv3
        par4       = &lt;ls_msglist_x&gt;-msgv4
        parameter  = ld_bapi_par
        row        = ld_bapi_row
        field      = ld_bapi_field
      IMPORTING
        return     = ls_list.
    APPEND ls_list TO et_list.
  ENDLOOP.
endmethod.
method GET_LIST_X.
DATA:
    lt_log_handle   TYPE bal_t_logh,
    lt_msg_handle   TYPE bal_t_msgh,
    ls_msg_filter   TYPE bal_s_mfil,
    ls_msg          TYPE bal_s_msg,
    ls_list_x       LIKE LINE OF et_list_x.
  FIELD-SYMBOLS:
    &lt;ls_msg_handle&gt; LIKE LINE OF lt_msg_handle.
  CLEAR et_list_x.
  IF id_msgty NA &apos;IWEA&apos;.
    mac_invalid_precondition.
  ENDIF.
  CALL METHOD get_msg_filter
    EXPORTING
      id_msgty      = id_msgty
      if_or_higher  = abap_true
    IMPORTING
      es_msg_filter = ls_msg_filter.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
      i_s_msg_filter = ls_msg_filter
    IMPORTING
      e_t_msg_handle = lt_msg_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    RETURN.
  ENDIF.
  LOOP AT lt_msg_handle ASSIGNING &lt;ls_msg_handle&gt;.
    CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
      EXPORTING
        i_s_msg_handle = &lt;ls_msg_handle&gt;
      IMPORTING
        e_s_msg        = ls_msg
      EXCEPTIONS
        log_not_found  = 1
        msg_not_found  = 2
        OTHERS         = 3.
    IF sy-subrc = 0.
      ls_list_x-msg       = ls_msg.
      ls_list_x-msgnumber = &lt;ls_msg_handle&gt;-msgnumber.
      APPEND ls_list_x TO et_list_x.
    ENDIF.
  ENDLOOP.
endmethod.
method GET_MSG_FILTER.
DATA:
    ls_so_msgty LIKE LINE OF es_msg_filter-msgty.
  DEFINE mac_add_msgty.
    clear ls_so_msgty.
    ls_so_msgty-sign   = &apos;I&apos;.
    ls_so_msgty-option = &apos;EQ&apos;.
    ls_so_msgty-low    = &amp;1.
    append ls_so_msgty to es_msg_filter-msgty.
  END-OF-DEFINITION.
  CLEAR es_msg_filter.
  IF id_msgty NA &apos;AEISWX&apos;.
    mac_invalid_precondition.
  ENDIF.
  IF ( id_msgty     CA &apos;IS&apos;     ) AND
     ( if_or_higher = abap_true ).
    RETURN.
  ENDIF.
  mac_add_msgty id_msgty.
  CASE id_msgty.
    WHEN &apos;I&apos;.     mac_add_msgty &apos;S&apos;.
    WHEN &apos;S&apos;.     mac_add_msgty &apos;I&apos;.
    WHEN &apos;A&apos;.     mac_add_msgty &apos;X&apos;.
    WHEN &apos;X&apos;.     mac_add_msgty &apos;A&apos;.
  ENDCASE.
  IF if_or_higher = abap_true.
    CASE id_msgty.
      WHEN &apos;I&apos; OR &apos;S&apos;.
        mac_add_msgty &apos;W&apos;.
        mac_add_msgty &apos;E&apos;.
        mac_add_msgty &apos;A&apos;.
        mac_add_msgty &apos;X&apos;.
      WHEN &apos;W&apos;.
        mac_add_msgty &apos;E&apos;.
        mac_add_msgty &apos;A&apos;.
        mac_add_msgty &apos;X&apos;.
      WHEN &apos;E&apos;.
        mac_add_msgty &apos;A&apos;.
        mac_add_msgty &apos;X&apos;.
    ENDCASE.
  ENDIF.
endmethod.
method GET_REF_TYPE.
DATA o_ref      TYPE REF TO cl_abap_refdescr.
  IF typedesc-&gt;kind = cl_abap_datadescr=&gt;kind_ref.
    o_ref ?= typedesc.
    ref_type = o_ref-&gt;get_referenced_type( ).
  ELSE.
    ref_type = typedesc.
  ENDIF.
endmethod.
method GET_STATISTICS.
  CLEAR rs_statistics.
  CALL FUNCTION &apos;BAL_LOG_HDR_READ&apos;
    EXPORTING
      i_log_handle = md_handle
    IMPORTING
      e_statistics = rs_statistics
    EXCEPTIONS
      OTHERS       = 0.
endmethod.
method HAS_MESSAGES_OF_MSGT.
DATA:
    ls_statistics TYPE bal_s_scnt,
    ld_msg_count  TYPE i.
  IF id_msgty NA &apos;IWEA&apos;.
    mac_invalid_precondition.
  ENDIF.
  IF ( id_msgty     = &apos;I&apos;       ) AND
     ( if_or_higher = abap_true ).
    IF is_empty( ) = abap_false.
      rf_exists = abap_true.
    ENDIF.
  ELSE.
    ls_statistics = get_statistics( ).
    ld_msg_count  = 0.
    CASE id_msgty.
      WHEN &apos;I&apos;.
        ld_msg_count = ls_statistics-msg_cnt_i +
                       ls_statistics-msg_cnt_s.
      WHEN &apos;W&apos;.
        ld_msg_count = ls_statistics-msg_cnt_w.
        IF ( if_or_higher = abap_true ) AND ( ld_msg_count = 0 ).
          ld_msg_count = ls_statistics-msg_cnt_e +
                         ls_statistics-msg_cnt_a.
        ENDIF.
      WHEN &apos;E&apos;.
        ld_msg_count = ls_statistics-msg_cnt_e.
        IF ( if_or_higher = abap_true ) AND ( ld_msg_count = 0 ).
          ld_msg_count = ls_statistics-msg_cnt_a.
        ENDIF.
      WHEN &apos;A&apos;.
        ld_msg_count = ls_statistics-msg_cnt_a.
    ENDCASE.
    IF ld_msg_count &gt; 0.
      rf_exists = abap_true.
    ENDIF.
  ENDIF.
endmethod.
method INIT.
DATA:
    lt_log_header TYPE balhdr_t,
    ls_log_header TYPE balhdr,
    ls_log_filter TYPE bal_s_lfil,
    ld_guid       TYPE guid_32.
  IF NOT auto_upd_custo IS INITIAL.
    check_custo( id_object = id_object
              id_subobject = id_subobject ).
  ENDIF.
  IF id_activity = actions-create.                    &quot;create
    ms_log-object     = id_object.
    ms_log-subobject  = id_subobject.
    ms_log-aluser     = sy-uname.
    ms_log-alprog     = sy-cprog.
    ms_log-aldate_del = sy-datum + 30.      &quot;expiration in 30 days
    IF id_extnumber IS NOT INITIAL.
      ms_log-extnumber = id_extnumber.
    ELSE.
      CALL FUNCTION &apos;GUID_CREATE&apos;
        IMPORTING
          ev_guid_32 = ld_guid.
      ms_log-extnumber = ld_guid.
    ENDIF.
    CALL FUNCTION &apos;BAL_LOG_CREATE&apos;
      EXPORTING
        i_s_log                 = ms_log
      IMPORTING
        e_log_handle            = md_handle
      EXCEPTIONS
        log_header_inconsistent = 1
        OTHERS                  = 2.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.
  ELSE.
    CALL FUNCTION &apos;BAL_FILTER_CREATE&apos;
      EXPORTING
        i_object       = id_object
        i_subobject    = id_subobject
        i_extnumber    = id_extnumber
      IMPORTING
        e_s_log_filter = ls_log_filter.
    CALL FUNCTION &apos;BAL_DB_SEARCH&apos;
      EXPORTING
        i_s_log_filter     = ls_log_filter
      IMPORTING
        e_t_log_header     = lt_log_header
      EXCEPTIONS
        log_not_found      = 1
        no_filter_criteria = 2
        OTHERS             = 3.
    IF sy-subrc &lt;&gt; 0.
      mac_symsg_raise error.
    ENDIF.
    CALL FUNCTION &apos;BAL_DB_LOAD&apos;
      EXPORTING
        i_t_log_header                = lt_log_header
      EXCEPTIONS
        no_logs_specified             = 1
        log_not_found                 = 2
        log_already_loaded            = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
      mac_symsg_raise error.
    ENDIF.
    READ TABLE lt_log_header INDEX 1 INTO ls_log_header.
    MOVE-CORRESPONDING ls_log_header TO ms_log.
    md_handle = ls_log_header-log_handle.
  ENDIF.
  object = id_object.
  subobject = id_subobject.
  ext_id = md_extnumber = ms_log-extnumber.
  md_level = mc_min_level.
endmethod.
method INIT_BY_HANDLE.
DATA:
    lt_log_handle TYPE bal_t_logh,
    lf_load_error TYPE abap_bool.
  INSERT id_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_DB_LOAD&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
    EXCEPTIONS
      no_logs_specified  = 1
      log_not_found      = 2
      log_already_loaded = 3
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    lf_load_error = abap_true.
  ENDIF.
  CALL FUNCTION &apos;BAL_LOG_HDR_READ&apos;
    EXPORTING
      i_log_handle = id_handle
    IMPORTING
      e_s_log      = ms_log
    EXCEPTIONS
      OTHERS       = 1.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise error.
  ENDIF.
  IF lf_load_error = abap_true.
    mf_log_not_stored = abap_true.
  ENDIF.
  md_handle    = id_handle.
  ext_id = md_extnumber = ms_log-extnumber.
  md_level     = mc_min_level.
endmethod.
method INSERT.
DATA:
    lt_msglist_x              TYPE t_msg_x,
    ld_insert_index           TYPE i,
    ld_delete_index           TYPE i,
    ld_num_detlevel_new       TYPE i,
    ld_num_detlevel_next      TYPE i,
    ld_num_detlevel_diff      TYPE i,
    ld_num_detlevel_following TYPE i.
  FIELD-SYMBOLS:
    &lt;ls_msglist_x&gt;            LIKE LINE OF lt_msglist_x.
  IF id_insert_index &gt; 0.
    ld_insert_index = id_insert_index.
  ELSE.
    ld_insert_index = 1.
  ENDIF.
  CALL METHOD get_list_x
    IMPORTING
      et_list_x = lt_msglist_x.
  IF ld_insert_index &gt; lines( lt_msglist_x ).
    CALL METHOD add
      EXPORTING
        is_message   = is_message
        id_msgty     = id_msgty
        id_msgid     = id_msgid
        id_msgno     = id_msgno
        id_msgv1     = id_msgv1
        id_msgv2     = id_msgv2
        id_msgv3     = id_msgv3
        id_msgv4     = id_msgv4
        id_msgd1     = id_msgd1
        id_msgd2     = id_msgd2
        id_msgd3     = id_msgd3
        id_msgd4     = id_msgd4
        id_detlevel  = id_detlevel
        id_probclass = id_probclass
        id_index     = id_index
      IMPORTING
        es_message   = es_message.
  ELSE.
    IF ld_insert_index &gt; 1.
      ld_delete_index = ld_insert_index - 1.
      DELETE lt_msglist_x TO ld_delete_index.
      LOOP AT lt_msglist_x ASSIGNING &lt;ls_msglist_x&gt;.
        CALL METHOD delete_message
          EXPORTING
            id_msgnumber = &lt;ls_msglist_x&gt;-msgnumber
          EXCEPTIONS
            OTHERS       = 0.
      ENDLOOP.
    ELSE.
      clear( ).
    ENDIF.
    CALL METHOD add
      EXPORTING
        is_message   = is_message
        id_msgty     = id_msgty
        id_msgid     = id_msgid
        id_msgno     = id_msgno
        id_msgv1     = id_msgv1
        id_msgv2     = id_msgv2
        id_msgv3     = id_msgv3
        id_msgv4     = id_msgv4
        id_msgd1     = id_msgd1
        id_msgd2     = id_msgd2
        id_msgd3     = id_msgd3
        id_msgd4     = id_msgd4
        id_detlevel  = id_detlevel
        id_probclass = id_probclass
        id_index     = id_index
      IMPORTING
        es_message   = es_message.
    IF if_set_following_as_subnode = abap_true.
      READ TABLE lt_msglist_x INDEX 1 ASSIGNING &lt;ls_msglist_x&gt;.
      ld_num_detlevel_next = &lt;ls_msglist_x&gt;-detlevel.
      ld_num_detlevel_new  = es_message-detlevel.
      ld_num_detlevel_diff = ld_num_detlevel_new  -
                             ld_num_detlevel_next + 1.
    ENDIF.
    LOOP AT lt_msglist_x ASSIGNING &lt;ls_msglist_x&gt;.
      CLEAR:
        &lt;ls_msglist_x&gt;-time_stmp,
        &lt;ls_msglist_x&gt;-msg_count.
      IF if_set_following_as_subnode = abap_true.
        ld_num_detlevel_following = &lt;ls_msglist_x&gt;-detlevel +
                                    ld_num_detlevel_diff.
        IF ld_num_detlevel_following &lt; 0.
          &lt;ls_msglist_x&gt;-detlevel = 0.
        ELSEIF ld_num_detlevel_following &gt; mc_max_level.
          &lt;ls_msglist_x&gt;-detlevel = mc_max_level.
        ELSE.
          &lt;ls_msglist_x&gt;-detlevel = ld_num_detlevel_following.
        ENDIF.
      ENDIF.
      CALL METHOD add( is_message = &lt;ls_msglist_x&gt;-msg ).
    ENDLOOP.
  ENDIF.
endmethod.
method IS_DATE_INITIAL.
  IF ( id_date(1) &gt;= &apos;1&apos; ).
    rf_initial = abap_false.
    RETURN.
  ENDIF.
  IF ( id_date IS INITIAL    ) OR
     ( id_date  = space      ) OR
     ( id_date  = &apos;00000000&apos; ).
    rf_initial = abap_true.
  ENDIF.
endmethod.
method IS_EMPTY.
DATA:
    lt_log_handle TYPE bal_t_logh.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      i_t_log_handle = lt_log_handle
    EXCEPTIONS
      msg_not_found  = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    rf_empty = abap_true.
  ENDIF.
endmethod.
method NEW.
CREATE OBJECT obj.
endmethod.
method RAISE_FIRST_MESSAGE.
DATA:
    ls_msg TYPE BAL_S_MSG.
  CALL METHOD get_first_message
    EXPORTING
      id_msgty     = id_msgty
      if_or_higher = if_or_higher
    IMPORTING
      es_message   = ls_msg
    EXCEPTIONS
      not_found    = 1
      OTHERS       = 2.
  IF sy-subrc = 0.
    MESSAGE ID ls_msg-msgid TYPE ls_msg-msgty NUMBER ls_msg-msgno
            WITH ls_msg-msgv1 ls_msg-msgv2 ls_msg-msgv3 ls_msg-msgv4
            RAISING first_message.
  ENDIF.
endmethod.
METHOD raise_on_error.
  DATA o_exception TYPE REF TO zaplink_cx.
  IF NOT has_messages_of_msgt( id_msgty = &apos;E&apos; ) IS INITIAL.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE e012(zaplink_package) WITH space space space. ENDIF.
    SET EXTENDED CHECK ON.
    add_abend( id_msgid = &apos;ZAPLINK_PACKAGE&apos;
               id_msgno = &apos;012&apos;
               id_msgv1 = object
               id_msgv2 = subobject
               id_msgv3 = ext_id
                ).
    o_exception = zaplink_cx=&gt;create_from_application_log( message_collector = me ).
    RAISE EXCEPTION o_exception.
  ENDIF.
ENDMETHOD.
method SET_DETAIL_LEVEL.
DATA:
    ld_num_min_level    LIKE id_relative,
    ld_num_max_level    LIKE id_relative,
    ld_num_level_signed LIKE id_relative.
  IF ( id_absolute IS NOT INITIAL ) AND
     ( id_relative IS NOT INITIAL ).
    mac_invalid_precondition.
  ENDIF.
  IF id_absolute IS NOT INITIAL.
    IF id_absolute BETWEEN mc_min_level AND mc_max_level.
      md_level = id_absolute.
    ENDIF.
  ELSEIF id_relative IS NOT INITIAL .
    ld_num_min_level = mc_min_level.
    ld_num_max_level = mc_max_level.
    ld_num_level_signed = md_level.
    ADD id_relative TO ld_num_level_signed.
    IF ld_num_level_signed &lt; ld_num_min_level.
      md_level = mc_min_level.
    ELSEIF ld_num_level_signed &gt; ld_num_max_level.
      md_level = mc_max_level.
    ELSE.
      md_level = ld_num_level_signed.
    ENDIF.
  ENDIF.
endmethod.
method SET_EXTNUMBER.
DATA:
    ls_log_temp LIKE ms_log.
  CHECK id_extnumber IS NOT INITIAL.
  ls_log_temp           = ms_log.
  ls_log_temp-extnumber = id_extnumber.
  CALL FUNCTION &apos;BAL_LOG_HDR_CHANGE&apos;
    EXPORTING
      i_log_handle            = md_handle
      i_s_log                 = ls_log_temp
    EXCEPTIONS
      log_not_found           = 1
      log_header_inconsistent = 2
      OTHERS                  = 3.
  IF sy-subrc &lt;&gt; 0.
    RETURN.
  ENDIF.
  ms_log-extnumber = id_extnumber.
  ext_id = md_extnumber     = id_extnumber.
endmethod.
method STORE.
DATA:
    lt_log_handle TYPE bal_t_logh.
  INSERT md_handle INTO TABLE lt_log_handle.
  CALL FUNCTION &apos;BAL_DB_SAVE&apos;
    EXPORTING
      i_in_update_task = if_in_update_task
      i_t_log_handle   = lt_log_handle
    EXCEPTIONS
      log_not_found    = 1
      save_not_allowed = 2
      numbering_error  = 3
      OTHERS           = 4.
  IF sy-subrc &lt;&gt; 0.
    mac_symsg_raise error.
  ENDIF.
endmethod.
method WRITE.
DATA lt_messages  TYPE t_msg_x.
  DATA _msg TYPE string.
  DATA _light TYPE icon_d.
  FIELD-SYMBOLS:
    &lt;m&gt; LIKE LINE OF lt_messages.
  CALL METHOD get_list_x
    IMPORTING
      et_list_x = lt_messages.
  LOOP AT lt_messages ASSIGNING &lt;m&gt;.
    CASE &lt;m&gt;-msgty.
      WHEN &apos;X&apos;. _light = icon_red_xcircle.
      WHEN &apos;A&apos;. _light = icon_message_critical_small.
      WHEN &apos;E&apos;. _light = icon_red_light.
      WHEN &apos;W&apos;. _light = icon_yellow_light.
      WHEN &apos;I&apos;. _light = icon_light_out.
      WHEN &apos;S&apos;. _light = icon_green_light.
      WHEN OTHERS. _light = icon_light_out.
    ENDCASE.
    MESSAGE ID &lt;m&gt;-msgid TYPE &apos;I&apos; NUMBER &lt;m&gt;-msgno WITH &lt;m&gt;-msgv1 &lt;m&gt;-msgv2 &lt;m&gt;-msgv3 &lt;m&gt;-msgv4 INTO _msg.
    WRITE:/ _offset, _light AS ICON, _msg.
  ENDLOOP.
endmethod.
METHOD _add_zl_cx.
  DATA _detlevel  TYPE ballevel.
  DATA cx_text    TYPE string.
  DATA o_ref      TYPE REF TO cl_abap_refdescr.
  DATA o_obj      TYPE REF TO cl_abap_classdescr.
  DATA prog       TYPE syrepid.
  DATA include    TYPE syrepid.
  DATA line       TYPE i.
  DATA cx_src_pos TYPE string.
  IF id_detlevel IS INITIAL.
    _detlevel = md_level.
  ELSE.
    _detlevel = id_detlevel.
  ENDIF.
  IF exception-&gt;prev_cx IS BOUND.
    ADD 1 TO _detlevel.
    CALL METHOD _add_zl_cx
      EXPORTING
        exception    = exception-&gt;prev_cx
        id_detlevel  = _detlevel
        id_probclass = id_probclass.
    SUBTRACT 1 FROM _detlevel.
  ENDIF.
  IF exception-&gt;previous IS BOUND.
    ADD 1 TO _detlevel.
    CALL METHOD add_exception
      EXPORTING
        exception    = exception-&gt;previous
        id_detlevel  = _detlevel
        id_probclass = id_probclass.
    SUBTRACT 1 FROM _detlevel.
  ENDIF.
  o_ref ?= cl_abap_classdescr=&gt;describe_by_data( p_data = exception ).
  o_obj ?= get_ref_type( o_ref ).
  CALL METHOD exception-&gt;get_source_position
    IMPORTING
      program_name = prog
      include_name = include
      source_line  = line.
  cx_src_pos = line.
  IF include IS INITIAL.
    CONCATENATE prog &apos; @&apos; cx_src_pos INTO cx_src_pos.
  ELSE.
    CONCATENATE include &apos;(&apos; prog &apos;) @&apos; cx_src_pos INTO cx_src_pos.
  ENDIF.
  cx_text = exception-&gt;if_message~get_text( ).
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE e002(zaplink_easyxml) WITH abap_true abap_true abap_true. ENDIF.
  SET EXTENDED CHECK ON.
  CALL METHOD add_error
    EXPORTING
      id_msgid     = &apos;ZAPLINK_EASYXML&apos;
      id_msgno     = &apos;002&apos;
      id_msgv1     = o_obj-&gt;absolute_name
      id_msgv2     = cx_text
      id_msgv3     = cx_src_pos
      id_detlevel  = _detlevel
      id_probclass = id_probclass
      .
  IF exception-&gt;messages IS BOUND.
    CALL METHOD add_from_instance
      EXPORTING
        io_msglist        = exception-&gt;messages
        if_add_as_subnode = abap_true
        .
  ENDIF.
ENDMETHOD.
method GET_STATISTICS_AS_TEXT.
DATA:
    ls_statistics   TYPE bal_s_scnt,
    ld_result       TYPE string,
    ld_result_cnt   TYPE string,
    ld_result_cnt_e TYPE string,
    ld_result_cnt_w TYPE string,
    ld_result_cnt_i TYPE string.
  CLEAR ed_text.
  ls_statistics = get_statistics( ).
  ADD ls_statistics-msg_cnt_a TO ls_statistics-msg_cnt_e.
  ADD ls_statistics-msg_cnt_s TO ls_statistics-msg_cnt_i.
  IF if_output_e_messages = abap_true.
    IF ls_statistics-msg_cnt_e &gt; 1.
      ld_result_cnt = ls_statistics-msg_cnt_e.
      ld_result_cnt_e = text-se0.
      REPLACE &apos;&amp;1&apos; WITH ld_result_cnt INTO ld_result_cnt_e.
      CONDENSE ld_result_cnt_e.
    ELSEIF ls_statistics-msg_cnt_e = 1.
      ld_result_cnt_e = text-se1.
    ENDIF.
  ENDIF.
  IF if_output_w_messages = abap_true.
    IF ls_statistics-msg_cnt_w &gt; 1.
      ld_result_cnt = ls_statistics-msg_cnt_w.
      ld_result_cnt_w = text-sw0.
      REPLACE &apos;&amp;1&apos; IN ld_result_cnt_w WITH ld_result_cnt.
      CONDENSE ld_result_cnt_w.
    ELSEIF ls_statistics-msg_cnt_w = 1.
      ld_result_cnt_w = text-sw1.
    ENDIF.
  ENDIF.
  IF if_output_i_messages = abap_true.
    IF ls_statistics-msg_cnt_i &gt; 1.
      ld_result_cnt = ls_statistics-msg_cnt_i.
      ld_result_cnt_i = text-si0.
      REPLACE &apos;&amp;1&apos; WITH ld_result_cnt INTO ld_result_cnt_i.
      CONDENSE ld_result_cnt_i.
    ELSEIF ls_statistics-msg_cnt_i = 1.
      ld_result_cnt_i = text-si1.
    ENDIF.
  ENDIF.
  IF ld_result_cnt_e IS NOT INITIAL.
    ld_result = ld_result_cnt_e.
  ENDIF.
  IF ld_result_cnt_w IS NOT INITIAL.
    IF ld_result IS INITIAL.
      ld_result = ld_result_cnt_w.
    ELSEIF if_output_highest_only = abap_false.
      CONCATENATE ld_result &apos;, &amp;1&apos;
             INTO ld_result.
      REPLACE &apos;&amp;1&apos; IN ld_result WITH ld_result_cnt_w.
    ENDIF.
  ENDIF.
  IF ld_result_cnt_i IS NOT INITIAL.
    IF ld_result IS INITIAL.
      ld_result = ld_result_cnt_i.
    ELSEIF if_output_highest_only = abap_false.
      CONCATENATE ld_result &apos;, &amp;1&apos;
             INTO ld_result.
      REPLACE &apos;&amp;1&apos; IN ld_result WITH ld_result_cnt_i.
    ENDIF.
  ENDIF.
  ed_text = ld_result.
endmethod.
endclass. &quot;ZAPLINK_MESSAGE_COLLECTOR implementation
class ZAPLINK_OPT_DEVCLASS implementation.
METHOD constructor.
  super-&gt;constructor( ).
  _substitution = substitutionkinds-keep_existing.
ENDMETHOD.
method GET_DEVCLASS.
result = _devclass.
endmethod.
method GET_SUBSTITUTIONKIND.
  result = _substitution.
endmethod.
method SET_DEVCLASS.
CHECK data &lt;&gt; _devclass.
  IF _devclass IS INITIAL AND _substitution = substitutionkinds-fixed.
    RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
          EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                 substkind = _substitution.
  ENDIF.
  _devclass = data.
endmethod.
method SET_SUBSTITUTIONKIND.
  CHECK data &lt;&gt; _substitution.
  CASE data.
    WHEN substitutionkinds-keep_existing OR
         substitutionkinds-use_container OR
         substitutionkinds-no_overwrite  OR
         substitutionkinds-local.
    WHEN substitutionkinds-fixed.
      IF _devclass IS INITIAL.
        RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
              EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                     substkind = data.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = data.
  ENDCASE.
  _substitution = data.
endmethod.
METHOD substitute.
  DATA comp_devc TYPE td_devclass.
  CHECK component IS BOUND.
  comp_devc = component-&gt;directory-devclass.
  TRY.
      IF component-&gt;get_type( ) = &apos;DEVC&apos;.
        result = component-&gt;get_name( ).
      ELSE.
        CASE _substitution.
          WHEN substitutionkinds-no_overwrite.
            result = get_existing( component ).
            IF NOT result IS INITIAL.
              EXIT.
            ENDIF.
            IF do_exists( comp_devc ) = abap_true.
              result = comp_devc.
              EXIT.
            ENDIF.
            result = me-&gt;_devclass.
          WHEN substitutionkinds-keep_existing.
            result = get_existing( component ).
            IF result IS INITIAL.
              result = local_devclass.
            ENDIF.
          WHEN substitutionkinds-use_container.
            IF do_exists( comp_devc ) = abap_true.
              result = comp_devc.
            ELSE.
              result = local_devclass.
            ENDIF.
          WHEN substitutionkinds-local.
            result = local_devclass.
          WHEN substitutionkinds-fixed.
            result = me-&gt;_devclass.
          WHEN OTHERS.
            RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
                  EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                         substkind = _substitution.
        ENDCASE.
      ENDIF.
    CATCH zaplink_cx_opt_devclass INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_existing.
  DATA _name        TYPE tadir-obj_name.
  DATA _type        TYPE tadir-object.
  DATA _exists      TYPE saus_dpara-tadirexist.
  CHECK component IS BOUND.
  TRY.
      _type = component-&gt;get_type( ).
      _name = component-&gt;get_name( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
    EXPORTING
      iv_pgmid           = &apos;R3TR&apos;
      iv_object          = _type
      iv_obj_name        = _name
    IMPORTING
      ev_devclass        = result
      ev_exist           = _exists.
  IF _exists IS INITIAL.
    CLEAR result.
  ENDIF.
ENDMETHOD.
METHOD do_exists.
  result = abap_false.
  CHECK NOT data IS INITIAL.
  CALL FUNCTION &apos;TRINT_DEVCLASS_GET&apos;
    EXPORTING
      iv_devclass              = data
    EXCEPTIONS
      devclass_not_found       = 1
      OTHERS                   = 2.
  IF sy-subrc = 0.
    result = abap_true.
  ELSEIF sy-subrc &lt;&gt; 1.
    RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
          EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                  devclass = data.
  ENDIF.
ENDMETHOD.
endclass. &quot;ZAPLINK_OPT_DEVCLASS implementation
class ZAPLINK_OPT_TRANSPORT_REQUEST implementation.
METHOD constructor.
  super-&gt;constructor( ).
  _substitution = substitutionkinds-input.
ENDMETHOD.
method GET_SUBSTITUTIONKIND.
result = _substitution.
endmethod.
METHOD set_substitutionkind.
  CHECK data &lt;&gt; _substitution.
  CLEAR _user_input.
  CASE data.
    WHEN substitutionkinds-same_as_container OR
         substitutionkinds-user OR
         substitutionkinds-custom OR
         substitutionkinds-input.
    WHEN substitutionkinds-fixed.
      IF _transport_request IS INITIAL.
        RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
              EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                     substkind = data.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = data.
  ENDCASE.
  _substitution = data.
ENDMETHOD.
METHOD substitute.
  DATA t_e071   TYPE STANDARD TABLE OF e071.
  DATA t_e071k  TYPE STANDARD TABLE OF e071k.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF _tr_mapping.
  CHECK component IS BOUND.
  CASE _substitution.
    WHEN substitutionkinds-input.
      CLEAR result.
      EXIT. &quot; all ways empty to let use choose the right transport request
    WHEN substitutionkinds-fixed.
      result = _transport_request.
    WHEN substitutionkinds-user.
      IF _user_input IS INITIAL.
        CALL FUNCTION &apos;TRINT_ORDER_CHOICE&apos;
          EXPORTING
            wi_order_type                = &apos;K&apos;
            wi_task_type                 = &apos;S&apos;
          IMPORTING
            we_task                      = _user_input
          TABLES
            wt_e071                      = t_e071
            wt_e071k                     = t_e071k
          EXCEPTIONS
            no_correction_selected       = 1
            display_mode                 = 2
            object_append_error          = 3
            recursive_call               = 4
            wrong_order_type             = 5
            OTHERS                       = 6.
        IF sy-subrc &lt;&gt; 0.
          CLEAR _user_input.
        ELSE.
          result = _user_input.
        ENDIF.
      ENDIF.
      IF NOT _user_input IS INITIAL.
        result = _user_input.
      ELSE.
        CLEAR result.
      ENDIF.
    WHEN substitutionkinds-custom.
    WHEN substitutionkinds-same_as_container.
      READ TABLE _tr_mapping ASSIGNING &lt;s&gt;
           WITH TABLE KEY xml_tr = component-&gt;directory-trkorr.
      IF sy-subrc = 0.
        result = &lt;s&gt;-sap_tr.
      ELSEIF NOT component-&gt;directory-trkorr IS INITIAL.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = _substitution.
  ENDCASE.
ENDMETHOD.
method GET_TRANSPORT_REQUEST.
  result = _transport_request.
endmethod.
method SET_TRANSPORT_REQUEST.
CHECK data &lt;&gt; _transport_request.
  IF _transport_request IS INITIAL AND _substitution = substitutionkinds-fixed.
    RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
          EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                 substkind = _substitution.
  ENDIF.
  _transport_request = data.
endmethod.
endclass. &quot;ZAPLINK_OPT_TRANSPORT_REQUEST implementation
class ZAPLINK_COMPONENT implementation.
method CLONE.
  result = me.
endmethod.
method CONNECTOR.
result = _connector-o_conn.
endmethod.
method CONNECTOR_EXISTS.
result = _connector-exists.
endmethod.
method CREATE_NEW.
DATA _cx TYPE REF TO zaplink_cx_component.
  TRY.
      CREATE OBJECT result.
      result-&gt;_set_key( key ).
    CATCH zaplink_cx_component INTO _cx.
      RAISE EXCEPTION _cx.
  ENDTRY.
endmethod.
method EXISTS.
  result = _exists.
endmethod.
method GET_DEVCLASS.
result = _devclass.
endmethod.
method GET_EXCEPTION.
result = _EXCEPTION.
endmethod.
method GET_KEY.
IF type IS INITIAL OR name IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_component
               EXPORTING textid = zaplink_cx_component=&gt;system_error.
  ENDIF.
  result-type = type.
  result-name = name.
endmethod.
method GET_MSG_COLL.
result = _msg_coll.
endmethod.
method GET_NAME.
result = name.
endmethod.
method GET_SUBCOMPONENTS.
result = _subcomponents.
endmethod.
method GET_TYPE.
result = type.
endmethod.
METHOD on_change_clear.
  CLEAR: _exists, _connector-uuid, _code_signature, _checksum.
ENDMETHOD.
METHOD on_change_update.
  DATA o_cx_cnx TYPE REF TO zaplink_cx_connector.
  IF _connector-o_conn IS BOUND AND NOT name IS INITIAL.
    TRY.
        _exists = _connector-o_conn-&gt;do_exists( me ).
      CATCH zaplink_cx_connector INTO o_cx_cnx.
        mac_cascade_raise o_mycx o_cx_cnx.
    ENDTRY.
    SELECT SINGLE devclass INTO _devclass
      FROM tadir
      WHERE pgmid = &apos;R3TR&apos;
       AND object = type
       AND obj_name = name.
    _connector-uuid = _connector-o_conn-&gt;uuid.
  ENDIF.
ENDMETHOD.
method SET_DEVCLASS.
  CHECK data &lt;&gt; _devclass.
  _devclass = data.
endmethod.
method SET_EXCEPTION.
DATA cx TYPE REF TO cx_root.
  DATA _cx TYPE REF TO zaplink_cx_component.
  DATA _desc TYPE REF TO cl_abap_typedescr.
  IF data IS BOUND.
    TRY.
        _exception ?= data.
      CATCH cx_root INTO cx.
        _desc = cl_abap_typedescr=&gt;describe_by_object_ref( data ).
        CREATE OBJECT _cx
          EXPORTING
            textid   = zaplink_cx_component=&gt;invalid_exception
            objtype  = _desc-&gt;absolute_name
            previous = cx.
        _cx-&gt;update( ).
        RAISE EXCEPTION _cx.
    ENDTRY.
  ELSE.
    CLEAR _exception.
  ENDIF.
endmethod.
method SET_MSG_COLL.
DATA cx TYPE REF TO cx_root.
  DATA _cx TYPE REF TO zaplink_cx_component.
  DATA _desc TYPE REF TO cl_abap_typedescr.
  IF data IS BOUND.
    TRY.
        _msg_coll ?= data.
      CATCH cx_root INTO cx.
        _desc = cl_abap_typedescr=&gt;describe_by_object_ref( data ).
        CREATE OBJECT _cx
          EXPORTING
            textid   = zaplink_cx_component=&gt;invalid_msg_coll
            objtype  = _desc-&gt;absolute_name
            previous = cx.
        _cx-&gt;update( ).
        RAISE EXCEPTION _cx.
    ENDTRY.
  ELSE.
    CLEAR _msg_coll.
  ENDIF.
endmethod.
method SET_NAME.
  CHECK data &lt;&gt; name.
  name = data.
  on_change_clear( ).
  on_change_update( ).
endmethod.
method SET_SUBCOMPONENTS.
DATA cx TYPE REF TO cx_root.
  DATA _cx TYPE REF TO zaplink_cx_component.
  DATA _desc TYPE REF TO cl_abap_typedescr.
  IF data IS BOUND.
    TRY.
        _subcomponents ?= data.
      CATCH cx_root INTO cx.
        _desc = cl_abap_typedescr=&gt;describe_by_object_ref( data ).
        CREATE OBJECT _cx
          EXPORTING
            textid   = zaplink_cx_component=&gt;invalid_subcomponents
            objtype  = _desc-&gt;absolute_name
            previous = cx.
        _cx-&gt;update( ).
        RAISE EXCEPTION _cx.
    ENDTRY.
  ELSE.
    CLEAR _msg_coll.
  ENDIF.
endmethod.
METHOD set_type.
  DATA o_conn TYPE to_connector.
  CHECK data &lt;&gt; type.
  TRY.
      o_conn = zaplink_connectors=&gt;create_connector( type = data ).
      type = data.    CLEAR _connector.
      on_change_clear( ).
      _connector-o_conn = o_conn.
      IF o_conn IS BOUND.   _connector-exists = connexists-exists.    ELSE.     _connector-exists = connexists-not_exists.    ENDIF.
      on_change_update( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method _GET_KEY.
  result-type = type.
  result-name = name.
endmethod.
method _SET_KEY.
DATA _cx TYPE REF TO zaplink_cx_component.
  TRY.
      set_type( data-type ).
      set_name( data-name ).
    CATCH zaplink_cx_component INTO _cx.
      RAISE EXCEPTION _cx.
  ENDTRY.
endmethod.
METHOD set_connuuid.
  DATA _cx    TYPE REF TO zaplink_cx.
  DATA o_conn TYPE to_connector.
  CHECK data &lt;&gt; _connector-uuid.
  TRY.
      o_conn = zaplink_connectors=&gt;create_connector( type = type
                                                 connuuid = data ).
      _connector-o_conn = o_conn.
      on_change_clear( ).
      _connector-uuid = data.
      IF o_conn IS BOUND.
        _connector-exists = connexists-exists.
      ELSE.
        _connector-exists = connexists-not_exists.
      ENDIF.
      on_change_update( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD GET_CONNUUID.
  result = _connector-uuid.
ENDMETHOD.
METHOD refresh.
  TRY.
      on_change_update( ).                                  &quot; Issue 31
    CATCH ZAPLINK_CX_COMPONENT INTO o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD get_with_subcomp.
  result = with_subcomp.
ENDMETHOD.
METHOD set_with_subcomp.
  CHECK data &lt;&gt; with_subcomp.
  with_subcomp = data.
ENDMETHOD.
method GET_CHECKSUM.
  result = _checksum.
endmethod.
method SET_CHECKSUM.
  _checksum = data.
endmethod.
METHOD get_code_signature.
  result = _code_signature.
ENDMETHOD.
METHOD set_code_signature.
  _code_signature = data.
ENDMETHOD.
endclass. &quot;ZAPLINK_COMPONENT implementation
class ZAPLINK_CONNECTORS implementation.
METHOD add_local_connector.
  TRY.
      _add_connector( class = local_class
                   devclass = local_devclass ).
      _update_def_class( ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD class_constructor.
  DATA t_types    TYPE STANDARD TABLE OF ko100 WITH DEFAULT KEY.
  DATA s_saptypes LIKE LINE OF saptypes.
  DATA t_saptypes TYPE STANDARD TABLE OF ts_saptypes.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF t_types.
  xmlengine = cl_ixml=&gt;create( ).
  CALL FUNCTION &apos;TR_OBJECT_TABLE&apos;
    TABLES
      wt_object_text       = t_types.
  SORT t_types BY object.
  DELETE ADJACENT DUPLICATES FROM t_types COMPARING object.
  LOOP AT t_types ASSIGNING &lt;t&gt;.
    CLEAR s_saptypes. s_saptypes-hdr = &lt;t&gt;.
    s_saptypes-order = max_order.
    APPEND s_saptypes TO t_saptypes.
  ENDLOOP.
  saptypes = t_saptypes.
  s_saptypes-order = 50.  MODIFY saptypes FROM s_saptypes TRANSPORTING order WHERE object = &apos;DEVC&apos;.
  s_saptypes-order = 100. MODIFY saptypes FROM s_saptypes TRANSPORTING order WHERE object = &apos;INTF&apos;.
  s_saptypes-order = 150. MODIFY saptypes FROM s_saptypes TRANSPORTING order WHERE object = &apos;CLAS&apos;.
  TRY.
      reset_connectors( ).
    CATCH zaplink_cx INTO o_cx.
      IF o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_uuid OR
         o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_class.
        RAISE EXCEPTION o_cx.   &quot;  Major failure that will cause Short Dump
      ENDIF.
  ENDTRY.
ENDMETHOD.
METHOD _add_connector.
  DATA connector TYPE REF TO zaplink_connector.
  DATA o_cx_root TYPE REF TO cx_root.
  DATA o_cx_create TYPE REF TO cx_sy_create_object_error.
  DATA cx_comp   TYPE REF TO zaplink_cx_component.
  DATA tabletypeline TYPE ko105.
  DATA _conn     LIKE LINE OF type_list.
  DATA _class    LIKE LINE OF _conn-classes.
  DATA the_class LIKE LINE OF _classes.
  DATA _value    LIKE LINE OF value_table.
  FIELD-SYMBOLS:
    &lt;cl&gt; LIKE LINE OF _classes,
    &lt;c&gt;  LIKE LINE OF type_list,
    &lt;st&gt; LIKE LINE OF saptypes,
    &lt;t&gt;  LIKE LINE OF connector-&gt;supported_types.
  TRY.
      CREATE OBJECT connector TYPE (class).
    CATCH cx_sy_create_object_error INTO o_cx_create.
      CASE o_cx_create-&gt;textid.
        WHEN cx_sy_create_object_error=&gt;abstract_class
          OR cx_sy_create_object_error=&gt;private_constructor
          OR cx_sy_create_object_error=&gt;protected_constructor.
        WHEN OTHERS.
          mac_cascade_raise_root o_mycx o_cx_create.
      ENDCASE.
    CATCH cx_root INTO o_cx_root.
      mac_cascade_raise_root o_mycx o_cx_root.
  ENDTRY.
  CHECK connector IS BOUND.
  IF NOT connector-&gt;uuid IS INITIAL               AND
     NOT connector-&gt;supported_types IS INITIAL.
    the_class-uuid = connector-&gt;uuid.
    READ TABLE _classes ASSIGNING &lt;cl&gt;
               WITH TABLE KEY uuid = the_class-uuid.
    IF sy-subrc = 0.
      IF &lt;cl&gt;-classname &lt;&gt; class.                           &quot; Issue 25
        RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
                        textid = zaplink_cx_connector=&gt;twice_uuid
                     connclass = class
                    otherclass = &lt;cl&gt;-classname
                      connuuid = &lt;cl&gt;-uuid.
      ELSEIF NOT ( &lt;cl&gt;-devclass &lt;&gt; local_devclass AND devclass = local_devclass ).
        RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
                        textid = zaplink_cx_connector=&gt;twice_class
                     connclass = class.
      ELSE.
        LOOP AT &lt;cl&gt;-types ASSIGNING &lt;t&gt;.
          READ TABLE type_list ASSIGNING &lt;c&gt;
               WITH TABLE KEY object = &lt;t&gt;-type.
          IF sy-subrc &lt;&gt; 0.
            RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
                            textid = zaplink_cx_connector=&gt;system_error
                           cx_name = &apos;TYPE NOT FOUND&apos;.
          ELSE.
            DELETE &lt;c&gt;-classes WHERE classname = class.
          ENDIF.
        ENDLOOP.
      ENDIF.
    ENDIF.
    the_class-classname = class.
    IF NOT devclass IS INITIAL.
      the_class-devclass = devclass.
    ELSE.
      SELECT SINGLE devclass INTO the_class-devclass
        FROM tadir
        WHERE pgmid = &apos;R3TR&apos;
          AND object = &apos;CLAS&apos;
          AND obj_name = the_class-classname.
    ENDIF.
    the_class-types = connector-&gt;supported_types.
    INSERT the_class INTO TABLE _classes.
    LOOP AT connector-&gt;supported_types ASSIGNING &lt;t&gt;.
      READ TABLE type_list ASSIGNING &lt;c&gt;
           WITH TABLE KEY object = &lt;t&gt;-type.
      IF sy-subrc &lt;&gt; 0.
        _conn-object = &lt;t&gt;-type.
        READ TABLE saptypes ASSIGNING &lt;st&gt;
                   WITH TABLE KEY object = _conn-object.
        IF sy-subrc = 0.
          _conn-text = &lt;st&gt;-text.
        ENDIF.
        INSERT _conn INTO TABLE type_list.
        READ TABLE type_list ASSIGNING &lt;c&gt;
             WITH TABLE KEY object = &lt;t&gt;-type.
      ENDIF.
      CLEAR _class.
      MOVE-CORRESPONDING the_class TO _class.
      INSERT _class INTO TABLE &lt;c&gt;-classes.
    ENDLOOP.
  ENDIF.
  CLEAR value_table.
  LOOP AT type_list ASSIGNING &lt;c&gt;.
    _value-object = &lt;c&gt;-object.
    _value-text = &lt;c&gt;-text.
    APPEND _value TO value_table.
  ENDLOOP.
ENDMETHOD.
METHOD _update_def_class.
  TYPES:
    BEGIN OF t_classlist,
      class TYPE seoclsname,
    END OF t_classlist.
  DATA classlist TYPE STANDARD TABLE OF t_classlist WITH DEFAULT KEY.
  DATA tabletypeline TYPE ko105.
  DATA _conn LIKE LINE OF type_list.
  DATA _class LIKE LINE OF _conn-classes.
  DATA _types TYPE STANDARD TABLE OF ko100 WITH DEFAULT KEY.
  DATA s_type LIKE LINE OF supported_types.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF type_list.
  REFRESH supported_types.
  LOOP AT type_list ASSIGNING &lt;c&gt;.
    CLEAR: s_type.    s_type-type = &lt;c&gt;-object.   INSERT s_type INTO TABLE supported_types.
    CHECK NOT &lt;c&gt;-classes IS INITIAL.
    LOOP AT &lt;c&gt;-classes INTO _class   WHERE devclass = local_devclass.
      EXIT.
    ENDLOOP.
    LOOP AT &lt;c&gt;-classes INTO _class   WHERE devclass = &apos;ZAPLINK-CONNECTORS-MAIN&apos;.
      EXIT.
    ENDLOOP.
    IF sy-subrc &lt;&gt; 0 OR _class-classname IS INITIAL.
      LOOP AT &lt;c&gt;-classes INTO _class WHERE devclass CP &apos;ZAPLINK-CONNECTORS*&apos;.
        EXIT.
      ENDLOOP.
    ENDIF.
    IF sy-subrc &lt;&gt; 0 OR _class-classname IS INITIAL.
      LOOP AT &lt;c&gt;-classes INTO _class WHERE devclass CP &apos;ZAPLINK*&apos;.
        EXIT.
      ENDLOOP.
    ENDIF.
    IF sy-subrc &lt;&gt; 0 OR _class-classname IS INITIAL.
      READ TABLE &lt;c&gt;-classes INTO _class INDEX 1.
    ENDIF.
    &lt;c&gt;-default_class = _class-classname.
  ENDLOOP.
ENDMETHOD.
METHOD do_exists.
  DATA _conn LIKE LINE OF type_list.
  TRY.
      result = exists-not_exists.
      _conn = _search_connector( type ).
      IF NOT _conn-classes IS INITIAL.
        result = exists-exists.
      ENDIF.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD create_connector.
  DATA _cx        TYPE REF TO cx_root.
  DATA _conn      LIKE LINE OF type_list.
  DATA _classname TYPE td_connclass.
  FIELD-SYMBOLS:
    &lt;cl&gt; LIKE LINE OF _classes,
    &lt;c&gt; LIKE LINE OF _conn-classes.
  IF NOT connuuid IS INITIAL.
    READ TABLE _classes ASSIGNING &lt;cl&gt;
               WITH TABLE KEY uuid = connuuid.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_connector
                 EXPORTING textid = zaplink_cx_connector=&gt;invalid_uuid
                             type = type
                         connuuid = connuuid.
    ELSE.
      IF NOT type IS INITIAL.
        READ TABLE &lt;cl&gt;-types TRANSPORTING NO FIELDS
             WITH TABLE KEY type = type.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
                     EXPORTING textid = zaplink_cx_connector=&gt;invalid_uuid
                                 type = type
                             connuuid = connuuid.
        ENDIF.
      ENDIF.
    ENDIF.
    _classname = &lt;cl&gt;-classname.
  ELSEIF NOT type IS INITIAL.
    TRY.
        _conn = _search_connector( type ).
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
    IF NOT _conn-classes IS INITIAL AND _conn-default_class IS INITIAL.
      READ TABLE _conn-classes ASSIGNING &lt;c&gt; INDEX 1.
      IF sy-subrc = 0.
        _conn-default_class = &lt;c&gt;-classname.
      ENDIF.
    ENDIF.
    _classname = _conn-default_class.
  ELSE.
    RAISE EXCEPTION TYPE zaplink_cx_connector
               EXPORTING textid = zaplink_cx_connector=&gt;invalid_uuid
                           type = type
                       connuuid = connuuid.
  ENDIF.
  IF NOT _classname IS INITIAL.
    TRY.
        CREATE OBJECT result TYPE (_classname).
      CATCH cx_root INTO _cx.
        RAISE EXCEPTION TYPE zaplink_cx_connector
                   EXPORTING textid = zaplink_cx=&gt;system_error
                           previous = _cx.
    ENDTRY.
  ENDIF.
ENDMETHOD.
METHOD _search_connector.
  READ TABLE type_list INTO result
             WITH TABLE KEY object = type.
  IF sy-subrc &lt;&gt; 0.
    READ TABLE saptypes TRANSPORTING NO FIELDS
               WITH TABLE KEY object = type.
    IF sy-subrc &lt;&gt; 0.
      RAISE EXCEPTION TYPE zaplink_cx_connector
                 EXPORTING textid = zaplink_cx_connector=&gt;invalid_type
                             type = type.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD get_values.
  DATA lt_return TYPE STANDARD TABLE OF ddshretval.
  DATA d_value   TYPE help_info-fldvalue.
  d_value = type.
  CALL FUNCTION &apos;F4IF_INT_TABLE_VALUE_REQUEST&apos;
    EXPORTING
      retfield               = &apos;OBJECT&apos;
      window_title           = &apos;Installed connectors&apos;(sh1)
      value                  = d_value
      value_org              = &apos;S&apos;
    TABLES
      value_tab              = value_table
      return_tab             = lt_return
    EXCEPTIONS
      parameter_error        = 1
      no_values_found        = 2
      OTHERS                 = 3.
  IF sy-subrc &lt;&gt; 0.
    TRY.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;F4IF_INT_TABLE_VALUE_REQUEST&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
  ELSE.
    type = d_value.
  ENDIF.
ENDMETHOD.
METHOD type2text.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF saptypes.
  READ TABLE saptypes ASSIGNING &lt;t&gt;
       WITH TABLE KEY object = data.
  IF sy-subrc = 0.
    result = &lt;t&gt;-text.
  ENDIF.
ENDMETHOD.
METHOD NODE_2_RAW.
  DATA ez_xml    TYPE REF TO zaplink_easyxml.
  DATA _xml_comp TYPE REF TO if_ixml_document.
  DATA _clone    TYPE REF TO if_ixml_node.
  DATA _cx       TYPE REF TO zaplink_cx.
  _xml_comp = xmlengine-&gt;create_document( ).
  _clone = node-&gt;clone( ).
  _xml_comp-&gt;if_ixml_node~append_child( _clone ).
  CREATE OBJECT result.
  CREATE OBJECT ez_xml.
  TRY.
      CALL METHOD ez_xml-&gt;xml2any
        EXPORTING
          xmldoc = _xml_comp
        CHANGING
          any    = result.
    CATCH zaplink_cx INTO _cx.
      create OBJECT o_mycx EXPORTING
             textid = zaplink_cx=&gt;SYSTEM_ERROR
            prev_cx = _cx.
      o_mycx-&gt;update( ).
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD get_classname.
  DATA o_typedesc TYPE REF TO cl_abap_objectdescr.
  CHECK o_conn IS BOUND.
  o_typedesc ?= cl_abap_objectdescr=&gt;describe_by_object_ref( o_conn ).
  result = o_typedesc-&gt;get_relative_name( ).
ENDMETHOD.
METHOD reset_connectors.
  DATA o_conn      TYPE REF TO zaplink_connector.
  DATA _connectors TYPE REF TO cl_oo_if_relations.
  DATA o_desc      TYPE REF TO cl_abap_typedescr.
  FIELD-SYMBOLS:
    &lt;im_cl&gt; LIKE LINE OF _connectors-&gt;implementing_classes,
    &lt;s_cl&gt; LIKE LINE OF _connectors-&gt;subclasses.
  CLEAR type_list.
  o_desc = cl_abap_structdescr=&gt;describe_by_name( &apos;ZAPLINK_CONNECTOR&apos; ).
  IF o_desc-&gt;absolute_name CP &apos;\INTERFACE=*&apos;.
    CREATE OBJECT _connectors
      EXPORTING
        clsname      = &apos;ZAPLINK_CONNECTOR&apos;
      EXCEPTIONS
        not_existing = 0    &quot; For installer ignore not existing class
        is_class     = 2
        OTHERS       = 3.
    IF sy-subrc &lt;&gt; 0.
      mac_raise_symsg &apos;ZAPLINK_CX_CONNECTOR&apos; zaplink_cx_connector=&gt;system_error.
    ENDIF.
    IF _connectors IS BOUND.
      LOOP AT _connectors-&gt;implementing_classes ASSIGNING &lt;im_cl&gt;
              WHERE exposure &lt;&gt; &apos;0&apos;   &quot; Private
                AND version = &apos;1&apos;     &quot; Active
                AND state &lt;&gt; &apos;0&apos;      &quot; Only modeled
                .
        TRY.
            _add_connector( class = &lt;im_cl&gt;-clsname ).
          CATCH zaplink_cx INTO o_cx.
            IF o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_uuid OR
               o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_class.
              mac_cascade_raise o_mycx o_cx.
            ENDIF.
        ENDTRY.
      ENDLOOP.
      LOOP AT _connectors-&gt;subclasses ASSIGNING &lt;s_cl&gt;
              WHERE state &lt;&gt; &apos;0&apos;      &quot; Only modeled
                AND version = &apos;1&apos;     &quot; Active
                .
        TRY.
            _add_connector( class = &lt;s_cl&gt;-clsname ).
          CATCH zaplink_cx INTO o_cx.
            IF o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_uuid OR
               o_cx-&gt;textid = zaplink_cx_connector=&gt;twice_class.
              mac_cascade_raise o_mycx o_cx.
            ENDIF.
        ENDTRY.
      ENDLOOP.
      _update_def_class( ).
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD CLEAR_CONNECTORS.
  clear type_list.
ENDMETHOD.
METHOD get_typeorder.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF saptypes.
  READ TABLE saptypes ASSIGNING &lt;t&gt;
       WITH TABLE KEY object = data.
  IF sy-subrc = 0.
    result = &lt;t&gt;-order.
  ELSE.
    result = max_order.
  ENDIF.
ENDMETHOD.
METHOD GET_CONNECTORLIST.
  DATA o_comp TYPE to_component.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF _classes.
  CREATE OBJECT result.
  LOOP AT _classes ASSIGNING &lt;c&gt;
       WHERE NOT types IS INITIAL
         AND NOT uuid IS INITIAL.
    CREATE OBJECT o_comp.
    o_comp-&gt;set_type( &apos;CLAS&apos; ).
    o_comp-&gt;set_name( &lt;c&gt;-classname ).
    result-&gt;add( o_comp ).
  ENDLOOP.
ENDMETHOD.
endclass. &quot;ZAPLINK_CONNECTORS implementation
class ZAPLINK_CONTAINER_4INST implementation.
method CLASS_CONSTRUCTOR.
  xmlengine = cl_ixml=&gt;create( ).
endmethod.
method CONSTRUCTOR.
  CREATE OBJECT _complist.
  CREATE OBJECT _options.
  CREATE OBJECT log.
  CALL METHOD log-&gt;init
    EXPORTING
      id_object      = ballog_object
      id_subobject   = ballog_subobject
      auto_upd_custo = abap_true
    EXCEPTIONS
      error          = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
               WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.
  xmldata = xmlengine-&gt;create_document( ).
  file = o_file.
endmethod.
METHOD get_content.
  TRY.
      result = _complist-&gt;clone( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method GET_ROOT.
  root = xmldata-&gt;get_first_child( ).
  check root is bound.
endmethod.
method LOAD_FROM_FILE.
  DATA _streamfactory TYPE REF TO if_ixml_stream_factory.
  DATA _stream TYPE REF TO if_ixml_istream.
  DATA _parser TYPE REF TO if_ixml_parser.
  DATA _doc TYPE REF TO if_ixml_document.
  DATA _xml TYPE string.
  DATA _file  TYPE to_file.
  IF o_file IS BOUND.
    _file = o_file.
  ELSE.
    _file = file.
  ENDIF.
  TRY.
      _file-&gt;load( ).
      _xml = _file-&gt;get_filecontent( ).
    CATCH zaplink_cx_file.
      RETURN.
  ENDTRY.
  file = _file.
  _streamfactory = xmlengine-&gt;create_stream_factory( ).
  _doc = xmlengine-&gt;create_document( ).
  _stream = _streamfactory-&gt;create_istream_string( _xml ).
  _parser = xmlengine-&gt;create_parser(  stream_factory = _streamfactory
                                       istream        = _stream
                                       document       = _doc ).
  _parser-&gt;parse( ).
  IF _doc IS BOUND.
    xmldata = _doc.
  ENDIF.
  _update_componentslist( ).
endmethod.
METHOD transport_to_sap.
  DATA o_connector  TYPE to_connector.
  DATA o_comp       TYPE to_component.
  DATA o_comp_n     TYPE to_component.
  DATA o_comp_s     TYPE to_component.
  DATA o_listsub    TYPE to_list.
  DATA o_subcomp    TYPE to_component.
  DATA object_off        TYPE to_raw.
  DATA _components  TYPE to_list.
  DATA _xml_comp    TYPE REF TO if_ixml_document.
  DATA _clone       TYPE REF TO if_ixml_node.
  DATA _cx_connector TYPE REF TO zaplink_cx_connector.
  DATA o_raw        TYPE to_raw_base.
  DATA _directory   TYPE ts_directory.
  DATA o_log        TYPE to_log.
  DATA o_todo       TYPE to_list.
  DATA o_remain     TYPE to_list.
  DATA o_skiplist   TYPE to_list.
  DATA o_deplist    TYPE to_list.
  CHECK object_list IS BOUND.
  TRY.
      object_list-&gt;keep_commun_list( _complist ).
      o_todo = object_list-&gt;clone( ).
      DO.
        CREATE OBJECT o_skiplist.
        o_remain = o_todo-&gt;clone( ).
        o_todo-&gt;display_progress = abap_true.
        o_todo-&gt;order_kind = zaplink_list=&gt;order_kinds-install.
        o_todo-&gt;init_sel_iter( ).
        o_comp_n = o_todo-&gt;get_next( ).
        WHILE o_comp_n IS BOUND.
          o_comp = o_comp_n.    o_comp_n = o_todo-&gt;get_next( ).    &quot; to allow continue
          o_comp_s = _complist-&gt;search( o_comp ).
          o_connector = o_comp_s-&gt;connector( ).
          o_connector-&gt;options = _options.
          o_log = o_comp_s-&gt;get_msg_coll( ).
          IF NOT o_log IS BOUND.
            CREATE OBJECT o_log.
            o_comp_s-&gt;set_msg_coll( o_log ).
            CALL METHOD o_log-&gt;init
              EXPORTING
                id_object      = ballog_object
                id_subobject   = ballog_subobject
                auto_upd_custo = abap_true
              EXCEPTIONS
                error          = 1
                OTHERS         = 2.
            IF sy-subrc &lt;&gt; 0.
              log-&gt;add_symsg( ).
            ENDIF.
          ENDIF.
          _xml_comp = xmlengine-&gt;create_document( ).
          _clone = _find_component_node( o_comp_s ).
          _clone = _clone-&gt;clone( ).
          _xml_comp-&gt;if_ixml_node~append_child( _clone ).
          TRY.
              o_raw = zaplink_connectors=&gt;node_2_raw( _clone ).
              CREATE OBJECT o_deplist.
              o_deplist-&gt;add_keys( o_raw-&gt;dependencies ).
              IF o_remain-&gt;has_any( o_deplist ) = abap_true.
                o_skiplist-&gt;add( o_comp ). &quot; because dependcies will be processed
                CONTINUE.
              ENDIF.
              _directory = _options-&gt;directory-&gt;set_directory( o_raw ).
              o_log-&gt;add_from_instance( _options-&gt;directory-&gt;o_log ).
              o_listsub = o_comp_s-&gt;get_subcomponents( ).
              IF o_listsub IS BOUND.
                o_listsub-&gt;display_progress = abap_false.
                o_listsub-&gt;init_iter( ).
                o_subcomp = o_listsub-&gt;get_next( ).
                WHILE o_subcomp IS BOUND.
                  _clone = _find_component_node( component = o_comp_s
                                                  sub_comp = o_subcomp ).
                  o_raw = zaplink_connectors=&gt;node_2_raw( _clone ).
                  _options-&gt;directory-&gt;set_directory( o_raw ).
                  IF _options-&gt;directory-&gt;o_log IS BOUND.
                    o_log-&gt;add_from_instance( _options-&gt;directory-&gt;o_log ).
                  ENDIF.
                  o_subcomp = o_listsub-&gt;get_next( ).
                ENDWHILE.
              ENDIF.
              _components = o_connector-&gt;import_to_sap( _xml_comp ).
              o_comp-&gt;set_subcomponents( _components ).
              o_comp-&gt;set_msg_coll( o_connector-&gt;application_log ).
              IF _components-&gt;search( o_comp ) IS BOUND.    _components-&gt;remove( o_comp ).    ENDIF.
              o_remain-&gt;remove( o_comp ).                   &quot; Issue 47
            CATCH zaplink_cx_connector INTO _cx_connector.
              o_comp-&gt;set_exception( _cx_connector ).
              CALL METHOD log-&gt;add_exception
                EXPORTING
                  exception = _cx_connector.
              mac_add_log o_connector-&gt;application_log o_log &apos;E&apos;.   &quot; append application log if error is present
          ENDTRY.
        ENDWHILE.
        IF o_skiplist-&gt;is_empty( ) = abap_true.   EXIT.   ENDIF.
        IF o_todo-&gt;get_count( ) = o_skiplist-&gt;get_count( ).
          RAISE EXCEPTION TYPE zaplink_cx_container EXPORTING textid = zaplink_cx_container=&gt;circular_dependencies.
        ENDIF.
        o_todo = o_skiplist-&gt;clone( ).    o_todo-&gt;select_all( ).
      ENDDO.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD uninstall_from_sap.
  DATA o_connector  TYPE to_connector.
  DATA o_comp       TYPE to_component.
  DATA object       TYPE to_raw.
  DATA _done        TYPE abap_bool.
  DATA s_key        TYPE ts_component.
  DATA _cx_connector TYPE REF TO zaplink_cx_connector.
  CHECK object_list IS BOUND.
  TRY.
      object_list-&gt;display_progress = abap_true.
      object_list-&gt;order_kind = zaplink_list=&gt;order_kinds-uninstall.
      object_list-&gt;init_sel_iter( ).
      o_comp = object_list-&gt;get_next( ).
      WHILE o_comp IS BOUND.
        o_connector = o_comp-&gt;connector( ).
        TRY.
            s_key = o_comp-&gt;get_key( ).
            _done = o_connector-&gt;delete_from_sap( o_comp ).
            IF _done = abap_true.
              SET EXTENDED CHECK OFF.
              IF 1 = 2. MESSAGE s001(zaplink_connector) WITH space space. ENDIF.
              SET EXTENDED CHECK ON.
              CALL METHOD log-&gt;add_success
                EXPORTING
                  id_msgid     = &apos;ZAPLINK_CONNECTOR&apos;
                  id_msgno     = &apos;001&apos;
                  id_msgv1     = s_key-type
                  id_msgv2     = s_key-name
                 .
            ELSE.
              SET EXTENDED CHECK OFF.
              IF 1 = 2. MESSAGE e003(zaplink_connector) WITH space space. ENDIF.
              SET EXTENDED CHECK ON.
              CALL METHOD log-&gt;add_error
                EXPORTING
                  id_msgid     = &apos;ZAPLINK_CONNECTOR&apos;
                  id_msgno     = &apos;003&apos;
                  id_msgv1     = s_key-type
                  id_msgv2     = s_key-name
                  .
            ENDIF.
            IF o_connector-&gt;application_log IS BOUND.
              IF o_connector-&gt;application_log-&gt;has_messages_of_msgt( id_msgty     = &apos;W&apos; ) = abap_true.
                CALL METHOD log-&gt;add_from_instance
                  EXPORTING
                    io_msglist        = o_connector-&gt;application_log
                    if_add_as_subnode = abap_true.
              ENDIF.
            ENDIF.
          CATCH zaplink_cx_connector INTO _cx_connector.
            CALL METHOD log-&gt;add_exception
              EXPORTING
                exception = _cx_connector.
        ENDTRY.
        o_comp = object_list-&gt;get_next( ).
      ENDWHILE.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD _update_componentslist.
  DATA o_iterator  TYPE REF TO if_ixml_node_iterator.
  DATA o_node      TYPE REF TO if_ixml_node.
  o_iterator = xmldata-&gt;create_iterator( depth = 1 ).   &quot; Do only root level
  o_node = o_iterator-&gt;get_next( ).
  WHILE o_node IS BOUND.
    TRY.
        _search_components( o_node ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
    o_node = o_iterator-&gt;get_next( ).&quot; get next one to allow to use &apos;continue&apos;
  ENDWHILE.
ENDMETHOD.
METHOD _is_subcomponent.
  data _cursor type ref to IF_IXML_NODE.
  result = abap_false.
  clear o_cursor.
  _cursor = node-&gt;get_parent( ).
  WHILE _cursor IS BOUND.
    IF _cursor-&gt;get_name( ) = comp_nodename.
      result = abap_true.
      o_cursor = _cursor.
    ENDIF.
    _cursor = _cursor-&gt;get_parent( ).
  ENDWHILE.
ENDMETHOD.
METHOD _find_component_node.
  DATA o_comp   TYPE to_component.
  DATA o_list   TYPE to_list.
  DATA _cx_list TYPE REF TO zaplink_cx_list.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _nodeindex.
  TRY.
    TRY.
        o_comp = _complist-&gt;search( component ).
      CATCH zaplink_cx_list INTO _cx_list.
        IF _cx_list-&gt;textid = zaplink_cx_list=&gt;not_found.
          EXIT.
        ELSE.
          CREATE OBJECT o_mycx
            EXPORTING
              textid  = zaplink_cx=&gt;system_error
              prev_cx = _cx_list.
          o_mycx-&gt;update( ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
    ENDTRY.
    CHECK o_comp IS BOUND.
    o_list = o_comp-&gt;get_subcomponents( ).
    IF sub_comp IS BOUND AND o_list IS BOUND.
      o_comp = o_list-&gt;search( sub_comp ).
    ENDIF.
    READ TABLE _nodeindex ASSIGNING &lt;i&gt;
         WITH TABLE KEY key = o_comp.
    IF sy-subrc = 0.
      node = &lt;i&gt;-node.
    ENDIF.
    mac_def_catch ZAPLINK_CX_CONTAINER.
  ENDTRY.
ENDMETHOD.
method GET_OPTIONS.
result = _options.
endmethod.
method SET_OPTIONS.
check data &lt;&gt; _options.
  _options = data.
endmethod.
METHOD _search_components.
  DATA o_iterator  TYPE REF TO if_ixml_node_iterator.
  DATA o_filt_name TYPE REF TO if_ixml_node_filter.
  DATA o_node      TYPE REF TO  if_ixml_node.
  DATA str         TYPE string.
  CHECK node IS BOUND.
  str = node-&gt;get_name( ).
  CHECK str &lt;&gt; &apos;#document&apos;.
  IF str = comp_nodename.
    TRY.
        _add_to_componentslist( node ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
  ELSE.
    o_filt_name = node-&gt;create_filter_name( name = comp_nodename ).
    o_iterator = node-&gt;create_iterator_filtered( filter = o_filt_name ).
    o_node = o_iterator-&gt;get_next( ).
    WHILE o_node IS BOUND.
      TRY.
          _add_to_componentslist( o_node ).
        CATCH zaplink_cx INTO o_cx.
          mac_cascade_raise o_mycx o_cx.
      ENDTRY.
      o_node = o_iterator-&gt;get_next( ).&quot; get next one to allow to use &apos;continue&apos;
    ENDWHILE.
  ENDIF.
ENDMETHOD.
METHOD _add_to_componentslist.
  DATA o_raw       TYPE to_raw_base.
  DATA o_comp      TYPE to_component.
  DATA o_comp_p    TYPE to_component.
  DATA o_cx_comp   TYPE REF TO zaplink_cx_component.
  DATA o_conn      TYPE to_connector.
  DATA o_list      TYPE to_list.
  DATA _index      LIKE LINE OF _nodeindex.
  DATA str         TYPE string.
  DATA d_uuid_init TYPE td_connuuid.
  CHECK node IS BOUND.
  str = node-&gt;get_name( ).
  CHECK str = comp_nodename. &quot; Security
  _index-node = node.          &quot; save current node
  TRY.
      o_raw = zaplink_connectors=&gt;node_2_raw( _index-node ).
      IF o_raw-&gt;name IS INITIAL.
        EXIT.
      ENDIF.
      TRY.
          o_comp = o_raw-&gt;get_component( ).
          TRY.
              d_uuid_init = o_raw-&gt;connector.
              o_comp-&gt;set_connuuid( d_uuid_init ).
              o_conn = o_comp-&gt;connector( ).
            CATCH zaplink_cx_component INTO o_cx_comp.
              CLEAR o_raw-&gt;connector.
              o_comp-&gt;set_connuuid( d_uuid_init ).
              o_conn = o_comp-&gt;connector( ).
          ENDTRY.
        CATCH zaplink_cx_component INTO o_cx_comp.
          CALL METHOD log-&gt;add_exception
            EXPORTING
              exception    = o_cx_comp
              .
      ENDTRY.
      IF NOT o_conn IS BOUND.
      ELSE.
        IF o_conn-&gt;is_supported_version( o_raw-&gt;version ) = abap_false.
        ENDIF.
      ENDIF.
      _index-key = o_comp.
      MODIFY TABLE _nodeindex FROM _index.
      IF sy-subrc &lt;&gt; 0.
        INSERT _index INTO TABLE _nodeindex.
      ENDIF.
      IF _is_subcomponent( _index-node ) = abap_false.
        _complist-&gt;add( o_comp ).
      ELSE.
        o_raw = zaplink_connectors=&gt;node_2_raw( o_cursor ).
        o_comp_p = o_raw-&gt;get_component( ).
        o_comp_p = _complist-&gt;search( o_comp_p ).
        o_list = o_comp_p-&gt;get_subcomponents( ).
        IF NOT o_list IS BOUND.
          CREATE OBJECT o_list.
          o_comp_p-&gt;set_subcomponents( o_list ).
        ENDIF.
        o_list-&gt;add( o_comp ).
      ENDIF.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
endclass. &quot;ZAPLINK_CONTAINER_4INST implementation
class ZAPLINK_EASYXML implementation.
DEFINE mac_syserr_log.
  IF &amp;1 &lt;&gt; 0.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 000 WITH abap_true abap_true abap_true. ENDIF.
    SET EXTENDED CHECK ON.
    crc = &amp;1.
    CALL METHOD application_log-&gt;add_error
      EXPORTING
        id_msgno     = &apos;000&apos;
        id_msgv1     = crc
        id_msgv2     = &amp;2
        id_msgv3     = &amp;3
        .
  ENDIF.
END-OF-DEFINITION.
METHOD add_any.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA string    TYPE string.
  DATA node      TYPE REF TO if_ixml_element.
  IF typedesc IS BOUND.
    _desc = typedesc.
  ELSE.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = any ).
  ENDIF.
  _desc = get_ref_type( _desc ).
  stack_descr( _desc ).
  CASE _desc-&gt;kind.
    WHEN cl_abap_datadescr=&gt;kind_ref.
      mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_ANY&apos;.
    WHEN cl_abap_datadescr=&gt;kind_elem.
      string = elem_2_string( any = any
                        type_desc = _desc ).
      IF NOT string IS INITIAL.
        IF name IS INITIAL.
          node = xml_node.
        ELSE.
          node = xmldoc-&gt;create_element( name ).
        ENDIF.
        rc = node-&gt;set_value( string ).
        mac_syserr_log rc &apos;set_value&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_ANY&apos;.
        xml_node-&gt;append_child( node ).
      ENDIF.
    WHEN cl_abap_datadescr=&gt;kind_struct.
      add_structure(   xmldoc = xmldoc
                     xml_node = xml_node
                         name = name
                    structure = any ).
    WHEN cl_abap_datadescr=&gt;kind_table.
      add_table(   xmldoc = xmldoc
                 xml_node = xml_node
                     name = name
                    table = any ).
    WHEN cl_abap_datadescr=&gt;kind_class.
      add_object(   xmldoc = xmldoc
                  xml_node = xml_node
                      name = name
                    object = any
                  typedesc = _desc ).
    WHEN cl_abap_datadescr=&gt;kind_intf.
      string = _desc-&gt;get_relative_name( ).
      SET EXTENDED CHECK OFF.
      IF 1 = 2. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 001 WITH name string. ENDIF.
      SET EXTENDED CHECK ON.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;001&apos;
          id_msgv1     = name
          id_msgv2     = string
          .
  ENDCASE.
  unstack( ).
ENDMETHOD.
METHOD add_object.
  DATA node      TYPE REF TO if_ixml_element.
  DATA o_obj     TYPE REF TO cl_abap_classdescr.
  DATA typedescr TYPE REF TO cl_abap_typedescr.
  DATA svalue    TYPE string.
  DATA sname     TYPE string.
  DATA attr_name TYPE string.
  DATA self_done TYPE flag.
  FIELD-SYMBOLS:
    &lt;d&gt; TYPE ANY,
    &lt;a&gt; LIKE LINE OF o_obj-&gt;attributes.
  IF NOT object IS BOUND. EXIT. ENDIF.
  o_obj ?= cl_abap_classdescr=&gt;describe_by_object_ref( p_object_ref = object ).
  unstack( ).
  attr_name = o_obj-&gt;absolute_name.
  stack( attr_name ).
  IF name IS INITIAL.
    node = xml_node.
  ELSE.
    node = xmldoc-&gt;create_element( name ).
  ENDIF.
  READ TABLE o_obj-&gt;attributes TRANSPORTING NO FIELDS
       WITH KEY name = self_fieldname.
  IF sy-subrc = 0.
    ASSIGN object-&gt;(self_fieldname) TO &lt;d&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE structure&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;. &quot;#EC NOTEXT
    ELSE.
      typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
      typedescr = get_ref_type( typedescr ).
      CASE typedescr-&gt;kind.
        WHEN cl_abap_datadescr=&gt;kind_elem.
          svalue = elem_2_string( any = &lt;d&gt;
                            type_desc = typedescr ).
          IF svalue IS NOT INITIAL.
            svalue = protect_string( svalue ).              &quot; Issue 61
            rc = node-&gt;set_value( svalue ).
            mac_syserr_log rc &apos;set_value&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
            IF rc = 0.
              self_done = abap_true.
            ENDIF.
          ENDIF.
        WHEN OTHERS.
          IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 004 WITH abap_true abap_true abap_true abap_true. ENDIF.
          svalue = typedescr-&gt;get_relative_name( ).
          CALL METHOD application_log-&gt;add_warning
            EXPORTING
              id_msgno     = 004
              id_msgv1     = self_fieldname
              id_msgv2     = name
              id_msgv3     = svalue
              id_msgv4     = typedescr-&gt;kind
              .
      ENDCASE.
    ENDIF.
  ENDIF.
  LOOP AT o_obj-&gt;attributes ASSIGNING &lt;a&gt;
    WHERE ( visibility = cl_abap_classdescr=&gt;public OR
            visibility = cl_abap_classdescr=&gt;protected )  &quot; May be friend of the class
      AND is_constant IS INITIAL  &quot; Do not handle constants
      AND is_class    IS INITIAL  &quot; Do not handle class attribute
      AND alias_for   IS INITIAL
      AND is_virtual  IS INITIAL.
    ASSIGN object-&gt;(&lt;a&gt;-name) TO &lt;d&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN object-&gt;(&lt;a&gt;-name)&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;. &quot;#EC NOTEXT
      CONTINUE.
    ENDIF.
    typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
    typedescr = get_ref_type( typedescr ).
    sname = &lt;a&gt;-name.
    CASE typedescr-&gt;kind.
      WHEN cl_abap_datadescr=&gt;kind_elem.
        svalue = elem_2_string( any = &lt;d&gt;
                          type_desc = typedescr ).
        IF svalue IS NOT INITIAL AND ( &lt;a&gt;-name &lt;&gt; self_fieldname OR self_done &lt;&gt; abap_true ).
          rc = node-&gt;set_attribute( name = sname
                                   value = svalue ).
          mac_syserr_log rc &apos;set_attribute&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;. &quot;#EC NOTEXT
        ENDIF.
      WHEN OTHERS.
        attr_name = &lt;a&gt;-name.
        stack( attr_name ).
        add_any(   xmldoc = xmldoc
                 xml_node = node
                     name = attr_name
                      any = &lt;d&gt; ).
        unstack( ).
    ENDCASE.
  ENDLOOP.
  IF node IS BOUND AND NOT name IS INITIAL.
    rc = xml_node-&gt;append_child( node ).
    mac_syserr_log rc &apos;append_child&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;. &quot;#EC NOTEXT
  ENDIF.
ENDMETHOD.
METHOD add_structure.
  DATA node        TYPE REF TO if_ixml_element.
  DATA sname       TYPE string.
  DATA svalue      TYPE string.
  DATA structdescr TYPE REF TO cl_abap_structdescr.
  DATA typedescr   TYPE REF TO cl_abap_typedescr.
  FIELD-SYMBOLS:
    &lt;fieldvalue&gt; TYPE ANY,
    &lt;fld&gt; TYPE ANY,
    &lt;c&gt; LIKE LINE OF structdescr-&gt;components.
  IF structure IS INITIAL. EXIT. ENDIF.
  IF name IS INITIAL.
    node = xml_node.
  ELSE.
    node = xmldoc-&gt;create_element( name ).
  ENDIF.
  structdescr ?= cl_abap_structdescr=&gt;describe_by_data( structure ).
  READ TABLE structdescr-&gt;components TRANSPORTING NO FIELDS
       WITH KEY name = self_fieldname.
  IF sy-subrc = 0.
    ASSIGN COMPONENT self_fieldname OF STRUCTURE structure TO &lt;fieldvalue&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE structure&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
    ELSE.
      typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;fieldvalue&gt; ).
      typedescr = get_ref_type( typedescr ).
      CASE typedescr-&gt;kind.
        WHEN cl_abap_datadescr=&gt;kind_elem.
          svalue = elem_2_string( any = &lt;fieldvalue&gt;
                            type_desc = typedescr ).
          IF svalue IS NOT INITIAL.
            svalue = protect_string( svalue ).              &quot; Issue 61
            rc = node-&gt;set_value( svalue ).
            mac_syserr_log rc &apos;set_value&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
          ENDIF.
        WHEN OTHERS.
          IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 004 WITH abap_true abap_true abap_true abap_true. ENDIF.
          svalue = typedescr-&gt;get_relative_name( ).
          CALL METHOD application_log-&gt;add_warning
            EXPORTING
              id_msgno     = 004
              id_msgv1     = self_fieldname
              id_msgv2     = name
              id_msgv3     = svalue
              id_msgv4     = typedescr-&gt;kind
              .
      ENDCASE.
    ENDIF.
  ENDIF.
  LOOP AT structdescr-&gt;components ASSIGNING &lt;c&gt;.
    ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE structure TO &lt;fieldvalue&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE structure&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
      CONTINUE.
    ENDIF.
    typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;fieldvalue&gt; ).
    typedescr = get_ref_type( typedescr ).
    sname = &lt;c&gt;-name.
    CASE typedescr-&gt;kind.
      WHEN cl_abap_datadescr=&gt;kind_ref.
        mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
      WHEN cl_abap_datadescr=&gt;kind_elem.
        svalue = elem_2_string( any = &lt;fieldvalue&gt;
                          type_desc = typedescr ).
        IF svalue IS NOT INITIAL AND &lt;c&gt;-name &lt;&gt; self_fieldname.
          IF sname(1) CO &apos;0123456789&apos;.    &quot; Issue 46 : Field names strating with numbre in attributes
            CONCATENATE issue46_prefix sname INTO sname. UNASSIGN &lt;fld&gt;. ASSIGN COMPONENT sname OF STRUCTURE structure TO &lt;fld&gt;.
            WHILE &lt;fld&gt; IS ASSIGNED. CONCATENATE issue46_prefix sname INTO sname. UNASSIGN &lt;fld&gt;. ASSIGN COMPONENT sname OF STRUCTURE structure TO &lt;fld&gt;. ENDWHILE.
          ENDIF.
          rc = node-&gt;set_attribute( name = sname
                                   value = svalue ).
          mac_syserr_log rc &apos;set_attribute&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
        ENDIF.
      WHEN OTHERS.
        stack( sname ).
        add_any( xmldoc = xmldoc
               xml_node = node
                   name = sname
                    any = &lt;fieldvalue&gt;
               typedesc = typedescr ).
        unstack( ).
    ENDCASE.
  ENDLOOP.
  IF node IS BOUND AND NOT name IS INITIAL.
    rc = xml_node-&gt;append_child( node ).
    mac_syserr_log rc &apos;append_child&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;. &quot;#EC NOTEXT
  ENDIF.
ENDMETHOD.
method ADD_TABLE.
  DATA node        TYPE REF TO if_ixml_element.
  FIELD-SYMBOLS:
    &lt;l&gt; TYPE ANY.
  IF table IS INITIAL. EXIT. ENDIF.
  IF name IS INITIAL.
    node = xml_node.
  ELSE.
    node = xmldoc-&gt;create_element( name ).
  ENDIF.
  LOOP AT table ASSIGNING &lt;l&gt;.
    add_any(   xmldoc = xmldoc
             xml_node = node
                 name = EN_LINE
                  any = &lt;l&gt; ).
  ENDLOOP.
  IF node IS BOUND AND NOT name IS INITIAL.
    rc = xml_node-&gt;append_child( node ).
    mac_syserr_log rc &apos;append_child&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_TABLE&apos;.
  ENDIF.
endmethod.
method ANY2XML.
  DATA xml_node  TYPE REF TO if_ixml_element.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA string    TYPE string.
  xmldoc = ixml-&gt;create_document( ).
  xml_node = xmldoc-&gt;create_element( type ). stack( type ).
  IF attributs IS SUPPLIED.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = attributs ).
    _desc = get_ref_type( _desc ).
    stack_descr( _desc ).
    CASE _desc-&gt;kind.
      WHEN cl_abap_datadescr=&gt;kind_ref.
        mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
      WHEN cl_abap_datadescr=&gt;kind_struct.
        add_structure(   xmldoc = xmldoc
                       xml_node = xml_node
                      structure = attributs ).
        &quot; cl_abap_datadescr=&gt;kind_elem.
        &quot; cl_abap_datadescr=&gt;kind_table.
        &quot; cl_abap_datadescr=&gt;kind_class.
      WHEN OTHERS. &quot; cl_abap_datadescr=&gt;kind_intf.
        string = _desc-&gt;get_relative_name( ).
        MESSAGE ID MSGID TYPE &apos;X&apos; NUMBER 001 WITH string &apos;ATTRIBUTES&apos;.
    ENDCASE.
    unstack( ).
  ENDIF.
  add_any( xmldoc = xmldoc
         xml_node = xml_node
              any = any ).
  rc = xmldoc-&gt;append_child( xml_node ).
  mac_syserr_log rc &apos;append_child&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
  IF application_log-&gt;has_messages_of_msgt( id_msgty     = &apos;E&apos; ) IS INITIAL.
    IF NOT application_log IS BOUND. MESSAGE ID MSGID TYPE &apos;S&apos; NUMBER 006. ENDIF.
    CALL METHOD application_log-&gt;add_success
      EXPORTING
        id_msgno     = &apos;006&apos;
        .
  ENDIF.
  unstack( ).
endmethod.
METHOD class_constructor.
  DATA s_char LIKE LINE OF char_to_protect.
  s_char-sign = &apos;I&apos;.    s_char-option = &apos;EQ&apos;.
  s_char-low = space.                                 APPEND s_char TO char_to_protect.
  s_char-low = CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE.       APPEND s_char TO char_to_protect.
  s_char-low = CL_ABAP_CHAR_UTILITIES=&gt;CR_LF.         APPEND s_char TO char_to_protect.
  s_char-low = CL_ABAP_CHAR_UTILITIES=&gt;FORM_FEED.     APPEND s_char TO char_to_protect.
  CONCATENATE &apos;^[&apos; issue46_prefix &apos;]*&apos; INTO issue46_regex.
ENDMETHOD.
method CONSTRUCTOR.
  ixml = cl_ixml=&gt;create( ).
  reset( ).
endmethod.
METHOD elem_2_string.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA exception TYPE REF TO cx_root.
  DATA l_convin  TYPE REF TO cl_abap_conv_in_ce.
  IF any IS INITIAL.
    EXIT.
  ENDIF.
  IF type_desc IS BOUND.
    _desc = type_desc.
  ELSE.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = any ).
  ENDIF.
  IF _desc-&gt;kind &lt;&gt; cl_abap_datadescr=&gt;kind_elem. EXIT. ENDIF.
  CASE _desc-&gt;type_kind.
    WHEN cl_abap_typedescr=&gt;typekind_xstring
      OR cl_abap_typedescr=&gt;typekind_xsequence.
      TRY.
          l_convin = cl_abap_conv_in_ce=&gt;create( encoding = &apos;UTF-8&apos;
                                                    input = any ).
          CALL METHOD l_convin-&gt;read
            IMPORTING
              data = string.
        CATCH cx_root INTO exception.
          application_log-&gt;add_exception( exception = exception ).
      ENDTRY.
    WHEN cl_abap_typedescr=&gt;typekind_char
      OR cl_abap_typedescr=&gt;typekind_clike
      OR cl_abap_typedescr=&gt;typekind_date
      OR cl_abap_typedescr=&gt;typekind_time
      OR cl_abap_typedescr=&gt;typekind_string
      OR cl_abap_typedescr=&gt;typekind_csequence
      OR cl_abap_typedescr=&gt;typekind_num
      OR cl_abap_typedescr=&gt;typekind_numeric
      OR cl_abap_typedescr=&gt;typekind_int
      OR cl_abap_typedescr=&gt;typekind_int1
      OR cl_abap_typedescr=&gt;typekind_int2
      OR cl_abap_typedescr=&gt;typekind_float
      OR cl_abap_typedescr=&gt;typekind_packed
      OR cl_abap_typedescr=&gt;typekind_simple
      OR cl_abap_typedescr=&gt;typekind_hex        &quot; Convert Hex to String works
        .
      TRY.
          string = any.
        CATCH cx_root INTO exception.
          IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 002 WITH abap_true abap_true abap_true. ENDIF.
          CALL METHOD application_log-&gt;add_error
            EXPORTING
              id_msgno     = &apos;002&apos;
              id_msgv1     = any
              id_msgv2     = string
              .
      ENDTRY.
    WHEN OTHERS.
      mac_syserr_log -1 &apos;WHEN OTHERS&apos; &apos;ZAPLINK_EASYXML-&gt;ELEM_2_STRING&apos;.
  ENDCASE.
ENDMETHOD.
method GET_ATTRIBUTS.
  DATA root_node   TYPE REF TO if_ixml_element.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA string    TYPE string.
  root_node = xmldoc-&gt;get_root_element( ).
  IF root_node IS BOUND.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = attributs ).
    _desc = get_ref_type( _desc ).
    stack_descr( _desc ).
    CASE _desc-&gt;kind.
      WHEN cl_abap_datadescr=&gt;kind_ref.
        mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
      WHEN cl_abap_datadescr=&gt;kind_struct.
        read_structure( EXPORTING
                         xml_node = root_node
                         CHANGING
                        structure = attributs ).
        &quot; cl_abap_datadescr=&gt;kind_elem.
        &quot; cl_abap_datadescr=&gt;kind_table.
        &quot; cl_abap_datadescr=&gt;kind_class.
      WHEN OTHERS. &quot; cl_abap_datadescr=&gt;kind_intf.
        string = _desc-&gt;get_relative_name( ).
        MESSAGE ID msgid TYPE &apos;X&apos; NUMBER 001 WITH string &apos;ATTRIBUTES&apos;.
    ENDCASE.
    unstack( ).
  ENDIF.
endmethod.
method GET_REF_TYPE.
  DATA o_ref      TYPE REF TO cl_abap_refdescr.
  IF typedesc-&gt;kind = cl_abap_datadescr=&gt;kind_ref.
    o_ref ?= typedesc.
    ref_type = o_ref-&gt;get_referenced_type( ).
  ELSE.
    ref_type = typedesc.
  ENDIF.
endmethod.
method IS_SIMPLE_TYPE_KIND.
  result = &apos;?&apos;.  &quot; unknow
  CASE TYPE_KIND.
    WHEN cl_abap_typedescr=&gt;typekind_char
      OR cl_abap_typedescr=&gt;typekind_clike
      OR cl_abap_typedescr=&gt;typekind_date
      OR cl_abap_typedescr=&gt;typekind_time
      OR cl_abap_typedescr=&gt;typekind_string
      OR cl_abap_typedescr=&gt;typekind_xstring
      OR cl_abap_typedescr=&gt;typekind_num
      OR cl_abap_typedescr=&gt;typekind_numeric
      OR cl_abap_typedescr=&gt;typekind_int
      OR cl_abap_typedescr=&gt;typekind_int1
      OR cl_abap_typedescr=&gt;typekind_int2
      OR cl_abap_typedescr=&gt;typekind_float
      OR cl_abap_typedescr=&gt;typekind_packed
      OR cl_abap_typedescr=&gt;typekind_simple
        .
     result = abap_true.
    WHEN cl_abap_typedescr=&gt;typekind_class
      or cl_abap_typedescr=&gt;typekind_struct1
      or cl_abap_typedescr=&gt;typekind_struct2
      or cl_abap_typedescr=&gt;typekind_table
      .
     result = abap_false.
    WHEN cl_abap_typedescr=&gt;typekind_any.
    WHEN cl_abap_typedescr=&gt;typekind_csequence.
    WHEN cl_abap_typedescr=&gt;typekind_data.
    WHEN cl_abap_typedescr=&gt;typekind_dref.
    WHEN cl_abap_typedescr=&gt;typekind_hex.
    WHEN cl_abap_typedescr=&gt;typekind_intf.
    WHEN cl_abap_typedescr=&gt;typekind_iref.
    WHEN cl_abap_typedescr=&gt;typekind_oref.
    WHEN cl_abap_typedescr=&gt;typekind_w.
    WHEN cl_abap_typedescr=&gt;typekind_xsequence.
  ENDCASE.
endmethod.
method NODE2STRING.
  DATA _ixml TYPE REF TO if_ixml.
  DATA _streamfactory TYPE REF TO if_ixml_stream_factory.
  DATA _outputstream TYPE REF TO if_ixml_ostream.
  DATA _printxmldoc TYPE REF TO cl_xml_document.
  _ixml = cl_ixml=&gt;create( ).
  _streamfactory = _ixml-&gt;create_stream_factory( ).
  _outputstream = _streamfactory-&gt;create_ostream_cstring( string ).
  CALL METHOD xml_node-&gt;render
    EXPORTING
      ostream   = _outputstream.
  CREATE OBJECT _printxmldoc.
  _printxmldoc-&gt;parse_string( string ).
endmethod.
METHOD read_any.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA string    TYPE string.
  DATA name      TYPE string.
  DATA object    TYPE REF TO object.
  IF typedesc IS BOUND.
    _desc = typedesc.
  ELSE.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = any ).
  ENDIF.
  _desc = get_ref_type( _desc ).
  stack_descr( _desc ).
  CASE _desc-&gt;kind.
    WHEN cl_abap_datadescr=&gt;kind_ref.
      mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref&apos; &apos;ZAPLINK_EASYXML-&gt;READ_ANY&apos;.
    WHEN cl_abap_datadescr=&gt;kind_elem.
      string = xml_node-&gt;get_value( ).
      string_2_elem( EXPORTING
                        string = string
                    type_desc = _desc
                     CHANGING
                          any = any ).
    WHEN cl_abap_datadescr=&gt;kind_struct.
      read_structure( EXPORTING
                       xml_node = xml_node
                       CHANGING
                      structure = any ).
    WHEN cl_abap_datadescr=&gt;kind_table.
      read_table( EXPORTING
                   xml_node = xml_node
                   CHANGING
                      table = any ).
    WHEN cl_abap_datadescr=&gt;kind_class.
      object = any.
      read_object( EXPORTING
                    xml_node = xml_node
                    typedesc = _desc
                    CHANGING
                      object = object ).
      IF any &lt;&gt; object.   any ?= object.    ENDIF.
    WHEN cl_abap_datadescr=&gt;kind_intf.
      string = _desc-&gt;get_relative_name( ).
      name = xml_node-&gt;get_name( ).
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 001 WITH space space. ENDIF.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;001&apos;
          id_msgv1     = name
          id_msgv2     = string
          .
  ENDCASE.
  unstack( ).
ENDMETHOD.
METHOD read_object.
  DATA o_ref      TYPE REF TO cl_abap_refdescr.
  DATA elem       TYPE REF TO if_ixml_element.
  DATA next_node  TYPE REF TO if_ixml_node.
  DATA node       TYPE REF TO if_ixml_node.
  DATA o_obj      TYPE REF TO cl_abap_classdescr.
  DATA iterator   TYPE REF TO if_ixml_node_iterator.
  DATA childs     TYPE REF TO if_ixml_node_list.
  DATA attrs      TYPE REF TO if_ixml_named_node_map.
  DATA data_type  TYPE string.
  DATA attr_name  TYPE string.
  DATA name       TYPE string.
  DATA svalue     TYPE string.
  DATA typedescr  TYPE REF TO cl_abap_typedescr.
  DATA _cx        TYPE REF TO cx_root.
  FIELD-SYMBOLS:
    &lt;d&gt; TYPE ANY.
  IF NOT object IS BOUND AND NOT typedesc IS BOUND. EXIT. ENDIF.
  IF NOT object IS BOUND.
    data_type = typedesc-&gt;get_relative_name( ).
    TRY.
        CREATE OBJECT object TYPE (data_type).
      CATCH cx_root INTO _cx.
        CALL METHOD application_log-&gt;add_exception
          EXPORTING
            exception    = _cx
            .
        EXIT.
    ENDTRY.
  ENDIF.
  o_obj ?= cl_abap_classdescr=&gt;describe_by_object_ref( p_object_ref = object ).
  unstack( ).
  attr_name = o_obj-&gt;absolute_name.
  stack( attr_name ).
  svalue = get_node_text( xml_node ).                       &quot; Issue 38
  IF NOT svalue IS INITIAL.
    svalue = unprotect_string( svalue ).                    &quot; Issue 61
    ASSIGN object-&gt;(self_fieldname) TO &lt;d&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN object-&gt;(self_fieldname) TO &lt;d&gt;&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;. &quot;#EC NOTEXT
    ELSE.
      typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
      typedescr = get_ref_type( typedescr ).
      CASE typedescr-&gt;kind.
        WHEN cl_abap_datadescr=&gt;kind_ref.
          mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref (Value)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;. &quot;#EC NOTEXT
        WHEN cl_abap_datadescr=&gt;kind_elem.
          string_2_elem( EXPORTING
                            string = svalue
                        type_desc = typedescr
                         CHANGING
                              any = &lt;d&gt; ).
        WHEN OTHERS.
          mac_syserr_log -1 &apos;NOT cl_abap_datadescr=&gt;kind_elem (Value)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;. &quot;#EC NOTEXT
      ENDCASE.
    ENDIF.
  ENDIF.
  attrs = xml_node-&gt;get_attributes( ).
  iterator = attrs-&gt;create_iterator( ).
  next_node = iterator-&gt;get_next( ).
  WHILE next_node IS BOUND.
    node = next_node.    next_node ?= iterator-&gt;get_next( ).
    attr_name = node-&gt;get_name( ).
    READ TABLE o_obj-&gt;attributes TRANSPORTING NO FIELDS WITH KEY name = attr_name.
    IF sy-subrc &lt;&gt; 0.
      data_type = o_obj-&gt;get_relative_name( ).
      name = xml_node-&gt;get_name( ).
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 003 WITH abap_true abap_true abap_true. ENDIF.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;003&apos;
          id_msgv1     = attr_name
          id_msgv2     = name
          id_msgv3     = data_type
          .
    ELSE.
      ASSIGN object-&gt;(attr_name) TO &lt;d&gt;.
      IF sy-subrc &lt;&gt; 0.
        mac_syserr_log sy-subrc &apos;ASSIGN object-&gt;(attr_name) TO &lt;d&gt; (Attrs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
      ELSE.
        typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
        typedescr = get_ref_type( typedescr ).
        CASE typedescr-&gt;kind.
          WHEN cl_abap_datadescr=&gt;kind_ref.
            mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref (Attrs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
          WHEN cl_abap_datadescr=&gt;kind_elem.
            svalue = node-&gt;get_value( ).
            string_2_elem( EXPORTING
                              string = svalue
                          type_desc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
          WHEN OTHERS.
            TRY.
                elem ?= node.
                stack( attr_name ).
                read_any( EXPORTING
                           xml_node = elem
                           typedesc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
                unstack( ).
              CATCH cx_root INTO _cx.
                application_log-&gt;add_exception( exception = _cx ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
  ENDWHILE.
  childs = xml_node-&gt;get_children( ).
  iterator = childs-&gt;create_iterator( ).
  next_node = iterator-&gt;get_next( ).
  WHILE next_node IS BOUND.
    node = next_node.    next_node ?= iterator-&gt;get_next( ).
    attr_name = node-&gt;get_name( ).
    CHECK node_is_not_type( node = node type = if_ixml_node=&gt;co_node_text ) = abap_true. &quot; not text node
    READ TABLE o_obj-&gt;attributes TRANSPORTING NO FIELDS WITH KEY name = attr_name.
    IF sy-subrc &lt;&gt; 0.
      data_type = o_obj-&gt;get_relative_name( ).
      name = xml_node-&gt;get_name( ).
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 003 WITH abap_true abap_true abap_true. ENDIF.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;003&apos;
          id_msgv1     = attr_name
          id_msgv2     = name
          id_msgv3     = data_type
          .
    ELSE.
      ASSIGN object-&gt;(attr_name) TO &lt;d&gt;.
      IF sy-subrc &lt;&gt; 0.
        mac_syserr_log sy-subrc &apos;ASSIGN object-&gt;(attr_name)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;. &quot;#EC NOTEXT
      ELSE.
        typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
        typedescr = get_ref_type( typedescr ).
        CASE typedescr-&gt;kind.
          WHEN cl_abap_datadescr=&gt;kind_elem.
            svalue = node-&gt;get_value( ).
            string_2_elem( EXPORTING
                              string = svalue
                          type_desc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
          WHEN OTHERS.
            TRY.
                elem ?= node.
                stack( attr_name ).
                read_any( EXPORTING
                           xml_node = elem
                           typedesc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
                unstack( ).
              CATCH cx_root INTO _cx.
                application_log-&gt;add_exception( exception = _cx ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
  ENDWHILE.
ENDMETHOD.
METHOD read_structure.
  DATA elem        TYPE REF TO if_ixml_element.
  DATA node        TYPE REF TO if_ixml_node.
  DATA next_node   TYPE REF TO if_ixml_node.
  DATA structdescr TYPE REF TO cl_abap_structdescr.
  DATA typedescr   TYPE REF TO cl_abap_typedescr.
  DATA svalue      TYPE string.
  FIELD-SYMBOLS:
    &lt;d&gt; TYPE ANY,
    &lt;c&gt; LIKE LINE OF structdescr-&gt;components.
  DATA attrs      TYPE REF TO if_ixml_named_node_map.
  DATA iterator   TYPE REF TO if_ixml_node_iterator.
  DATA childs     TYPE REF TO if_ixml_node_list.
  DATA attr_name  TYPE string.
  DATA name       TYPE string.
  DATA data_type  TYPE string.
  DATA exception  TYPE REF TO cx_root.
  DATA o_filter   TYPE REF TO if_ixml_node_filter.
  DATA o_iterator TYPE REF TO if_ixml_node_iterator.
  DATA o_text     TYPE REF TO if_ixml_node.
  svalue = get_node_text( xml_node ).                       &quot; Issue 38
  IF NOT svalue IS INITIAL.
    svalue = unprotect_string( svalue ).                    &quot; Issue 61
    ASSIGN COMPONENT self_fieldname OF STRUCTURE structure TO &lt;d&gt;.
    IF sy-subrc &lt;&gt; 0.
      mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT self_fieldname OF STRUCTURE structure (Value)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
    ELSE.
      typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
      typedescr = get_ref_type( typedescr ).
      CASE typedescr-&gt;kind.
        WHEN cl_abap_datadescr=&gt;kind_ref.
          mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref (Value)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
        WHEN cl_abap_datadescr=&gt;kind_elem.
          string_2_elem( EXPORTING
                            string = svalue
                        type_desc = typedescr
                         CHANGING
                              any = &lt;d&gt; ).
        WHEN OTHERS.
          mac_syserr_log -1 &apos;NOT cl_abap_datadescr=&gt;kind_elem (Value)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
      ENDCASE.
    ENDIF.
  ENDIF.
  structdescr ?= cl_abap_structdescr=&gt;describe_by_data( structure ).
  attrs = xml_node-&gt;get_attributes( ).
  iterator = attrs-&gt;create_iterator( ).
  node = iterator-&gt;get_next( ).
  WHILE node IS BOUND.
    attr_name = node-&gt;get_name( ).    UNASSIGN &lt;c&gt;.
    READ TABLE structdescr-&gt;components ASSIGNING &lt;c&gt; WITH KEY name = attr_name.
    IF sy-subrc &lt;&gt; 0.
      REPLACE FIRST OCCURRENCE OF REGEX issue46_regex IN attr_name WITH ``.
      IF sy-subrc = 0 AND STRLEN( attr_name ) &gt; 0.
        IF attr_name(1) CO &apos;0123456789&apos;.    &quot; Issue 46 : Field names strating with numbre in attributes
          READ TABLE structdescr-&gt;components ASSIGNING &lt;c&gt; WITH KEY name = attr_name.
        ENDIF.
      ENDIF.
      IF NOT &lt;c&gt; IS ASSIGNED.   attr_name = node-&gt;get_name( ).    endif.
    ENDIF.
    IF NOT &lt;c&gt; IS ASSIGNED.
      data_type = structdescr-&gt;get_relative_name( ).
      name = xml_node-&gt;get_name( ).
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 003 WITH abap_true abap_true abap_true. ENDIF.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;003&apos;
          id_msgv1     = attr_name
          id_msgv2     = name
          id_msgv3     = data_type
          .
    ELSE.
      ASSIGN COMPONENT attr_name OF STRUCTURE structure TO &lt;d&gt;.
      IF sy-subrc &lt;&gt; 0.
        mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT attr_name OF STRUCTURE structure (Attrs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
      ELSE.
        typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
        typedescr = get_ref_type( typedescr ).
        CASE typedescr-&gt;kind.
          WHEN cl_abap_datadescr=&gt;kind_ref.
            mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref (Attrs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
          WHEN cl_abap_datadescr=&gt;kind_elem.
            svalue = node-&gt;get_value( ).
            string_2_elem( EXPORTING
                              string = svalue
                          type_desc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
          WHEN OTHERS.
            TRY.
                elem ?= node.
                stack( attr_name ).
                read_any( EXPORTING
                           xml_node = elem
                           typedesc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
                unstack( ).
              CATCH cx_root INTO exception.
                application_log-&gt;add_exception( exception = exception ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
    node ?= iterator-&gt;get_next( ).
  ENDWHILE.
  childs = xml_node-&gt;get_children( ).
  iterator = childs-&gt;create_iterator( ).
  next_node ?= iterator-&gt;get_next( ).
  WHILE next_node IS BOUND.
    node = next_node.    next_node ?= iterator-&gt;get_next( ).
    attr_name = node-&gt;get_name( ).
    CHECK node_is_not_type( node = node type = if_ixml_node=&gt;co_node_text ) = abap_true. &quot; not text node
    READ TABLE structdescr-&gt;components ASSIGNING &lt;c&gt; WITH KEY name = attr_name.
    IF sy-subrc &lt;&gt; 0.
      data_type = structdescr-&gt;get_relative_name( ).
      name = xml_node-&gt;get_name( ).
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;E&apos; NUMBER 003 WITH abap_true abap_true abap_true. ENDIF.
      CALL METHOD application_log-&gt;add_warning
        EXPORTING
          id_msgno     = &apos;003&apos;
          id_msgv1     = attr_name
          id_msgv2     = name
          id_msgv3     = data_type
          .
    ELSE.
      ASSIGN COMPONENT attr_name OF STRUCTURE structure TO &lt;d&gt;.
      IF sy-subrc &lt;&gt; 0.
        mac_syserr_log sy-subrc &apos;ASSIGN COMPONENT attr_name OF STRUCTURE structure (Childs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
      ELSE.
        typedescr = cl_abap_typedescr=&gt;describe_by_data( &lt;d&gt; ).
        typedescr = get_ref_type( typedescr ).
        CASE typedescr-&gt;kind.
          WHEN cl_abap_datadescr=&gt;kind_ref.
            mac_syserr_log -1 &apos;cl_abap_datadescr=&gt;kind_ref (Childs)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;. &quot;#EC NOTEXT
          WHEN cl_abap_datadescr=&gt;kind_elem.
            svalue = node-&gt;get_value( ).
            string_2_elem( EXPORTING
                              string = svalue
                          type_desc = typedescr
                           CHANGING
                                any = &lt;d&gt; ).
          WHEN OTHERS.
            elem ?= node.
            stack( attr_name ).
            read_any( EXPORTING
                       xml_node = elem
                       typedesc = typedescr
                       CHANGING
                            any = &lt;d&gt; ).
            unstack( ).
        ENDCASE.
      ENDIF.
    ENDIF.
  ENDWHILE.
ENDMETHOD.
METHOD read_table.
  DATA o_node     TYPE REF TO if_ixml_node.
  DATA o_n_elem   TYPE REF TO if_ixml_element.
  DATA o_elem     TYPE REF TO if_ixml_element.
  DATA o_iterator TYPE REF TO if_ixml_node_iterator.
  DATA o_childs   TYPE REF TO if_ixml_node_list.
  DATA o_filter   TYPE REF TO if_ixml_node_filter.
  DATA dref       TYPE REF TO data.
  DATA d_name     TYPE string.
  DATA d_context  LIKE LINE OF context.
  DATA _cx        TYPE REF TO cx_root.
  DATA _count     TYPE string.
  FIELD-SYMBOLS:
    &lt;d&gt; TYPE ANY.
  o_childs = xml_node-&gt;get_children( ).
  o_filter = xml_node-&gt;create_filter_node_type( if_ixml_node=&gt;co_node_element ).
  o_iterator = o_childs-&gt;create_iterator_filtered( filter = o_filter ).
  o_n_elem ?= o_iterator-&gt;get_next( ).
  WHILE o_n_elem IS BOUND.
    ADD 1 TO _count.    stack( _count ).
    o_elem = o_n_elem.    o_n_elem ?= o_iterator-&gt;get_next( ).
    d_name = o_elem-&gt;get_name( ).
    IF en_line &lt;&gt; d_name.
      IF NOT context IS INITIAL. READ TABLE context INTO d_context INDEX 1. ENDIF.
      CALL METHOD application_log-&gt;add_error
        EXPORTING
          id_msgno     = &apos;007&apos;
          id_msgv1     = en_line
          id_msgv2     = d_name
          id_msgv3     = d_context
          .
    ELSE.
      TRY.
          CREATE DATA dref LIKE LINE OF table.
        CATCH cx_root INTO _cx.
          application_log-&gt;add_exception( exception = _cx ).
          CONTINUE.
      ENDTRY.
      ASSIGN dref-&gt;* TO &lt;d&gt;.
      IF sy-subrc &lt;&gt; 0.
        mac_syserr_log sy-subrc &apos;ASSIGN dref-&gt;*&apos; &apos;ZAPLINK_EASYXML-&gt;READ_TABLE&apos;. &quot;#EC NOTEXT
      ELSE.
        read_any( EXPORTING
                   xml_node = o_elem
                   CHANGING
                        any = &lt;d&gt; ).
        INSERT &lt;d&gt; INTO TABLE table.
        mac_syserr_log sy-subrc &apos;INSERT &lt;d&gt; INTO TABLE table.&apos; &apos;ZAPLINK_EASYXML-&gt;READ_TABLE&apos;. &quot;#EC NOTEXT
      ENDIF.
    ENDIF.
    unstack( ).
  ENDWHILE.
ENDMETHOD.
method RESET.
  DATA object TYPE balobj_d.
  DATA subobject  TYPE balsubobj.
  DATA ext_id TYPE balnrext.
  IF application_log IS BOUND.
    application_log-&gt;clear( ).
    application_log-&gt;free( ).
  ELSE.
    CREATE OBJECT application_log.
    application_log-&gt;msgid = msgid.
    object = &apos;ZAPLINK&apos;.
    subobject = &apos;EASYXML&apos;.
    CALL METHOD application_log-&gt;init
      EXPORTING
        id_object      = object
        id_subobject   = subobject
        id_extnumber   = ext_id
        auto_upd_custo = abap_true
        id_activity    = zaplink_message_collector=&gt;actions-create
      EXCEPTIONS
        error          = 1
        OTHERS         = 2.
    IF sy-subrc &lt;&gt; 0.
    ELSE.
      bal_level = 1.
    ENDIF.
  ENDIF.
endmethod.
method STACK.
  IF NOT item IS INITIAL.
    INSERT item INTO context INDEX 1.
  ENDIF.
endmethod.
METHOD stack_descr.
  DATA name TYPE string.
  name = desc-&gt;absolute_name.
  stack( name ).
ENDMETHOD.
METHOD string_2_elem.
  DATA _desc     TYPE REF TO cl_abap_typedescr.
  DATA exception TYPE REF TO cx_root.
  IF string IS INITIAL. EXIT. ENDIF.
  IF type_desc IS BOUND.
    _desc = type_desc.
  ELSE.
    _desc = cl_abap_typedescr=&gt;describe_by_data( p_data = any ).
  ENDIF.
  IF _desc-&gt;kind &lt;&gt; cl_abap_datadescr=&gt;kind_elem. EXIT. ENDIF.
  CASE _desc-&gt;type_kind.
    WHEN cl_abap_typedescr=&gt;typekind_xstring
      OR cl_abap_typedescr=&gt;typekind_xsequence.
      TRY.
          CALL FUNCTION &apos;ECATT_CONV_STRING_TO_XSTRING&apos;
            EXPORTING
              im_string         = string
            IMPORTING
              ex_xstring        = any
                    .
        CATCH cx_root INTO exception.
          application_log-&gt;add_exception( exception = exception ).
      ENDTRY.
    WHEN cl_abap_typedescr=&gt;typekind_char
      OR cl_abap_typedescr=&gt;typekind_clike
      OR cl_abap_typedescr=&gt;typekind_date
      OR cl_abap_typedescr=&gt;typekind_time
      OR cl_abap_typedescr=&gt;typekind_string
      OR cl_abap_typedescr=&gt;typekind_csequence
      OR cl_abap_typedescr=&gt;typekind_num
      OR cl_abap_typedescr=&gt;typekind_numeric
      OR cl_abap_typedescr=&gt;typekind_int
      OR cl_abap_typedescr=&gt;typekind_int1
      OR cl_abap_typedescr=&gt;typekind_int2
      OR cl_abap_typedescr=&gt;typekind_float
      OR cl_abap_typedescr=&gt;typekind_packed
      OR cl_abap_typedescr=&gt;typekind_simple
      OR cl_abap_typedescr=&gt;typekind_hex        &quot; Convert Hex to String works
        .
      TRY.
          any = string.
        CATCH cx_root INTO exception.
          application_log-&gt;add_exception( exception = exception ).
      ENDTRY.
    WHEN OTHERS.
      mac_syserr_log -1 &apos;WHEN OTHERS&apos; &apos;ZAPLINK_EASYXML-&gt;STRING_2_ELEM&apos;.
  ENDCASE.
ENDMETHOD.
METHOD unstack.
  IF NOT context IS INITIAL.
    DELETE context INDEX 1.
  ENDIF.
ENDMETHOD.
METHOD xml2any.
  DATA root_node   TYPE REF TO if_ixml_element.
  root_node = xmldoc-&gt;get_root_element( ).
  IF root_node IS BOUND.
    IF attributs IS SUPPLIED.
      CALL METHOD me-&gt;get_attributs
        EXPORTING
          xmldoc    = xmldoc
        CHANGING
          attributs = attributs.
    ENDIF.
    read_any( EXPORTING
               xml_node = root_node
               CHANGING
                    any = any ).
    IF application_log-&gt;has_messages_of_msgt( id_msgty     = &apos;E&apos; ) IS INITIAL.
      IF NOT application_log IS BOUND. MESSAGE ID msgid TYPE &apos;S&apos; NUMBER 005. ENDIF.
      CALL METHOD application_log-&gt;add_success
        EXPORTING
          id_msgno     = &apos;005&apos;
          .
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD _xml2any.
  DATA root_node   TYPE REF TO if_ixml_element.
  DATA _doc        TYPE REF TO if_ixml_document.
  TRY.
      _doc ?= xml.
      root_node = _doc-&gt;get_root_element( ).
    CATCH cx_sy_move_cast_error.
      root_node ?= xml.
  ENDTRY.
  IF root_node IS BOUND.
    read_any( EXPORTING
               xml_node = root_node
               CHANGING
                    any = any ).
  ENDIF.
ENDMETHOD.
METHOD GET_NODE_TEXT.
  DATA o_filter   TYPE REF TO if_ixml_node_filter.
  DATA o_iterator TYPE REF TO if_ixml_node_iterator.
  DATA o_text     TYPE REF TO if_ixml_node.
  check xml_node-&gt;contains( if_ixml_node=&gt;co_node_text ) = abap_true.    &quot; value returned by get_value is the right one.
  o_filter = xml_node-&gt;create_filter_node_type( if_ixml_node=&gt;co_node_text ).
  o_iterator = xml_node-&gt;create_iterator_filtered( depth = 1
                                                  filter = o_filter ).
  o_text = o_iterator-&gt;get_next( ).   result = o_text-&gt;get_value( ).    IF result = &apos;#&apos;. clear result. endif.
ENDMETHOD.
method NODE_IS_NOT_TYPE.
  DATA d_mask(8)  TYPE x.
  DATA d_txt_m(8) TYPE x.
  check node is bound.
  d_mask = node-&gt;get_type( ).   d_txt_m = type.
  d_mask = d_mask BIT-AND d_txt_m.
  if d_mask = 00000000.   result = abap_true.   endif.
endmethod.
method NODE_IS_TYPE.
  DATA d_mask(8)  TYPE x.
  DATA d_txt_m(8) TYPE x.
  check node is bound.
  d_mask = node-&gt;get_type( ).   d_txt_m = type.
  d_mask = d_mask BIT-AND d_txt_m.
  if d_mask = d_txt_m.    result = abap_true.   endif.
endmethod.
METHOD protect_string.
  DATA d_last TYPE i.
  CHECK NOT string IS INITIAL.
  d_last = strlen( string ) - 1.
  IF NOT string(1) IN char_to_protect.
    result = string.
  ELSE.
    CONCATENATE protection_char string INTO result.
  ENDIF.
  IF string+d_last(1) IN char_to_protect.   CONCATENATE result protection_char INTO result.   ENDIF.    &quot; Issue 61 &amp; 68
ENDMETHOD.
METHOD unprotect_string.
  DATA d_last TYPE i.
  CHECK NOT string IS INITIAL.
  d_last = STRLEN( string ) - 1.    result = string.
  IF string(1) = protection_char AND d_last &gt;= 1.
    IF string+1(1) IN char_to_protect.
      SHIFT result BY 1 PLACES LEFT.
    ENDIF.
  ENDIF.
  IF string+d_last(1) = protection_char AND d_last &gt;= 2.      &quot; Issue 61 &amp; 68
    SUBTRACT 1 FROM d_last.
    IF string+d_last(1) IN char_to_protect.
      SHIFT result BY 1 PLACES RIGHT CIRCULAR.    SHIFT result BY 1 PLACES LEFT.
    ENDIF.
  ENDIF.
ENDMETHOD.
endclass. &quot;ZAPLINK_EASYXML implementation
class ZAPLINK_LIST implementation.
method ADD.
  DATA _idx  LIKE LINE OF _index.
  DATA _comp LIKE LINE OF _allcomp.
  _idx = search_index( comp ).
  IF _idx-o_comp IS BOUND.
    RAISE EXCEPTION TYPE zaplink_cx_list
               EXPORTING textid = zaplink_cx_list=&gt;already_exists
                           type = _idx-key-type
                           name = _idx-key-name.
  ENDIF.
  _idx-o_comp = comp.
  INSERT _idx INTO TABLE _index.
  MOVE-CORRESPONDING _idx TO _comp. INSERT _comp INTO TABLE _allcomp.
  _add_subcomp( comp ).
endmethod.
method ADD_KEYS.
  DATA o_comp   TYPE to_component.
  DATA o_cx_comp TYPE REF TO zaplink_cx_component.
  DATA _list    TYPE tt_compkeys.
  FIELD-SYMBOLS:
    &lt;k&gt; LIKE LINE OF _list.
  TRY.
      _list = data.
      SORT _list.
      DELETE ADJACENT DUPLICATES FROM _list.
      DELETE _list WHERE table_line IS INITIAL.
      LOOP AT _list ASSIGNING &lt;k&gt;.
        TRY.
            o_comp = zaplink_component=&gt;create_new( &lt;k&gt; ).
          CATCH zaplink_cx_component INTO o_cx_comp.
            CREATE OBJECT o_mycx
              EXPORTING
                textid  = zaplink_cx_list=&gt;failed
                prev_cx = o_cx_comp.
            o_mycx-&gt;update( ).
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        add( o_comp ).
      ENDLOOP.
    CATCH zaplink_cx_list INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
endmethod.
method ADD_LIST.
DATA t_allcomp   TYPE tt_allcomplist.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  LOOP AT data-&gt;_index ASSIGNING &lt;i&gt;.
    READ TABLE _index TRANSPORTING NO FIELDS
               WITH TABLE KEY key = &lt;i&gt;-key.
    IF sy-subrc = 0.
      CONTINUE.
    ENDIF.
    t_allcomp = data-&gt;_allcomp.
    DELETE t_allcomp WHERE o_comp &lt;&gt; &lt;i&gt;-o_comp.
    INSERT &lt;i&gt; INTO TABLE _index.
    INSERT LINES OF t_allcomp INTO TABLE _allcomp.
  ENDLOOP.
endmethod.
method CHANGE_SELECTION.
  DATA alv TYPE td_alv.
  alv = conv_to_alv( ).
  CALL FUNCTION &apos;REUSE_ALV_GRID_DISPLAY&apos;
    EXPORTING
      i_grid_title             = &apos;Select objects&apos;(lst)
      it_fieldcat              = alv_conf-simple-fields
      is_layout                = alv_conf-simple-layout
    TABLES
      t_outtab                 = alv-headers
    EXCEPTIONS
      OTHERS                   = 0.
  update_from_alv( alv ).
endmethod.
METHOD class_constructor.
  DATA field_s   LIKE LINE OF alv_conf-simple-fields.
  DATA field_h   LIKE LINE OF alv_conf-hierar-fields.
  DATA i_pos     TYPE i VALUE 0. &quot; position d&apos;affichage des champs
  DATA t_desc    TYPE REF TO cl_abap_typedescr.
  DATA st_desc   TYPE REF TO cl_abap_structdescr.
  DATA o_elem    TYPE REF TO cl_abap_elemdescr.
  DATA list      TYPE tt_alv.
  DATA line      LIKE LINE OF list.
  DATA text_name TYPE string.
  DATA i_len     TYPE i.
  CONSTANTS fn_sel TYPE string VALUE &apos;SELECT&apos;.
  FIELD-SYMBOLS:
    &lt;t&gt; TYPE ANY,
    &lt;c&gt; LIKE LINE OF st_desc-&gt;components.
  DEFINE m_fieldcat_s.
    clear field_s.
    field_s-fieldname = &amp;1.
    field_s-seltext_m = field_s-seltext_l = &amp;2.
    append field_s to alv_conf-simple-fields.
  END-OF-DEFINITION.
  DEFINE m_fieldcat_h.
    clear field_h.
    field_h-row_pos   = 1.
    field_h-tabname   = &amp;1.
    field_h-col_pos   = i_pos.
    field_h-fieldname = &amp;2.
    field_h-seltext_m = field_h-seltext_l = &amp;3.
    field_h-intlen  = field_h-outputlen = field_h-ddic_outputlen = &amp;4.
    field_h-datatype = &apos;CHAR&apos;.
    case field_h-fieldname.
      when &apos;NAME&apos;.
        field_h-key = abap_true.
      when &apos;TYPE&apos;.
        field_h-key = abap_true.
      when &apos;SELECT&apos;.
        field_h-input = abap_true.
        field_h-checkbox = abap_true.
      when &apos;MSG&apos;.
        field_h-row_pos   = 2.
        field_h-col_pos   = 1.
    endcase.
    append field_h to alv_conf-hierar-fields.
  END-OF-DEFINITION.
  t_desc = cl_abap_structdescr=&gt;describe_by_data( line ).
  CHECK t_desc-&gt;kind = cl_abap_structdescr=&gt;kind_struct.
  st_desc ?= t_desc.
  LOOP AT st_desc-&gt;components ASSIGNING &lt;c&gt;.
    text_name = i_pos = sy-tabix.
    CONDENSE text_name NO-GAPS.
    CONCATENATE &apos;TEXT-NF&apos; text_name INTO text_name.
    ASSIGN (text_name) TO &lt;t&gt;.
    IF sy-subrc = 0.
      text_name = &lt;t&gt;.
    ELSE.
      text_name = &lt;c&gt;-name.
    ENDIF.
    CLEAR i_len.
    ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE line TO &lt;t&gt;.
    IF sy-subrc = 0.
      t_desc = cl_abap_structdescr=&gt;describe_by_data( &lt;t&gt; ).
      IF t_desc-&gt;kind = cl_abap_structdescr=&gt;kind_elem.
        o_elem ?= t_desc.
        IF o_elem-&gt;output_length = 0.
          CASE &lt;c&gt;-name.
            WHEN &apos;NAME&apos;.
              i_len = 30.
            WHEN &apos;MSG&apos;.
              i_len = 80.
            WHEN OTHERS.
              i_len = 50.
          ENDCASE.
        ELSE.
          i_len = o_elem-&gt;output_length.
        ENDIF.
      ENDIF.
    ENDIF.
    IF i_len IS INITIAL. i_len = &lt;c&gt;-length. ENDIF.
    m_fieldcat_s &lt;c&gt;-name text_name.
    m_fieldcat_h alv_h_tables-header &lt;c&gt;-name text_name i_len.
    m_fieldcat_h alv_h_tables-item &lt;c&gt;-name text_name i_len.
  ENDLOOP.
  alv_conf-simple-layout-box_fieldname     = fn_sel.
  alv_conf-simple-layout-f2code            = &apos;MYPICK&apos; .
  alv_conf-simple-layout-colwidth_optimize = &apos;X&apos;.
  DELETE alv_conf-simple-fields WHERE fieldname = alv_conf-simple-layout-box_fieldname
                                   or fieldname = &apos;ID&apos;
                                   or fieldname = &apos;EXPAND&apos;.
  alv_conf-hierar-layout-expand_fieldname = &apos;EXPAND&apos;.
  alv_conf-hierar-layout-box_fieldname     = fn_sel.
  alv_conf-hierar-layout-allow_switch_to_list = abap_true.
  DELETE alv_conf-hierar-fields WHERE fieldname = &apos;ID&apos;
                                   OR ( fieldname = fn_sel AND tabname = alv_h_tables-item )
                                   OR fieldname = alv_conf-hierar-layout-expand_fieldname.
ENDMETHOD.
METHOD clear.
  CLEAR:
      display_progress,
      _allcomp,
      _index,
      o_exception,
      t_cursors,
      _iterator_count,
      _iterator_tabix,
      _iterator_type.
ENDMETHOD.
method CLONE.
  DATA o_comp TYPE to_component.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  TRY.
      CREATE OBJECT result.
      LOOP AT _index ASSIGNING &lt;i&gt;.
        o_comp = &lt;i&gt;-o_comp-&gt;clone( ).
        result-&gt;add( o_comp ).
        If &lt;i&gt;-selected = abap_true.    result-&gt;select( o_comp ).    endif.
      ENDLOOP.
    CATCH zaplink_cx.
      CLEAR result.
  ENDTRY.
endmethod.
METHOD conv_to_alv.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  DATA _line  LIKE LINE OF result-headers.
  DATA s_item LIKE LINE OF result-items.
  DATA o_list TYPE to_me.
  DATA o_comp TYPE to_component.
  TRY.
      LOOP AT _index ASSIGNING &lt;i&gt;.
        _line = comp_to_alv( o_comp = &lt;i&gt;-o_comp
                           selected = &lt;i&gt;-selected ).
        CALL FUNCTION &apos;GUID_CREATE&apos;
          IMPORTING
            ev_guid_16 = _line-id.
        _line-select = &lt;i&gt;-selected.
        IF NOT w_item IS INITIAL.
          o_list = &lt;i&gt;-o_comp-&gt;get_subcomponents( ).
          IF o_list IS BOUND.
            _line-expand = abap_true.
          ENDIF.
        ENDIF.
        APPEND _line TO result-headers.
        IF NOT w_item IS INITIAL.
          CHECK o_list IS BOUND.
          o_list-&gt;display_progress = abap_false.
          o_list-&gt;init_iter( ).
          o_comp = o_list-&gt;get_next( ).
          WHILE o_comp IS BOUND.
            s_item = comp_to_alv( o_comp = o_comp
                                selected = &lt;i&gt;-selected ).
            o_comp = o_list-&gt;get_next( ).
            s_item-id = _line-id.
            s_item-select = _line-expand.
            APPEND s_item TO result-items.
          ENDWHILE.
        ENDIF.
      ENDLOOP.
    CATCH zaplink_cx_list INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_next.
  DATA component TYPE ts_compkey.
  DATA msg       TYPE string.
  DATA _pos      TYPE i.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF t_cursors.
  CHECK _iterator_tabix &lt; _iterator_count.
  CASE _iterator_type.
    WHEN iterator_types-selected.
    WHEN iterator_types-all.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_list
                 EXPORTING textid = zaplink_cx_list=&gt;iterator_not_initialize.
  ENDCASE.
  ADD 1 TO _iterator_tabix.
  READ TABLE t_cursors INDEX _iterator_tabix ASSIGNING &lt;i&gt;.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_list
               EXPORTING textid = zaplink_cx_list=&gt;system_error.
  ENDIF.
  result = &lt;i&gt;-o_comp.
  IF display_progress = abap_true.
    component = result-&gt;_get_key( ).
    IF sy-batch = abap_true.
      MESSAGE i000(zaplink_list) WITH component-type component-name.
    ELSE.
      MESSAGE i000(zaplink_list) WITH component-type component-name INTO msg.
      IF _iterator_count &gt; 0.
        _pos = 100 * _iterator_tabix / _iterator_count.
      ELSE.
        _pos = _iterator_tabix.
      ENDIF.
      CALL FUNCTION &apos;SAPGUI_PROGRESS_INDICATOR&apos;
        EXPORTING
          percentage = _pos
          text       = msg.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD init_iter.
  DATA s_cursor LIKE LINE OF t_cursors.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  CLEAR: _iterator_tabix, _iterator_count, t_cursors.    &quot; Issue 30
  _iterator_type = iterator_types-all.
  LOOP AT _index ASSIGNING &lt;i&gt;.
    MOVE-CORRESPONDING &lt;i&gt; TO s_cursor.
    IF order_kind &lt;&gt; order_kinds-no_order.
      s_cursor-order = zaplink_connectors=&gt;get_typeorder( &lt;i&gt;-key-type ).
    ENDIF.
    APPEND s_cursor TO t_cursors.
  ENDLOOP.
  CASE order_kind.
    WHEN order_kinds-install.
      SORT t_cursors BY order key.
    WHEN order_kinds-uninstall.
      SORT t_cursors BY order DESCENDING key.
    WHEN OTHERS.
      SORT t_cursors BY key.
  ENDCASE.
  DESCRIBE TABLE t_cursors LINES _iterator_count.
ENDMETHOD.
METHOD init_sel_iter.
  DATA s_cursor LIKE LINE OF t_cursors.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  CLEAR: _iterator_tabix, _iterator_count, t_cursors.    &quot; Issue 30
  _iterator_type = iterator_types-selected.
  LOOP AT _index ASSIGNING &lt;i&gt;
       WHERE selected = abap_true.
    MOVE-CORRESPONDING &lt;i&gt; TO s_cursor.
    IF order_kind &lt;&gt; order_kinds-no_order.
      s_cursor-order = zaplink_connectors=&gt;get_typeorder( &lt;i&gt;-key-type ).
    ENDIF.
    APPEND s_cursor TO t_cursors.
  ENDLOOP.
  CASE order_kind.
    WHEN order_kinds-install.
      SORT t_cursors BY order key.
    WHEN order_kinds-uninstall.
      SORT t_cursors BY order DESCENDING key.
    WHEN OTHERS.
      SORT t_cursors BY key.
  ENDCASE.
  DESCRIBE TABLE t_cursors LINES _iterator_count.
ENDMETHOD.
method IS_INCLUDED.
DATA t_allcomp TYPE tt_allcomplist.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF _allcomp.
  t_allcomp = list-&gt;_allcomp.
  DELETE ADJACENT DUPLICATES FROM t_allcomp COMPARING key.
  result = abap_true.
  LOOP AT t_allcomp ASSIGNING &lt;c&gt;.
    READ TABLE _allcomp TRANSPORTING NO FIELDS
         WITH TABLE KEY key = &lt;c&gt;-key.
    IF sy-subrc &lt;&gt; 0.
      result = abap_false.
      EXIT.
    ENDIF.
  ENDLOOP.
endmethod.
method KEEP_COMMUN_LIST.
FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  LOOP AT _index ASSIGNING &lt;i&gt;.
    READ TABLE data-&gt;_index TRANSPORTING NO FIELDS
               WITH TABLE KEY key = &lt;i&gt;-key.
    IF sy-subrc &lt;&gt; 0.
      DELETE _index.
    ENDIF.
  ENDLOOP.
endmethod.
method REMOVE.
  DATA _idx LIKE LINE OF _index.
  TRY.
      _idx = search_index( comp ).
    CATCH zaplink_cx_list INTO o_exception.
      RAISE EXCEPTION o_exception.
  ENDTRY.
  DELETE _allcomp WHERE o_comp = _idx-o_comp.
  DELETE TABLE _index FROM _idx.
endmethod.
method REMOVE_LIST.
FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  LOOP AT data-&gt;_index ASSIGNING &lt;i&gt;.
    TRY.
        remove( &lt;i&gt;-o_comp ).
      CATCH zaplink_cx_list INTO o_exception.
    ENDTRY.
  ENDLOOP.
endmethod.
method SEARCH.
  DATA _idx LIKE LINE OF _index.
  _idx = search_index( comp ).
  IF NOT _idx-o_comp IS BOUND.
    exit.
  ENDIF.
  result = _idx-o_comp.
endmethod.
method SEARCH_INDEX.
  DATA _key TYPE ts_compkey.
  check comp is bound.
  _key = comp-&gt;_get_key( ).
  READ TABLE _index INTO result
             WITH TABLE KEY key = _key.
  IF sy-subrc &lt;&gt; 0.
    result-key = _key.
  ENDIF.
endmethod.
method SELECT_DEFAULT.
TRY.
      CASE sel_action.
        WHEN sel_actions-export.
          select_export( ).
        WHEN sel_actions-import.
          select_import( ).
        WHEN sel_actions-uninstall.
          select_export( ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_list
                     EXPORTING textid = zaplink_cx_list=&gt;invalid_action
                           sel_action = sel_action.
      ENDCASE.
    CATCH zaplink_cx_list INTO o_exception.
      RAISE EXCEPTION o_exception.
  ENDTRY.
endmethod.
method SELECT_EXPORT.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  LOOP AT _index ASSIGNING &lt;i&gt;.
    CLEAR &lt;i&gt;-selected.
    IF     &lt;i&gt;-o_comp-&gt;_exists = zaplink_connector=&gt;exists
       AND &lt;i&gt;-o_comp-&gt;_connector-exists = zaplink_component=&gt;connexists-exists.
      &lt;i&gt;-selected = abap_true.
    ENDIF.
  ENDLOOP.
endmethod.
method SELECT_IMPORT.
FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF _index.
  LOOP AT _index ASSIGNING &lt;i&gt;.
    CLEAR &lt;i&gt;-selected.
    IF     &lt;i&gt;-o_comp-&gt;_exists = zaplink_connector=&gt;exists-not_exists
       AND &lt;i&gt;-o_comp-&gt;_connector-exists = zaplink_component=&gt;connexists-exists.
      &lt;i&gt;-selected = abap_true.
    ENDIF.
  ENDLOOP.
endmethod.
method UPDATE_FROM_ALV.
  FIELD-SYMBOLS:
    &lt;a&gt; LIKE LINE OF data-headers,
    &lt;i&gt; LIKE LINE OF _index.
  DATA _key TYPE ts_compkey.
  LOOP AT data-headers ASSIGNING &lt;a&gt;.
    _key-type = &lt;a&gt;-type.
    _key-name = &lt;a&gt;-name.
    READ TABLE _index ASSIGNING &lt;i&gt;
         WITH KEY key = _key.
    IF sy-subrc = 0.
      IF NOT &lt;a&gt;-select IS INITIAL.
        &lt;i&gt;-selected = abap_true.
      ELSE.
        &lt;i&gt;-selected = abap_false.
      ENDIF.
    ENDIF.
  ENDLOOP.
endmethod.
METHOD _add_subcomp.
  DATA o_list TYPE to_me.
  DATA _comp LIKE LINE OF _allcomp.
  CHECK data IS BOUND.
  TRY.
      o_list = data-&gt;get_subcomponents( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  CHECK o_list IS BOUND.
  LOOP AT o_list-&gt;_allcomp INTO _comp.
    _comp-as_sub = abap_true.
    _comp-o_comp = data.
    INSERT _comp INTO TABLE _allcomp.
  ENDLOOP.
ENDMETHOD.
METHOD is_selected.
  DATA _idx LIKE LINE OF _index.
  _idx = search_index( comp ).
  IF _idx-selected IS NOT INITIAL.
    result = abap_true.
  ELSE.
    result = abap_false.
  ENDIF.
ENDMETHOD.
METHOD select.
  TRY.
      _select( comp = comp
              value = abap_true ).
    CATCH zaplink_cx_list INTO o_exception.
      RAISE EXCEPTION o_exception.
  ENDTRY.
ENDMETHOD.
METHOD _select.
  DATA _idx LIKE LINE OF _index.
  _idx = search_index( comp ).
  IF NOT _idx-o_comp IS BOUND.
    RAISE EXCEPTION TYPE zaplink_cx_list
               EXPORTING textid = zaplink_cx_list=&gt;not_found
                           type = _idx-key-type
                           name = _idx-key-name.
  ENDIF.
  _idx-selected = value.
  MODIFY TABLE _index FROM _idx TRANSPORTING selected.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_list
               EXPORTING textid = zaplink_cx_list=&gt;system_error
                           type = _idx-key-type
                           name = _idx-key-name.
  ENDIF.
ENDMETHOD.
METHOD UNSELECT.
  TRY.
      _select( comp = comp
              value = abap_false ).
    CATCH zaplink_cx_list INTO o_exception.
      RAISE EXCEPTION o_exception.
  ENDTRY.
ENDMETHOD.
METHOD display.
  DATA alv        TYPE td_alv.
  DATA s_keyinfo  TYPE slis_keyinfo_alv.
  s_keyinfo-header01 = s_keyinfo-item01 = &apos;ID&apos;.
  alv = conv_to_alv( abap_true ).
  CALL FUNCTION &apos;REUSE_ALV_HIERSEQ_LIST_DISPLAY&apos;
    EXPORTING
      is_layout                      = alv_conf-hierar-layout
      it_fieldcat                    = alv_conf-hierar-fields
      i_tabname_header               = alv_h_tables-header
      i_tabname_item                 = alv_h_tables-item
      is_keyinfo                     = s_keyinfo
    TABLES
      t_outtab_header                = alv-headers
      t_outtab_item                  = alv-items
    EXCEPTIONS
      program_error                  = 1
      OTHERS                         = 2.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
            WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.
ENDMETHOD.
METHOD comp_to_alv.
  DATA _key TYPE ts_compkey.
  _key = o_comp-&gt;_get_key( ).
  result-type = _key-type.
  result-name = _key-name.
  result-typ_txt = zaplink_connectors=&gt;type2text( result-type ).
  IF o_comp-&gt;_connector-exists = zaplink_component=&gt;connexists-not_exists.
    result-connector = lights-red.
    result-status = lights-no.
    MESSAGE e000(zaplink_gui) WITH result-type INTO result-msg.
  ELSE.
    result-connector = lights-green.
    result-checksum = o_comp-&gt;get_checksum( ).
    result-code_signature = o_comp-&gt;get_code_signature( ).
    IF o_comp-&gt;_exists = zaplink_connector=&gt;exists.
      SELECT SINGLE devclass srcsystem
        INTO (result-devclass, result-srcsystem)
        FROM tadir
        WHERE    pgmid = &apos;R3TR&apos;
          AND   object = result-type
          AND obj_name = result-name.
      CASE selected.
        WHEN abap_true.
          result-status = lights-green.
        WHEN abap_false.
          result-status = lights-yellow.
          CLEAR result-select.
          MESSAGE e001(zaplink_gui) WITH result-type result-name INTO result-msg.
      ENDCASE.
    ELSE.   &quot; Not Exists
      CASE selected.
        WHEN abap_false.
          result-status = lights-red.
          MESSAGE e003(zaplink_gui) WITH result-type result-name INTO result-msg.
        WHEN abap_true.
          result-status = lights-green.
      ENDCASE.
    ENDIF.
  ENDIF.
ENDMETHOD.
method HAS_ANY.
  DATA t_allcomp TYPE tt_allcomplist.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF _allcomp.
  t_allcomp = list-&gt;_allcomp.
  DELETE ADJACENT DUPLICATES FROM t_allcomp COMPARING key.
  result = abap_false.
  LOOP AT t_allcomp ASSIGNING &lt;c&gt;.
    READ TABLE _allcomp TRANSPORTING NO FIELDS
         WITH TABLE KEY key = &lt;c&gt;-key.
    IF sy-subrc = 0.
      result = abap_true.
      EXIT.
    ENDIF.
  ENDLOOP.
endmethod.
METHOD is_empty.
  IF _index IS INITIAL.   result = abap_true.   ENDIF.
ENDMETHOD.
METHOD get_count.
  IF is_selected IS INITIAL.
    result = LINES( _index ).
  ELSE.
    LOOP AT _index TRANSPORTING NO FIELDS WHERE selected = abap_true. ADD 1 TO result. ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD select_all.
  DATA s_idx LIKE LINE OF _index.
  s_idx-selected = abap_true.   MODIFY _index FROM s_idx TRANSPORTING selected WHERE selected &lt;&gt; s_idx-selected.
ENDMETHOD.
METHOD get_keys.
  FIELD-SYMBOLS:
    &lt;k&gt; LIKE LINE OF _index.
  TRY.
      LOOP AT _index ASSIGNING &lt;k&gt;.
        APPEND &lt;k&gt;-key TO result.
      ENDLOOP.
      SORT result.    DELETE ADJACENT DUPLICATES FROM result.
    CATCH zaplink_cx_list INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
endclass. &quot;ZAPLINK_LIST implementation
class ZAPLINK_OBJECT_DATA implementation.
METHOD fd_comp_desc.
  DATA _t     LIKE LINE OF texts.
  DATA s_key  TYPE ts_doc_key.
  FIELD-SYMBOLS:
    &lt;d&gt;    LIKE LINE OF documentation,
    &lt;dt&gt;   LIKE LINE OF &lt;d&gt;-texts,
    &lt;desc&gt; LIKE LINE OF descriptions.
  LOOP AT descriptions ASSIGNING &lt;desc&gt;
       WHERE clsname = obj_name
         AND cmpname = component.
    _t-main = &lt;desc&gt;.
    CLEAR: _t-clsname, _t-cmpname. &quot; VERSION
    s_key-name = obj_name.
    s_key-other = component.
    READ TABLE documentation ASSIGNING &lt;d&gt;
         WITH KEY object = s_key           &quot; Component name should be unique so no realy need to check ID
                      id = id.
    IF sy-subrc = 0.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = _t-langu.
      IF sy-subrc = 0.
        _t-documentation = &lt;dt&gt;.
        CLEAR _t-documentation-tdspras.
      ENDIF.
    ENDIF.
    INSERT _t INTO TABLE texts.
  ENDLOOP.
ENDMETHOD.
method FD_EXCEPTIONS.
DATA: _ex  LIKE LINE OF exceptions.
  FIELD-SYMBOLS:
    &lt;ex&gt;  LIKE LINE OF fm_data-exceps.
  LOOP AT fm_data-exceps ASSIGNING &lt;ex&gt;
       WHERE clsname = obj_name
         AND cmpname = component.
    CLEAR: _ex.
    _ex-hdr = &lt;ex&gt;.
    _ex-texts = fd_subc_desc( descriptions = fm_data-subcomponent_desc
                                 component = &lt;ex&gt;-cmpname
                             sub_component = &lt;ex&gt;-sconame ).
    CLEAR: _ex-clsname, _ex-cmpname, _ex-descript. &quot; VERSION
    INSERT _ex INTO TABLE exceptions.
  ENDLOOP.
endmethod.
method FD_PARAMETERS.
DATA: _pa  LIKE LINE OF parameters.
  FIELD-SYMBOLS:
    &lt;pa&gt;  LIKE LINE OF fm_data-parameters.
  LOOP AT fm_data-parameters ASSIGNING &lt;pa&gt;
       WHERE clsname = obj_name
         AND cmpname = component.
    CLEAR: _pa.
    _pa-hdr = &lt;pa&gt;.
    _pa-texts = fd_subc_desc( descriptions = fm_data-subcomponent_desc
                                 component = &lt;pa&gt;-cmpname
                             sub_component = &lt;pa&gt;-sconame ).
    CLEAR: _pa-clsname, _pa-cmpname, _pa-langu, _pa-descript. &quot; VERSION
    INSERT _pa INTO TABLE parameters.
  ENDLOOP.
endmethod.
method FD_SUBC_DESC.
DATA: _t   LIKE LINE OF texts.
  FIELD-SYMBOLS:
    &lt;desc&gt; LIKE LINE OF DESCRIPTIONS.
  LOOP AT DESCRIPTIONS ASSIGNING &lt;desc&gt;
       WHERE clsname = obj_name
         AND cmpname = component
         AND sconame = sub_component.
    _t = &lt;desc&gt;.
    CLEAR: _t-clsname, _t-cmpname, _t-sconame. &quot; VERSION
    INSERT _t INTO TABLE texts.
  ENDLOOP.
endmethod.
METHOD from_data.
  DATA _at  LIKE LINE OF attributs.
  DATA _ty  LIKE LINE OF types.
  DATA _tg  LIKE LINE OF typegroups.
  DATA _me  LIKE LINE OF methods.
  DATA _al  LIKE LINE OF aliases.
  DATA _ev  LIKE LINE OF events.
  DATA _mk  TYPE seocpdkey.
  DATA _dc  LIKE LINE OF deferred-classes.
  DATA _di  LIKE LINE OF deferred-interfaces.
  DATA id   TYPE doku_id.
  FIELD-SYMBOLS:
    &lt;at&gt;  LIKE LINE OF fm_data-attributes,
    &lt;al&gt;  LIKE LINE OF fm_data-aliases,
    &lt;me&gt;  LIKE LINE OF fm_data-methods,
    &lt;ev&gt;  LIKE LINE OF fm_data-events,
    &lt;cd&gt;  LIKE LINE OF fm_data-clsdeferrds,
    &lt;id&gt;  LIKE LINE OF fm_data-intdeferrds,
    &lt;ty&gt;  LIKE LINE OF fm_data-types,
    &lt;tu&gt;  LIKE LINE OF fm_data-typeusages.
  LOOP AT fm_data-typeusages ASSIGNING &lt;tu&gt;
          WHERE clsname = obj_name.
    CLEAR _tg.
    _tg-hdr = &lt;tu&gt;.
    READ TABLE fm_data-clsdeferrds ASSIGNING &lt;cd&gt;
         WITH TABLE KEY clsname = &lt;tu&gt;-clsname
                      typegroup = &lt;tu&gt;-typegroup
                        version = &lt;tu&gt;-version.
    IF sy-subrc = 0.
      _tg-defered = &lt;cd&gt;.
    ENDIF.
    READ TABLE fm_data-intdeferrds ASSIGNING &lt;id&gt;
         WITH TABLE KEY clsname = &lt;tu&gt;-clsname
                      typegroup = &lt;tu&gt;-typegroup
                        version = &lt;tu&gt;-version.
    IF sy-subrc = 0.
      _tg-itf_def = &lt;id&gt;.
    ENDIF.
    CLEAR: _tg-clsname, _tg-defered-clsname, _tg-itf_def-clsname. &quot; VERSION
    INSERT _tg INTO TABLE typegroups.
  ENDLOOP.
  LOOP AT fm_data-clsdeferrds ASSIGNING &lt;cd&gt;.
    _dc = &lt;cd&gt;.
    CLEAR: _dc-clsname.
    INSERT _dc INTO TABLE deferred-classes.
  ENDLOOP.
  LOOP AT fm_data-intdeferrds ASSIGNING &lt;id&gt;.
    _di = &lt;id&gt;.
    CLEAR: _di-clsname.
    INSERT _di INTO TABLE deferred-interfaces.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-attribute. ELSE. id = doc_ids-interface-attribute. ENDIF.
  LOOP AT fm_data-attributes ASSIGNING &lt;at&gt;
    WHERE clsname = obj_name.
    CLEAR _at.
    _at-hdr = &lt;at&gt;.
    _at-_ = _at-typesrc. CLEAR _at-typesrc.                 &quot; Issue 68
    REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;cr_lf IN _at-_ WITH cl_abap_char_utilities=&gt;newline. &quot; Issue 68
    _at-texts = fd_comp_desc( descriptions = fm_data-component_desc
                                        id = id
                             documentation = fm_data-documentation
                                 component = &lt;at&gt;-cmpname ).
    CLEAR: _at-clsname, _at-langu, _at-descript. &quot; VERSION ?
    CLEAR: _at-srcrow1, _at-srccolumn1, _at-srcrow2, _at-srccolumn2, _at-typesrc_leng. &quot; Issue 68
    INSERT _at INTO TABLE attributs.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-method. ELSE. id = doc_ids-interface-method. ENDIF.
  LOOP AT fm_data-methods ASSIGNING &lt;me&gt;
          WHERE clsname = obj_name.
    CLEAR _me.
    _me-hdr = &lt;me&gt;.
    _me-texts = fd_comp_desc( descriptions = fm_data-component_desc
                                        id = id
                             documentation = fm_data-documentation
                                 component = &lt;me&gt;-cmpname ).
    _me-exceptions = fd_exceptions( fm_data = fm_data
                                  component = &lt;me&gt;-cmpname ).
    _me-parameters = fd_parameters( fm_data = fm_data
                                  component = &lt;me&gt;-cmpname ).
    CLEAR: _me-clsname, _me-langu, _me-descript. &quot; VERSION
    INSERT _me INTO TABLE methods.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-event. ELSE. id = doc_ids-interface-event. ENDIF.
  LOOP AT fm_data-events ASSIGNING &lt;ev&gt;
          WHERE clsname = obj_name.
    CLEAR _ev.
    _ev-hdr = &lt;ev&gt;.
    _ev-texts = fd_comp_desc( descriptions = fm_data-component_desc
                                        id = id
                             documentation = fm_data-documentation
                                 component = &lt;ev&gt;-cmpname ).
    _ev-parameters = fd_parameters( fm_data = fm_data
                                  component = &lt;ev&gt;-cmpname ).
    CLEAR: _ev-clsname, _ev-langu, _ev-descript. &quot; VERSION
    INSERT _ev INTO TABLE events.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-type. ELSE. id = doc_ids-interface-type. ENDIF.
  LOOP AT fm_data-types ASSIGNING &lt;ty&gt;
          WHERE clsname = obj_name.
    CLEAR _ty.
    _ty-hdr = &lt;ty&gt;.
    _ty-_ = _ty-typesrc. CLEAR _ty-typesrc.                 &quot; Issue 68
    REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;cr_lf IN _ty-_ WITH cl_abap_char_utilities=&gt;newline. &quot; Issue 68
    _ty-texts = fd_comp_desc( descriptions = fm_data-component_desc
                                        id = id
                             documentation = fm_data-documentation
                                 component = &lt;ty&gt;-cmpname ).
    CLEAR: _ty-clsname, _ty-langu, _ty-descript. &quot; VERSION
    CLEAR: _ty-srcrow1, _ty-srccolumn1, _ty-srcrow2, _ty-srccolumn2, _ty-typesrc_leng. &quot; Issue 68
    INSERT _ty INTO TABLE types.
  ENDLOOP.
  LOOP AT fm_data-aliases ASSIGNING &lt;al&gt;
          WHERE clsname = obj_name.
    CLEAR _al.    _al-hdr = &lt;al&gt;.   CLEAR: _al-clsname. &quot; VERSION
    INSERT _al INTO TABLE aliases.
  ENDLOOP.
ENDMETHOD.
METHOD td_comp_desc.
  DATA _t     LIKE LINE OF descriptions.
  DATA _d     LIKE LINE OF documentation.
  DATA _dt    LIKE LINE OF _d-texts.
  DATA s_key  TYPE ts_doc_key.
  FIELD-SYMBOLS:
    &lt;t&gt;   LIKE LINE OF texts.
  _d-application = &apos;DOKU&apos;.
  _d-id = id.
  s_key-name = obj_name. s_key-other = component.
  _d-object = s_key.
  _d-langu = sy-langu.
  _d-masterlang = abap_true.
  _d-typ = &apos;E&apos;.
  _d-dokform = &apos;S_DOCU_SHOW&apos;.
  _d-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR _t.
    _t = &lt;t&gt;-main.
    _t-clsname = obj_name.
    _t-cmpname = component.
    INSERT _t INTO TABLE descriptions.
    CHECK NOT &lt;t&gt;-documentation IS INITIAL.
    _dt = &lt;t&gt;-documentation.
    _dt-tdspras = &lt;t&gt;-langu.
    INSERT _dt INTO TABLE _d-texts.
  ENDLOOP.
  IF NOT _d-texts IS INITIAL. INSERT _d INTO TABLE documentation. ENDIF.
ENDMETHOD.
method TD_EXCEPTIONS.
DATA: _ex  LIKE LINE OF fm_data-exceps.
  FIELD-SYMBOLS:
    &lt;ex&gt;  LIKE LINE OF exception,
    &lt;t&gt;   LIKE LINE OF &lt;ex&gt;-texts.
  LOOP AT exception ASSIGNING &lt;ex&gt;.
    CLEAR: _ex.
    _ex = &lt;ex&gt;-hdr.
    CALL METHOD td_subc_desc
      EXPORTING
        sub_component = &lt;ex&gt;-sconame
        component     = component
        texts         = &lt;ex&gt;-texts
      CHANGING
        descriptions  = fm_data-subcomponent_desc.
    CLEAR: _ex-clsname, _ex-cmpname. &quot; VERSION
    _ex-clsname = obj_name.
    _ex-cmpname = component.
    _ex-langu = obj_langu.
    READ TABLE &lt;ex&gt;-texts ASSIGNING &lt;t&gt;
         WITH TABLE KEY langu = _ex-langu.
    IF sy-subrc = 0.
      _ex-descript = &lt;t&gt;-descript.
    ENDIF.
    INSERT _ex INTO TABLE fm_data-exceps.
  ENDLOOP.
endmethod.
method TD_PARAMETERS.
DATA: _pa  LIKE LINE OF fm_data-parameters.
  FIELD-SYMBOLS:
    &lt;pa&gt;  LIKE LINE OF parameters,
    &lt;t&gt;   LIKE LINE OF &lt;pa&gt;-texts.
  LOOP AT parameters ASSIGNING &lt;pa&gt;.
    CLEAR: _pa.
    _pa = &lt;pa&gt;-hdr.
    CALL METHOD td_subc_desc
      EXPORTING
        sub_component = &lt;pa&gt;-sconame
        component     = COMPONENT
        texts         = &lt;pa&gt;-texts
      changing
        descriptions  = fm_data-subcomponent_desc.
    _pa-clsname = obj_name.
    _pa-cmpname = component.
    _pa-langu = obj_langu.
    READ TABLE &lt;pa&gt;-texts ASSIGNING &lt;t&gt;
         WITH TABLE KEY langu = _pa-langu.
    IF sy-subrc = 0.
      _pa-descript = &lt;t&gt;-DESCRIPT.
    ENDIF.
    INSERT _pa INTO TABLE fm_data-parameters.
  ENDLOOP.
endmethod.
method TD_SUBC_DESC.
DATA: _t   LIKE LINE OF texts.
  LOOP AT texts into _t.
    _t-clsname = obj_name.
    _t-cmpname = component.
    _t-sconame = sub_component.
    INSERT _t INTO TABLE DESCRIPTIONS.
  ENDLOOP.
endmethod.
METHOD to_data.
  DATA _id  LIKE LINE OF fm_data-impl_details.
  DATA _at  LIKE LINE OF fm_data-attributes.
  DATA _ty  LIKE LINE OF fm_data-types.
  DATA _tg  LIKE LINE OF fm_data-typeusages.
  DATA _me  LIKE LINE OF fm_data-methods.
  DATA _al  LIKE LINE OF fm_data-aliases.
  DATA _ev  LIKE LINE OF fm_data-events.
  DATA _ms  LIKE LINE OF fm_data-method_sources.
  DATA _dc  LIKE LINE OF fm_data-clsdeferrds.
  DATA _di  LIKE LINE OF deferred-interfaces.
  DATA tmp_me LIKE LINE OF methods.
  DATA id   TYPE doku_id.
  FIELD-SYMBOLS:
    &lt;at&gt;  LIKE LINE OF attributs,
    &lt;al&gt;  LIKE LINE OF aliases,
    &lt;me&gt;  LIKE LINE OF methods,
    &lt;ev&gt;  LIKE LINE OF events,
    &lt;ct&gt;  LIKE LINE OF &lt;at&gt;-texts,
    &lt;dc&gt;  LIKE LINE OF deferred-classes,
    &lt;di&gt;  LIKE LINE OF deferred-interfaces,
    &lt;ty&gt;  LIKE LINE OF types,
    &lt;tu&gt;  LIKE LINE OF typegroups.
  APPEND LINES OF documentation TO fm_data-documentation.
  LOOP AT typegroups ASSIGNING &lt;tu&gt;.
    CLEAR _tg.
    _tg = &lt;tu&gt;-hdr.
    IF NOT &lt;tu&gt;-defered IS INITIAL.
      &lt;tu&gt;-defered-clsname = &lt;tu&gt;-clsname.
      &lt;tu&gt;-defered-typegroup = &lt;tu&gt;-typegroup.
      &lt;tu&gt;-defered-version = &lt;tu&gt;-version.
      APPEND &lt;tu&gt;-defered TO fm_data-clsdeferrds.
    ENDIF.
    IF NOT &lt;tu&gt;-itf_def IS INITIAL.
      &lt;tu&gt;-itf_def-clsname = &lt;tu&gt;-clsname.
      &lt;tu&gt;-itf_def-typegroup = &lt;tu&gt;-typegroup.
      &lt;tu&gt;-itf_def-version = &lt;tu&gt;-version.
      APPEND &lt;tu&gt;-itf_def TO fm_data-intdeferrds.
    ENDIF.
    _tg-clsname = obj_name.
    INSERT _tg INTO TABLE fm_data-typeusages.
  ENDLOOP.
  LOOP AT deferred-classes ASSIGNING &lt;dc&gt;.
    CLEAR _dc. _dc = &lt;dc&gt;.
    _dc-clsname = obj_name..
    INSERT _dc INTO TABLE fm_data-clsdeferrds.
  ENDLOOP.
  LOOP AT deferred-interfaces ASSIGNING &lt;di&gt;.
    CLEAR _di. _di = &lt;di&gt;.
    _di-clsname = obj_name.
    INSERT _di INTO TABLE fm_data-intdeferrds.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-attribute. ELSE. id = doc_ids-interface-attribute. ENDIF.
  LOOP AT attributs ASSIGNING &lt;at&gt;.
    CLEAR _at.
    _at = &lt;at&gt;-hdr.
    _at-typesrc = &lt;at&gt;-_.                                   &quot; Issue 68
    REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;newline IN _at-typesrc WITH cl_abap_char_utilities=&gt;cr_lf.
    CALL METHOD td_comp_desc
      EXPORTING
        component     = &lt;at&gt;-cmpname
        texts         = &lt;at&gt;-texts
        id            = id
      CHANGING
        documentation = fm_data-documentation
        descriptions  = fm_data-component_desc.
    _at-clsname = obj_name.
    _at-langu = obj_langu.
    READ TABLE &lt;at&gt;-texts ASSIGNING &lt;ct&gt;
         WITH TABLE KEY langu = _at-langu.
    IF sy-subrc = 0.
      _at-descript = &lt;ct&gt;-descript.
    ENDIF.
    INSERT _at INTO TABLE fm_data-attributes.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-method. ELSE. id = doc_ids-interface-method. ENDIF.
  LOOP AT methods ASSIGNING &lt;me&gt;.
    CLEAR: _me, _ms.
    _me = &lt;me&gt;-hdr.
    CALL METHOD td_comp_desc
      EXPORTING
        component     = &lt;me&gt;-cmpname
        texts         = &lt;me&gt;-texts
        id            = id
      CHANGING
        documentation = fm_data-documentation
        descriptions  = fm_data-component_desc.
    CALL METHOD td_parameters
      EXPORTING
        component  = &lt;me&gt;-cmpname
        PARAMETERS = &lt;me&gt;-parameters
      CHANGING
        fm_data    = fm_data.
    CALL METHOD td_exceptions
      EXPORTING
        component = &lt;me&gt;-cmpname
        exception = &lt;me&gt;-exceptions
      CHANGING
        fm_data   = fm_data.
    tmp_me = &lt;me&gt;.
    CLEAR: tmp_me-cmpname, tmp_me-source.
    IF tmp_me IS INITIAL.
      CONTINUE.  &quot; Interface implementation
    ENDIF.
    _ms-cpdname = &lt;me&gt;-cmpname.
    _ms-source = zaplink_object=&gt;conv_abap_source2raw( &lt;me&gt;-source-_ ).
    APPEND _ms TO fm_data-method_sources.
    _me-clsname = obj_name.
    _me-langu = obj_langu.
    READ TABLE &lt;me&gt;-texts ASSIGNING &lt;ct&gt;
         WITH TABLE KEY langu = _me-langu.
    IF sy-subrc = 0.
      _me-descript = &lt;ct&gt;-descript.
    ENDIF.
    INSERT _me INTO TABLE fm_data-methods.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-event. ELSE. id = doc_ids-interface-event. ENDIF.
  LOOP AT events ASSIGNING &lt;ev&gt;.
    CLEAR _ev.
    _ev = &lt;ev&gt;-hdr.
    CALL METHOD td_comp_desc
      EXPORTING
        component     = &lt;ev&gt;-cmpname
        texts         = &lt;ev&gt;-texts
        id            = id
      CHANGING
        documentation = fm_data-documentation
        descriptions  = fm_data-component_desc.
    CALL METHOD td_parameters
      EXPORTING
        component  = &lt;ev&gt;-cmpname
        PARAMETERS = &lt;ev&gt;-parameters
      CHANGING
        fm_data    = fm_data.
    _ev-clsname = obj_name.
    _ev-langu = obj_langu.
    READ TABLE &lt;ev&gt;-texts ASSIGNING &lt;ct&gt;
         WITH TABLE KEY langu = _ev-langu.
    IF sy-subrc = 0.
      _ev-descript = &lt;ct&gt;-descript.
    ENDIF.
    INSERT _ev INTO TABLE fm_data-events.
  ENDLOOP.
  IF obj_type = object_types-class. id = doc_ids-class-type. ELSE. id = doc_ids-interface-type. ENDIF.
  LOOP AT types ASSIGNING &lt;ty&gt;.
    CLEAR _ty.
    _ty = &lt;ty&gt;-hdr.
    _ty-typesrc = &lt;ty&gt;-_.                                   &quot; Issue 68
    REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;newline IN _ty-typesrc WITH cl_abap_char_utilities=&gt;cr_lf.
    CALL METHOD me-&gt;td_comp_desc
      EXPORTING
        component     = &lt;ty&gt;-cmpname
        texts         = &lt;ty&gt;-texts
        id            = id
      CHANGING
        documentation = fm_data-documentation
        descriptions  = fm_data-component_desc.
    _ty-clsname = obj_name.
    _ty-langu = obj_langu.
    READ TABLE &lt;ty&gt;-texts ASSIGNING &lt;ct&gt;
         WITH TABLE KEY langu = _ty-langu.
    IF sy-subrc = 0.
      _ty-descript = &lt;ct&gt;-descript.
    ENDIF.
    INSERT _ty INTO TABLE fm_data-types.
  ENDLOOP.
  LOOP AT aliases ASSIGNING &lt;al&gt;.
    CLEAR _al.
    _al = &lt;al&gt;-hdr.
    _al-clsname = obj_name.
    INSERT _al INTO TABLE fm_data-aliases.
  ENDLOOP.
ENDMETHOD.
METHOD complete_data.
  DATA s_impl_detail LIKE LINE OF fm_data-impl_details.
  FIELD-SYMBOLS:
    &lt;m&gt; LIKE LINE OF fm_data-includes-methods.
  CHECK NOT obj_name IS INITIAL.                            &quot; Issue 23
  SELECT * INTO TABLE fm_data-class_desc
    FROM seoclasstx
    WHERE clsname = obj_name.                               &quot; Issue 23
  SELECT * INTO TABLE fm_data-component_desc
    FROM seocompotx
    WHERE clsname = obj_name.                               &quot; Issue 23
  SELECT * INTO TABLE fm_data-subcomponent_desc
    FROM seosubcotx
    WHERE clsname = obj_name.                               &quot; Issue 23
  DELETE fm_data-class_desc WHERE descript IS INITIAL.
  DELETE fm_data-component_desc WHERE descript IS INITIAL.
  DELETE fm_data-subcomponent_desc WHERE descript IS INITIAL.
  LOOP AT fm_data-includes-methods ASSIGNING &lt;m&gt;
          WHERE cpdkey-clsname = obj_name.                  &quot; Issue 23
    READ TABLE fm_data-methods TRANSPORTING NO FIELDS
         WITH KEY clsname = &lt;m&gt;-cpdkey-clsname
                  cmpname = &lt;m&gt;-cpdkey-cpdname.
    IF sy-subrc = 0.
      CONTINUE.
    ENDIF.
    READ TABLE fm_data-redefinitions TRANSPORTING NO FIELDS
         WITH KEY clsname = &lt;m&gt;-cpdkey-clsname
               refclsname = fm_data-inheritance-refclsname
                  mtdname = &lt;m&gt;-cpdkey-cpdname.
    IF sy-subrc = 0.
      CONTINUE.
    ENDIF.
    CLEAR s_impl_detail.
    s_impl_detail-clsname = &lt;m&gt;-cpdkey-clsname.
    SPLIT &lt;m&gt;-cpdkey-cpdname AT method_separator INTO s_impl_detail-refclsname s_impl_detail-mtdname.
    IF s_impl_detail-mtdname IS INITIAL. &quot; no ~ in name
      MESSAGE a000(zaplink_object) WITH &lt;m&gt;-cpdkey-cpdname &lt;m&gt;-cpdkey-clsname.
    ENDIF.
    READ TABLE fm_data-impl_details TRANSPORTING NO FIELDS
         WITH KEY clsname = s_impl_detail-clsname
               refclsname = s_impl_detail-refclsname
                  mtdname = s_impl_detail-mtdname.
    IF sy-subrc = 0.
      CONTINUE.
    ENDIF.
    s_impl_detail-version = &apos;1&apos;. APPEND s_impl_detail TO fm_data-impl_details.
  ENDLOOP.
ENDMETHOD.
METHOD anonymize.
  DATA s_al  LIKE LINE OF aliases.
  DATA s_at LIKE LINE OF attributs.
  FIELD-SYMBOLS &lt;ev&gt;    LIKE LINE OF events.
  FIELD-SYMBOLS &lt;in&gt;    LIKE LINE OF interfaces.
  DATA s_co  LIKE LINE OF &lt;in&gt;-components.
  DATA s_ty  LIKE LINE OF types.
  DATA s_tg  LIKE LINE OF typegroups.
  FIELD-SYMBOLS &lt;me&gt;    LIKE LINE OF methods.
  DATA s_pa  LIKE LINE OF &lt;me&gt;-parameters.
  DATA s_ex  LIKE LINE OF &lt;me&gt;-exceptions.
  DATA s_dc  LIKE LINE OF deferred-classes.
  DATA s_di  LIKE LINE OF deferred-interfaces.
  MODIFY aliases FROM s_al TRANSPORTING version             &quot; Issue 75
         WHERE NOT cmpname IS INITIAL OR cmpname IS INITIAL.
  MODIFY attributs FROM s_at TRANSPORTING author createdon changedby changedon r3release version &quot; Issue 75
         WHERE NOT cmpname IS INITIAL OR cmpname IS INITIAL.
  LOOP AT events ASSIGNING &lt;ev&gt;.
    CLEAR: &lt;ev&gt;-author, &lt;ev&gt;-createdon, &lt;ev&gt;-changedby, &lt;ev&gt;-changedon, &lt;ev&gt;-r3release, &lt;ev&gt;-version. &quot; Issue 75
    MODIFY &lt;ev&gt;-parameters FROM s_pa TRANSPORTING author createdon changedby changedon  version &quot; Issue 75
           WHERE NOT cmpname IS INITIAL OR cmpname IS INITIAL.
  ENDLOOP.
  LOOP AT interfaces ASSIGNING &lt;in&gt;.
    CLEAR: &lt;in&gt;-author, &lt;in&gt;-createdon, &lt;in&gt;-changedby, &lt;in&gt;-changedon, &lt;in&gt;-version. &quot; Issue 75
    MODIFY &lt;in&gt;-components FROM s_co TRANSPORTING version   &quot; Issue 75
           WHERE NOT clsname IS INITIAL OR clsname IS INITIAL.
  ENDLOOP.
  LOOP AT methods ASSIGNING &lt;me&gt;.
    CLEAR: &lt;me&gt;-author, &lt;me&gt;-createdon, &lt;me&gt;-changedby, &lt;me&gt;-changedon, &lt;me&gt;-r3release, &lt;me&gt;-version. &quot; Issue 75
    MODIFY &lt;me&gt;-parameters FROM s_pa TRANSPORTING author createdon changedby changedon version &quot; Issue 75
           WHERE NOT sconame IS INITIAL OR sconame IS INITIAL. &quot; Issue 22
    MODIFY &lt;me&gt;-exceptions FROM s_ex TRANSPORTING author createdon changedby changedon version &quot; Issue 75
           WHERE NOT sconame IS INITIAL OR sconame IS INITIAL. &quot; Issue 22
  ENDLOOP.
  MODIFY typegroups FROM s_tg TRANSPORTING version          &quot; Issue 75
         WHERE NOT clsname IS INITIAL OR clsname IS INITIAL.
  MODIFY types FROM s_ty TRANSPORTING author createdon changedby changedon r3release version &quot; Issue 75
         WHERE NOT cmpname IS INITIAL OR cmpname IS INITIAL.
  MODIFY deferred-classes FROM s_dc TRANSPORTING version    &quot; Issue 75
         WHERE NOT clsname IS INITIAL OR clsname IS INITIAL.
  MODIFY deferred-interfaces FROM s_di TRANSPORTING version &quot; Issue 75
         WHERE NOT clsname IS INITIAL OR clsname IS INITIAL.
ENDMETHOD.
METHOD UNANONYMIZE.
ENDMETHOD.
METHOD class_constructor.
  DATA _id LIKE LINE OF r_doc_ids-class.
  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-class-header.     APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-class-attribute.  APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-class-method.     APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-class-event.      APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-class-type.       APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-interface-header.     APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-interface-attribute.  APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-interface-method.     APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-interface-event.      APPEND _id TO r_doc_ids-class.
  _id-low = doc_ids-interface-type.       APPEND _id TO r_doc_ids-class.
ENDMETHOD.
METHOD td_text.
  DATA _d   LIKE LINE OF documentation.
  DATA _dt  LIKE LINE OF _d-texts.
  DATA _ct  LIKE LINE OF descriptions.
  FIELD-SYMBOLS:
    &lt;t&gt;   LIKE LINE OF texts.
  _d-application = &apos;DOKU&apos;.
  _d-id = id.
  _d-object = classname.
  _d-langu = sy-langu.
  _d-masterlang = abap_true.
  _d-typ = &apos;E&apos;.
  _d-dokform = &apos;S_DOCU_SHOW&apos;.
  _d-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR _ct.
    _ct = &lt;t&gt;-main.
    _ct-clsname = classname.
    INSERT _ct INTO TABLE descriptions.
    CHECK NOT &lt;t&gt;-documentation IS INITIAL.
    _dt = &lt;t&gt;-documentation.
    _dt-tdspras = &lt;t&gt;-langu.
    INSERT _dt INTO TABLE _d-texts.
  ENDLOOP.
  IF NOT _d-texts IS INITIAL. INSERT _d INTO TABLE documentation. ENDIF.
ENDMETHOD.
METHOD fd_text.
  DATA _t     LIKE LINE OF texts.
  DATA s_key  TYPE ts_doc_key.
  DATA s_txt  LIKE LINE OF texts.
  FIELD-SYMBOLS:
    &lt;doc&gt;  LIKE LINE OF documentation,
    &lt;dt&gt;   LIKE LINE OF &lt;doc&gt;-texts,
    &lt;desc&gt; LIKE LINE OF descriptions.
  LOOP AT descriptions ASSIGNING &lt;desc&gt;
       WHERE clsname = classname.
    s_txt-main = &lt;desc&gt;.
    CLEAR: s_txt-clsname. &quot; VERSION
    s_key-name = obj_name.
    READ TABLE documentation ASSIGNING &lt;doc&gt;
         WITH KEY object = s_key.           &quot; Component name should be unique so no need to check ID
    IF sy-subrc = 0.
      READ TABLE &lt;doc&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_txt-langu.
      IF sy-subrc = 0.
        s_txt-documentation = &lt;dt&gt;.
        CLEAR: s_txt-documentation-tdspras.
      ENDIF.
    ENDIF.
    INSERT s_txt INTO TABLE texts.
  ENDLOOP.
ENDMETHOD.
METHOD clear_tags.
  CLEAR: obj_name, obj_version, obj_langu, obj_type.
ENDMETHOD.
METHOD fix_included_type_pool.
  DATA d_tabix TYPE sy-tabix.
  DATA t_tokens TYPE STANDARD TABLE OF stokes.
  DATA t_statments TYPE STANDARD TABLE OF sstmnt.
  DATA s_tp     LIKE LINE OF NEW_TYPEPOOLS.
  DATA d_flag TYPE abap_bool.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF new_sourcecode,
    &lt;t&gt; LIKE LINE OF t_tokens,
    &lt;n&gt; LIKE LINE OF t_tokens.
  CHECK NOT sourcecode IS INITIAL.
  new_sourcecode = sourcecode.
  SCAN ABAP-SOURCE sourcecode
                   TOKENS INTO t_tokens
                   STATEMENTS INTO t_statments.
  LOOP AT t_tokens ASSIGNING &lt;t&gt;
    WHERE str CP &apos;TYPE-POOLS&apos;.
    d_tabix = sy-tabix + 1.
    READ TABLE t_tokens ASSIGNING &lt;n&gt; INDEX d_tabix.
    CHECK sy-subrc = 0.
    CHECK &lt;n&gt;-row = &lt;t&gt;-row.    &quot; TYPE-POOLS ABAP.
    READ TABLE typepools TRANSPORTING NO FIELDS
         WITH KEY typegroup = &lt;n&gt;-str
                   explicit = abap_true.
    CHECK sy-subrc &lt;&gt; 0 OR public IS INITIAL.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_tp.
      s_tp-typegroup = &lt;n&gt;-str.
      s_tp-tputype = 0.     &quot; Type group use                (TYPE-POOLS tp)
      s_tp-explicit = abap_true.
      s_tp-implicit = abap_false.
      APPEND s_tp TO new_typepools.
    ENDIF.
    READ TABLE new_sourcecode ASSIGNING &lt;s&gt; INDEX &lt;n&gt;-row.
    CONCATENATE &apos;*&apos; &lt;s&gt; &apos;&quot;Auto commented by ZAPLINK_OBJECT connector and added as Explicit type group&apos;(cmt) INTO &lt;s&gt;.
    d_flag = abap_true.
  ENDLOOP.
  IF d_flag IS INITIAL. CLEAR new_sourcecode. ENDIF.
ENDMETHOD.
endclass. &quot;ZAPLINK_OBJECT_DATA implementation
class ZAPLINK_OPTIONS implementation.
method GET_DEVCLASS.
  result = devclass.
endmethod.
method SET_DEVCLASS.
  CHECK data &lt;&gt; devclass.
  devclass = data.
endmethod.
METHOD get_directory.
  result = directory.
ENDMETHOD.
method SET_DIRECTORY.
  CHECK data &lt;&gt; directory.
  directory = data.
endmethod.
method CONSTRUCTOR.
  create OBJECT directory.
  create OBJECT devclass.
endmethod.
endclass. &quot;ZAPLINK_OPTIONS implementation
class ZAPLINK_OPT_DIRECTORY implementation.
METHOD constructor.
  CREATE OBJECT _devclass.
  CREATE OBJECT _tr.
  CREATE OBJECT o_log.
  CALL METHOD o_log-&gt;init
    EXPORTING
      id_object      = ballog_object
      id_subobject   = ballog_subobject
      auto_upd_custo = abap_true
    EXCEPTIONS
      error          = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
               WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.
ENDMETHOD.
method GET_DEVCLASS.
result = _devclass.
endmethod.
method SET_DEVCLASS.
  CHECK data &lt;&gt; _devclass.
  _devclass = data.
endmethod.
METHOD get_transport_request.
  result = _tr.
ENDMETHOD.
method SET_TRANSPORT_REQUEST.
  CHECK data &lt;&gt; _tr.
  _tr = data.
endmethod.
method GET_SUBSTITUTIONKIND_OFF.
result = _substitution.
endmethod.
method SET_SUBSTITUTIONKIND_OFF.
CHECK data &lt;&gt; _substitution.
  CASE data.
    WHEN substitutionkinds-keep_container OR
         substitutionkinds-use_component OR
         substitutionkinds-local.
    WHEN substitutionkinds-fixed.
      IF _devclass IS INITIAL.
        RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
              EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                     substkind = data.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = data.
  ENDCASE.
  _substitution = data.
endmethod.
METHOD set_directory.
  DATA _name        TYPE tadir-obj_name.
  DATA _type        TYPE tadir-object.
  DATA _act_devc    TYPE tadir-devclass.
  DATA _exists      TYPE saus_dpara-tadirexist.
  CHECK component IS BOUND.
  result = component-&gt;directory.
  TRY.
      IF me-&gt;_devclass IS BOUND.
        TRY.
            result-devclass = me-&gt;_devclass-&gt;substitute( component ).
          CATCH zaplink_cx_options INTO o_mycx.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      ENDIF.
      IF me-&gt;_tr IS BOUND.
        TRY.
            result-trkorr = _tr-&gt;substitute( component ).
          CATCH zaplink_cx_options INTO o_mycx.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      ENDIF.
      _type = component-&gt;get_type( ).
      _name = component-&gt;get_name( ).
      CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
        EXPORTING
          iv_pgmid           = &apos;R3TR&apos;
          iv_object          = _type
          iv_obj_name        = _name
        IMPORTING
          ev_devclass        = _act_devc
          ev_exist           = _exists.
      IF _exists IS INITIAL.
        CALL FUNCTION &apos;TRINT_TADIR_INSERT&apos;
          EXPORTING
            devclass                   = result-devclass
            object                     = _type
            obj_name                   = _name
            pgmid                      = &apos;R3TR&apos;
          EXCEPTIONS
            object_exists_global       = 1
            object_exists_local        = 2
            OTHERS                     = 3.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( classname = &apos;ZAPLINK_CX_OPT_DEVCLASS&apos;
                                                    funcname = &apos;TRINT_TADIR_INSERT&apos;
                                                       subrc = sy-subrc ).
          o_log-&gt;add_symsg( ).
          o_log-&gt;add_exception( o_mycx ).
          CLEAR o_mycx.
        ENDIF.
      ELSEIF _act_devc &lt;&gt; result-devclass.
        CALL FUNCTION &apos;TRINT_TADIR_MODIFY&apos;
          EXPORTING
            devclass                   = result-devclass
            object                     = _type
            obj_name                   = _name
            pgmid                      = &apos;R3TR&apos;
          EXCEPTIONS
            object_exists_global       = 1
            object_exists_local        = 2
            object_has_no_tadir        = 3
            OTHERS                     = 4.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( classname = &apos;ZAPLINK_CX_OPT_DEVCLASS&apos;
                                                    funcname = &apos;TRINT_TADIR_MODIFY&apos;
                                                       subrc = sy-subrc ).
          o_log-&gt;add_symsg( ).
          o_log-&gt;add_exception( o_mycx ).
          CLEAR o_mycx.
        ENDIF.
      ENDIF.
      CALL FUNCTION &apos;RS_CORR_INSERT&apos;
        EXPORTING
          object                         = _name
          object_class                   = _type
          mode                           = &apos;I&apos;        &quot; Insert
          global_lock                    = abap_true        &quot; R3TR
          devclass                       = result-devclass
          korrnum                        = result-trkorr
        IMPORTING
          korrnum                        = result-trkorr
        EXCEPTIONS
          cancelled                      = 1
          permission_failure             = 2
          unknown_objectclass            = 3
          OTHERS                         = 4.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( classname = &apos;ZAPLINK_CX_OPT_DEVCLASS&apos;
                                                  funcname = &apos;RS_CORR_INSERT&apos;
                                                     subrc = sy-subrc ).
        o_log-&gt;add_symsg( ).
        o_log-&gt;add_exception( o_mycx ).
        CLEAR o_mycx.
      ENDIF.
    CATCH zaplink_cx_options INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
endclass. &quot;ZAPLINK_OPT_DIRECTORY implementation
class ZAPLINK_RAW_BASE implementation.
method ANONYMIZE.
  clear:
    me-&gt;DIRECTORY-korrnum,
    me-&gt;DIRECTORY-srcsystem,
    me-&gt;DIRECTORY-author,
    me-&gt;DIRECTORY-trkorr.
endmethod.
method CLASS_CONSTRUCTOR.
  xmlengine = cl_ixml=&gt;create( ).
endmethod.
METHOD CONSTRUCTOR.
  TRY.
      IF o_comp IS BOUND.
        set_component( o_comp ).
      ENDIF.
    CATCH zaplink_cx.
  ENDTRY.
ENDMETHOD.
METHOD conv_to_xml.
  DATA ez_xml          TYPE to_ez_xml.
  DATA o_xml           TYPE to_xml.
  CREATE OBJECT ez_xml.
  CLEAR checksum.  &quot; Issue 21 : clear previous checksum
  o_xml = ez_xml-&gt;any2xml( any       = me
                           type      = comp_nodename ).
  result = o_xml.
ENDMETHOD.
METHOD GET_CHECKSUM.
  result = checksum.
ENDMETHOD.
METHOD GET_COMPONENT.
  TRY.
      CREATE OBJECT o_comp.
      o_comp-&gt;set_type( type ).
      o_comp-&gt;set_name( name ).
      o_comp-&gt;set_devclass( directory-devclass ).
      o_comp-&gt;set_connuuid( connector ).
      o_comp-&gt;set_checksum( checksum ).
      o_comp-&gt;set_code_signature( code_signature ).
    CATCH zaplink_cx_component INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD GET_NAME.
  result = name.
ENDMETHOD.
METHOD GET_TYPE.
  result = type.
ENDMETHOD.
METHOD REFRESH_DIRECTORY.
  SELECT SINGLE *
    INTO CORRESPONDING FIELDS OF directory
    FROM tadir
    WHERE pgmid = &apos;R3TR&apos;
      AND object = type
      AND obj_name = name.
  IF type = &apos;DEVC&apos;. CLEAR directory-devclass. ENDIF.
ENDMETHOD.
METHOD set_checksum.
  DATA o_xml           TYPE to_xml.
  DATA _tempstring     TYPE string.
  DATA _len            TYPE i.
  o_xml = conv_to_xml( ).
  CHECK o_xml IS BOUND.
  _tempstring = xml_2_string( o_xml ).
  REPLACE FIRST OCCURRENCE OF REGEX &apos;&lt;\?.*\?&gt;&apos; IN _tempstring WITH ``.
  checksum = zaplink_tools=&gt;calculate_md5_hash( _tempstring ).
ENDMETHOD.
METHOD SET_COMPONENT.
  CHECK o_comp IS BOUND.
  TRY.
      type = o_comp-&gt;get_type( ).
      name = o_comp-&gt;get_name( ).
      connector = o_comp-&gt;get_connuuid( ).
      refresh_directory( ).
    CATCH zaplink_cx_container INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method UNANONYMIZE.
  If me-&gt;DIRECTORY-srcsystem is INITIAL. me-&gt;DIRECTORY-srcsystem = Sy-sysid. endif.
  if me-&gt;DIRECTORY-author is INITIAL. me-&gt;DIRECTORY-author = sy-uname. endif.
endmethod.
method XML_2_STRING.
  DATA _streamfactory  TYPE REF TO if_ixml_stream_factory.
  DATA _outputstream   TYPE REF TO if_ixml_ostream.
  DATA _renderer       TYPE REF TO if_ixml_renderer.
  DATA _tempstring     TYPE string.
  DATA _printxmldoc    TYPE REF TO cl_xml_document.
  DATA _rc             TYPE sysubrc.
  check o_xml IS BOUND.
  _streamfactory = xmlengine-&gt;create_stream_factory( ).
  _outputstream = _streamfactory-&gt;create_ostream_cstring( _tempstring ).
  _renderer = xmlengine-&gt;create_renderer( document = o_xml
                                           ostream = _outputstream ).
  _renderer-&gt;set_normalizing( ).
  _rc = _renderer-&gt;render( ).
  CREATE OBJECT _printxmldoc.
  _rc = _printxmldoc-&gt;parse_string( _tempstring ).
  WHILE _tempstring(1) &lt;&gt; &apos;&lt;&apos;.
    SHIFT _tempstring LEFT BY 1 PLACES.
  ENDWHILE.
  result = _tempstring.
endmethod.
METHOD UPDATE_CONNECTOR_DATA.
  me-&gt;connector = o_connector-&gt;uuid.
  me-&gt;version = o_connector-&gt;version.
ENDMETHOD.
endclass. &quot;ZAPLINK_RAW_BASE implementation
class ZAPLINK_CONNECTOR_ implementation.
METHOD conv_abap_raw2source.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF raw.
  LOOP AT raw ASSIGNING &lt;c&gt;.
    CONCATENATE result &lt;c&gt; INTO result SEPARATED BY line_separator. &quot; will start with line_sep better for XML display and required because get_value remove spaces
  ENDLOOP.
ENDMETHOD.
METHOD conv_abap_source2raw.
  SPLIT source AT line_separator INTO TABLE result.
  IF NOT result IS INITIAL.       &quot; remove first line separator
    IF source(1) = line_separator.
      DELETE result INDEX 1.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD get_prog_rawsource.
  DATA d_obj_name   TYPE e071-obj_name.
  DATA d_is_work_i  TYPE abap_bool.
  DATA d_is_inactiv TYPE abap_bool.
  d_obj_name = program.
  CALL FUNCTION &apos;RS_OBJECT_IN_WORKING_AREA&apos;
    EXPORTING
      object                        = &apos;REPS&apos;
      obj_name                      = d_obj_name
    IMPORTING
      object_is_work_item           = d_is_work_i     &quot; My inactive object
      object_inactive_version       = d_is_inactiv.
  IF NOT d_is_work_i IS INITIAL OR NOT d_is_inactiv IS INITIAL.
    READ REPORT program INTO result STATE &apos;I&apos;.
  ELSE.
    sy-subrc = 4.
  ENDIF.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT program INTO result STATE &apos;A&apos;.
  ENDIF.
ENDMETHOD.
method GET_PROG_SOURCE.
  DATA code TYPE tt_abaprawsource.
  code = get_prog_rawsource( program ).
  result = conv_abap_raw2source( code ).
endmethod.
METHOD get_prog_textpool.
  DATA t_textpool TYPE STANDARD TABLE OF textpool.
  DATA t_langlist TYPE instlang.
  TYPES:
    BEGIN OF ts_text,
      id      TYPE  textpoolid,
      key     TYPE  textpoolky,
      langu   TYPE spras,
      entry   TYPE textpooltx,
      length  TYPE textpoolln,
    END OF ts_text.
  DATA: t_texts TYPE STANDARD TABLE OF ts_text.
  DATA _text LIKE LINE OF t_texts.
  DATA _textpool LIKE LINE OF result.
  DATA _tpool LIKE LINE OF _textpool-texts.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_langlist,
    &lt;t&gt; LIKE LINE OF t_textpool.
  CALL FUNCTION &apos;RS_TEXTLOG_GET_PARAMETERS&apos;
    CHANGING
      installed_languages = t_langlist.
  LOOP AT t_langlist ASSIGNING &lt;l&gt;.
    READ TEXTPOOL program INTO t_textpool LANGUAGE &lt;l&gt;.
    IF sy-subrc = 0.
      _text-langu = &lt;l&gt;.
      LOOP AT t_textpool ASSIGNING &lt;t&gt;.
        _text-id = &lt;t&gt;-id.
        _text-key = &lt;t&gt;-key.
        _text-entry = &lt;t&gt;-entry.
        _text-length = &lt;t&gt;-length.
        APPEND _text TO t_texts.
      ENDLOOP.
    ENDIF.
  ENDLOOP.
  SORT t_texts BY id key langu.
  DELETE ADJACENT DUPLICATES FROM t_texts COMPARING id key langu.
  LOOP AT t_texts INTO _text.
    AT NEW key. &quot; ID
      CLEAR _textpool.
      _textpool-id = _text-id.
      _textpool-key = _text-key.
    ENDAT.
    AT NEW langu.
      CLEAR _tpool.
      _tpool-langu = _text-langu.
    ENDAT.
    _tpool-entry = _text-entry.
    _tpool-length = _text-length.
    AT END OF langu.
      APPEND _tpool TO _textpool-texts.
    ENDAT.
    AT END OF key.
      APPEND _textpool TO result.
    ENDAT.
  ENDLOOP.
ENDMETHOD.
METHOD get_type_from_xml.
  DATA root_node TYPE REF TO if_ixml_node.
  DATA o_raw     TYPE to_raw_base.
  DATA _name     TYPE string.
  CHECK object IS BOUND.
  root_node = object-&gt;get_root_element( ).
  IF NOT root_node IS BOUND.
    _name = &apos;$NONE$&apos;(001).
    RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
          textid = zaplink_cx_connector=&gt;invalid_xml
       node_name = _name.
  ENDIF.
  _name = root_node-&gt;get_name( ).
  IF _name &lt;&gt; comp_nodename.
    RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
          textid = zaplink_cx_connector=&gt;invalid_xml
       node_name = _name.
  ENDIF.
  TRY.
      o_raw = zaplink_connectors=&gt;node_2_raw( root_node ).
      result = o_raw-&gt;type.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD set_base_attributs.
  DATA o_desc    TYPE REF TO cl_abap_typedescr.
  DATA string    TYPE string.
  DATA _name     TYPE tadir-obj_name.
  DATA _type     TYPE tadir-object.
  o_desc = cl_abap_typedescr=&gt;describe_by_object_ref( p_object_ref = me ).
  string = o_desc-&gt;get_relative_name( ).
  TRY.
      _name = attributs-name = component-&gt;get_name( ).
      _type = component-&gt;get_type( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  attributs-class = string.
  attributs-version = me-&gt;version.
  CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
    EXPORTING
      iv_pgmid           = &apos;R3TR&apos;
      iv_object          = _type
      iv_obj_name        = _name
    IMPORTING
      ev_devclass        = attributs-devclass
            .
ENDMETHOD.
method SET_PROG_RAWSOURCE.
INSERT REPORT program FROM raw STATE &apos;I&apos;.
  IF sy-subrc = 0.
    INSERT REPORT program FROM raw STATE &apos;A&apos;.
  ENDIF.
endmethod.
method SET_PROG_SOURCE.
DATA _raw TYPE tt_abaprawsource.
  _raw = conv_abap_source2raw( source ).
  set_prog_rawsource( program = program
                          raw = _raw ).
endmethod.
method SET_PROG_TEXTPOOL.
  TYPES:
    BEGIN OF ts_text,
      langu   TYPE spras,
      id      TYPE  textpoolid,
      key     TYPE  textpoolky,
      entry   TYPE textpooltx,
      length  TYPE textpoolln,
    END OF ts_text.
  DATA t_textpool TYPE STANDARD TABLE OF textpool.
  DATA: t_texts TYPE STANDARD TABLE OF ts_text.
  DATA _text LIKE LINE OF t_texts.
  DATA _textpool LIKE LINE OF t_textpool.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF textpool,
    &lt;l&gt; LIKE LINE OF &lt;t&gt;-texts.
  LOOP AT textpool ASSIGNING &lt;t&gt;.
    _text-id = &lt;t&gt;-id.
    _text-key = &lt;t&gt;-key.
    LOOP AT &lt;t&gt;-texts ASSIGNING &lt;l&gt;.
      _text-langu = &lt;l&gt;-langu.
      _text-entry = &lt;l&gt;-entry.
      _text-length = &lt;l&gt;-length.
      APPEND _text TO t_texts.
    ENDLOOP.
  ENDLOOP.
  SORT t_texts BY langu id key.
  DELETE ADJACENT DUPLICATES FROM t_texts COMPARING langu id key.
  LOOP AT t_texts INTO _text.
    AT NEW langu. &quot; ID
      CLEAR: t_textpool, _textpool.
    ENDAT.
    _textpool-id = _text-id.
    _textpool-key = _text-key.
    _textpool-entry = _text-entry.
    _textpool-length = _text-length.
    APPEND _textpool TO t_textpool.
    AT END OF langu.
      INSERT textpool program FROM t_textpool LANGUAGE _text-langu STATE &apos;I&apos;.   &quot; Issue 68
      INSERT textpool program FROM t_textpool LANGUAGE _text-langu STATE &apos;A&apos;.   &quot; Issue 68
    ENDAT.
  ENDLOOP.
endmethod.
METHOD zaplink_connector~export_from_sap.
  DATA ez_xml          TYPE to_ez_xml.
  DATA o_data          TYPE to_raw.
  o_data = read_from_sap( component ).
  IF o_data IS BOUND.
    o_data-&gt;update_connector_data( me ).
    CREATE OBJECT ez_xml.
    TRY.
        object = ez_xml-&gt;any2xml( any       = o_data
                                  type      = comp_nodename ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
  ENDIF.
ENDMETHOD.
METHOD zaplink_connector~import_to_sap.
  DATA root_node TYPE REF TO if_ixml_node.
  DATA o_raw_b   TYPE to_raw_base.
  DATA o_raw     TYPE to_raw.
  DATA _name     TYPE string.
  DATA ez_xml    TYPE to_ez_xml.
  DATA o_cx      TYPE REF TO cx_root.
  DATA o_zlcx    TYPE REF TO zaplink_cx.
  DATA t_bapiret TYPE bapirettab.
  CHECK object IS BOUND.
  TRY.
      root_node = object-&gt;get_root_element( ).
      IF NOT root_node IS BOUND.
        _name = &apos;$NONE$&apos;(001).
        RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
              textid = zaplink_cx_connector=&gt;invalid_xml
           node_name = _name.
      ENDIF.
      _name = root_node-&gt;get_name( ).
      IF _name &lt;&gt; comp_nodename.
        RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
              textid = zaplink_cx_connector=&gt;invalid_xml
           node_name = _name.
      ENDIF.
      TRY.
          o_raw_b = zaplink_connectors=&gt;node_2_raw( root_node ).
        CATCH zaplink_cx_connector INTO o_mycx.
          RAISE EXCEPTION o_mycx.
      ENDTRY.
      IF is_supported_version( o_raw_b-&gt;version ) = abap_false.
        RAISE EXCEPTION TYPE zaplink_cx_connector EXPORTING
              textid = zaplink_cx_connector=&gt;unsuported_version
            conn_ver = o_raw_b-&gt;version.
      ENDIF.
      o_raw = create_new_raw( o_raw_b-&gt;type ).
      CREATE OBJECT ez_xml.
      CALL METHOD ez_xml-&gt;xml2any
        EXPORTING
          xmldoc = object
        CHANGING
          any    = o_raw.
      IF ez_xml-&gt;application_log-&gt;has_messages_of_msgt( id_msgty = &apos;W&apos;) = abap_true.
        application_log-&gt;add_from_instance( io_msglist = ez_xml-&gt;application_log
                                     if_add_as_subnode = abap_true ).
        DATA t_handle TYPE bal_t_logh.
        DATA s_profil TYPE bal_s_prof.
        DATA s_choice TYPE bal_s_excm.
        APPEND application_log-&gt;md_handle TO t_handle.
        CALL FUNCTION &apos;BAL_DSP_PROFILE_SINGLE_LOG_GET&apos;
          IMPORTING
            e_s_display_profile = s_profil
          EXCEPTIONS
            OTHERS              = 0.
        s_profil-langu = sy-langu.
        MESSAGE i010(zaplink_easyxml) WITH o_raw_b-&gt;type o_raw_b-&gt;name INTO s_profil-title.
        s_profil-use_grid = s_profil-no_toolbar = s_profil-show_all = s_profil-cwidth_opt = abap_true.
        MESSAGE i009(zaplink_easyxml) WITH o_raw_b-&gt;type o_raw_b-&gt;name INTO s_profil-grid_title-gridtitle.
        s_profil-start_col = s_profil-start_row = 5.
        s_profil-end_col = 120.
        s_profil-end_row = 40.
        s_profil-head_size = 10.
        CALL FUNCTION &apos;BAL_DSP_LOG_DISPLAY&apos;
          EXPORTING
            i_s_display_profile          = s_profil
            i_t_log_handle               = t_handle
            i_amodal                     = abap_false
          IMPORTING
            e_s_exit_command             = s_choice
          EXCEPTIONS
            profile_inconsistent         = 1
            internal_error               = 2
            no_data_available            = 3
            no_authority                 = 4
            OTHERS                       = 5.
        IF sy-subrc &lt;&gt; 0 OR s_choice-continue IS INITIAL.
          CREATE OBJECT o_mycx
            EXPORTING
              textid = zaplink_cx_connector=&gt;xml_error
              TYPE   = o_raw_b-&gt;type
              name   = o_raw_b-&gt;name.
          o_mycx-&gt;update( ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
      ENDIF.
      components = write_to_sap( o_raw ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_zlcx.
      CREATE OBJECT o_mycx
        EXPORTING
          textid  = zaplink_cx=&gt;system_error
          prev_cx = o_zlcx.
      o_mycx-&gt;update( ).
      RAISE EXCEPTION o_mycx.
    CATCH cx_root INTO o_cx.
      CREATE OBJECT o_mycx
        EXPORTING
          textid   = zaplink_cx=&gt;system_error
          previous = o_cx.
      o_mycx-&gt;update( ).
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~get_values.
  DATA _obj_type TYPE  euobj-id.
  DATA _name TYPE td_compname.
  _obj_type = type.
  CALL FUNCTION &apos;REPOSITORY_INFO_SYSTEM_F4&apos;
    EXPORTING
      object_type           = _obj_type
      object_name           = name
      suppress_selection    = abap_true
      use_alv_grid          = abap_false
      without_personal_list = abap_false
    IMPORTING
      object_name_selected  = _name
    EXCEPTIONS
      cancel                = 1.
  IF sy-subrc = 0.
    name = _name.
  ENDIF.
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  TRY.
      CHECK object IS BOUND.
      object-&gt;anonymize( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~unanonymize.
  TRY.
      CHECK object IS BOUND.
      object-&gt;unanonymize( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_dynpros.
  SET EXTENDED CHECK OFF.
  INCLUDE mseusbit. &quot; for c_type_dynp_select_norm, c_type_dynp_select_mod, c_type_dynp_select_incl
  SET EXTENDED CHECK ON.
  TYPES:
    BEGIN OF t_dynpro,
      prog TYPE d020s-prog,
      dnum TYPE d020s-dnum,
    END OF t_dynpro.
  DATA t_dynpros TYPE SORTED TABLE OF t_dynpro WITH UNIQUE KEY dnum.
  DATA header TYPE d020s.
  DATA t_d021t TYPE SORTED TABLE OF d021t WITH UNIQUE KEY dynr fldn lang.
  DATA t_container TYPE dycatt_tab.
  DATA t_fields    TYPE dyfatc_tab.
  DATA t_flowlogic TYPE tt_flow_logic.
  DATA s_result LIKE LINE OF result.
  DATA s_cont   LIKE LINE OF s_result-containers.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF t_container,
    &lt;f&gt; LIKE LINE OF t_fields,
    &lt;t&gt; LIKE LINE OF t_d021t,
    &lt;r&gt; LIKE LINE OF t_dynpros.
  DATA s_field  LIKE LINE OF s_cont-fields.
  DATA s_text   LIKE LINE OF s_field-texts.
  DATA f_clear  TYPE abap_bool.
  SELECT prog dnum INTO TABLE t_dynpros
    FROM d020s
    WHERE prog = program
      AND type NOT IN (c_type_dynp_select_norm, c_type_dynp_select_mod, c_type_dynp_select_incl).
  SELECT *
    INTO TABLE t_d021t
    FROM d021t
    WHERE prog = program
      AND dtxt &lt;&gt; space.
  LOOP AT t_dynpros ASSIGNING &lt;r&gt;.
    CLEAR s_result.
      SET EXTENDED CHECK OFF.
      IF 1 = 2. MESSAGE i004(zaplink_connector) WITH space space. ENDIF.
      SET EXTENDED CHECK ON.
      application_log-&gt;add_info( id_msgid = &apos;ZAPLINK_CONNECTOR&apos;
                                 id_msgno = &apos;004&apos;
                                 id_msgv1 = &lt;r&gt;-prog
                                 id_msgv2 = &lt;r&gt;-dnum ).
    SELECT lang dtxt
      INTO CORRESPONDING FIELDS OF TABLE s_result-texts
      FROM d020t
      WHERE prog = &lt;r&gt;-prog
        AND dynr = &lt;r&gt;-dnum
        AND dtxt &lt;&gt; space.
    CALL FUNCTION &apos;RPY_DYNPRO_READ&apos;
      EXPORTING
        progname                    = &lt;r&gt;-prog
        dynnr                       = &lt;r&gt;-dnum
      IMPORTING
        header                      = s_result-hdr
      TABLES
        containers                  = t_container
        fields_to_containers        = t_fields
        flow_logic                  = t_flowlogic
        params                      = s_result-matchcodes
      EXCEPTIONS
        cancelled                   = 1
        not_found                   = 2
        permission_error            = 3
        OTHERS                      = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
    LOOP AT t_container ASSIGNING &lt;c&gt;.
      CLEAR s_cont.
      s_cont-hdr = &lt;c&gt;.
      LOOP AT t_fields ASSIGNING &lt;f&gt;
           WHERE cont_type = &lt;c&gt;-type
             AND cont_name = &lt;c&gt;-name.
        CLEAR: s_field, f_clear.
        s_field-hdr = &lt;f&gt;.
        CLEAR: s_field-cont_type, s_field-cont_name.
        IF &lt;f&gt;-type IN r_text_fields.       &quot; field may have texts
          LOOP AT t_d021t ASSIGNING &lt;t&gt;
               WHERE dynr = &lt;r&gt;-dnum
                 AND fldn = &lt;f&gt;-name.
            CLEAR s_text.
            s_text-langu = &lt;t&gt;-lang.
            s_text-short_txt = &lt;t&gt;-dtxt.
            INSERT s_text INTO TABLE s_field-texts.
            IF &lt;t&gt;-dtxt = s_field-text. f_clear = abap_true. ENDIF.
          ENDLOOP.
          IF NOT s_field-texts IS INITIAL AND NOT s_field-text CO &apos;_&apos; AND f_clear = abap_true. CLEAR s_field-text. ENDIF.
        ENDIF.
        INSERT s_field INTO TABLE s_cont-fields.
      ENDLOOP.
      INSERT s_cont INTO TABLE s_result-containers.
    ENDLOOP.
    s_result-flow_logic-_ = conv_flowlogic2abapsource( t_flowlogic ).
    CLEAR s_result-program.
    INSERT s_result INTO TABLE result.
  ENDLOOP.
ENDMETHOD.
METHOD set_dynpros.
  INCLUDE mseusbit. &quot; for c_type_dynp_select_norm, c_type_dynp_select_mod, c_type_dynp_select_incl
  DATA:
    BEGIN OF dynp_id,
      prog TYPE d020s-prog,
      dnum TYPE d020s-dnum,
    END OF dynp_id.
  DATA header   TYPE rpy_dyhead.
  DATA t_flowlogic TYPE tt_flow_logic.
  DATA t_containers TYPE dycatt_tab.
  DATA s_cont  LIKE LINE OF t_containers.
  DATA t_fields TYPE dyfatc_tab.
  DATA s_field LIKE LINE OF t_fields.
  DATA t_descs TYPE SORTED TABLE OF d020t WITH UNIQUE KEY prog dynr.
  DATA s_desc LIKE LINE OF t_descs.
  DATA t_texts TYPE SORTED TABLE OF d021t WITH UNIQUE KEY prog dynr fldn lang.
  DATA s_text LIKE LINE OF t_texts.
  DATA f_fill TYPE abap_bool.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF dynpros,
    &lt;l&gt; LIKE LINE OF &lt;r&gt;-texts,
    &lt;c&gt; LIKE LINE OF &lt;r&gt;-containers,
    &lt;f&gt; LIKE LINE OF &lt;c&gt;-fields,
    &lt;t&gt; LIKE LINE OF &lt;f&gt;-texts.
  CLEAR o_mycx.
  LOOP AT dynpros ASSIGNING &lt;r&gt;.
    CLEAR: header, t_containers, t_fields, t_texts, t_descs.
    header = &lt;r&gt;-hdr.
    header-program = program.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE i004(zaplink_connector) WITH space space. ENDIF.
    SET EXTENDED CHECK ON.
    application_log-&gt;add_info( id_msgid = &apos;ZAPLINK_CONNECTOR&apos;
                               id_msgno = &apos;004&apos;
                               id_msgv1 = header-program
                               id_msgv2 = header-screen ).
    LOOP AT &lt;r&gt;-texts ASSIGNING &lt;l&gt;.
      CLEAR s_desc.
      MOVE-CORRESPONDING &lt;l&gt; TO s_desc.
      INSERT s_desc INTO TABLE t_descs.
    ENDLOOP.
    t_flowlogic = conv_abapsource2flowlogic( &lt;r&gt;-flow_logic-_ ).
    LOOP AT &lt;r&gt;-containers ASSIGNING &lt;c&gt;.
      CLEAR s_cont.
      s_cont = &lt;c&gt;-hdr.
      LOOP AT &lt;c&gt;-fields ASSIGNING &lt;f&gt;.
        s_field = &lt;f&gt;-hdr.
        s_field-cont_type = &lt;c&gt;-type.
        s_field-cont_name = &lt;c&gt;-name.
        IF s_field-text IS INITIAL. f_fill = abap_true. ENDIF.    &quot; protect data
        LOOP AT &lt;f&gt;-texts ASSIGNING &lt;t&gt;.
          IF f_fill = abap_true AND ( sy-tabix = 1 OR &lt;t&gt;-langu = sy-langu ). s_field-text = &lt;t&gt;-short_txt. ENDIF.
          CLEAR s_text.
          s_text-prog = header-program.
          s_text-dynr = header-screen.
          s_text-fldn = &lt;f&gt;-name.
          s_text-lang = &lt;t&gt;-langu.
          s_text-dtxt = &lt;t&gt;-short_txt.
          INSERT s_text INTO TABLE t_texts.
        ENDLOOP.
        INSERT s_field INTO TABLE t_fields.
      ENDLOOP.
      INSERT s_cont INTO TABLE t_containers.
    ENDLOOP.
    CALL FUNCTION &apos;RPY_DYNPRO_INSERT&apos;
      EXPORTING
        suppress_exist_checks          = abap_true
        header                         = header
      TABLES
        containers                     = t_containers
        fields_to_containers           = t_fields
        flow_logic                     = t_flowlogic
        params                         = &lt;r&gt;-matchcodes
      EXCEPTIONS
        cancelled                      = 1
        already_exists                 = 2
        program_not_exists             = 3
        not_executed                   = 4
        missing_required_field         = 5
        illegal_field_value            = 6
        field_not_allowed              = 7
        not_generated                  = 8
        illegal_field_position         = 9
        OTHERS                         = 10.
    IF sy-subrc &lt;&gt; 0.
      TRY.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;RPY_DYNPRO_INSERT&apos;
                                                      subrc = sy-subrc
                                                  classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        CATCH zaplink_cx INTO o_cx.
          mac_cascade_raise o_mycx o_cx.
      ENDTRY.
      application_log-&gt;add_symsg( ).
      application_log-&gt;add_exception( o_mycx ).
      CONTINUE.
    ENDIF.
    MODIFY d020t FROM TABLE t_descs.
    MODIFY d021t FROM TABLE t_texts.
  ENDLOOP.
  IF o_mycx IS BOUND.
    RAISE EXCEPTION o_mycx.
  ENDIF.
ENDMETHOD.
method CONV_FLOWLOGIC2ABAPSOURCE.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF raw.
  LOOP AT raw ASSIGNING &lt;c&gt;.
    CONCATENATE result &lt;c&gt; INTO result SEPARATED BY line_separator. &quot; will start with line_sep better for XML display and required because get_value remove spaces
  ENDLOOP.
endmethod.
METHOD conv_abapsource2flowlogic.
  SPLIT source AT line_separator INTO TABLE result.
  IF NOT result IS INITIAL.       &quot; remove first line separator
    IF source(1) = line_separator.
      DELETE result INDEX 1.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD class_constructor.
  DATA s_type LIKE LINE OF r_text_fields.
  s_type-sign = &apos;I&apos;. s_type-option = &apos;EQ&apos;.
  s_type-low = rpyty_dynp_ftype-text.       APPEND s_type TO r_text_fields.
  s_type-low = rpyty_dynp_ftype-frame.      APPEND s_type TO r_text_fields.
  s_type-low = rpyty_dynp_ftype-push.       APPEND s_type TO r_text_fields.
ENDMETHOD.
METHOD get_menus.
  DATA s_fm_data TYPE zaplink_menupainter_data=&gt;ts_fm_data.
  CALL FUNCTION &apos;RS_CUA_INTERNAL_FETCH&apos;
    EXPORTING
      program                    = program
      state                      = &apos;A&apos;
    IMPORTING
      adm                        = s_fm_data-header
    TABLES
      sta                        = s_fm_data-status
      fun                        = s_fm_data-functions
      men                        = s_fm_data-menus_det
      mtx                        = s_fm_data-menus
      act                        = s_fm_data-bars_det
      but                        = s_fm_data-buttons_det
      pfk                        = s_fm_data-keyboards
      set                        = s_fm_data-stat_funcs
      doc                        = s_fm_data-attributes
      tit                        = s_fm_data-titles
      biv                        = s_fm_data-ffuncs
    EXCEPTIONS
      not_found                  = 1
      unknown_version            = 2
      OTHERS                     = 3.
  IF sy-subrc &lt;&gt; 0 OR s_fm_data IS INITIAL.
    EXIT.
  ENDIF.
  SELECT *
    INTO TABLE s_fm_data-texts
    FROM rsmptexts
    WHERE progname = program.
  CREATE OBJECT result.
  result-&gt;from_data( s_fm_data ).
ENDMETHOD.
METHOD set_menus.
  DATA s_fm_data TYPE zaplink_menupainter_data=&gt;ts_fm_data.
  DATA d_trkey   TYPE trkey.
  CHECK menus IS BOUND.
  s_fm_data = menus-&gt;to_data( ).
  d_trkey-obj_type = &apos;PROG&apos;.
  d_trkey-sub_name = d_trkey-obj_name = program.
  d_trkey-sub_type = &apos;CUAD&apos;.
  CALL FUNCTION &apos;RS_CUA_INTERNAL_WRITE&apos;
    EXPORTING
      program   = program
      language  = s_fm_data-header-mod_langu
      tr_key    = d_trkey
      adm       = s_fm_data-header
      state     = &apos;I&apos;
    TABLES
      sta       = s_fm_data-status
      fun       = s_fm_data-functions
      men       = s_fm_data-menus_det
      mtx       = s_fm_data-menus
      act       = s_fm_data-bars_det
      but       = s_fm_data-buttons_det
      pfk       = s_fm_data-keyboards
      set       = s_fm_data-stat_funcs
      doc       = s_fm_data-attributes
      tit       = s_fm_data-titles
      biv       = s_fm_data-ffuncs
    EXCEPTIONS
      not_found = 1
      OTHERS    = 2.
  IF sy-subrc &lt;&gt; 0.
  ENDIF.
  DELETE FROM rsmptexts WHERE progname = program.
  MODIFY rsmptexts FROM TABLE s_fm_data-texts.
ENDMETHOD.
method ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE.
endmethod.
endclass. &quot;ZAPLINK_CONNECTOR_ implementation
class ZAPLINK_CONTAINER implementation.
METHOD add_components.
  DATA o_comp    TYPE zaplink_list=&gt;to_component.
  DATA msg       TYPE string.
  DATA _msg_col  TYPE to_log.
  CHECK object_list IS BOUND.
  TRY.
      TRY.
          object_list-&gt;order_kind = zaplink_list=&gt;order_kinds-no_order.
          object_list-&gt;init_sel_iter( ).
          object_list-&gt;display_progress = abap_true.
          o_comp = object_list-&gt;get_next( ).
        CATCH zaplink_cx_list INTO o_cx.
          mac_cascade_raise o_mycx o_cx.
      ENDTRY.
      WHILE o_comp IS BOUND.
        TRY.
            _add_component( component = o_comp ).
          CATCH zaplink_cx_container INTO o_mycx.
            CALL METHOD log-&gt;add_exception
              EXPORTING
                exception    = o_mycx
                id_probclass = log-&gt;probcl-medium.
            TRY.
                _msg_col = o_comp-&gt;get_msg_coll( ).
              CATCH zaplink_cx INTO o_cx.
                mac_cascade_raise o_mycx o_cx.
            ENDTRY.
            IF _msg_col IS BOUND.
              CALL METHOD log-&gt;add_from_instance
                EXPORTING
                  io_msglist        = _msg_col
                  if_add_as_subnode = abap_true
                  .
            ENDIF.
        ENDTRY.
        TRY.
            o_comp = object_list-&gt;get_next( ).
          CATCH zaplink_cx_list INTO o_cx.
            mac_cascade_raise o_mycx o_cx.
        ENDTRY.
      ENDWHILE.
      compact( ).
    CATCH zaplink_cx_container INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
method CLASS_CONSTRUCTOR.
xmlengine = cl_ixml=&gt;create( ).
endmethod.
METHOD compact.
  DATA o_list TYPE to_list.
  DATA o_comp TYPE to_component.
  DATA o_subcomps TYPE to_list.
  TRY.
      _complist-&gt;init_iter( ).
      _complist-&gt;display_progress = abap_false.
      o_comp = _complist-&gt;get_next( ).
      WHILE o_comp IS BOUND.
        o_list = _complist-&gt;clone( ).
        o_list-&gt;remove( o_comp ).
        o_subcomps = o_comp-&gt;get_subcomponents( ).
        IF o_subcomps IS NOT BOUND.
          CREATE OBJECT o_subcomps.
        else.
          o_subcomps = o_subcomps-&gt;clone( ).    &quot; Issue 49 : DO not use list itself because generate nested loop
        ENDIF.
        o_subcomps-&gt;add( o_comp ).
        IF o_list-&gt;is_included( o_subcomps ) = abap_true.
          _remove_component( o_comp ).
        ENDIF.
        o_comp = _complist-&gt;get_next( ).
      ENDWHILE.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD create_new.
  DATA _desc TYPE REF TO cl_abap_objectdescr.
  DATA _pos TYPE i.
  DATA _str  TYPE string.
  CHECK NOT data-name IS INITIAL.
  CREATE OBJECT result
    EXPORTING
      o_file = o_file.
  result-&gt;data-public = data.
  result-&gt;data-version = version.
  _desc ?= cl_abap_objectdescr=&gt;describe_by_object_ref( result ).
  _str = _desc-&gt;absolute_name.
  FIND ALL OCCURRENCES OF &apos;=&apos; IN _str MATCH OFFSET _pos.
  IF NOT _pos IS INITIAL.
    ADD 1 TO _pos.
    IF STRLEN( _str ) &gt; _pos.
      _str = _str+_pos.
    ENDIF.
  ENDIF.
  result-&gt;data-class = _str.
  result-&gt;_update_header( ).
ENDMETHOD.
METHOD remove_components.
  DATA o_comp    TYPE zaplink_list=&gt;to_component.
  CHECK object_list IS BOUND.
  TRY.
      object_list-&gt;order_kind = zaplink_list=&gt;order_kinds-no_order.
      object_list-&gt;init_sel_iter( ).
      object_list-&gt;display_progress = abap_true.
      o_comp = object_list-&gt;get_next( ).
      WHILE o_comp IS BOUND.
        TRY.
            _remove_component( o_comp ).
          CATCH zaplink_cx_connector.
        ENDTRY.
        o_comp = object_list-&gt;get_next( ).
      ENDWHILE.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method SAVE_TO_FILE.
  DATA _streamfactory TYPE REF TO if_ixml_stream_factory.
  DATA _outputstream TYPE REF TO if_ixml_ostream.
  DATA _renderer TYPE REF TO if_ixml_renderer.
  DATA _tempstring TYPE string.
  DATA _printxmldoc TYPE REF TO cl_xml_document.
  DATA _rc      TYPE sysubrc.
  DATA _file    TYPE to_file.
  IF NOT xmldata IS BOUND.
    EXIT.
  ENDIF.
  _streamfactory = xmlengine-&gt;create_stream_factory( ).
  _outputstream = _streamfactory-&gt;create_ostream_cstring( _tempstring ).
  _update_header( ).
  _renderer = xmlengine-&gt;create_renderer( document = xmldata
                                           ostream = _outputstream ).
  _renderer-&gt;set_normalizing( ).
  _rc = _renderer-&gt;render( ).
  CREATE OBJECT _printxmldoc.
  _rc = _printxmldoc-&gt;parse_string( _tempstring ).
  WHILE _tempstring(1) &lt;&gt; &apos;&lt;&apos;.
    SHIFT _tempstring LEFT BY 1 PLACES.
  ENDWHILE.
  IF o_file IS BOUND.
    _file = o_file.
  ELSE.
    _file = file.
  ENDIF.
  TRY.
      _file-&gt;set_filecontent( _tempstring ).
      _file-&gt;save( ).
    CATCH zaplink_cx_file.
      RETURN.
  ENDTRY.
  file = _file.
endmethod.
METHOD _add_component.
  DATA o_connector TYPE zaplink_component=&gt;to_connector.
  DATA root      TYPE REF TO if_ixml_element.
  DATA _base     TYPE REF TO if_ixml_node.
  DATA rval      TYPE i.
  DATA _comp     TYPE zaplink_component=&gt;ts_component.
  DATA object    TYPE to_xml.
  DATA _index    LIKE LINE OF _nodeindex.
  DATA o_cx_cnx  TYPE REF TO zaplink_cx_connector.
  DATA o_cx_comp TYPE REF TO zaplink_cx_component.
  DATA o_cx_list TYPE REF TO zaplink_cx_list.
  CHECK component IS BOUND.
  TRY.
      _comp = component-&gt;get_key( ).
      o_connector = component-&gt;connector( ).
    CATCH zaplink_cx_component INTO o_cx_comp.
      TRY.
          component-&gt;set_exception( o_cx_comp ).
        CATCH zaplink_cx INTO o_cx.
          mac_cascade_raise o_mycx o_cx.
      ENDTRY.
      RAISE EXCEPTION TYPE zaplink_cx_container
                 EXPORTING textid = zaplink_cx_container=&gt;add_comp_failed
                             type = _comp-type
                             name = _comp-name.
  ENDTRY.
  CHECK o_connector IS BOUND.
  TRY.
      o_connector-&gt;options = _options.
      object = o_connector-&gt;export_from_sap( component ).
      component-&gt;set_msg_coll( o_connector-&gt;application_log ).
    CATCH zaplink_cx_connector INTO o_cx_cnx.
      TRY.
          component-&gt;set_exception( o_cx_cnx ).
          component-&gt;set_msg_coll( o_connector-&gt;application_log ).
        CATCH zaplink_cx INTO o_cx.
          mac_cascade_raise o_mycx o_cx.
      ENDTRY.
      RAISE EXCEPTION TYPE zaplink_cx_container
                 EXPORTING textid = zaplink_cx_container=&gt;add_comp_failed
                          prev_cx = o_cx_cnx
                             type = _comp-type
                             name = _comp-name.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  IF NOT object IS BOUND.
    RAISE EXCEPTION TYPE zaplink_cx_container
               EXPORTING textid = zaplink_cx_container=&gt;add_comp_failed
                           type = _comp-type
                           name = _comp-name.
  ENDIF.
  TRY.
      root = object-&gt;get_root_element( ).
      _base = get_root( ). &quot; xmldata
      CHECK root IS BOUND.
      _remove_component( component ).
      rval = _base-&gt;append_child( root ).
      IF rval &lt;&gt; 0.
        EXIT.
      ENDIF.
      TRY.
          _complist-&gt;add( component ).
        CATCH zaplink_cx_list INTO o_cx_list.
          TRY.
              component-&gt;set_exception( o_cx_list ).
            CATCH zaplink_cx INTO o_cx.
              mac_cascade_raise o_mycx o_cx.
          ENDTRY.
          RAISE EXCEPTION TYPE zaplink_cx_container
                     EXPORTING textid = zaplink_cx_container=&gt;add_comp_failed
                                 type = _comp-type
                                 name = _comp-name.
      ENDTRY.
      _index-key = component.
      _index-node = root.
      MODIFY TABLE _nodeindex FROM _index.
      IF sy-subrc &lt;&gt; 0.
        INSERT _index INTO TABLE _nodeindex.
      ENDIF.
    CATCH zaplink_cx_container INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD _remove_component.
  DATA node   TYPE REF TO if_ixml_node.
  DATA o_comp TYPE to_component.
  TRY.
      node = _find_component_node( component ).
      WHILE node IS BOUND.
        node-&gt;remove_node( ).
        IF sy-subrc = 0.
          DELETE _nodeindex WHERE node = node.
          o_comp = _complist-&gt;search( component ).
          IF o_comp IS BOUND.
            DELETE _nodeindex WHERE key = o_comp.
          ELSE. &quot; for security
            DELETE _nodeindex WHERE key = component.
          ENDIF.
          _complist-&gt;remove( component ).
        ENDIF.
        node = _find_component_node( component ).
      ENDWHILE.
    CATCH zaplink_cx_container INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD _update_header.
  DATA _root TYPE REF TO if_ixml_element.
  DATA _ezxml TYPE REF TO zaplink_easyxml.
  _root = xmldata-&gt;get_root_element( ).
  IF NOT _root IS BOUND.
    _root = xmldata-&gt;create_element( name = tn_container_root ).
    xmldata-&gt;if_ixml_node~append_child( _root ).
  ENDIF.
  CREATE OBJECT _ezxml.
  _ezxml-&gt;add_any( EXPORTING xml_node = _root
                                  any = data
                               xmldoc = xmldata ).
ENDMETHOD.
endclass. &quot;ZAPLINK_CONTAINER implementation
class ZAPLINK_DOCUMENTATION implementation.
DEFINE lmac_add_mf_and_raise.
  o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &amp;1
                                              subrc = &amp;2
                                          classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
  log-&gt;add_symsg( ).
  log-&gt;add_exception( o_mycx ).
  raise exception o_mycx.
END-OF-DEFINITION.
METHOD class_constructor.
  mac_create_log log ballog_subobject space.
ENDMETHOD.
METHOD docu_get.
  DATA _text  TYPE tt_rawtext.
  TRY.
    head-id = docu-id.
    head-object = docu-object.
    head-masterlang = docu-masterlang.
    head-langu = docu-langu.
    head-typ = docu-typ.
    head-selfdef = docu-selfdef.
    IF docu-selfdef = space.
      CALL FUNCTION &apos;DOCU_GET&apos;
        EXPORTING
          id                           = docu-id
          langu                        = docu-langu
          object                       = docu-object
          typ                          = docu-typ
          version                      = docu-version
          version_active_or_last       = &apos;A&apos;
        IMPORTING
          dokstate                     = lang-state
          head                         = lang-head
        TABLES
          line                         = _text
        EXCEPTIONS
          no_docu_on_screen            = 1
          no_docu_self_def             = 2
          no_docu_temp                 = 3
          ret_code                     = 4
          OTHERS                       = 5.
      IF sy-subrc &lt;&gt; 0.
        lmac_add_mf_and_raise &apos;DOCU_GET&apos; sy-subrc.
      ENDIF.
      lang-_ = raw2string( _text ).
      head-application = lang-tdobject.
      head-dokform = lang-tdform.
      head-dokstyle = lang-tdstyle.
      CLEAR:
        lang-tdobject,
        lang-tdname,
        lang-tdid,
        lang-tdform,
        lang-tdstyle.
    ENDIF.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD get.
  DATA _obj   TYPE RANGE OF doku_obj.
  DATA my_obj LIKE LINE OF _obj.
  DATA docs   TYPE STANDARD TABLE OF dokil WITH DEFAULT KEY.
  DATA doc    LIKE LINE OF t_docs.
  DATA _lang  LIKE LINE OF doc-texts.
  FIELD-SYMBOLS:
    &lt;d&gt; LIKE LINE OF docs.
  IF ids IS INITIAL.
    EXIT.
  ENDIF.
  my_obj-sign = &apos;I&apos;. my_obj-option = &apos;CP&apos;.
  my_obj-low = object. APPEND my_obj TO _obj.
  SELECT * INTO TABLE docs
    FROM dokil
    WHERE id IN ids
      AND object IN _obj.
  IF docs IS INITIAL.
    EXIT.
  ENDIF.
  reset( ).
  SORT docs BY id object masterlang DESCENDING langu.
  LOOP AT docs ASSIGNING &lt;d&gt;.
    AT NEW object. &quot; ID + OBJECT
      CLEAR doc.
      CALL METHOD docu_get
        EXPORTING
          docu = &lt;d&gt;
        IMPORTING
          head = doc-hdr
          lang = _lang.
    ENDAT.
    IF _lang IS INITIAL.
      CALL METHOD docu_get
        EXPORTING
          docu   = &lt;d&gt;
        IMPORTING
          lang   = _lang.
    ENDIF.
    IF NOT _lang IS INITIAL.
      CLEAR: _lang-tdversion, _lang-tdfuser, _lang-tdfdate, _lang-tdftime, _lang-tdluser, _lang-tdldate, _lang-tdltime.   &quot; Issue 68 : Remove useless data
      INSERT _lang INTO TABLE doc-texts.
      CLEAR _lang.
    ENDIF.
    AT END OF object. &quot; ID + OBJECT
      APPEND doc TO t_docs.
    ENDAT.
  ENDLOOP.
ENDMETHOD.
method RAW2STRING.
FIELD-SYMBOLS &lt;l&gt; LIKE LINE OF raw.
  DATA str TYPE string.
  LOOP AT raw ASSIGNING &lt;l&gt;.
    str = &lt;l&gt;.
    IF string IS INITIAL.
      string = str.
    ELSE.
      CONCATENATE string line_separator str INTO string.
    ENDIF.
  ENDLOOP.
endmethod.
METHOD reset.
  DATA object TYPE balobj_d.
  DATA subobject  TYPE balsubobj.
  DATA ext_id TYPE balnrext.
  IF NOT log IS BOUND.    EXIT.   ENDIF.
  object = zaplink_connector=&gt;ballog_object.
  subobject = &apos;DOCT&apos;.
  CALL METHOD log-&gt;init
    EXPORTING
      id_object      = object
      id_subobject   = subobject
      id_extnumber   = ext_id
      auto_upd_custo = abap_true
      id_activity    = zaplink_message_collector=&gt;actions-create
    EXCEPTIONS
      error          = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
  ENDIF.
ENDMETHOD.
METHOD set.
  DATA _text  TYPE tt_rawtext.
  DATA _dokil TYPE dokil.
  DATA _head  TYPE thead.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_docs,
    &lt;t&gt; LIKE LINE OF &lt;o&gt;-texts.
  IF t_docs IS INITIAL.
    EXIT. &quot;nothing to do
  ENDIF.
  LOOP AT t_docs ASSIGNING &lt;o&gt;.
    _dokil-id = &lt;o&gt;-id.
    _dokil-object = &lt;o&gt;-object.
    _dokil-selfdef = &lt;o&gt;-selfdef.
    CALL FUNCTION &apos;DOCU_SELFDEF_WRITE&apos;
      EXPORTING
        object_id   = _dokil-id
        object_name = _dokil-object
        selfdef     = _dokil-selfdef
      EXCEPTIONS
        not_deleted = 1
        OTHERS      = 2.
    IF sy-subrc &lt;&gt; 0.
      lmac_add_mf_and_raise &apos;DOCU_SELFDEF_WRITE&apos; sy-subrc.
    ENDIF.
    LOOP AT &lt;o&gt;-texts ASSIGNING &lt;t&gt;.
      _text = string2raw( &lt;t&gt;-_  ).
      _head = &lt;t&gt;-head.
      _head-tdobject = &lt;o&gt;-application.
      _head-tdname = &lt;o&gt;-object.
      _head-tdid = &lt;o&gt;-id.
      _head-tdform = &lt;o&gt;-dokform.
      _head-tdstyle = &lt;o&gt;-dokstyle.
      IF &lt;o&gt;-selfdef IS INITIAL.
        CALL FUNCTION &apos;DOCU_UPDATE&apos;
          EXPORTING
            head                = _head
            state               = &lt;t&gt;-state
            typ                 = &lt;o&gt;-typ
            version             = 0
          TABLES
            line                = _text.
      ENDIF.
    ENDLOOP.
  ENDLOOP.
ENDMETHOD.
method STRING2RAW.
SPLIT string AT LINE_SEPARATOR
        INTO TABLE raw.
endmethod.
METHOD GET_AS_XML_OFF.
ENDMETHOD.
method SET_AS_XML_OFF.
endmethod.
METHOD zaplink_connector~create_new_raw.
  DATA o_doc TYPE to_doc.
  CREATE OBJECT object.
  CASE type.
    WHEN supportedtypes-general or supportedtypes-indep.
      CREATE OBJECT o_doc.
      object-&gt;raw = o_doc.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_PROGRAM&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA pool     TYPE rs38l-area.
  DATA type     TYPE td_comptype.
  DATA s_mask   TYPE ts_name_mask.
  DATA d_ori_modified TYPE c.
  DATA d_doc_type TYPE doku_typ.
  DATA s_dokil  TYPE dokil.
  DATA s_head   TYPE thead.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN supportedtypes-general OR supportedtypes-indep.
          CASE type.
            WHEN supportedtypes-general. s_mask-id = &apos;TX&apos;.    s_mask-object = component-&gt;get_name( ).     &quot; Issue 60
            WHEN supportedtypes-indep.   s_mask = component-&gt;get_name( ).
          ENDCASE.
          CALL FUNCTION &apos;EXT_MODIFY_ORIGINAL_CHECK&apos;
            EXPORTING
              p_id                = s_mask-id
              p_object            = s_mask-object
            IMPORTING
              p_original_modified = d_ori_modified
            EXCEPTIONS
              OTHERS              = 1.
          IF d_ori_modified = abap_true.&quot;Modi. vorh.
            d_doc_type = &apos;M&apos;.
          ELSEIF s_mask-id = &apos;FU&apos; OR s_mask-id = &apos;FX&apos;.
            d_doc_type = &apos;T&apos;.
          ELSE.
            d_doc_type = &apos;E&apos;.
          ENDIF.
          SELECT SINGLE * INTO s_dokil
            FROM dokil
            WHERE id = s_mask-id
              AND object = s_mask-object
              AND typ = d_doc_type
              AND masterlang = abap_true.
          IF sy-subrc &lt;&gt; 0.
            SELECT SINGLE * INTO s_dokil
              FROM dokil
              WHERE id = s_mask-id
                AND object = s_mask-object
                AND typ = d_doc_type.
          ENDIF.
          s_head-tdid     = s_mask-id.
          s_head-tdname   = s_mask-object.
          s_head-tdspras  = s_dokil-langu.
          CALL FUNCTION &apos;ENQUEUE_ESDOC&apos;
            EXPORTING
              id     = s_dokil-id
              object = s_dokil-object
              langu  = s_dokil-langu
              typ    = s_dokil-typ
            EXCEPTIONS
              foreign_lock         = 1
              system_failure       = 2
              OTHERS               = 3.
          IF sy-subrc &lt;&gt; 0.
            mac_add_mf_and_raise &apos;ENQUEUE_ESDOC&apos; sy-subrc.
          ENDIF.
          CALL FUNCTION &apos;DOCU_DELETE&apos;
            EXPORTING
              head                  = s_head
              typ                   = d_doc_type
              version               = s_dokil-version.
          IF sy-subrc &lt;&gt; 0.
            mac_add_mf_and_raise &apos;DOCU_DELETE&apos; sy-subrc.
          ENDIF.
          CALL FUNCTION &apos;DEQUEUE_ESDOC&apos;
           EXPORTING
              id     = s_dokil-id
              object = s_dokil-object
              langu  = s_dokil-langu
              typ    = s_dokil-typ.
          SELECT SINGLE * INTO s_dokil
            FROM dokil
            WHERE id = s_mask-id
              AND object = s_mask-object
              AND typ = d_doc_type.
          IF sy-subrc &lt;&gt; 0.   result = abap_true.   ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA type     TYPE td_comptype.
  DATA s_mask   TYPE ts_name_mask.
  DATA d_name   TYPE td_compname.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN supportedtypes-general OR supportedtypes-indep..
          d_name = component-&gt;get_name( ).
          s_mask = name_2_mask( type = type    name = d_name ).
          SELECT SINGLE id INTO s_mask-id
            FROM dokil
            WHERE     id = s_mask-id
              AND object = s_mask-object.
          IF sy-subrc = 0.    exists = me-&gt;exists-exists.   ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.    result = abap_true.   endif.
endmethod.
METHOD zaplink_connector~read_from_sap.
  DATA o_data   TYPE to_doc.
  DATA d_name   TYPE td_compname.
  DATA type     TYPE td_comptype.
  DATA s_mask   TYPE ts_name_mask.
  DATA s_doc    TYPE ts_doc.
  TRY.
    type = component-&gt;get_type( ).
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    CASE type.
      WHEN supportedtypes-general OR supportedtypes-indep.
        d_name = component-&gt;get_name( ).
        s_mask = name_2_mask( type = type    name = d_name ).
        s_doc = get_single( ids = s_mask-id
                         object = s_mask-object ).
        CREATE OBJECT o_data.
        o_data-&gt;from_data( s_doc ).
        CLEAR: o_data-&gt;a0_maindata-id, o_data-&gt;a0_maindata-object.
        object-&gt;raw = o_data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_DOCUMENTATION&apos; type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA o_data   TYPE to_doc.
  DATA o_comp   TYPE to_component.
  DATA s_mask   TYPE ts_name_mask.
  DATA s_doc    TYPE ts_doc.
  TRY.
      CASE object-&gt;type.
        WHEN supportedtypes-general OR supportedtypes-indep.
          o_data ?= object-&gt;raw.
          CASE object-&gt;type.
            WHEN supportedtypes-general. s_mask-id = &apos;TX&apos;.    s_mask-object = object-&gt;name.
            WHEN supportedtypes-indep.   s_mask = object-&gt;name.
          ENDCASE.
          o_data-&gt;a0_maindata-id = s_mask-id.   o_data-&gt;a0_maindata-object = s_mask-object.
          s_doc = o_data-&gt;to_data( ).
          set_single( s_doc ).
          CREATE OBJECT o_comp.
          o_comp-&gt;set_type( object-&gt;type ).   o_comp-&gt;set_name( object-&gt;name ).
          CREATE OBJECT components.
          components-&gt;add( o_comp ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      ROLLBACK WORK.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      ROLLBACK WORK.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_single.
  DATA r_ids  TYPE tr_docid.
  DATA my_id  LIKE LINE OF r_ids.
  DATA t_docs TYPE tt_docs.
  my_id-sign = &apos;I&apos;. my_id-option = &apos;EQ&apos;.    my_id-low = ids. APPEND my_id TO r_ids.
  t_docs = get( ids = r_ids
             object = object ).
  IF NOT t_docs IS INITIAL.   READ TABLE t_docs INTO result INDEX 1.    ENDIF.
ENDMETHOD.
method CONSTRUCTOR.
  DATA type LIKE LINE OF supported_types.
  super-&gt;constructor( ).
  mac_create_log application_log ballog_subobject space.
  type-type = supportedtypes-general. INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-indep.   INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
METHOD SET_SINGLE.
  DATA t_docs TYPE tt_docs.
  append data to t_docs.
  set( t_docs ).
ENDMETHOD.
METHOD name_2_mask.
  CASE type.
    WHEN supportedtypes-general. result-id = &apos;TX&apos;.    result-object = name.
    WHEN supportedtypes-indep.   result = name.
  ENDCASE.
ENDMETHOD.
endclass. &quot;ZAPLINK_DOCUMENTATION implementation
class ZAPLINK_EASYXML_4CNX implementation.
METHOD read_object.
  DATA o_raw_base TYPE to_raw_base.
  DATA data_type  TYPE string.
  DATA o_conn     TYPE to_connector.
  DATA _cx        TYPE REF TO cx_root.
  DATA o_cx_cnx   TYPE REF TO zaplink_cx_connector.
  CHECK object IS BOUND OR typedesc IS BOUND.
  IF NOT object IS BOUND.
    data_type = typedesc-&gt;get_relative_name( ).
    TRY.
        CREATE OBJECT object TYPE (data_type).
      CATCH cx_root INTO _cx.
        CALL METHOD application_log-&gt;add_exception
          EXPORTING
            exception = _cx.
        EXIT.
    ENDTRY.
  ENDIF.
  TRY.
      o_raw_base ?= object.
    CATCH cx_root.
  ENDTRY.
  IF o_raw_base IS BOUND.   &quot; object inherited from o_raw_base
    TRY.
        CLEAR o_raw_base.   o_raw_base = zaplink_connectors=&gt;node_2_raw( xml_node ).
        o_conn = zaplink_connectors=&gt;create_connector( connuuid = o_raw_base-&gt;connector ).
        object = o_conn-&gt;create_new_raw( type = o_raw_base-&gt;type ).
      CATCH zaplink_cx_connector INTO o_cx_cnx.
        CALL METHOD application_log-&gt;add_exception
          EXPORTING
            exception = _cx.
        EXIT.
    ENDTRY.
  ENDIF.
  CALL METHOD super-&gt;read_object
    EXPORTING
      xml_node = xml_node
      typedesc = typedesc
    CHANGING
      object   = object.
ENDMETHOD.
endclass. &quot;ZAPLINK_EASYXML_4CNX implementation
class ZAPLINK_FUNCTION_GROUP implementation.
METHOD constructor.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_function_group. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
ENDMETHOD.
METHOD ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE.
ENDMETHOD.
method ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE.
endmethod.
METHOD zaplink_connector~create_new_raw.
  DATA o_group TYPE to_group.
  CREATE OBJECT object.
  CASE type.
    WHEN st_function_group.
      CREATE OBJECT o_group.
      object-&gt;raw = o_group.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_PROGRAM&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA pool  TYPE rs38l-area.
  DATA type  TYPE td_comptype.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_function_group.
          pool = component-&gt;get_name( ).
          CALL FUNCTION &apos;FUNCTION_POOL_DELETE&apos;
            EXPORTING
              pool              = pool
              skip_progress_ind = &apos;X&apos;
            EXCEPTIONS
              functions_exists  = 1
              not_found         = 0
              OTHERS            = 3.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;FUNCTION_POOL_DELETE&apos;
                                                        subrc = sy-subrc
                                                    classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                    textid = zaplink_cx=&gt;system_error ).
            RAISE EXCEPTION o_mycx.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA _name TYPE td_functiongroup_name.
  DATA type  TYPE td_comptype.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_function_group.
          _name = component-&gt;get_name( ).
          CALL FUNCTION &apos;RS_FUNCTION_POOL_EXISTS&apos;
            EXPORTING
              function_pool   = _name
            EXCEPTIONS
              pool_not_exists = 1
              OTHERS          = 2.
          IF sy-subrc = 0.    exists = me-&gt;exists-exists.   ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.
    result = abap_true.
  endif.
endmethod.
METHOD zaplink_connector~read_from_sap.
  DATA o_data     TYPE to_group.
  DATA s_fm_data  TYPE ts_fm_data.
  DATA d_name TYPE td_compname.
  DATA type   TYPE td_comptype.
  DATA d_mainprog TYPE td_progname.
  DATA d_soft_comp TYPE tdevc-dlvunit.
  DATA t_functions TYPE tt_rs38l_incl.
  DATA s_func LIKE LINE OF s_fm_data-functions.
  DATA t_doc TYPE STANDARD TABLE OF rsfdo WITH DEFAULT KEY.
  DATA t_src TYPE STANDARD TABLE OF rssource WITH DEFAULT KEY.
  DATA t_tmp_doc TYPE tt_docs.
  DATA d_doc TYPE doku_obj.
  DATA s_doc_param TYPE zaplink_fugr_data=&gt;ts_doc_param.
  FIELD-SYMBOLS:
    &lt;f&gt; LIKE LINE OF t_functions.
  TRY.
    type = component-&gt;get_type( ).
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    CASE type.
      WHEN st_function_group.
        s_fm_data-header-area = d_name = object-&gt;name.
        CALL FUNCTION &apos;RS_FUNCTION_POOL_CONTENTS&apos;
          EXPORTING
            function_pool           = s_fm_data-header-area
          TABLES
            functab                 = t_functions
          EXCEPTIONS
            function_pool_not_found = 1
            OTHERS                  = 2.
        IF sy-subrc &lt;&gt; 0.
          mac_add_mf_and_raise &apos;RS_FUNCTION_POOL_CONTENTS&apos; sy-subrc.
        ENDIF.
        d_doc = d_mainprog = get_mainprogram( s_fm_data-header-area ).
        s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_fugr_data=&gt;r_doc_ids-group
                                                  object = d_doc  ).
        SELECT * INTO TABLE s_fm_data-texts FROM tlibt WHERE area = s_fm_data-header-area.
        SELECT * INTO TABLE s_fm_data-function_texts FROM tftit FOR ALL ENTRIES IN t_functions WHERE funcname = t_functions-funcname.
        SELECT * INTO TABLE s_fm_data-param_texts FROM funct FOR ALL ENTRIES IN t_functions WHERE funcname = t_functions-funcname.
        LOOP AT t_functions ASSIGNING &lt;f&gt;.
          CLEAR s_func.   s_doc_param-func = s_func-header-name = &lt;f&gt;-funcname.   s_func-source = get_prog_rawsource( &lt;f&gt;-include ).
          s_doc_param-param = &apos;*&apos;.    d_doc = s_doc_param.
          t_tmp_doc = zaplink_documentation=&gt;get( ids = zaplink_fugr_data=&gt;r_doc_ids-function
                                               object =  d_doc ).
          APPEND LINES OF t_tmp_doc TO s_fm_data-docs.
          CALL FUNCTION &apos;RPY_FUNCTIONMODULE_READ&apos;
            EXPORTING
              functionname             = s_func-header-name
            IMPORTING
              global_flag              = s_func-header-global
              remote_call              = s_func-header-remote
              update_task              = s_func-header-utask
            TABLES
              import_parameter         = s_func-import_p
              changing_parameter       = s_func-changing_p
              export_parameter         = s_func-export_p
              tables_parameter         = s_func-tables
              exception_list           = s_func-exceptions
              documentation            = t_doc
              SOURCE                   = t_src
            EXCEPTIONS
              error_message            = 1
              function_not_found       = 2
              invalid_name             = 3
              OTHERS                   = 4.
          IF sy-subrc &lt;&gt; 0.
          ENDIF.
          INSERT s_func INTO TABLE s_fm_data-functions.
        ENDLOOP.
        SELECT SINGLE dlvunit INTO d_soft_comp
          FROM v_tralan
          WHERE pgmid = &apos;R3TR&apos;
            AND object = &apos;FUGR&apos;
            AND obj_name = s_fm_data-header-area.
        s_fm_data-includes = get_all_includes( s_fm_data-header-area ).
        s_fm_data-textspool = get_prog_textpool( d_mainprog ).
        s_fm_data-dynpros = get_dynpros( d_mainprog ).
        s_fm_data-menupainter = get_menus( d_mainprog ).
        CREATE OBJECT o_data.
        o_data-&gt;from_data( s_fm_data ).
        o_data-&gt;_code_signature = get_group_signature( o_data-&gt;a0_maindata-area ).
        CLEAR o_data-&gt;a0_maindata-area.
        object-&gt;raw = o_data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_FUNCTION_GROUP&apos; type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA o_data      TYPE to_group.
  DATA s_fm_data   TYPE ts_fm_data.
  DATA _comp       TYPE to_component.
  DATA d_pname     TYPE tfdir-pname.
  DATA d_group     TYPE rs38l-area.
  DATA _name       TYPE td_compname.
  DATA d_mainprog  TYPE td_progname.
  DATA t_functions TYPE tt_rs38l_incl.
  DATA d_msg       TYPE string.
  DATA d_answer    TYPE c.
  DATA t_doc       TYPE STANDARD TABLE OF rsfdo WITH DEFAULT KEY.
  DATA t_src       TYPE STANDARD TABLE OF rssource WITH DEFAULT KEY.
  DATA t_params    TYPE STANDARD TABLE OF spar WITH DEFAULT KEY.
  DATA s_param     LIKE LINE OF t_params.
  FIELD-SYMBOLS:
    &lt;fi&gt; LIKE LINE OF t_functions,
    &lt;f&gt;  LIKE LINE OF s_fm_data-functions.
  TRY.
      CASE object-&gt;type.
        WHEN st_function_group.
          o_data ?= object-&gt;raw.
          o_data-&gt;a0_maindata-area = object-&gt;name.
          s_fm_data = o_data-&gt;to_data( ).
          d_mainprog = get_mainprogram( s_fm_data-header-area ).
          CALL FUNCTION &apos;RS_FUNCTION_POOL_DELETE&apos;
            EXPORTING
              area                         = s_fm_data-header-area
              suppress_popups              = abap_true
              skip_progress_ind            = abap_true
            EXCEPTIONS
              canceled_in_corr             = 1
              enqueue_system_failure       = 2
              function_exist               = 3
              not_executed                 = 4
              no_modify_permission         = 5
              no_show_permission           = 6
              permission_failure           = 7
              pool_not_exist               = 0
              cancelled                    = 9
              OTHERS                       = 10.
          IF sy-subrc &lt;&gt; 0.
            mac_add_mf_and_raise &apos;RS_FUNCTION_POOL_DELETE&apos; sy-subrc.
          ENDIF.
          IF sy-batch = abap_false.   &quot;only delete in forground
            LOOP AT s_fm_data-functions ASSIGNING &lt;f&gt;.
              SELECT SINGLE pname INTO d_pname FROM tfdir WHERE funcname = &lt;f&gt;-header-name.
              IF sy-subrc &lt;&gt; 0.   CONTINUE.   ENDIF.
              CALL FUNCTION &apos;FUNCTION_INCLUDE_SPLIT&apos;
                EXPORTING
                  program                            = d_pname
                IMPORTING
                  group                              = d_group
                EXCEPTIONS
                  include_not_exists                 = 1
                  group_not_exists                   = 2
                  no_selections                      = 3
                  no_function_include                = 4
                  no_function_pool                   = 5
                  delimiter_wrong_position           = 6
                  no_customer_function_group         = 7
                  no_customer_function_include       = 8
                  reserved_name_customer             = 9
                  namespace_too_long                 = 10
                  area_length_error                  = 11
                  OTHERS                             = 12.
              IF sy-subrc &lt;&gt; 0.
                CONTINUE.
              ENDIF.
              MESSAGE i000 WITH d_pname d_group INTO d_msg.
              REFRESH t_params.
              s_param-param = &apos;FUNCTION&apos;.   s_param-value = &lt;f&gt;-header-name.          APPEND s_param TO t_params.
              s_param-param = &apos;GROUP&apos;.      s_param-value = d_group.                  APPEND s_param TO t_params.
              s_param-param = &apos;CURRENT_G&apos;.  s_param-value = s_fm_data-header-area.    APPEND s_param TO t_params.
              CALL FUNCTION &apos;POPUP_TO_CONFIRM&apos;
                EXPORTING
                  titlebar              = &apos;Confirm module function deletion&apos;(d00)
                  diagnose_object       = &apos;ZAPLINK_FUNCTION_GROUP-CONF&apos;
                  text_question         = d_msg
                  text_button_1         = &apos;Yes&apos;(yes)
                  icon_button_1         = &apos;ICON_DELETE&apos;
                  text_button_2         = &apos;No&apos;(no_)
                  icon_button_2         = &apos;ICON_SKIP&apos;
                  default_button        = &apos;3&apos;
                  display_cancel_button = &apos;X&apos;
                  userdefined_f1_help   = &apos;ZAPLINK_FUNCTION_GROUP-CONFH&apos;
                  start_column          = 10
                  start_row             = 4
                  popup_type            = &apos;ICON_MESSAGE_WARNING&apos;
                  iv_quickinfo_button_1 = &apos;Function is deleted. Function group will be created with this function.&apos;(hye)
                  iv_quickinfo_button_2 = &apos;Function is not deleted and process to next existing function. Function group will be created without this function.&apos;(hno)
                IMPORTING
                  answer                = d_answer
                TABLES
                  parameter             = t_params
                EXCEPTIONS
                  text_not_found        = 1
                  OTHERS                = 2.
              IF sy-subrc &lt;&gt; 0.
                mac_add_mf_and_raise &apos;POPUP_TO_CONFIRM&apos; sy-subrc.
              ELSEIF d_answer = &apos;N&apos; OR d_answer = &apos;2&apos;.
                CONTINUE.
              ELSEIF d_answer = &apos;A&apos;.    &quot; abend
                ROLLBACK WORK.
                mac_add_mf_and_raise &apos;RS_FUNCTION_POOL_INSERT&apos; 1.
              ENDIF.
              CALL FUNCTION &apos;RS_FUNCTION_DELETE&apos;
                EXPORTING
                  funcname                 = &lt;f&gt;-header-name
                  suppress_popups          = abap_true
                EXCEPTIONS
                  cancelled                = 1
                  function_released        = 2
                  OTHERS                   = 3.
              IF sy-subrc &lt;&gt; 0.
                mac_add_mf_and_raise &apos;RS_FUNCTION_DELETE&apos; sy-subrc.
              ENDIF.
            ENDLOOP.
          ENDIF.
          CALL FUNCTION &apos;RS_FUNCTION_POOL_INSERT&apos;
            EXPORTING
              function_pool                 = s_fm_data-header-area
              short_text                    = space
            EXCEPTIONS
              name_already_exists           = 1
              name_not_correct              = 2
              function_already_exists       = 3
              invalid_function_pool         = 4
              invalid_name                  = 5
              too_many_functions            = 6
              no_modify_permission          = 7
              no_show_permission            = 8
              enqueue_system_failure        = 9
              canceled_in_corr              = 10
              undefined_error               = 11
              OTHERS                        = 12.
          IF sy-subrc &lt;&gt; 0.
            ROLLBACK WORK.
            mac_add_mf_and_raise &apos;RS_FUNCTION_POOL_INSERT&apos; sy-subrc.
          ENDIF.
          LOOP AT s_fm_data-functions ASSIGNING &lt;f&gt;.
            DELETE FROM tftit WHERE funcname = &lt;f&gt;-header-name.
            DELETE FROM funct WHERE funcname = &lt;f&gt;-header-name.
            CALL FUNCTION &apos;RPY_FUNCTIONMODULE_INSERT&apos;
              EXPORTING
                funcname                      = &lt;f&gt;-header-name
                function_pool                 = s_fm_data-header-area
                interface_global              = &lt;f&gt;-header-global
                remote_call                   = &lt;f&gt;-header-remote
                short_text                    = space
                suppress_corr_check           = abap_false
                update_task                   = &lt;f&gt;-header-utask
              TABLES
                import_parameter              = &lt;f&gt;-import_p
                export_parameter              = &lt;f&gt;-export_p
                tables_parameter              = &lt;f&gt;-tables
                changing_parameter            = &lt;f&gt;-changing_p
                exception_list                = &lt;f&gt;-exceptions
                parameter_docu                = t_doc
                SOURCE                        = t_src
              EXCEPTIONS
                double_task                   = 1
                error_message                 = 2
                function_already_exists       = 3
                invalid_function_pool         = 4
                invalid_name                  = 5
                too_many_functions            = 6
                no_modify_permission          = 7
                no_show_permission            = 8
                enqueue_system_failure        = 9
                canceled_in_corr              = 10
                OTHERS                        = 11.
            IF sy-subrc &lt;&gt; 0.
              ROLLBACK WORK.
              mac_add_mf_and_raise &apos;RPY_FUNCTIONMODULE_INSERT&apos; sy-subrc.
            ENDIF.
          ENDLOOP.
          CALL FUNCTION &apos;RS_FUNCTION_POOL_CONTENTS&apos;
            EXPORTING
              function_pool           = s_fm_data-header-area
            TABLES
              functab                 = t_functions
            EXCEPTIONS
              function_pool_not_found = 1
              OTHERS                  = 2.
          IF sy-subrc &lt;&gt; 0.
            ROLLBACK WORK.
            mac_add_mf_and_raise &apos;RS_FUNCTION_POOL_CONTENTS&apos; sy-subrc.
          ENDIF.
          LOOP AT s_fm_data-functions ASSIGNING &lt;f&gt;.
            READ TABLE t_functions ASSIGNING &lt;fi&gt;
                 WITH KEY funcname = &lt;f&gt;-header-name.
            IF sy-subrc &lt;&gt; 0.
              ROLLBACK WORK.
              mac_add_mf_and_raise &apos;RS_FUNCTIONMODULE_INSERT&apos; 12.
              CONTINUE.
            ENDIF.
            set_prog_rawsource( program = &lt;fi&gt;-include
                                    raw = &lt;f&gt;-source ).
          ENDLOOP.
          set_prog_textpool( program = d_mainprog
                            textpool = s_fm_data-textspool ).
          set_dynpros( program = d_mainprog
                       dynpros = s_fm_data-dynpros ).
          set_menus( program = d_mainprog
                       menus = s_fm_data-menupainter ).
          DELETE FROM tlibt WHERE area = s_fm_data-header-area.
          MODIFY tlibt FROM TABLE s_fm_data-texts.
          MODIFY tftit FROM TABLE s_fm_data-function_texts.
          MODIFY funct FROM TABLE s_fm_data-param_texts.
          CREATE OBJECT _comp.
          _comp-&gt;set_type( st_function_group ).
          _name = o_data-&gt;a0_maindata-area.
          _comp-&gt;set_name( _name ).
          CREATE OBJECT components.
          components-&gt;add( _comp ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      ROLLBACK WORK.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      ROLLBACK WORK.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_all_includes.
  DATA: _result           LIKE LINE OF results.
  DATA d_include          TYPE rs38l-include.
  DATA d_is_hidden        TYPE abap_bool.
  DATA d_is_extern        TYPE abap_bool.
  DATA d_not_funct        TYPE abap_bool.
  DATA d_suffix           TYPE rs38l-suffix.
  DATA: program           TYPE trdir-name.
  DATA: _fugr_name        TYPE rs38l-area.
  DATA: _is_reserved_name TYPE c.
  DATA: includes          TYPE STANDARD TABLE OF rseuinc.
  FIELD-SYMBOLS:
    &lt;wa&gt; LIKE LINE OF includes.
  program = get_mainprogram( name ).
  SELECT * FROM d010inc
           APPENDING CORRESPONDING FIELDS OF TABLE includes
           WHERE master = program.
  CALL FUNCTION &apos;RS_WORKING_AREA_ACTIVE_CHECK&apos;
    EXCEPTIONS
      nok = 1.
  IF sy-subrc = 0.
    SELECT * FROM rseuinc
             APPENDING CORRESPONDING FIELDS OF TABLE includes
             WHERE master = program.
  ENDIF.
  SORT includes BY include.
  DELETE ADJACENT DUPLICATES FROM includes COMPARING include.
  LOOP AT includes ASSIGNING &lt;wa&gt;.
    d_include = &lt;wa&gt;-include.
    CALL FUNCTION &apos;FUNCTION_INCLUDE_SPLIT&apos;
      IMPORTING
        group                              = _fugr_name
        no_function_include                = d_is_extern
        no_function_module                 = d_not_funct
        suffix                             = d_suffix
        reserved_name                      = _is_reserved_name
        hidden_name                        = d_is_hidden
      CHANGING
        include                            = d_include
      EXCEPTIONS
        include_not_exists                 = 1
        group_not_exists                   = 2
        no_selections                      = 3
        no_function_include                = 4
        no_function_pool                   = 5
        delimiter_wrong_position           = 6
        no_customer_function_group         = 7
        no_customer_function_include       = 8
        reserved_name_customer             = 9
        namespace_too_long                 = 10
        area_length_error                  = 11
        OTHERS                             = 12.
    IF sy-subrc = 0 AND _fugr_name = name AND d_is_extern = abap_false AND
      ( with_code = abap_true OR
              ( d_not_funct = abap_true AND d_is_hidden = abap_false AND
                        ( d_suffix = &apos;TOP&apos; OR _is_reserved_name = abap_false ) ) ) .
      _result-name = &lt;wa&gt;-include.
      _result-source = get_prog_rawsource( _result-name ).
      APPEND _result TO results.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD get_mainprogram.
  DATA s_rs38l TYPE rs38l.
  CALL FUNCTION &apos;FUNCTION_INCLUDE_SPLIT&apos;
    EXPORTING
      complete_area = name
    IMPORTING
      namespace     = s_rs38l-namespace
      group         = s_rs38l-str_area
    EXCEPTIONS
      OTHERS        = 6.
  CONCATENATE s_rs38l-namespace c_mainprog_prefix s_rs38l-str_area INTO result.
ENDMETHOD.
METHOD get_group_signature.
  DATA t_includes  TYPE tt_includes.
  DATA t_code      TYPE tt_abaprawsource.
  DATA d_src       TYPE string.
  DATA d_mainprog  TYPE td_progname.
  DATA t_functions TYPE tt_rs38l_incl.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF t_includes,
    &lt;f&gt; LIKE LINE OF t_functions.
  d_mainprog = get_mainprogram( group_name ).
  t_code = get_prog_rawsource( d_mainprog ).
  t_includes = get_all_includes( name = group_name
                            with_code = abap_true  ).
  LOOP AT t_includes ASSIGNING &lt;i&gt;.   APPEND LINES OF &lt;i&gt;-source TO t_code.   ENDLOOP.
  zaplink_tools=&gt;pretty_printer( CHANGING table = t_code ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = t_code ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).
ENDMETHOD.
METHOD zaplink_cnx_ext_code_signature~get_signature.
  DATA d_name TYPE td_functiongroup_name.
  DATA d_type  TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_function_group.
        d_name = component-&gt;get_name( ).
        result = get_group_signature( d_name ).
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_MESSAGE&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
endclass. &quot;ZAPLINK_FUNCTION_GROUP implementation
class ZAPLINK_MESSAGE implementation.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_id.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = C_MSG_ID. APPEND _id TO r_doc_id.
endmethod.
method CONSTRUCTOR.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_msgclass. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
METHOD zaplink_connector~create_new_raw.
  DATA o_data TYPE to_data.
  CREATE OBJECT object.
  CASE type.
    WHEN st_msgclass.
      CREATE OBJECT o_data.
      object-&gt;raw = o_data.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_MESSAGE&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA _name TYPE t100a-arbgb.
  data type  type td_comptype.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_msgclass.
          _name = component-&gt;get_name( ).
          CALL FUNCTION &apos;RS_DELETE_MESSAGE_ID&apos;
            EXPORTING
              nachrichtenklasse = _name
            EXCEPTIONS
              not_executed      = 1
              not_found         = 2
              no_permission     = 3
              OTHERS            = 4.
          IF sy-subrc &lt;&gt; 0. &quot; SAP NameSpace
            CASE sy-subrc.
              WHEN 2.
                RAISE EXCEPTION TYPE zaplink_cx_connector
                  EXPORTING textid = zaplink_cx_connector=&gt;not_found.
              WHEN OTHERS.
                RAISE EXCEPTION TYPE zaplink_cx_connector
                  EXPORTING textid = zaplink_cx_connector=&gt;system_error.
            ENDCASE.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA _name TYPE t100a-arbgb.
  DATA type  TYPE td_comptype.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_msgclass.
          _name = component-&gt;get_name( ).
          SELECT SINGLE arbgb INTO _name
            FROM t100a
            WHERE arbgb = _name.
          IF sy-subrc = 0.
            exists = me-&gt;exists-exists.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~read_from_sap.
  DATA _data  TYPE to_data.
  DATA _obj   TYPE doku_obj.
  DATA t_t100 TYPE SORTED TABLE OF t100 WITH UNIQUE KEY msgnr sprsl.
  DATA _name  TYPE arbgb.
  DATA t_docs TYPE zaplink_documentation=&gt;tt_docs.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_docs,
    &lt;lt&gt; LIKE LINE OF &lt;l&gt;-texts,
    &lt;t&gt; LIKE LINE OF t_t100,
    &lt;m&gt; LIKE LINE OF _data-&gt;messages,
    &lt;mt&gt; LIKE LINE OF &lt;m&gt;-texts.
  DATA _text LIKE LINE OF &lt;m&gt;-texts.
  DATA _htxt LIKE LINE OF _data-&gt;texts.
  DATA _key  TYPE doku_obj.
  DATA d_type TYPE td_comptype.
  TRY.
    CREATE OBJECT object.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_msgclass.
        _name = component-&gt;get_name( ).
        CONCATENATE _name &apos;+++&apos; INTO _obj.  &quot; +++ stand for message number
        t_docs = zaplink_documentation=&gt;get( ids = r_doc_id
                                          object = _obj ).
        DELETE t_docs WHERE texts IS INITIAL.
        CREATE OBJECT _data.
        SELECT SINGLE *
          INTO CORRESPONDING FIELDS OF _data-&gt;a0_maindata
          FROM t100a
          WHERE arbgb = _name.
        SELECT sprsl stext
          INTO TABLE _data-&gt;texts
          FROM t100t
          WHERE arbgb = _name.
        READ TABLE _data-&gt;texts TRANSPORTING NO FIELDS
             WITH TABLE KEY langu = _data-&gt;a0_maindata-masterlang.
        IF sy-subrc &lt;&gt; 0.
          _htxt-langu = _data-&gt;a0_maindata-masterlang.
          _htxt-short_txt = _data-&gt;a0_maindata-stext.
          INSERT _htxt INTO TABLE _data-&gt;texts.
        ENDIF.
        CLEAR _data-&gt;a0_maindata-stext.
        SELECT *
          INTO CORRESPONDING FIELDS OF TABLE _data-&gt;messages
          FROM t100u
          WHERE arbgb = _name.
        SELECT * INTO TABLE t_t100
          FROM t100
          WHERE arbgb = _name.
        LOOP AT _data-&gt;messages ASSIGNING &lt;m&gt;.
          LOOP AT t_t100 ASSIGNING &lt;t&gt;
                  WHERE msgnr = &lt;m&gt;-msgnr.
            CLEAR _text.
            _text-langu = &lt;t&gt;-sprsl.
            _text-short_txt = &lt;t&gt;-text.
            INSERT _text INTO TABLE &lt;m&gt;-texts.
          ENDLOOP.
          CONCATENATE _name &lt;m&gt;-msgnr INTO _key.
          LOOP AT t_docs ASSIGNING &lt;l&gt;
                  WHERE object = _key.
            IF &lt;m&gt;-application IS INITIAL.
              &lt;m&gt;-application = &lt;l&gt;-application.
            ELSEIF &lt;m&gt;-application &lt;&gt; &lt;l&gt;-application.
              RAISE EXCEPTION TYPE zaplink_cx_connector.
            ENDIF.
            IF &lt;m&gt;-typ IS INITIAL.
              &lt;m&gt;-typ = &lt;l&gt;-typ.
            ELSEIF &lt;m&gt;-typ &lt;&gt; &lt;l&gt;-typ.
              RAISE EXCEPTION TYPE zaplink_cx_connector.
            ENDIF.
            IF &lt;m&gt;-dokform IS INITIAL.
              &lt;m&gt;-dokform = &lt;l&gt;-dokform.
            ELSEIF &lt;m&gt;-dokform &lt;&gt; &lt;l&gt;-dokform.
              RAISE EXCEPTION TYPE zaplink_cx_connector.
            ENDIF.
            IF &lt;m&gt;-dokstyle IS INITIAL.
              &lt;m&gt;-dokstyle = &lt;l&gt;-dokstyle.
            ELSEIF &lt;m&gt;-dokstyle &lt;&gt; &lt;l&gt;-dokstyle.
              RAISE EXCEPTION TYPE zaplink_cx_connector.
            ENDIF.
            LOOP AT &lt;l&gt;-texts ASSIGNING &lt;lt&gt;.
              READ TABLE &lt;m&gt;-texts ASSIGNING &lt;mt&gt;
                   WITH TABLE KEY langu = &lt;lt&gt;-tdspras.
              IF sy-subrc = 0.
                &lt;mt&gt;-long_txt = &lt;lt&gt;.
                CLEAR &lt;mt&gt;-long_txt-tdspras.
              ELSE.
                CLEAR _text.
                _text-long_txt = &lt;lt&gt;.
                CLEAR _text-long_txt-tdspras.
                INSERT _text INTO TABLE &lt;m&gt;-texts.
              ENDIF.
            ENDLOOP.
          ENDLOOP.
        ENDLOOP.
        object-&gt;set_component( component ).
        CLEAR _data-&gt;a0_maindata-arbgb.
        object-&gt;raw = _data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_MESSAGE&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA _data TYPE to_data.
  DATA _comp TYPE to_component.
  DATA _name TYPE td_compname.
  DATA t_docs TYPE zaplink_documentation=&gt;tt_docs.
  DATA ls_doc LIKE LINE OF t_docs.
  DATA: lt_t100  TYPE STANDARD TABLE OF t100,
        ls_t100  LIKE LINE OF lt_t100,
        lt_t100t TYPE STANDARD TABLE OF t100t,
        ls_t100t LIKE LINE OF lt_t100t,
        lt_t100u TYPE STANDARD TABLE OF t100u,
        ls_t100u LIKE LINE OF lt_t100u,
        ls_t100a TYPE t100a.
  FIELD-SYMBOLS:
    &lt;m&gt; LIKE LINE OF _data-&gt;messages,
    &lt;l&gt; LIKE LINE OF &lt;m&gt;-texts,
    &lt;t&gt; LIKE LINE OF _data-&gt;texts.
  TRY.
      CASE object-&gt;type.
        WHEN st_msgclass.
          _data ?= object-&gt;raw.
          _data-&gt;a0_maindata-arbgb = object-&gt;name.
          MOVE-CORRESPONDING _data-&gt;a0_maindata TO ls_t100a.
          LOOP AT _data-&gt;texts ASSIGNING &lt;t&gt;.
            CLEAR ls_t100t.
            ls_t100t-arbgb = _data-&gt;a0_maindata-arbgb.
            ls_t100t-sprsl = &lt;t&gt;-langu.
            ls_t100t-stext = &lt;t&gt;-short_txt.
            APPEND ls_t100t TO lt_t100t.
            IF &lt;t&gt;-langu = _data-&gt;a0_maindata-masterlang.
              ls_t100a-stext = &lt;t&gt;-short_txt.
            ENDIF.
          ENDLOOP.
          LOOP AT _data-&gt;messages ASSIGNING &lt;m&gt;.
            CLEAR ls_t100u.
            MOVE-CORRESPONDING &lt;m&gt; TO ls_t100u.
            ls_t100u-arbgb = _data-&gt;a0_maindata-arbgb.
            APPEND ls_t100u TO lt_t100u.
            CLEAR ls_doc.
            ls_doc-application = &lt;m&gt;-application.
            ls_doc-id = c_msg_id.
            CONCATENATE _data-&gt;a0_maindata-arbgb &lt;m&gt;-msgnr INTO ls_doc-object.
            ls_doc-typ = &lt;m&gt;-typ.
            ls_doc-dokform = &lt;m&gt;-dokform.
            ls_doc-dokstyle = &lt;m&gt;-dokstyle.
            ls_doc-selfdef = &lt;m&gt;-selfdef.
            CLEAR ls_t100.
            MOVE-CORRESPONDING &lt;m&gt; TO ls_t100.
            MOVE-CORRESPONDING ls_t100u TO ls_t100.
            LOOP AT &lt;m&gt;-texts ASSIGNING &lt;l&gt;.
              IF NOT &lt;l&gt;-short_txt IS INITIAL.
                ls_t100-sprsl = &lt;l&gt;-langu.
                ls_t100-text = &lt;l&gt;-short_txt.
                MOVE-CORRESPONDING &lt;l&gt; TO ls_t100.
                APPEND ls_t100 TO lt_t100.
              ENDIF.
              IF NOT &lt;l&gt;-long_txt IS INITIAL.
                &lt;l&gt;-long_txt-tdspras = &lt;l&gt;-langu.
                INSERT &lt;l&gt;-long_txt INTO TABLE ls_doc-texts .
              ENDIF.
            ENDLOOP.
            IF NOT ls_doc-texts IS INITIAL.
              INSERT ls_doc INTO TABLE t_docs.
            ENDIF.
          ENDLOOP.
          CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
            EXPORTING
              mode         = &apos;FREE&apos;
              object       = ls_t100a-arbgb
              object_class = &apos;T100&apos;.
          CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
            EXPORTING
              authority_check          = &apos;X&apos;
              global_lock              = &apos;X&apos;
              mode                     = &apos;INSERT&apos;
              language_upd_exit        = &apos;UPDATE_MASTER&apos;
              master_language          = ls_t100a-masterlang
              object                   = ls_t100a-arbgb
              object_class             = &apos;T100&apos;
              suppress_language_check  = &apos; &apos;
            EXCEPTIONS
              canceled_in_corr         = 01
              enqueued_by_user         = 02
              enqueue_system_failure   = 03
              illegal_parameter_values = 04
              locked_by_author         = 05
              no_modify_permission     = 06
              no_show_permission       = 07
              permission_failure       = 08.
          CASE sy-subrc.
            WHEN 0.
            WHEN 2 OR 5.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                    EXPORTING
                        name = _name
                        type = object-&gt;type
                      textid = zaplink_cx_connector=&gt;object_locked.
            WHEN 6 OR 7 OR 8 OR 9.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                    EXPORTING
                        name = _name
                        type = object-&gt;type
                      textid = zaplink_cx_connector=&gt;not_authorized.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                    EXPORTING
                        name = _name
                        type = object-&gt;type
                      textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
          MODIFY t100a FROM ls_t100a.
          MODIFY t100t FROM TABLE lt_t100t.
          MODIFY t100u FROM TABLE lt_t100u.
          MODIFY t100 FROM TABLE lt_t100.
          CALL METHOD zaplink_documentation=&gt;set
            EXPORTING
              t_docs = t_docs.
          CREATE OBJECT _comp.
          _comp-&gt;set_type( st_msgclass ).
          _name = _data-&gt;a0_maindata-arbgb.
          _comp-&gt;set_name( _name ).
          CREATE OBJECT components.
          components-&gt;add( _comp ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.
    result = abap_true.
  endif.
endmethod.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  DATA o_msag TYPE to_data.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  o_msag ?= object-&gt;raw.
  o_msag-&gt;anonymize( ).
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~unanonymize.
  DATA o_msag TYPE to_data.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  o_msag ?= object-&gt;raw.
  o_msag-&gt;unanonymize( ).
ENDMETHOD.
endclass. &quot;ZAPLINK_MESSAGE implementation
class ZAPLINK_OS_COMMAND implementation.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_id.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = C_MSG_ID. APPEND _id TO r_doc_id.
endmethod.
method COMP_TO_KEY.
SPLIT data AT field_separator INTO result-name result-opsystem.
endmethod.
method CONSTRUCTOR.
DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_os_cmd. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
method KEY_TO_COMP.
CONCATENATE data-name field_separator data-opsystem INTO result.
endmethod.
METHOD zaplink_connector~create_new_raw.
  DATA o_data TYPE to_data.
  CREATE OBJECT object.
  CASE type.
    WHEN st_os_cmd.
      CREATE OBJECT o_data.
      object-&gt;raw ?= o_data.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported &apos;ZAPLINK_OS_COMMAND&apos; type.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA d_name TYPE td_compname.
  DATA s_name TYPE ts_os_cmd_key.
  DATA d_dialog TYPE c.
  TYPES: BEGIN OF s_ext_cmd.
  INCLUDE TYPE sxpgcostab.
  TYPES:  sapcommand TYPE sxpgcolist-sapcommand,
          type(8)    TYPE c,
        END OF s_ext_cmd.
  DATA: external_command TYPE s_ext_cmd.
  TYPES retcode TYPE i.
  DATA d_rc     TYPE retcode.
  CONSTANTS:
    rc_command_not_found           TYPE retcode VALUE 801,
    rc_last_error                  TYPE retcode VALUE 9999. &quot;#EC NEEDED
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_os_cmd.
        d_name = component-&gt;get_name( ).
        s_name = comp_to_key( d_name ).
        external_command-name = s_name-name.
        external_command-opsystem = s_name-opsystem.
        PERFORM command_delete IN PROGRAM saplsxpt
                USING d_dialog
             CHANGING external_command
                      d_rc.
        IF d_rc &lt;&gt; 0.
          CASE d_rc.
            WHEN rc_command_not_found.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OS_COMMAND&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA d_name TYPE td_compname.
  DATA d_type TYPE td_comptype.
  DATA s_name TYPE ts_os_cmd_key.
  TRY.
    exists = me-&gt;exists-not_exists.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_os_cmd.
        d_name = component-&gt;get_name( ).
        s_name = comp_to_key( d_name ).
        CALL FUNCTION &apos;SXPG_COMMAND_GET&apos;
          EXPORTING
            commandname             = s_name-name
            operatingsystem         = s_name-opsystem
          EXCEPTIONS
            command_not_found       = 1
            OTHERS                  = 2.
        IF sy-subrc = 0.
          exists = me-&gt;exists-exists.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OS_COMMAND&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
result = abap_false.
  IF version = _ver.
    result = abap_true.
  ENDIF.
endmethod.
METHOD zaplink_connector~read_from_sap.
  DATA d_name TYPE td_compname.
  DATA d_type TYPE td_comptype.
  DATA s_name TYPE ts_os_cmd_key.
  DATA o_data  TYPE to_data.
  TRY.
    CREATE OBJECT object.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_os_cmd.
        d_name = component-&gt;get_name( ).
        s_name = comp_to_key( d_name ).
        CREATE OBJECT o_data.
        CALL FUNCTION &apos;SXPG_COMMAND_GET&apos;
          EXPORTING
            commandname             = s_name-name
            operatingsystem         = s_name-opsystem
          IMPORTING
            command                 = o_data-&gt;a0_maindata
          EXCEPTIONS
            command_not_found       = 1
            OTHERS                  = 2.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
             EXPORTING
               textid = zaplink_cx_connector=&gt;not_found
               name   = d_name
               type   = st_os_cmd.
        ENDIF.
        object-&gt;set_component( component ).
        CLEAR: o_data-&gt;a0_maindata-name,
               o_data-&gt;a0_maindata-opsystem.
        object-&gt;raw ?= o_data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_OS_COMMAND&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA d_name TYPE td_compname.
  DATA d_type TYPE td_comptype.
  DATA s_name TYPE ts_os_cmd_key.
  DATA o_data  TYPE to_data.
  DATA o_comp  TYPE to_component.
  d_type = object-&gt;type.
  CASE d_type.
    WHEN st_os_cmd.
      o_data ?= object-&gt;raw.
      d_name = object-&gt;get_name( ).
      s_name = comp_to_key( d_name ).
      o_data-&gt;a0_maindata-name = s_name-name.
      o_data-&gt;a0_maindata-opsystem = s_name-opsystem.
      CALL FUNCTION &apos;SXPG_COMMAND_INSERT&apos;
        EXPORTING
          command                      = o_data-&gt;a0_maindata
        EXCEPTIONS
          command_already_exists       = 1
          no_permission                = 2
          parameters_wrong             = 3
          foreign_lock                 = 4
          system_failure               = 5
          OTHERS                       = 6.
      IF sy-subrc &lt;&gt; 0.
        IF sy-subrc &lt;&gt; 1.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname  = &apos;SXPG_COMMAND_INSERT&apos;
                                                   subrc     = sy-subrc
                                                   classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                 ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
        CALL FUNCTION &apos;SXPG_COMMAND_MODIFY&apos;
          EXPORTING
            command                = o_data-&gt;a0_maindata
          EXCEPTIONS
            no_permission          = 1
            parameters_wrong       = 2
            system_failure         = 3
            foreign_lock           = 4
            OTHERS                 = 5.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname  = &apos;SXPG_COMMAND_MODIFY&apos;
                                                   subrc     = sy-subrc
                                                   classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                 ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
      ENDIF.
      CREATE OBJECT o_comp.
      o_comp-&gt;set_type( st_os_cmd ).
      MOVE-CORRESPONDING o_data-&gt;a0_maindata TO s_name.
      d_name = key_to_comp( s_name ).
      o_comp-&gt;set_name( d_name ).
      CREATE OBJECT components.
      components-&gt;add( o_comp ).
    WHEN OTHERS.
      mac_raise_type_not_supported &apos;ZAPLINK_OS_COMMAND&apos; d_type.
  ENDCASE.
ENDMETHOD.
endclass. &quot;ZAPLINK_OS_COMMAND implementation
class ZAPLINK_PROGRAM implementation.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_id.
  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = &apos;CF&apos;. APPEND _id TO r_doc_id.
  _id-low = &apos;CM&apos;. APPEND _id TO r_doc_id.
  _id-low = &apos;RE&apos;. APPEND _id TO r_doc_id.
endmethod.
METHOD constructor.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_program. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
ENDMETHOD.
METHOD zaplink_connector~create_new_raw.
  DATA o_prog TYPE to_program.
  CREATE OBJECT object.
  CASE type.
    WHEN st_program.
      CREATE OBJECT o_prog.
      object-&gt;raw = o_prog.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_PROGRAM&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA program TYPE sy-repid.
  DATA type  TYPE td_comptype.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_program.
          program = component-&gt;get_name( ).
          CALL FUNCTION &apos;RS_DELETE_PROGRAM&apos;
            EXPORTING
              program                          = program
              suppress_popup                   = &apos;X&apos;
            EXCEPTIONS
              enqueue_lock                     = 1
              object_not_found                 = 2
              permission_failure               = 3
              reject_deletion                  = 4
              OTHERS                           = 5.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;RS_DELETE_PROGRAM&apos;
                                                        subrc = sy-subrc
                                                    classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                    textid = zaplink_cx=&gt;system_error ).
            RAISE EXCEPTION o_mycx.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA _name TYPE trdir-name.
  DATA type  TYPE td_comptype.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_program.
          _name = component-&gt;get_name( ).
          SELECT SINGLE name INTO _name
            FROM trdir
            WHERE name = _name.
          IF sy-subrc = 0.
            exists = me-&gt;exists-exists.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~read_from_sap.
  TYPES:
    BEGIN OF ts_doc,
      prog TYPE programm,
      wildcard(1) TYPE c,
    END OF ts_doc.
  DATA s_obj TYPE ts_doc.
  DATA o_data      TYPE to_program.
  DATA s_fm_data   TYPE ts_fm_data.
  DATA _prog       TYPE td_progname.
  DATA _name       TYPE td_compname.
  DATA _obj        TYPE doku_obj.
  DATA type        TYPE td_comptype.
  TRY.
    type = component-&gt;get_type( ).
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    CASE type.
      WHEN st_program.
        _prog = _name = object-&gt;name.
        CREATE OBJECT o_data.
        SELECT SINGLE *
          INTO s_fm_data-header
          FROM progdir    &quot; reposrc
          WHERE name = _name
            AND state = &apos;A&apos;.        &quot; Active
        IF sy-subrc &lt;&gt; 0.
          SELECT SINGLE *
            INTO s_fm_data-header
            FROM progdir    &quot;reposrc
            WHERE name = _name
              AND state = &apos;I&apos;.      &quot; Inactive
        ENDIF.
        s_fm_data-source = get_prog_source( _prog ).
        s_fm_data-textspool = get_prog_textpool( _prog ).
        s_fm_data-dynpros = get_dynpros( _prog ).
        s_fm_data-menupainter = get_menus( _prog ).
        SELECT *
          INTO TABLE s_fm_data-texts
          FROM trdirti
          WHERE name = _name.
        s_obj-prog = _name.
        s_obj-wildcard = &apos;*&apos;.
        _obj = s_obj.
        s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_prog_data=&gt;r_doc_ids-prog
                                                  object = _obj ).
        o_data-&gt;from_data( s_fm_data ).
        o_data-&gt;_code_signature = get_program_signature( o_data-&gt;a0_maindata-name ).
        CLEAR o_data-&gt;a0_maindata-name.
        object-&gt;raw = o_data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_PROGRAM&apos; type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA o_data      TYPE to_program.
  DATA _prog       TYPE programm.
  DATA _oname      TYPE e071-obj_name.
  DATA _rep        TYPE progdir.
  DATA _comp       TYPE to_component.
  DATA _name       TYPE td_compname.
  DATA s_fm_data   TYPE ts_fm_data.
  TRY.
      CASE object-&gt;type.
        WHEN st_program.
          o_data ?= object-&gt;raw.
          _oname = _prog = o_data-&gt;a0_maindata-name = object-&gt;name.
          s_fm_data = o_data-&gt;to_data( ).
          CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
            EXPORTING
              object                  = &apos;REPS&apos;
              obj_name                = _oname
            EXCEPTIONS
              wrong_object_name       = 1
              OTHERS                  = 2.
          IF sy-subrc &lt;&gt; 0.
            mac_add_mf_and_raise &apos;RS_INSERT_INTO_WORKING_AREA&apos; sy-subrc.
          ENDIF.
          CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
            EXPORTING
              object                  = &apos;REPT&apos;
              obj_name                = _oname
            EXCEPTIONS
              wrong_object_name       = 1
              OTHERS                  = 2.
          IF sy-subrc &lt;&gt; 0.
            mac_add_mf_and_raise &apos;RS_INSERT_INTO_WORKING_AREA&apos; sy-subrc.
          ENDIF.
          MOVE-CORRESPONDING s_fm_data-header TO _rep.
          _rep-state = &apos;I&apos;.   MODIFY progdir FROM _rep.
          _rep-state = &apos;A&apos;.   MODIFY progdir FROM _rep.
          set_prog_source( program = _prog
                            source = s_fm_data-source ).
          set_prog_textpool( program = _prog
                            textpool = s_fm_data-textspool ).
          set_dynpros( program = _prog
                       dynpros = s_fm_data-dynpros ).
          set_menus( program = _prog
                       menus = s_fm_data-menupainter ).
          zaplink_documentation=&gt;set( t_docs = s_fm_data-docs ).
          DELETE FROM trdirti WHERE name = s_fm_data-header-name.
          MODIFY trdirti FROM TABLE s_fm_data-texts.
          CREATE OBJECT _comp.
          _comp-&gt;set_type( st_program ).
          _name = _prog.
          _comp-&gt;set_name( _name ).
          CREATE OBJECT components.
          components-&gt;add( _comp ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_PROGRAM&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.
    result = abap_true.
  endif.
endmethod.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  DATA o_prog TYPE to_program.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  o_prog ?= object-&gt;raw.
  o_prog-&gt;anonymize( ).
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~unanonymize.
  DATA o_prog TYPE to_program.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  o_prog ?= object-&gt;raw.
  o_prog-&gt;unanonymize( ).
ENDMETHOD.
METHOD zaplink_cnx_ext_code_signature~get_signature.
  DATA d_type TYPE td_comptype.
  DATA d_prog TYPE td_progname.
  TRY.
      d_type = component-&gt;get_type( ).
      CASE d_type.
        WHEN st_program.
          d_prog = component-&gt;get_name( ).
          result = get_program_signature( d_prog ).
        WHEN OTHERS.
          mac_raise_type_not_supported &apos;ZAPLINK_PROGRAM&apos; d_type.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD get_program_signature.
  DATA t_code TYPE tt_abaprawsource.
  DATA d_src  TYPE string.
  t_code = get_prog_rawsource( program_name ).
  zaplink_tools=&gt;pretty_printer( CHANGING table = t_code ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = t_code ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).
ENDMETHOD.
endclass. &quot;ZAPLINK_PROGRAM implementation
class ZAPLINK_RAW implementation.
METHOD constructor.
  super-&gt;constructor( o_comp ).
ENDMETHOD.
METHOD update_connector_data.
  DATA o_raw_data      TYPE to_raw_data.
  o_raw_data = me-&gt;raw.
  IF NOT o_raw_data-&gt;_dependencies IS INITIAL.    me-&gt;dependencies = o_raw_data-&gt;_dependencies.     CLEAR o_raw_data-&gt;_dependencies.    ENDIF.  &quot; Issue 47 : Introducing dependencies
  IF NOT o_raw_data-&gt;_code_signature IS INITIAL.  me-&gt;code_signature = o_raw_data-&gt;_code_signature. CLEAR o_raw_data-&gt;_code_signature.  ENDIF.  &quot; Issue 65 : Source Code signature
  super-&gt;update_connector_data( o_connector = o_connector ).
  me-&gt;set_checksum( ).
ENDMETHOD.
endclass. &quot;ZAPLINK_RAW implementation
class ZAPLINK_BADI implementation.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_id_definition.
  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = &apos;HY&apos;. APPEND _id TO r_doc_id_definition.
  _id-low = &apos;BI&apos;. APPEND _id TO r_doc_id_implementation.
endmethod.
METHOD constructor.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_badi_def. INSERT type INTO TABLE supported_types.
  type-type = st_badi_impl. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
ENDMETHOD.
method CREATE_DOC_KEY.
  doc_key-simg = &apos;SIMG&apos;.
endmethod.
METHOD do_exists_impl.
  _exists = zaplink_badi=&gt;exists-not_exists.
  CALL FUNCTION &apos;SXV_IMP_EXISTS&apos;
    EXPORTING
      imp_name           = name
    EXCEPTIONS
      not_existing       = 1
      data_inconsistency = 2
      OTHERS             = 3.
  IF sy-subrc = 0.
    _exists =  zaplink_badi=&gt;exists-exists.
  ENDIF.
ENDMETHOD.
METHOD export_from_sap_def.
  DATA obj_mask    TYPE doku_obj.
  DATA docu_key    TYPE ts_doc_key.
  DATA _d          TYPE zaplink_sxsd_data=&gt;t_fm_data.
  DATA exit_name   TYPE rsexscrn-exit_name.
  DATA o_conn      TYPE to_connector.
  DATA _list       TYPE to_list.
  DATA _comp       TYPE to_component.
  DATA _name       TYPE td_compname.
  DATA f_subcomp  TYPE td_with_subcomp.
  TRY.
      CHECK component-&gt;get_type( ) = st_badi_def.
      f_subcomp = component-&gt;get_with_subcomp( ).
      exit_name = component-&gt;get_name( ).
      CALL FUNCTION &apos;SXO_BADI_READ&apos;
        EXPORTING
          exit_name                = exit_name
        IMPORTING
          badi                     = _d-definition
          mast_langu               = _d-mast_langu
          ext_clname               = _d-ext_clname
          filter_obj               = _d-filter_obj
        TABLES
          fcodes                   = _d-fcodes
          cocos                    = _d-cocos
          intas                    = _d-intas
          scrns                    = _d-scrns
          methods                  = _d-methods
          inactive_tabstrips       = _d-inactive_tabstrips
        EXCEPTIONS
          read_failure             = 1
          OTHERS                   = 2.
      IF sy-subrc &lt;&gt; 0.
      ENDIF.
      docu_key = create_doc_key( ).
      docu_key-name = component-&gt;get_name( ).
      obj_mask = docu_key.
      CREATE OBJECT o_data.
      o_data-&gt;from_data( _d ).
      IF NOT o_data-&gt;a0_maindata-inter_name IS INITIAL AND f_subcomp = abap_true.
        o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_itf ).
        IF o_conn IS BOUND.
          CREATE OBJECT _comp.
          _comp-&gt;set_type( t_badi_itf ).
          _name = o_data-&gt;a0_maindata-inter_name.
          _comp-&gt;set_name( _name ).
          o_data-&gt;interface = o_conn-&gt;read_from_sap( _comp ).
          IF o_data-&gt;interface IS BOUND.
            CLEAR o_data-&gt;a0_maindata-inter_name.
            CREATE OBJECT _list.
            _list-&gt;add( _comp ).
            component-&gt;set_subcomponents( _list ).
          ENDIF.
        ENDIF.
      ENDIF.
      o_data-&gt;documentation = zaplink_documentation=&gt;get( ids = r_doc_id_definition
                                                       object = obj_mask ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD export_from_sap_impl.
  DATA obj_mask    TYPE doku_obj.
  DATA _d          TYPE zaplink_badi_data=&gt;t_fm_data.
  DATA imp_name    TYPE rsexscrn-imp_name.
  DATA exit_name   TYPE rsexscrn-exit_name.
  DATA inter_name  TYPE rsexscrn-inter_name.
  DATA filters     TYPE seex_filter_table.
  DATA o_conn      TYPE to_connector.
  DATA _comp       TYPE to_component.
  DATA badi_info   TYPE badi_data.
  DATA filter_obj  TYPE REF TO cl_badi_flt_struct.
  DATA t_fcodes    TYPE seex_fcode_table.
  DATA t_cocos     TYPE seex_coco_table.
  DATA t_intas     TYPE seex_table_table.
  DATA t_scrns     TYPE seex_screen_table.
  DATA methods     TYPE seex_mtd_table.
  DATA _name       TYPE td_compname.
  DATA f_subcomp  TYPE td_with_subcomp.
  TRY.
      CHECK component-&gt;get_type( ) = st_badi_impl.
      f_subcomp = component-&gt;get_with_subcomp( ).
      imp_name = component-&gt;get_name( ).
      IF do_exists_impl( imp_name ) &lt;&gt; exists.
        EXIT.
      ENDIF.
      CALL FUNCTION &apos;SXV_EXIT_FOR_IMP&apos;
        EXPORTING
          imp_name           = imp_name
        IMPORTING
          exit_name          = exit_name
        TABLES
          filters            = filters
        EXCEPTIONS
          data_inconsistency = 1
          OTHERS             = 2.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SXV_EXIT_FOR_IMP&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      CALL FUNCTION &apos;SXO_BADI_READ&apos;
        EXPORTING
          exit_name                = exit_name
        IMPORTING
          badi                     = badi_info
          filter_obj               = filter_obj
        TABLES
          fcodes                   = t_fcodes
          cocos                    = t_cocos
          intas                    = t_intas
          scrns                    = t_scrns
          methods                  = methods
        EXCEPTIONS
          read_failure             = 1
          OTHERS                   = 2.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SXO_BADI_READ&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      inter_name = badi_info-inter_name.
      IF filter_obj IS BOUND.
        _d-impl_w_filter = badi_info-flt_ext.
        _d-filter_datatype = filter_obj-&gt;flt_type.
      ENDIF.
      CALL FUNCTION &apos;SXO_IMPL_FOR_BADI_READ&apos;
        EXPORTING
          imp_name                = imp_name
          exit_name               = exit_name
          inter_name              = inter_name
          filter_obj              = filter_obj
        IMPORTING
          impl                    = _d-implementation
          mast_langu              = _d-mast_langu
        TABLES
          fcodes                  = _d-fcodes
          cocos                   = _d-cocos
          intas                   = _d-intas
          scrns                   = _d-scrns
        CHANGING
          methods                 = methods
        EXCEPTIONS
          read_failure            = 1
          OTHERS                  = 2.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SXO_IMPL_FOR_BADI_READ&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      CALL FUNCTION &apos;SXV_EXIT_FOR_IMP&apos;
        EXPORTING
          imp_name                 = imp_name
        TABLES
          filters                  = _d-filter_values
        EXCEPTIONS
          data_inconsistency       = 1
          OTHERS                   = 2.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SXV_EXIT_FOR_IMP&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      CREATE OBJECT o_data.
      o_data-&gt;from_data( _d ).
      IF NOT o_data-&gt;a0_maindata-imp_class IS INITIAL AND f_subcomp = abap_true.
        o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_impl ).
        IF o_conn IS BOUND.
          CREATE OBJECT _comp.
          _comp-&gt;set_type( t_badi_impl ).
          _name = o_data-&gt;a0_maindata-imp_class.
          _comp-&gt;set_name( _name ).
          o_data-&gt;implementation = o_conn-&gt;read_from_sap( _comp ).
          IF o_data-&gt;implementation IS BOUND.
            CLEAR o_data-&gt;a0_maindata-imp_class.
          ENDIF.
        ENDIF.
      ENDIF.
      CONCATENATE _name &apos;*&apos; INTO obj_mask.
      o_data-&gt;documentation = zaplink_documentation=&gt;get( ids = r_doc_id_implementation
                                                       object = obj_mask ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_def.
  DATA _d               TYPE zaplink_sxsd_data=&gt;t_fm_data.
  DATA i_korrnr         TYPE trkorr.
  DATA i_devclass       TYPE devclass.
  DATA _component       TYPE to_component.
  DATA mast_langu       TYPE sy-langu.
  DATA o_conn           TYPE to_connector.
  DATA transport_key    TYPE trkey.
  TRY.
      IF o_data-&gt;interface IS BOUND.
        o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_itf ).
        IF o_conn IS BOUND.
          o_data-&gt;interface-&gt;type = t_badi_itf.
          components = o_conn-&gt;write_to_sap( o_data-&gt;interface ).
          IF components IS BOUND.
            components-&gt;init_iter( ).
            _component = components-&gt;get_next( ).
            WHILE _component IS BOUND.
              IF _component-&gt;get_type( ) = t_badi_itf.
                o_data-&gt;a0_maindata-inter_name = _component-&gt;get_name( ).
                EXIT.
              ENDIF.
              _component = components-&gt;get_next( ).
            ENDWHILE.
          ENDIF.
        ENDIF.
      ENDIF.
      _d = o_data-&gt;to_data( ).
      CALL FUNCTION &apos;SXO_BADI_SAVE&apos;
        EXPORTING
          badi                   = _d-definition
        IMPORTING
          mast_langu             = mast_langu
        TABLES
          fcodes_to_insert       = _d-fcodes
          cocos_to_insert        = _d-cocos
          intas_to_insert        = _d-intas
          sscrs_to_insert        = _d-scrns
        CHANGING
          korrnum                = i_korrnr
          devclass               = i_devclass
        EXCEPTIONS
          save_failure           = 1
          action_canceled        = 2
          OTHERS                 = 3.
      CASE sy-subrc.
        WHEN &apos;0&apos;.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.
      IF mast_langu &lt;&gt; o_data-&gt;a0_maindata-mast_langu.
        transport_key-obj_name = o_data-&gt;a0_maindata-exit_name.
        CALL FUNCTION &apos;SXO_BADI_MAST_LANG_UPDATE&apos;
          EXPORTING
            new_master_language = o_data-&gt;a0_maindata-mast_langu
            old_master_language = mast_langu
            transport_key       = transport_key
          EXCEPTIONS
            object_not_found    = 1
            OTHERS              = 2.
        IF sy-subrc &lt;&gt; 0.
        ENDIF.
      ENDIF.
      zaplink_documentation=&gt;set( o_data-&gt;documentation ).
      CREATE OBJECT _component.
      _component-&gt;set_type( st_badi_def ).
      _component-&gt;set_name( o_data-&gt;a0_maindata-exit_name ).
      IF NOT components IS BOUND. CREATE OBJECT components. ENDIF.
      components-&gt;add( _component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_impl.
  DATA _d               TYPE zaplink_badi_data=&gt;t_fm_data.
  DATA i_korrnr         TYPE trkorr.
  DATA i_devclass       TYPE devclass.
  DATA _component       TYPE to_component.
  DATA mast_langu       TYPE sy-langu.
  DATA o_conn           TYPE to_connector.
  DATA transport_key    TYPE trkey.
  DATA o_filter         TYPE REF TO cl_badi_flt_struct.
  DATA o_filter_val     TYPE REF TO cl_badi_flt_values_alv.
  DATA badi_data        TYPE badi_data.
  TRY.
      IF o_data-&gt;implementation IS BOUND.
        o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_impl ).
        IF o_conn IS BOUND.
          o_data-&gt;implementation-&gt;type = t_badi_impl.
          components = o_conn-&gt;write_to_sap( o_data-&gt;implementation ).
          IF components IS BOUND.
            components-&gt;init_iter( ).
            _component = components-&gt;get_next( ).
            WHILE _component IS BOUND.
              IF _component-&gt;get_type( ) = t_badi_impl.
                o_data-&gt;a0_maindata-imp_class = _component-&gt;get_name( ).
                EXIT.
              ENDIF.
              _component = components-&gt;get_next( ).
            ENDWHILE.
          ENDIF.
        ENDIF.
      ENDIF.
      _d = o_data-&gt;to_data( ).
      CALL FUNCTION &apos;SXO_BADI_READ&apos;
        EXPORTING
          exit_name                = _d-implementation-exit_name
        IMPORTING
          badi                     = badi_data
        EXCEPTIONS
          read_failure             = 1
          OTHERS                   = 2.
      IF sy-subrc &lt;&gt; 0.
      ENDIF.
      CREATE OBJECT o_filter
        EXPORTING
          filter_structure               = _d-filter_datatype
          extend                         = badi_data-flt_ext
        EXCEPTIONS
          ddic_object_not_active         = 1
          no_data_element                = 2
          domain_not_of_char             = 3
          domain_too_long                = 4
          filtertype_inadmissible        = 5
          shlp_inadmissible              = 6
          invalid_key_comb_of_val_table  = 7
          invalid_key_comb_of_text_table = 8
          wrong_table_class              = 9
          invalid_text_table             = 10
          no_value_table                 = 11
          no_text_table                  = 12
          checktable_existing            = 13
          no_domain                      = 14
          OTHERS                         = 15.
      IF sy-subrc &lt;&gt; 0.
      ENDIF.
      CREATE OBJECT o_filter_val
        EXPORTING
          filter_object = o_filter
          filter_values = _d-filter_values
          .
      CALL FUNCTION &apos;SXO_IMPL_SAVE&apos;
        EXPORTING
          impl                   = _d-implementation
          flt_ext                = _d-impl_w_filter
          flt_type               = _d-filter_datatype
          maint_langu            = _d-mast_langu
          filter_val_obj         = o_filter_val
        IMPORTING
          mast_langu             = mast_langu
        TABLES
          fcodes_to_insert       = _d-fcodes
          cocos_to_insert        = _d-cocos
          intas_to_insert        = _d-intas
          sscrs_to_insert        = _d-scrns
        CHANGING
          korrnum                = i_korrnr
          devclass               = i_devclass
        EXCEPTIONS
          save_failure           = 1
          action_canceled        = 2
          OTHERS                 = 3.
      CASE sy-subrc.
        WHEN &apos;0&apos;.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.
      IF mast_langu &lt;&gt; o_data-&gt;a0_maindata-mast_langu.
        transport_key-obj_name = o_data-&gt;a0_maindata-exit_name.
        CALL FUNCTION &apos;SXO_IMPL_MAST_LANG_UPDATE&apos;
          EXPORTING
            new_master_language = o_data-&gt;a0_maindata-mast_langu
            old_master_language = mast_langu
            transport_key       = transport_key
          EXCEPTIONS
            object_not_found    = 1
            OTHERS              = 2.
        IF sy-subrc &lt;&gt; 0.
        ENDIF.
      ENDIF.
      zaplink_documentation=&gt;set( o_data-&gt;documentation ).
      IF NOT _d-implementation-active IS INITIAL.
        CALL FUNCTION &apos;SXO_IMPL_ACTIVE&apos;
          EXPORTING
            imp_name                        = _d-implementation-imp_name
            no_dialog                       = seex_true
          EXCEPTIONS
            badi_not_existing               = 1
            imp_not_existing                = 2
            already_active                  = 3
            data_inconsistency              = 4
            activation_not_admissable       = 5
            action_canceled                 = 6
            access_failure                  = 7
            OTHERS                          = 8.
        IF sy-subrc &lt;&gt; 0.
        ENDIF.
      ENDIF.
      CREATE OBJECT _component.
      _component-&gt;set_type( st_badi_impl ).
      _component-&gt;set_name( o_data-&gt;a0_maindata-exit_name ).
      IF NOT components IS BOUND. CREATE OBJECT components. ENDIF.
      components-&gt;add( _component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~create_new_raw.
  DATA o_conn   TYPE to_connector.
  DATA o_sxsd   TYPE to_badi_def.
  DATA o_sxci   TYPE to_badi_impl.
  DATA _type    TYPE td_comptype.
  CREATE OBJECT object.
  CASE type.
    WHEN st_badi_def.
      CREATE OBJECT o_sxsd.
      o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_itf ).
      IF o_conn IS BOUND.
        _type = t_badi_itf.
        o_sxsd-&gt;interface = o_conn-&gt;create_new_raw( _type ).
      ENDIF.
      object-&gt;raw = o_sxsd.
    WHEN st_badi_impl.
      CREATE OBJECT o_sxci.
      o_conn = zaplink_connectors=&gt;create_connector( type = t_badi_impl ).
      IF o_conn IS BOUND.
        _type = t_badi_impl.
        o_sxci-&gt;implementation = o_conn-&gt;create_new_raw( _type ).
      ENDIF.
      object-&gt;raw = o_sxci.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported &apos;ZAPLINK_BADI&apos; type.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA exit_name  TYPE rsexscrn-exit_name.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_badi_def.
        exit_name = component-&gt;get_name( ).
        CALL FUNCTION &apos;SXO_BADI_DELETE&apos;
          EXPORTING
            exit_name                = exit_name
            no_dialog                = seex_true
          EXCEPTIONS
            badi_not_existing        = 1
            action_canceled          = 2
            access_failure           = 3
            data_inconsistency       = 4
            OTHERS                   = 5
                  .
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN st_badi_impl.
        exit_name = component-&gt;get_name( ).
        CALL FUNCTION &apos;SXO_IMPL_DELETE&apos;
          EXPORTING
            imp_name                 = exit_name
          EXCEPTIONS
            imp_not_existing         = 1
            action_canceled          = 2
            access_failure           = 3
            data_inconsistency       = 4
            OTHERS                   = 5.
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_BADI&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA exit_name  TYPE rsexscrn-exit_name.
  DATA imp_name   TYPE rsexscrn-imp_name.
  TRY.
      exists = me-&gt;exists-not_exists.
      CASE component-&gt;get_type( ).
        WHEN st_badi_def.
          exit_name = component-&gt;get_name( ).
          CALL FUNCTION &apos;SXV_EXIT_EXISTS&apos;
            EXPORTING
              exit_name                   = exit_name
            EXCEPTIONS
              not_existing                = 1
              exit_interface_not_existing = 2
              category_conflict           = 3
              no_sxs_inter_entry          = 4
              OTHERS                      = 5.
          IF sy-subrc = 0.
            exists = me-&gt;exists-exists.
          ENDIF.
        WHEN st_badi_impl.
          imp_name = component-&gt;get_name( ).
          exists = do_exists_impl( imp_name ).
        WHEN OTHERS.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~read_from_sap.
  DATA o_bdef TYPE to_badi_def.
  DATA o_impl TYPE to_badi_impl.
  DATA d_type TYPE td_comptype.
  TRY.
    CREATE OBJECT object.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_badi_def.
        o_bdef = export_from_sap_def( component ).
        object-&gt;raw = o_bdef.
      WHEN st_badi_impl.
        o_impl = export_from_sap_impl( component ).
        object-&gt;raw = o_impl.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_BADI&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA _o_def         TYPE to_badi_def.
  DATA _o_impl        TYPE to_badi_impl.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = object-&gt;type.
    CASE d_type.
      WHEN st_badi_def.
        _o_def ?= object-&gt;raw.
        _o_def-&gt;a0_maindata-exit_name = object-&gt;name.
        components = import_to_sap_def( _o_def ).
      WHEN st_badi_impl.
        _o_impl ?= object-&gt;raw.
        _o_impl-&gt;a0_maindata-imp_name = object-&gt;name.
        components = import_to_sap_impl( _o_impl ).
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_BADI&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.    result = abap_true.   endif.
endmethod.
endclass. &quot;ZAPLINK_BADI implementation
class ZAPLINK_BADI_DATA implementation.
method FROM_DATA.
  DATA _fc    LIKE LINE OF functions_codes.
  DATA _cc    LIKE LINE OF controls_composites.
  DATA _scr   LIKE LINE OF subscreens.
  DATA _t     LIKE LINE OF tables.
  FIELD-SYMBOLS:
    &lt;fc&gt;  LIKE LINE OF fm_data-fcodes,
    &lt;cc&gt;  LIKE LINE OF fm_data-cocos,
    &lt;in&gt;  LIKE LINE OF fm_data-intas,
    &lt;scr&gt; LIKE LINE OF fm_data-scrns,
    &lt;it&gt;  LIKE LINE OF fm_data-inactive_tabstrips.
  LOOP AT fm_data-fcodes ASSIGNING &lt;fc&gt;
    WHERE exit_name = def_name.
    CLEAR _fc.
    _fc = &lt;fc&gt;.
    CLEAR: _fc-exit_name. &quot; VERSION
    INSERT _fc INTO TABLE functions_codes.
  ENDLOOP.
  LOOP AT fm_data-cocos ASSIGNING &lt;cc&gt;
    WHERE exit_name = def_name.
    CLEAR _cc.
    _cc = &lt;cc&gt;.
    CLEAR: _cc-exit_name. &quot; VERSION
    INSERT _cc INTO TABLE controls_composites.
  ENDLOOP.
  LOOP AT fm_data-intas ASSIGNING &lt;in&gt;
    WHERE exit_name = def_name.
    CLEAR _t.
    _t = &lt;in&gt;.
    CLEAR: _t-exit_name. &quot; VERSION
    INSERT _t INTO TABLE tables.
  ENDLOOP.
  LOOP AT fm_data-scrns ASSIGNING &lt;scr&gt;
    WHERE exit_name = def_name.
    CLEAR _scr.
    _scr = &lt;scr&gt;.
    CLEAR: _scr-exit_name. &quot; VERSION
    INSERT _scr INTO TABLE subscreens.
  ENDLOOP.
endmethod.
method TO_DATA.
DATA _in  LIKE LINE OF fm_data-intas.
  DATA _cc  LIKE LINE OF fm_data-cocos.
  DATA _fc  LIKE LINE OF fm_data-fcodes.
  DATA _scr LIKE LINE OF fm_data-scrns.
  FIELD-SYMBOLS:
    &lt;t&gt;   LIKE LINE OF tables,
    &lt;scr&gt; LIKE LINE OF subscreens,
    &lt;fc&gt;  LIKE LINE OF functions_codes,
    &lt;cc&gt;  LIKE LINE OF controls_composites.
  LOOP AT functions_codes ASSIGNING &lt;fc&gt;.
    CLEAR _fc.
    _fc = &lt;fc&gt;.
    _fc-exit_name = def_name.
    INSERT _fc INTO TABLE fm_data-fcodes.
  ENDLOOP.
  LOOP AT controls_composites ASSIGNING &lt;cc&gt;.
    CLEAR _cc.
    _cc = &lt;cc&gt;.
    _cc-exit_name = def_name.
    INSERT _cc INTO TABLE fm_data-cocos.
  ENDLOOP.
  LOOP AT tables ASSIGNING &lt;t&gt;.
    CLEAR _in.
    _in = &lt;t&gt;.
    _in-exit_name = def_name.
    INSERT _in INTO TABLE fm_data-intas.
  ENDLOOP.
  LOOP AT subscreens ASSIGNING &lt;scr&gt;.
    CLEAR _scr.
    _scr = &lt;scr&gt;.
    _scr-exit_name = def_name.
    INSERT _scr INTO TABLE fm_data-scrns.
  ENDLOOP.
endmethod.
endclass. &quot;ZAPLINK_BADI_DATA implementation
class ZAPLINK_CLAS_DATA implementation.
METHOD get_source.
  DATA code TYPE zaplink_object=&gt;tt_abaprawsource.
  DATA linecount TYPE i.
  DATA d_line LIKE LINE OF code.                            &quot; Issue 68
  FIELD-SYMBOLS: &lt;l&gt; LIKE LINE OF code.
  code = zaplink_object=&gt;get_prog_rawsource( program ).
  IF NOT code IS INITIAL.
    linecount = LINES( code ).
    IF linecount &gt; 1.
      READ TABLE code INTO d_line INDEX linecount.
      TRANSLATE d_line TO UPPER CASE.                     &quot;#EC SYNTCHAR
      IF d_line CP &apos;ENDMETHOD.*&apos;.
        DELETE code INDEX linecount.
      ENDIF.
    ENDIF.
    READ TABLE code INTO d_line INDEX 1.
    TRANSLATE d_line TO UPPER CASE.                         &quot;#EC *
    IF d_line CP &apos;METHOD *&apos;.                              &quot;#EC SYNTCHAR
      DELETE code INDEX 1.
    ENDIF.
    IF NOT code IS INITIAL.
      linecount = LINES( code ).
      READ TABLE code ASSIGNING &lt;l&gt; INDEX linecount.
      WHILE &lt;l&gt; IS INITIAL.
        DELETE code INDEX linecount.
        linecount = LINES( code ).
        READ TABLE code ASSIGNING &lt;l&gt; INDEX linecount.
        IF NOT &lt;l&gt; IS ASSIGNED.   EXIT.   ENDIF.
      ENDWHILE.
    ENDIF.
  ENDIF.
  source = zaplink_object=&gt;conv_abap_raw2source( code ).
ENDMETHOD.
METHOD from_data.
  DATA _in  LIKE LINE OF interfaces.
  DATA _ia  LIKE LINE OF _in-components.
  DATA _t   LIKE LINE OF a0_maindata-texts.
  DATA _fr  LIKE LINE OF friends.
  DATA _re  LIKE LINE OF me-&gt;redefinitions.
  DATA _me  LIKE LINE OF methods.
  DATA _dep LIKE LINE OF _dependencies.
  DATA _mk  TYPE seocpdkey.
  DATA _source TYPE zaplink_program=&gt;ts_source.
  FIELD-SYMBOLS:
    &lt;dc&gt;  LIKE LINE OF deferred-classes,
    &lt;di&gt;  LIKE LINE OF deferred-interfaces,
    &lt;m_&gt;  LIKE LINE OF fm_data-includes-methods,
    &lt;im&gt;  LIKE LINE OF fm_data-implementings,
    &lt;ei&gt;  LIKE LINE OF fm_data-explore_implementings,
    &lt;ic&gt;  LIKE LINE OF &lt;ei&gt;-comprisings,
    &lt;rd&gt;  LIKE LINE OF fm_data-impl_details,
    &lt;me&gt;  LIKE LINE OF methods,
    &lt;fr&gt;  LIKE LINE OF fm_data-friendships,
    &lt;re&gt;  LIKE LINE OF fm_data-redefinitions.
  FIELD-SYMBOLS:
    &lt;cx&gt;   LIKE LINE OF fm_data-exceptions_texts,
    &lt;cxt&gt;  LIKE LINE OF &lt;cx&gt;-texts,
    &lt;cxl&gt;  LIKE LINE OF &lt;cx&gt;-longtexts,
    &lt;at&gt;   LIKE LINE OF fm_data-attributes.
  DATA _cx_text  LIKE LINE OF exceptions_texts.
  DATA _sotr_key TYPE sotr_conc.
  DATA _text     LIKE LINE OF _cx_text-texts.
  DATA _fm_data  TYPE t_fm_data.
  FIELD-SYMBOLS:
    &lt;desc&gt; LIKE LINE OF fm_data-class_desc,
    &lt;doc&gt;  LIKE LINE OF fm_data-documentation,
    &lt;dt&gt;   LIKE LINE OF &lt;doc&gt;-texts.
  DATA s_txt  LIKE LINE OF a0_maindata-texts.
  DATA s_key  TYPE ts_doc_key.
  a0_maindata-hdr = fm_data-class.
  obj_name = a0_maindata-clsname.
  obj_version = a0_maindata-version.
  obj_langu = a0_maindata-langu.
  obj_type = object_types-class.
  CLEAR a0_maindata-uuid.                                   &quot; Issue 59
  a0_maindata-inheritance = fm_data-inheritance.
  CLEAR a0_maindata-inheritance-clsname.
  a0_maindata-texts = fd_text( descriptions  = fm_data-class_desc
                                   classname = obj_name
                                          id = doc_ids-class-header
                               documentation = fm_data-documentation ).
  IF NOT a0_maindata-texts IS INITIAL. CLEAR a0_maindata-descript. ENDIF.
  _fm_data = fm_data.
  IF fm_data-class-category = &apos;40&apos;.  &quot; 40 Exception Class
    DELETE _fm_data-methods WHERE cmpname = &apos;CONSTRUCTOR&apos;.    &quot; Auto generated
    LOOP AT _fm_data-attributes ASSIGNING &lt;at&gt;
         WHERE attdecltyp = &apos;2&apos;   &quot; Constant
           AND locked = abap_true
           AND type = &apos;SOTR_CONC&apos;
           AND NOT attvalue IS INITIAL.
      CLEAR _cx_text.   MOVE-CORRESPONDING &lt;at&gt; TO _cx_text. &quot; Issue 71.
      READ TABLE fm_data-exceptions_texts ASSIGNING &lt;cx&gt;
           WITH TABLE KEY cmpname = _cx_text-cmpname.
      IF sy-subrc &lt;&gt; 0.
        CONTINUE.
      ENDIF.
      LOOP AT &lt;cx&gt;-texts ASSIGNING &lt;cxt&gt;.
        CLEAR _text.
        _text-langu = &lt;cxt&gt;-langu.
        _text-short_txt = &lt;cxt&gt;-text.
        READ TABLE &lt;cx&gt;-longtexts ASSIGNING &lt;cxl&gt;
             WITH KEY langu = _text-langu.
        IF sy-subrc = 0.    &quot; has long texts
          _text-long_txt-_ = &lt;cxl&gt;-text.
          REPLACE ALL OCCURRENCES OF cl_abap_char_utilities=&gt;cr_lf IN _text-long_txt-_ WITH cl_abap_char_utilities=&gt;newline.   &quot; Issue 63 : Text has CR &amp; CR+LF
        ENDIF.
        INSERT _text INTO TABLE _cx_text-texts.
      ENDLOOP.
      IF &lt;at&gt;-cmpname = a0_maindata-clsname. CLEAR _cx_text-cmpname. ENDIF.  &quot; do not repeat self exception text : Issue 64
      INSERT _cx_text INTO TABLE exceptions_texts.
      DELETE _fm_data-attributes.                 &quot; exception text no logner an attribute
    ENDLOOP.
  ENDIF.
  CALL METHOD super-&gt;from_data
    EXPORTING
      fm_data = _fm_data.
  dynpros = _fm_data-dynpros.
  menupainter = _fm_data-menupainter.
  textspool = _fm_data-textspool.
  local-types-_ = get_source( fm_data-includes-ccdef ).
  local-implementations-_ = get_source( fm_data-includes-ccimp ).
  local-macros-_ = get_source( fm_data-includes-ccmac ).
  LOOP AT fm_data-implementings ASSIGNING &lt;im&gt;
          WHERE clsname = a0_maindata-clsname.
    CLEAR _in.
    _in-hdr = &lt;im&gt;.
    LOOP AT fm_data-impl_details ASSIGNING &lt;rd&gt;
         WHERE clsname = &lt;im&gt;-clsname
           AND refclsname = &lt;im&gt;-refclsname.
      CLEAR _ia.
      _ia-hdr = &lt;rd&gt;.
      CLEAR: _ia-clsname, _ia-refclsname.
      IF &lt;rd&gt;-attvalue IS INITIAL             &quot; Component is a method
         AND &lt;rd&gt;-mtdabstrct IS INITIAL.      &quot; not abstract : with source code
        CLEAR _mk.
        _mk-clsname = &lt;rd&gt;-clsname.
        CONCATENATE &lt;rd&gt;-refclsname method_separator &lt;rd&gt;-mtdname INTO _mk-cpdname.
        READ TABLE _fm_data-includes-methods ASSIGNING &lt;m_&gt;
             WITH KEY cpdkey = _mk.
        IF sy-subrc = 0.
          _ia-source-_ = get_source( &lt;m_&gt;-incname ).
          IF NOT _ia-source-_ IS INITIAL.
            CLEAR &lt;m_&gt;. &quot; do it once : DELETE _fm_data-includes-methods. dump
          ENDIF.
        ENDIF.
        IF _ia-source-_ IS INITIAL.
          _ia-source-_ = &apos;Source code Expected&apos;(sce). &quot; to generate a compilation error on target method in order to user to investigate the reson
        ENDIF.
      ENDIF.
      INSERT _ia  INTO TABLE _in-components.
    ENDLOOP.
    CLEAR _in-clsname.
    INSERT _in INTO TABLE interfaces.
  ENDLOOP.
  LOOP AT fm_data-explore_implementings ASSIGNING &lt;ei&gt;
       WHERE NOT comprisings IS INITIAL.
    LOOP AT &lt;ei&gt;-comprisings ASSIGNING &lt;ic&gt;.
      DELETE interfaces WHERE refclsname = &lt;ic&gt;-refclsname.
    ENDLOOP.
  ENDLOOP.
  LOOP AT methods ASSIGNING &lt;me&gt;.
    _mk-clsname = a0_maindata-clsname.
    _mk-cpdname = &lt;me&gt;-cmpname.
    READ TABLE _fm_data-includes-methods ASSIGNING &lt;m_&gt;
         WITH KEY cpdkey = _mk.
    CHECK sy-subrc = 0.
    _source = get_source( &lt;m_&gt;-incname ).
    CHECK NOT _source IS INITIAL.
    &lt;me&gt;-source-_ = _source.
  ENDLOOP.
  LOOP AT fm_data-friendships ASSIGNING &lt;fr&gt;
    WHERE clsname = a0_maindata-clsname.
    CLEAR _fr.  _fr = &lt;fr&gt;.   CLEAR _fr-clsname.
    IF _fr-refclsname = a0_maindata-clsname. CLEAR _fr-refclsname. ENDIF.  &quot; do not repeat self : Issue 64
    INSERT _fr INTO TABLE friends.
  ENDLOOP.
  LOOP AT fm_data-redefinitions ASSIGNING &lt;re&gt;
       WHERE clsname = a0_maindata-clsname.
    CLEAR: _re.
    _re-hdr = &lt;re&gt;.
    _mk-clsname = &lt;re&gt;-clsname.
    _mk-cpdname = &lt;re&gt;-mtdname.
    READ TABLE fm_data-includes-methods ASSIGNING &lt;m_&gt;
         WITH KEY cpdkey = _mk.
    IF sy-subrc = 0.
      _re-source-_ = get_source( &lt;m_&gt;-incname ).
    ENDIF.
    CLEAR _re-clsname.
    INSERT _re INTO TABLE redefinitions.
  ENDLOOP.
  IF NOT redefinitions IS INITIAL.    CLEAR _dep.   _dep-type = object_types-class.   _dep-name = a0_maindata-inheritance-refclsname. INSERT _dep INTO TABLE _dependencies.   ENDIF.
  LOOP AT deferred-classes ASSIGNING &lt;dc&gt;.
    CLEAR _dep.   _dep-type = object_types-class.   _dep-name = &lt;dc&gt;-typegroup.
    INSERT _dep INTO TABLE _dependencies.
  ENDLOOP.
  LOOP AT deferred-interfaces ASSIGNING &lt;di&gt;.
    CLEAR _dep.   _dep-type = object_types-interface.   _dep-name = &lt;di&gt;-typegroup.
    INSERT _dep INTO TABLE _dependencies.
  ENDLOOP.
  clear_tags( ).
ENDMETHOD.
METHOD to_data.
  DATA _t   LIKE LINE OF a0_maindata-texts.
  DATA _ct  LIKE LINE OF fm_data-class_desc.
  DATA _in  LIKE LINE OF fm_data-implementings.
  DATA _fr  LIKE LINE OF fm_data-friendships.
  DATA _id  LIKE LINE OF fm_data-impl_details.
  DATA _ms  LIKE LINE OF fm_data-method_sources.
  DATA _at  LIKE LINE OF fm_data-attributes.
  DATA _cx  LIKE LINE OF fm_data-exceptions_texts.
  FIELD-SYMBOLS:
    &lt;cx&gt;  LIKE LINE OF exceptions_texts,
    &lt;re&gt;  LIKE LINE OF redefinitions,
    &lt;in&gt;  LIKE LINE OF interfaces,
    &lt;t&gt;   LIKE LINE OF a0_maindata-texts,
    &lt;ia&gt;  LIKE LINE OF &lt;in&gt;-components,
    &lt;ct&gt;  LIKE LINE OF &lt;cx&gt;-texts,
    &lt;fr&gt;  LIKE LINE OF friends.
  DATA _text LIKE LINE OF _cx-texts.
  DATA _cx_l LIKE LINE OF _cx-longtexts.
  DATA _cx_t LIKE LINE OF _cx-texts.
  obj_name = a0_maindata-clsname.
  obj_version = a0_maindata-version.
  obj_langu = a0_maindata-langu.
  obj_type = object_types-class.
  CALL METHOD super-&gt;to_data
    RECEIVING
      fm_data = fm_data.
  fm_data-class = a0_maindata-hdr.
  READ TABLE a0_maindata-texts INTO _t
       WITH TABLE KEY langu = a0_maindata-langu.
  IF sy-subrc = 0.
    fm_data-class-descript = _t-descript.
  ENDIF.
  fm_data-dynpros = dynpros.
  fm_data-textspool = textspool.
  fm_data-locals_def = zaplink_object=&gt;conv_abap_source2raw( local-types-_ ).
  fm_data-locals_imp = zaplink_object=&gt;conv_abap_source2raw( local-implementations-_ ).
  fm_data-locals_mac = zaplink_object=&gt;conv_abap_source2raw( local-macros-_ ).
  CALL METHOD td_text
    EXPORTING
      classname     = a0_maindata-clsname
      texts         = a0_maindata-texts
      id            = doc_ids-class-header
    CHANGING
      documentation = fm_data-documentation
      descriptions  = fm_data-class_desc.
  fm_data-inheritance = a0_maindata-inheritance.
  fm_data-inheritance-clsname = a0_maindata-clsname.
  LOOP AT interfaces ASSIGNING &lt;in&gt;.
    CLEAR _in.
    _in = &lt;in&gt;-hdr.
    _in-clsname = a0_maindata-clsname.
    INSERT _in INTO TABLE fm_data-implementings.
    LOOP AT &lt;in&gt;-components ASSIGNING &lt;ia&gt;.
      _id = &lt;ia&gt;-hdr.
      _id-clsname = _in-clsname.
      _id-refclsname = _in-refclsname .
      APPEND _id TO fm_data-impl_details.
      IF &lt;ia&gt;-attvalue IS INITIAL             &quot; Component is a method
         AND &lt;ia&gt;-mtdabstrct IS INITIAL.      &quot; not abstract : with source code
        CLEAR: _ms.
        CONCATENATE &lt;in&gt;-refclsname method_separator &lt;ia&gt;-mtdname INTO _ms-cpdname.
        _ms-redefine = abap_true.
        _ms-source = zaplink_object=&gt;conv_abap_source2raw( &lt;ia&gt;-source-_ ).
        APPEND _ms TO fm_data-method_sources.
      ENDIF.
    ENDLOOP.
  ENDLOOP.
  LOOP AT friends ASSIGNING &lt;fr&gt;.
    CLEAR _fr.
    _fr = &lt;fr&gt;.
    _fr-clsname = a0_maindata-clsname.
    IF _fr-refclsname IS INITIAL. _fr-refclsname = a0_maindata-clsname. ENDIF.  &quot; do not repeat self : Issue 64
    INSERT _fr INTO TABLE fm_data-friendships.
  ENDLOOP.
  LOOP AT redefinitions ASSIGNING &lt;re&gt;.
    CLEAR: _ms.
    &lt;re&gt;-clsname = a0_maindata-clsname.
    APPEND &lt;re&gt;-hdr TO fm_data-redefinitions.
    _ms-cpdname = &lt;re&gt;-mtdname.
    _ms-redefine = abap_true.
    _ms-source = zaplink_object=&gt;conv_abap_source2raw( &lt;re&gt;-source-_ ).
    APPEND _ms TO fm_data-method_sources.
  ENDLOOP.
  LOOP AT exceptions_texts ASSIGNING &lt;cx&gt;.
    CLEAR: _at, _cx.
    _at-clsname = a0_maindata-clsname.    _at-cmpname = &lt;cx&gt;-cmpname.     _at-editorder = &lt;cx&gt;-editorder. &quot; Issue 71.
    IF _at-cmpname IS INITIAL. _at-cmpname = a0_maindata-clsname. ENDIF.  &quot; do not repeat self exception text : Issue 64
    _at-attdecltyp = &apos;2&apos;.   &quot; Constant
    _at-exposure = &apos;2&apos;.     &quot; Public
    _at-state = &apos;1&apos;.        &quot; Implemented
    _at-locked = abap_true.
    _at-typtype = &apos;1&apos;.      &quot; Type
    _at-type = &apos;SOTR_CONC&apos;.
    CALL FUNCTION &apos;GUID_CREATE&apos;
      IMPORTING
        ev_guid_32 = _cx-concept.
    _at-attvalue = sotr2value( _cx-concept ).
    _cx-cmpname = _at-cmpname.
    SELECT SINGLE devclass INTO _cx-paket
      FROM tadir
      WHERE pgmid = &apos;R3TR&apos;
        AND object = object_types-class
        AND obj_name = a0_maindata-clsname.
    _cx-trala_type = 1.
    _cx-crea_lan = a0_maindata-langu.
    _cx-objid_vec = &apos;08000000000000000000&apos;.
    _cx-lhdr = _cx-hdr.
    LOOP AT &lt;cx&gt;-texts ASSIGNING &lt;ct&gt;.
      CLEAR: _cx_t, _cx_l.
      _cx_t-concept = _cx-concept.
      _cx_t-langu = &lt;ct&gt;-langu.
      _cx_t-flag_cntxt = abap_true.
      _cx_t-status = &apos;R&apos;.
      IF NOT &lt;ct&gt;-long_txt IS INITIAL.
        MOVE-CORRESPONDING _cx_t TO _cx_l.
        _cx_l-text = &lt;ct&gt;-long_txt-_.
        APPEND _cx_l TO _cx-longtexts.
      ENDIF.
      _cx_t-length = 255.
      _cx_t-text = &lt;ct&gt;-short_txt.
      APPEND _cx_t TO _cx-texts.
    ENDLOOP.
    IF NOT _cx-texts IS INITIAL OR NOT _cx-longtexts IS INITIAL.    INSERT _cx INTO TABLE fm_data-exceptions_texts.   ENDIF.
    IF NOT _at IS INITIAL.    INSERT _at INTO TABLE fm_data-attributes.   ENDIF.
  ENDLOOP.
  clear_tags( ).
ENDMETHOD.
METHOD complete_data.
  DATA _val TYPE seovalue.
  DATA _sotr LIKE LINE OF fm_data-exceptions_texts.
  DATA _text TYPE STANDARD TABLE OF sotr_text.
  DATA _attr_text LIKE LINE OF fm_data-component_desc.
  FIELD-SYMBOLS:
    &lt;pt&gt; LIKE LINE OF fm_data-component_desc,
    &lt;st&gt; LIKE LINE OF _sotr-texts,
    &lt;a&gt; LIKE LINE OF fm_data-attributes.
  obj_name = fm_data-class-clsname.                         &quot; Issue 23
  CALL METHOD super-&gt;complete_data
    CHANGING
      fm_data = fm_data.
  IF fm_data-class-category = &apos;40&apos;.  &quot; 40 Exception Class
    LOOP AT fm_data-attributes ASSIGNING &lt;a&gt;
         WHERE attdecltyp = &apos;2&apos;   &quot; Constant
           AND locked = abap_true
           AND type = &apos;SOTR_CONC&apos;
           AND NOT attvalue IS INITIAL.
      CLEAR _sotr. _sotr-cmpname = &lt;a&gt;-cmpname.
      _sotr-concept = value2sotr( &lt;a&gt;-attvalue ).
      SELECT SINGLE concept_2 INTO _sotr-lhdr-concept
        FROM sotr_link
        WHERE concept_1 = _sotr-concept.
      IF sy-subrc = 0.
        SELECT SINGLE * INTO _sotr-lhdr
          FROM sotr_headu
          WHERE concept = _sotr-lhdr-concept.
        SELECT * INTO TABLE _sotr-longtexts
          FROM sotr_textu
          WHERE concept = _sotr-lhdr-concept.
      ENDIF.
      CALL FUNCTION &apos;SOTR_GET_CONCEPT&apos;
        EXPORTING
          concept        = _sotr-concept
        IMPORTING
          header         = _sotr-hdr
        TABLES
          entries        = _text
        EXCEPTIONS
          no_entry_found = 1
          OTHERS         = 2.
      IF sy-subrc &lt;&gt; 0.
        CLEAR: _sotr, _val, _text.
        CONTINUE.
      ENDIF.
      _sotr-texts = _text.
      _sotr-cmpname = &lt;a&gt;-cmpname.
      INSERT _sotr INTO TABLE fm_data-exceptions_texts.
      LOOP AT _sotr-texts ASSIGNING &lt;st&gt;
           WHERE NOT text IS INITIAL.
        READ TABLE fm_data-component_desc ASSIGNING &lt;pt&gt;
             WITH KEY cmpname = &lt;a&gt;-cmpname
                        langu = &lt;st&gt;-langu.
        IF sy-subrc = 0.
          IF &lt;pt&gt;-descript IS INITIAL.
            &lt;pt&gt;-descript = &lt;st&gt;-text.
          ENDIF.
        ELSE.
          MOVE-CORRESPONDING &lt;a&gt; TO _attr_text.
          _attr_text-langu = &lt;st&gt;-langu.
          _attr_text-descript = &lt;st&gt;-text.
          INSERT _attr_text INTO TABLE fm_data-component_desc.
        ENDIF.
      ENDLOOP.
    ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD value2sotr.
  DATA _val TYPE seovalue.
  _val = data.
  REPLACE ALL OCCURRENCES OF &apos;&apos;&apos;&apos; IN _val WITH space.
  CONDENSE _val.
  result = _val.
ENDMETHOD.
METHOD SOTR2VALUE.
  concatenate &apos;&apos;&apos;&apos; data &apos;&apos;&apos;&apos; into result.
ENDMETHOD.
METHOD update_concept.
  DATA lt_types TYPE sotr_objects.
  DATA _type    LIKE LINE OF lt_types.
  DATA _paket   TYPE sotr_pack.
  DATA _entries TYPE sotr_text_tt.
  DATA _entry   LIKE LINE OF _entries.
  DATA lt_cx    TYPE tt_cx_texts.
  DATA ls_cx    LIKE LINE OF fm_data-exceptions_texts.
  FIELD-SYMBOLS:
    &lt;at&gt; LIKE LINE OF fm_data-attributes,
    &lt;cx&gt; LIKE LINE OF fm_data-exceptions_texts,
    &lt;lt&gt; LIKE LINE OF &lt;cx&gt;-longtexts.
  DATA _at     LIKE LINE OF fm_data-attributes.
  DATA concept TYPE  sotr_text-concept.
  DATA t_texts TYPE  sotr_textl_tt.
  DATA s_text  LIKE LINE OF t_texts.
  DATA s_sotrl TYPE sotr_link.
  TRY.
      LOOP AT fm_data-exceptions_texts ASSIGNING &lt;cx&gt;.
        CALL FUNCTION &apos;SOTR_OBJECT_GET_OBJECTS&apos;
          EXPORTING
            object_vector    = &lt;cx&gt;-objid_vec
          IMPORTING
            OBJECTS          = lt_types
          EXCEPTIONS
            object_not_found = 1
            OTHERS           = 2.
        IF sy-subrc &lt;&gt; 0 OR lt_types IS INITIAL.
          CALL METHOD msg_col-&gt;add_symsg( ).
          CONTINUE.
        ENDIF.
        READ TABLE lt_types INTO _type INDEX 1.
        _paket-paket = &lt;cx&gt;-paket.
        IF NOT &lt;cx&gt;-longtexts IS INITIAL.
          LOOP AT &lt;cx&gt;-longtexts ASSIGNING &lt;lt&gt;.
            CLEAR s_text. MOVE-CORRESPONDING &lt;lt&gt; TO s_text.
            APPEND s_text TO t_texts.
          ENDLOOP.
          CALL FUNCTION &apos;SOTR_STRING_CREATE_CONCEPT&apos;
            EXPORTING
              paket                               = _paket    &quot; &lt;cx&gt;-lhdr-paket
              crea_lan                            = &lt;cx&gt;-lhdr-crea_lan
              object                              = _type
              entries                             = t_texts
            IMPORTING
              concept                             = &lt;cx&gt;-lhdr-concept
            EXCEPTIONS
              package_missing                     = 1
              crea_lan_missing                    = 2
              object_missing                      = 3
              paket_does_not_exist                = 4
              alias_already_exist                 = 5
              object_type_not_found               = 6
              langu_missing                       = 7
              identical_context_not_allowed       = 8
              text_too_long                       = 9
              error_in_update                     = 10
              no_master_langu                     = 11
              error_in_concept_id                 = 12
              internal_error                      = 13
              concept_not_found                   = 14
              tadir_entry_creation_failed         = 15
              error_in_correction                 = 16
              user_cancelled                      = 17
              no_entry_found                      = 18
              alias_not_allowed                   = 19
              OTHERS                              = 20.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( subrc = sy-subrc
                                                 classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                  funcname = &apos;SOTR_STRING_CREATE_CONCEPT&apos; ).
            IF NOT msg_col IS BOUND.
              RAISE EXCEPTION o_mycx.
            ELSE.
              msg_col-&gt;add_symsg( ).
              CALL METHOD msg_col-&gt;add_exception
                EXPORTING
                  exception = o_mycx.
            ENDIF.
          ENDIF.
        ENDIF.
        _entries = &lt;cx&gt;-texts.
        MODIFY _entries FROM _entry TRANSPORTING concept WHERE concept &lt;&gt; _entry-concept.
        ls_cx = &lt;cx&gt;.
        TRY.
            CALL FUNCTION &apos;SOTR_CREATE_CONCEPT&apos;
              EXPORTING
                paket                               = _paket
                crea_lan                            = &lt;cx&gt;-crea_lan
                alias_name                          = &lt;cx&gt;-alias_name
                object                              = _type
                entries                             = _entries
                concept_default                     = &lt;cx&gt;-concept
              IMPORTING
                concept                             = ls_cx-concept
              EXCEPTIONS
                package_missing                     = 1
                crea_lan_missing                    = 2
                object_missing                      = 3
                paket_does_not_exist                = 4
                alias_already_exist                 = 5
                object_type_not_found               = 6
                langu_missing                       = 7
                identical_context_not_allowed       = 8
                text_too_long                       = 9
                error_in_update                     = 10
                no_master_langu                     = 11
                error_in_concept_id                 = 12
                alias_not_allowed                   = 13
                tadir_entry_creation_failed         = 14
                internal_error                      = 15
                error_in_correction                 = 16
                user_cancelled                      = 17
                no_entry_found                      = 18
                OTHERS                              = 19.
          CATCH cx_root.
            CALL FUNCTION &apos;SOTR_CREATE_CONCEPT&apos;
              EXPORTING
                paket                               = _paket
                crea_lan                            = &lt;cx&gt;-crea_lan
                alias_name                          = &lt;cx&gt;-alias_name
                object                              = _type
                entries                             = _entries
              IMPORTING
                concept                             = ls_cx-concept
              EXCEPTIONS
                package_missing                     = 1
                crea_lan_missing                    = 2
                object_missing                      = 3
                paket_does_not_exist                = 4
                alias_already_exist                 = 5
                object_type_not_found               = 6
                langu_missing                       = 7
                identical_context_not_allowed       = 8
                text_too_long                       = 9
                error_in_update                     = 10
                no_master_langu                     = 11
                error_in_concept_id                 = 12
                alias_not_allowed                   = 13
                tadir_entry_creation_failed         = 14
                internal_error                      = 15
                error_in_correction                 = 16
                user_cancelled                      = 17
                no_entry_found                      = 18
                OTHERS                              = 19.
        ENDTRY.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( subrc = sy-subrc
                                               classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                funcname = &apos;SOTR_CREATE_CONCEPT&apos; ).
          IF NOT msg_col IS BOUND.
            RAISE EXCEPTION o_mycx.
          ELSE.
            msg_col-&gt;add_symsg( ).
            CALL METHOD msg_col-&gt;add_exception
              EXPORTING
                exception = o_mycx.
          ENDIF.
          CONTINUE.
        ENDIF.
        IF &lt;cx&gt;-lhdr-concept &lt;&gt; ls_cx-concept AND NOT &lt;cx&gt;-lhdr-concept IS INITIAL.
          s_sotrl-concept_1 = ls_cx-concept.    &quot; FLAG_STR_1
          s_sotrl-concept_2 = &lt;cx&gt;-lhdr-concept.    s_sotrl-flag_str_2 = abap_true.
          CALL FUNCTION &apos;SOTR_LINK_UPDATE_LINK&apos;
            EXPORTING
              sotr_link         = s_sotrl
            EXCEPTIONS
              incomplete_data   = 1
              concept_not_found = 2
              OTHERS            = 3.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( subrc = sy-subrc
                                                 classname = &apos;ZAPLINK_CX_CONNECTOR&apos;
                                                  funcname = &apos;SOTR_LINK_UPDATE_LINK&apos; ).
            IF NOT msg_col IS BOUND.
              RAISE EXCEPTION o_mycx.
            ELSE.
              msg_col-&gt;add_symsg( ).
              CALL METHOD msg_col-&gt;add_exception
                EXPORTING
                  exception = o_mycx.
            ENDIF.
          ENDIF.
        ENDIF.
        _at-clsname = fm_data-class-clsname.    _at-cmpname = &lt;cx&gt;-cmpname.
        IF &lt;cx&gt;-cmpname IS INITIAL.
          READ TABLE fm_data-attributes ASSIGNING &lt;at&gt;
               WITH KEY cmpname = fm_data-class-clsname.
        ELSE.
          READ TABLE fm_data-attributes ASSIGNING &lt;at&gt;
               WITH KEY cmpname = &lt;cx&gt;-cmpname.
        ENDIF.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
             EXPORTING
               textid = ZAPLINK_CX=&gt;SYSTEM_ERROR
               cx_name = &apos;Attribut should exists !!&apos;.
        ENDIF.
        &lt;at&gt;-attvalue = sotr2value( ls_cx-concept ).
        CHECK ls_cx-concept &lt;&gt; &lt;cx&gt;-concept.
        INSERT ls_cx INTO TABLE lt_cx.
        DELETE fm_data-exceptions_texts.
      ENDLOOP.
      INSERT LINES OF fm_data-exceptions_texts INTO TABLE lt_cx.
      fm_data-exceptions_texts = lt_cx.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD anonymize.
  DATA s_fr LIKE LINE OF friends.
  DATA s_re LIKE LINE OF redefinitions.
  super-&gt;anonymize( ).
  CLEAR: a0_maindata-author, a0_maindata-createdon, a0_maindata-changedby, a0_maindata-changedon, a0_maindata-chgdanyby, a0_maindata-chgdanyon, a0_maindata-r3release,
    a0_maindata-inheritance-author, a0_maindata-inheritance-createdon, a0_maindata-inheritance-changedby, a0_maindata-inheritance-changedon, a0_maindata-inheritance-version. &quot; Issue 75
  MODIFY friends FROM s_fr TRANSPORTING author createdon changedby changedon version &quot; Issue 75
         WHERE NOT refclsname IS INITIAL OR refclsname IS INITIAL. &quot; Issue 68
  MODIFY redefinitions FROM s_re TRANSPORTING version       &quot; Issue 75
         WHERE NOT refclsname IS INITIAL OR refclsname IS INITIAL.
ENDMETHOD.
endclass. &quot;ZAPLINK_CLAS_DATA implementation
class ZAPLINK_COMPONENT_4INST implementation.
endclass. &quot;ZAPLINK_COMPONENT_4INST implementation
class ZAPLINK_CONNECTORS_4INST implementation.
endclass. &quot;ZAPLINK_CONNECTORS_4INST implementation
class ZAPLINK_DEPENDENCIES_ANALYSER implementation.
  DEFINE mac_read_tadir.
    select single devclass dlvunit into (&amp;3, &amp;4)
      from v_tralan
      where pgmid = &apos;R3TR&apos;
        and object = &amp;1
        and obj_name = &amp;2.
  END-OF-DEFINITION.
  DEFINE mac_add_comp.
    if not s_comp-type is initial and not s_comp-name is initial.
      mac_read_tadir s_comp-type s_comp-name s_comp-devclass s_comp-softcomp.
      if s_comp-devclass in packages and s_comp-softcomp in softcomponents.
        insert s_comp into table all_components.
      endif.
    endif.
  END-OF-DEFINITION.
method ADD_ATTRIBUTS.
DATA _name TYPE string.
  FIELD-SYMBOLS:
    &lt;a&gt; LIKE LINE OF attributs.
  LOOP AT attributs ASSIGNING &lt;a&gt;.
    CONCATENATE &apos;Attributs-&gt;&apos; &lt;a&gt;-cmpname INTO _name.   &quot;#EC NOTEXT
    stack( _name ).
    CALL METHOD process_type( type = &lt;a&gt;-typtype
                              name = &lt;a&gt;-type ).
    unstack( ).
  ENDLOOP.
endmethod.
METHOD ADD_CLASS_DEP.
  DATA _codes      LIKE LINE OF classes.
  DATA o_raw       TYPE to_raw.
  DATA o_data      TYPE to_class.
  DATA _component  TYPE to_component.
  DATA _key        TYPE td_name.
  DATA d_softcomp  TYPE tdevc-dlvunit.
  DATA d_devclass  TYPE tdevc-devclass.
  DATA _order      LIKE LINE OF order.
  DATA _name       TYPE td_compname.
  DATA f_before    TYPE xfeld.
  DATA d_tabix     TYPE sy-tabix.
  DATA _class      TYPE vseoclass.
  DATA s_key       TYPE seoclskey.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF circular_context,
    &lt;f&gt; LIKE LINE OF o_data-&gt;friends.
  CHECK IS_EXCLUDED_CLASS( type = &apos;CLAS&apos;  name = name ) = ABAP_false.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = name
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do
  s_key-clsname = name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = s_key
    IMPORTING
      class              = _class
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  _order-name = name.
  IF _class-category = &apos;40&apos;.    _order-type = objtype-exception_class.   ELSE.   _order-type = objtype-class.   ENDIF.
  READ TABLE context TRANSPORTING NO FIELDS
       WITH KEY context = name
                   type = _order-type.
  IF sy-subrc = 0.    &quot; Circular reference =&gt; Use defered
    stack( context = name   type = _order-type    full = full ).
    d_tabix = sy-tabix + 1.   circular_context = context.   DELETE circular_context FROM d_tabix.
    current_comp = name.    handle_context( ).        &quot; CLEAR:  circular_ref_on, circular_context.
    unstack( ).
    EXIT.
  ENDIF.
  READ TABLE classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do
  stack( context = name   type = _order-type    full = full ).
  CALL METHOD do_class
    EXPORTING
      name   = name
    EXCEPTIONS
      failed = 1
      OTHERS = 2.
  IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.
  CREATE OBJECT _component.
  _component-&gt;set_type( &apos;CLAS&apos; ).   _name = name.   _component-&gt;set_name( _name ).
  o_raw = o_object-&gt;zaplink_connector~read_from_sap( _component ).    o_data ?= o_raw-&gt;raw.
  append_typegroups( o_data-&gt;typegroups ).
  append_message( o_data-&gt;a0_maindata-msg_id ).
  IF NOT o_data-&gt;a0_maindata-inheritance-refclsname IS INITIAL.
    _key = o_data-&gt;a0_maindata-inheritance-refclsname.
    add_object_to_list( name = _key
                        full = abap_true
                      source = &apos;=&gt;inheritance-refclsname&apos; ).
  ENDIF.
  CALL METHOD add_types( o_data-&gt;types ).
  CALL METHOD add_interfaces( o_data-&gt;interfaces ).
  CALL METHOD add_attributs( o_data-&gt;attributs ).
  CALL METHOD add_methods( o_data-&gt;methods ).
  LOOP AT o_data-&gt;friends ASSIGNING &lt;f&gt;.
    _key = &lt;f&gt;-refclsname.    CALL METHOD add_object_to_list( name = _key   SOURCE = &apos;=&gt;friends&apos; ).
  ENDLOOP.
  do_object_list( name = name ).
  unstack( ).
  insert_order( s_order = _order   context = context ).
ENDMETHOD.
METHOD ADD_DEFERED_OK.
  TYPES:
    BEGIN OF ts_dep,
      ori_name  TYPE td_name,
      type      TYPE td_classtype,    &quot; 0 Class 1 interface
      full_def  TYPE flag,          &quot; Full definition required
      count     TYPE i,
    END OF ts_dep.
  DATA t_tmp     TYPE STANDARD TABLE OF ts_dep WITH DEFAULT KEY.
  DATA s_dep     LIKE LINE OF t_tmp.
  DATA t_deps    TYPE SORTED TABLE OF ts_dep WITH UNIQUE KEY ori_name TYPE full_def.
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF requirements,
    &lt;c&gt; LIKE LINE OF remain_classes.
  LOOP AT requirements ASSIGNING &lt;r&gt;.
    CLEAR s_dep.    MOVE-CORRESPONDING &lt;r&gt; TO s_dep.    s_dep-count = 1.
    COLLECT s_dep INTO t_tmp.
  ENDLOOP.
  t_deps = t_tmp.
  LOOP AT remain_classes ASSIGNING &lt;c&gt;.
    LOOP AT t_deps INTO s_dep
         WHERE ori_name = &lt;c&gt;-name
           AND (   type = objtype-exception_class   &quot; Exception are full required
            OR full_def = abap_true ).
      EXIT.
    ENDLOOP.
    IF sy-subrc &lt;&gt; 0.   clear s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    result = abap_true.   DELETE remain_classes.    ENDIF.
  ENDLOOP.
  add_without_requirements( ).
ENDMETHOD.
METHOD ADD_DEFERRED_CODE.
  DATA _obj      LIKE LINE OF deferred_declaration.
  DATA _line     LIKE LINE OF abapcode.
  READ TABLE deferred_declaration TRANSPORTING NO FIELDS
       WITH TABLE KEY name = name.
  IF sy-subrc = 0.
    EXIT.
  ENDIF.
  CASE type.
    WHEN objtype-class OR objtype-exception_class.
      CONCATENATE &apos;CLASS&apos; name &apos;DEFINITION DEFERRED.&apos; INTO _line SEPARATED BY space.
      APPEND _line TO abapcode.
      _obj-name = name.
      INSERT _obj INTO TABLE deferred_declaration.
    WHEN objtype-interface.
      CONCATENATE &apos;INTERFACE&apos; name &apos;DEFERRED.&apos; INTO _line SEPARATED BY space.
      APPEND _line TO abapcode.
      _obj-name = name.
      INSERT _obj INTO TABLE deferred_declaration.
  ENDCASE.
ENDMETHOD.
METHOD ADD_INTERFACES.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF interfaces.
  LOOP AT interfaces ASSIGNING &lt;i&gt;.
    _key = &lt;i&gt;-refclsname.
    add_object_to_list( name = _key
                        full = abap_true
                      source = &apos;=&gt;interface&apos; ).
  ENDLOOP.
ENDMETHOD.
METHOD ADD_INTERFACE_DEP.
  DATA _codes      LIKE LINE OF classes.
  DATA o_raw       TYPE to_raw.
  DATA o_data      TYPE to_interface.
  DATA _component  TYPE zaplink_connector=&gt;to_component.
  DATA d_softcomp  TYPE tdevc-dlvunit.
  DATA d_devclass  TYPE tdevc-devclass.
  DATA _order      LIKE LINE OF order.
  DATA _name       TYPE zaplink_connector=&gt;td_compname.
  DATA d_tabix     TYPE sy-tabix.
  CHECK IS_EXCLUDED_CLASS( type = &apos;INTF&apos;  name = name ) = ABAP_false.
  _order-name = name.   _order-type = objtype-interface.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = _order-name
                type = _order-type
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do
  READ TABLE context TRANSPORTING NO FIELDS
       WITH KEY context = name
                   type = _order-type.
  IF sy-subrc = 0.      &quot; Circular reference =&gt; Use defered
    stack( context = name   type = _order-type    full = full ).
    d_tabix = sy-tabix + 1.   circular_context = context.   DELETE circular_context FROM d_tabix.
    current_comp = name.    handle_context( ).        &quot; CLEAR:  circular_ref_on, circular_context.
    unstack( ).
    EXIT.
  ENDIF.
  READ TABLE classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do
  stack( context = name   type = _order-type    full = full ).
  CALL METHOD do_class
    EXPORTING
      name   = name
    EXCEPTIONS
      failed = 1
      OTHERS = 2.
  IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.
  CREATE OBJECT _component.
  _component-&gt;set_type( &apos;INTF&apos; ).   _name = name.   _component-&gt;set_name( _name ).
  o_raw = o_object-&gt;zaplink_connector~read_from_sap( _component ).
  o_data ?= o_raw-&gt;raw.
  append_typegroups( o_data-&gt;typegroups ).
  CALL METHOD add_types( o_data-&gt;types ).
  CALL METHOD add_interfaces( o_data-&gt;interfaces ).
  CALL METHOD add_attributs( o_data-&gt;attributs ).
  CALL METHOD add_methods( o_data-&gt;methods ).
  do_object_list( name = name ).
  unstack( ).
  insert_order( s_order = _order   context = context ).
ENDMETHOD.
METHOD ADD_METHODS.
  DATA _name       TYPE string.
  DATA t_objs      TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objs,
    &lt;m&gt; LIKE LINE OF methods,
    &lt;p&gt; LIKE LINE OF &lt;m&gt;-parameters,
    &lt;e&gt; LIKE LINE OF &lt;m&gt;-exceptions.
  LOOP AT methods ASSIGNING &lt;m&gt;.
    CONCATENATE &apos;Method-&gt;&apos; &lt;m&gt;-cmpname INTO _name.    &quot;#EC NOTEXT
    stack( _name ).
    LOOP AT &lt;m&gt;-parameters ASSIGNING &lt;p&gt;.
      CALL METHOD process_type( type = &lt;p&gt;-typtype
                                name = &lt;p&gt;-type ).
    ENDLOOP.
    IF NOT &lt;m&gt;-mtdnewexc IS INITIAL.
      LOOP AT &lt;m&gt;-exceptions ASSIGNING &lt;e&gt;.
        _key = &lt;e&gt;-sconame.   add_object_to_list( name = _key   source = _name ).
      ENDLOOP.
    ENDIF.
    add_source_to_list( code = &lt;m&gt;-source-_   source = _name ).
    unstack( ).
  ENDLOOP.
ENDMETHOD.
METHOD ADD_METHOD_SOURCE.
  DATA ref_objs    TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF ref_objs.
  CHECK NOT code IS INITIAL.
  ref_objs = analyse_method_source( code ).
  LOOP AT ref_objs ASSIGNING &lt;o&gt;.
    _key = &lt;o&gt;.
    CALL METHOD add_object
      EXPORTING
        name         = _key
      EXCEPTIONS
        failed       = 1
        exists       = 2
        not_existing = 3
        OTHERS       = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD ADD_OBJECT.
  DATA _key   TYPE seoclskey.
  DATA o_type TYPE seoclstype.
  DATA o_desc TYPE REF TO cl_abap_typedescr.
  DATA _name  TYPE td_name.
  DATA _class TYPE vseoclass.
  _name = name. TRANSLATE _name TO UPPER CASE.            &quot;#EC SYNTCHAR
  CALL FUNCTION &apos;SEO_CLIF_CHECK_NAME&apos;
    EXPORTING
      clsname                   = _name
    EXCEPTIONS
      reserved                  = 1
      space_not_allowed         = 2
      small_letters_not_allowed = 3
      symbols_not_allowed       = 4
      first_character_no_number = 5
      namespace_error           = 6
      OTHERS                    = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  CALL METHOD cl_abap_typedescr=&gt;describe_by_name
    EXPORTING
      p_name         = _name
    RECEIVING
      p_descr_ref    = o_desc
    EXCEPTIONS
      type_not_found = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    RAISE not_existing.
  ENDIF.
  CHECK o_desc-&gt;kind = cl_abap_typedescr=&gt;kind_class
     OR o_desc-&gt;kind = cl_abap_typedescr=&gt;kind_intf.
  _key-clsname = _name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = _key
    IMPORTING
      clstype            = o_type
      class              = _class
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    CHECK _key &lt;&gt; &apos;OBJECT&apos;. &quot; reserved word
    RAISE not_existing.
  ENDIF.
  IF o_type &lt;&gt; objtype-class AND o_type &lt;&gt; objtype-interface.
    RAISE failed.
  ENDIF.
  IF o_type = objtype-class.
    add_class_dep( _name ).
  ELSE.
    add_interface_dep( _name ).
  ENDIF.
  IF context IS INITIAL.
    CALL METHOD _clean_up( ).
  ENDIF.
ENDMETHOD.
METHOD ADD_OBJECT_TO_LIST.
  DATA s_obj       LIKE LINE OF required_objects.
  DATA s_key       TYPE seoclskey.
  DATA o_type      TYPE seoclstype.
  DATA s_class     TYPE vseoclass.
  s_key-clsname = name.   TRANSLATE s_key-clsname TO UPPER CASE.    s_obj-name = s_key-clsname.
  CHECK is_excluded_class( name = s_key-clsname ) = abap_false.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = s_key
    IMPORTING
      clstype            = o_type
      class              = s_class
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    EXIT.
  ENDIF.
  s_obj-type = o_type.    s_obj-full_def = full.    s_obj-source = source.
  IF s_class-category = &apos;40&apos;.    s_obj-type = objtype-exception_class.   ENDIF.
  APPEND s_obj TO required_objects.
ENDMETHOD.
method ADD_SOURCE.
  DATA _code TYPE string.
  FIELD-SYMBOLS:
    &lt;f&gt; LIKE LINE OF code.
  LOOP AT code ASSIGNING &lt;f&gt;.   CONCATENATE _code &lt;f&gt; line_separator INTO _code.    ENDLOOP.
  add_method_source( _code ).
endmethod.
METHOD ADD_SOURCE_TO_LIST.
  DATA t_objs      TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objs.
  t_objs = analyse_method_source( code ).
  LOOP AT t_objs ASSIGNING &lt;o&gt;.
    _key = &lt;o&gt;.   add_object_to_list( name = _key   source = source ).
  ENDLOOP.
ENDMETHOD.
method ADD_TYPES.
DATA _name TYPE string.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF types.
  LOOP AT types ASSIGNING &lt;t&gt;.
    CONCATENATE &apos;Type=&gt;&apos; &lt;t&gt;-cmpname INTO _name.    &quot;#EC NOTEXT
    stack( _name ).
    CALL METHOD process_type( type = &lt;t&gt;-typtype
                              name = &lt;t&gt;-type
                            SOURCE = &lt;t&gt;-_ ).
    unstack( ).
  ENDLOOP.
endmethod.
METHOD ADD_WITHOUT_REQUIREMENTS.
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS &lt;c&gt; LIKE LINE OF remain_classes.
  LOOP AT remain_classes ASSIGNING &lt;c&gt;.
    READ TABLE requirements TRANSPORTING NO FIELDS
         WITH KEY ori_name = &lt;c&gt;-name.
    IF sy-subrc &lt;&gt; 0.   clear s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    result = abap_true.   DELETE remain_classes.    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD ANALYSE_METHOD_SOURCE.
  DATA static_objs TYPE td_sourcecode.
  DATA _code       TYPE string.
  CHECK NOT code IS INITIAL.
  _code = convert_line( code ).
  objects_list = extract_strings(
      forward     = &apos;X&apos;
      search_term = &apos;TYPE REF TO &apos;
      code        = _code
      ).
  static_objs = extract_strings(
      search_term = &apos;=&gt;&apos;
      code        = _code
      ).
  APPEND LINES OF static_objs TO objects_list.
  SORT objects_list.
  DELETE ADJACENT DUPLICATES FROM objects_list.
ENDMETHOD.
METHOD APPEND_MESSAGE.
  DATA s_msg LIKE LINE OF messages.
  check not data is INITIAL.
  s_msg-name = data.    APPEND s_msg TO messages.
ENDMETHOD.
METHOD APPEND_TYPEGROUPS.
  DATA _tg LIKE LINE OF me-&gt;typegroups.
  FIELD-SYMBOLS &lt;t&gt; LIKE LINE OF typegroups.
  LOOP AT typegroups ASSIGNING &lt;t&gt;.
    _tg-name = &lt;t&gt;-typegroup.
    APPEND _tg TO me-&gt;typegroups.
  ENDLOOP.
ENDMETHOD.
method CLASS_CONSTRUCTOR.
  DATA _softcomp LIKE LINE OF softcomponents.
  _softcomp-sign = &apos;I&apos;. _softcomp-option = &apos;EQ&apos;.
  _softcomp-low = space. APPEND _softcomp TO softcomponents.
  _softcomp-low = &apos;HOME&apos;. APPEND _softcomp TO softcomponents.
  _softcomp-low = &apos;LOCAL&apos;. APPEND _softcomp TO softcomponents.
  CREATE OBJECT o_object.
endmethod.
METHOD CLEAN_CODE.
  result = code.
  DELETE result WHERE table_line IS INITIAL. &quot; DELETE result WHERE table_line = space.
ENDMETHOD.
METHOD CONVERT_LINE.
  target = zaplink_tools=&gt;conv_abap_line( source ).
ENDMETHOD.
METHOD CONVERT_SOURCE.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF targetcode.
  targetcode = sourcecode.
  LOOP AT targetcode ASSIGNING &lt;l&gt;.
    IF &lt;l&gt; IS INITIAL. DELETE targetcode. CONTINUE. ENDIF.  &quot; Condense
    IF &lt;l&gt;(1) = &apos;*&apos;.   DELETE targetcode. CONTINUE. ENDIF.  &quot; Condense
    &lt;l&gt; = convert_line( &lt;l&gt; ).
  ENDLOOP.
ENDMETHOD.
method CONVERT_SOURCE_UPCASE.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF targetcode.
  targetcode = sourcecode.
  LOOP AT targetcode ASSIGNING &lt;l&gt;.
    TRANSLATE &lt;l&gt; TO UPPER CASE.  &quot;#EC SYNTCHAR
  ENDLOOP.
endmethod.
METHOD DO_CLASS.
  DATA _codes      LIKE LINE OF classes.
  TRY.
      _codes = get_source( name ).
    CATCH cx_root.
      RAISE failed.
  ENDTRY.
  search_for_include( CHANGING codes = _codes ).
  INSERT _codes INTO TABLE classes.
ENDMETHOD.
METHOD DO_OBJECT_LIST.
  CONSTANTS c_intftype TYPE td_classtype VALUE &apos;9&apos;.
  DATA t_objects TYPE tt_req_objects.
  DATA s_object  LIKE LINE OF required_objects.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objects.
  SORT required_objects BY name full_def DESCENDING.   DELETE ADJACENT DUPLICATES FROM required_objects COMPARING name.
  s_object-type = c_intftype.    MODIFY required_objects FROM s_object TRANSPORTING type WHERE type = objtype-interface.   SORT required_objects BY full_def DESCENDING type DESCENDING name.
  t_objects = required_objects.    CLEAR required_objects.   &quot; memorize object list for recursive calls
  LOOP AT t_objects ASSIGNING &lt;o&gt;.
    stack( context = &lt;o&gt;-source ).    &lt;o&gt;-ori_name = name.    APPEND &lt;o&gt; TO requirements.
    IF &lt;o&gt;-type = c_intftype.   add_interface_dep( name = &lt;o&gt;-name  full = &lt;o&gt;-full_def ).    ELSE.   add_class_dep( name = &lt;o&gt;-name  full = &lt;o&gt;-full_def ).    ENDIF.
    unstack( ).
  ENDLOOP.
ENDMETHOD.
METHOD EXTRACT_STRINGS.
  CONSTANTS:
    c_crlf TYPE string VALUE line_separator,
    c_commentedline TYPE string VALUE &apos;*&apos;,
    c_commentscheme TYPE string VALUE &apos;*&quot;*&apos;,
    c_commentchar TYPE string VALUE &apos;&quot;&apos;.
  DATA _objects    TYPE STANDARD TABLE OF string WITH DEFAULT KEY.
  DATA _max        TYPE sy-tabix.
  DATA _pos        TYPE sy-tabix.
  DATA _idx        TYPE sy-tabix.
  DATA _lines      TYPE STANDARD TABLE OF string WITH DEFAULT KEY.
  DATA _line       TYPE string.
  DATA _tmp        TYPE string.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF _objects,
    &lt;l2&gt; LIKE LINE OF _objects.
  DEFINE mac_split.
    split _line at &amp;1 into table _lines. &quot; split line into words
    check not _lines is initial.
    read table _lines into _line index 1.
  END-OF-DEFINITION.
  CHECK search_term &lt;&gt; c_crlf.
  IF forward IS INITIAL.
    SPLIT code AT search_term INTO TABLE _objects.
    CHECK NOT _objects IS INITIAL.
    _pos = LINES( _objects ).
    DELETE _objects INDEX _pos.  &quot; remove last line (unwanted) because backward search
    LOOP AT _objects ASSIGNING &lt;l&gt;.
      SPLIT &lt;l&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
      WHILE NOT _lines IS INITIAL.
        _pos = LINES( _lines ).
        READ TABLE _lines INTO _line INDEX _pos.
        _tmp = _line.
        CONDENSE _tmp NO-GAPS.
        IF NOT _tmp IS INITIAL.
          EXIT.
        ENDIF.
        DELETE _lines INDEX _pos.  &quot; empty line
      ENDWHILE.
      CHECK _line(1) &lt;&gt; c_commentedline.      &quot; code line is a comment
      CHECK NOT _line CP c_commentscheme.     &quot; Check line for line comment
      SPLIT _line AT space INTO TABLE _lines. &quot; split line into words
      _pos = LINES( _lines ).
      READ TABLE _lines INTO _line INDEX _pos.
      APPEND _line TO results.
    ENDLOOP.
  ELSE.
    SPLIT code AT search_term INTO TABLE _objects.
    CHECK NOT _objects IS INITIAL.
    _max = LINES( _objects ) - 1.
    LOOP AT _objects ASSIGNING &lt;l&gt; TO _max.
      _idx = sy-tabix.
      SPLIT &lt;l&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
      _pos = LINES( _lines ).
      READ TABLE _lines INTO _line INDEX _pos.
      IF NOT _line IS INITIAL.
        CHECK _line(1) &lt;&gt; c_commentedline.        &quot; code line is a comment =&gt; ignore
        CHECK NOT _line CP c_commentscheme.       &quot; Check line for line comment
      ENDIF.
      ADD 1 TO _idx.
      READ TABLE _objects ASSIGNING &lt;l2&gt; INDEX _idx.
      SPLIT &lt;l2&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
      DELETE _lines WHERE table_line IS INITIAL.
      LOOP AT _lines ASSIGNING &lt;l2&gt;.
        IF &lt;l2&gt;(1) = c_commentedline.
          DELETE _lines.
        ENDIF.
      ENDLOOP.
      LOOP AT _lines INTO _line.
        CLEAR _pos.
        FIND FIRST OCCURRENCE OF c_commentchar IN _line MATCH OFFSET _pos.
        IF NOT _pos IS INITIAL.
          _line = _line(_pos).      &quot; remove comment
        ENDIF.
        _tmp = _line.
        CONDENSE _tmp NO-GAPS.
        IF NOT _tmp IS INITIAL.
          EXIT.
        ENDIF.
      ENDLOOP.
      CONDENSE _line.
      CHECK NOT _line IS INITIAL.
      mac_split space. mac_split &apos;,&apos;. mac_split &apos;.&apos;.
      APPEND _line TO results.
    ENDLOOP.
  ENDIF.
  SORT results.
  DELETE ADJACENT DUPLICATES FROM results.
  DELETE results WHERE table_line IS INITIAL.
ENDMETHOD.
METHOD GET_CLASS_SOURCE.
  DATA o_source    TYPE REF TO cl_oo_source.
  DATA _clskey     TYPE seoclskey.
  DATA _pos        TYPE sy-tabix.
  DATA t_code      TYPE td_sourcecode.
  DATA t_upcode    TYPE td_sourcecode.
  DATA t_lines     TYPE td_sourcecode.
  DATA _line       LIKE LINE OF t_upcode.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_upcode.
  _clskey = name.
  CREATE OBJECT o_source
    EXPORTING
      clskey             = _clskey
    EXCEPTIONS
      class_not_existing = 1
      OTHERS             = 2.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  t_code = convert_source( o_source-&gt;source ).
  t_upcode = convert_source_upcase( t_code ).
  CLEAR o_source.
  CONCATENATE &apos;CLASS&apos; _clskey &apos;DEFINITION&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc = 0.
    _pos = sy-tabix.
    APPEND LINES OF t_code FROM _pos TO t_lines.
    SUBTRACT 1 FROM _pos.
    IF _pos &gt;= 1. DELETE t_upcode TO _pos. ENDIF.
    READ TABLE t_upcode INDEX 2 INTO _line.
    CONDENSE _line NO-GAPS.
    IF _line = &apos;PUBLIC&apos;.
      DELETE t_lines INDEX 2.
      DELETE t_upcode INDEX 2.
    ENDIF.
  ELSE.
    t_lines = t_code.
  ENDIF.
  CONCATENATE &apos;CLASS&apos; _clskey &apos;IMPLEMENTATION.&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc = 0.
    _pos = sy-tabix.
    APPEND LINES OF t_lines  FROM _pos TO codes-impl.
    DELETE t_lines FROM _pos.
    DELETE t_upcode FROM _pos.
    CONCATENATE &apos;ENDCLASS. &quot;&apos; _clskey &apos; DEFINITION&apos; INTO _line.
    READ TABLE t_upcode TRANSPORTING NO FIELDS
         FROM _line.
    IF sy-subrc &lt;&gt; 0.
      RAISE failed.
    ENDIF.
    _pos = sy-tabix.
    APPEND LINES OF t_lines TO _pos TO codes-def.
    DELETE t_lines TO _pos.
    DELETE t_upcode to _pos.
    codes-macro = t_lines.
  ELSE.
    codes-def = t_lines.
  ENDIF.
  t_upcode = convert_source_upcase( codes-def ).
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*GLOBAL FRIENDS*&apos;.
    REPLACE FIRST OCCURRENCE OF &apos;GLOBAL FRIENDS&apos; IN &lt;l&gt; WITH &apos;FRIENDS&apos;.
    modify codes-def from &lt;l&gt; index sy-tabix.
  ENDLOOP.
  remove_def_load( CHANGING codes = codes ).
  codes-name = name.
ENDMETHOD.
method GET_INTERFACE_SOURCE.
  DATA _key    TYPE seoclsname.
  DATA _prog   TYPE program.
  DATA _line   LIKE LINE OF codes-def.
  DATA _pos        TYPE sy-tabix.
  DATA t_upcode    TYPE td_sourcecode.
  _key = name.
  _prog = cl_oo_classname_service=&gt;get_intfsec_name( _key ).
  READ REPORT _prog INTO codes-def.
  codes-def = convert_source( codes-def ).
  t_upcode = convert_source_upcase( codes-def ).
  CONCATENATE &apos;INTERFACE&apos; _key INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  _pos = sy-tabix.
  CONCATENATE _line &apos;.&apos; INTO _line.
  MODIFY codes-def FROM _line INDEX _pos.
  ADD 1 TO _pos.
  READ TABLE t_upcode INTO _line INDEX _pos.
  CONDENSE _line NO-GAPS.
  IF _line = &apos;PUBLIC.&apos;.
    DELETE codes-def INDEX _pos.
  ENDIF.
  remove_def_load( CHANGING codes = codes ).
  codes-name = name.
endmethod.
METHOD GET_SOURCE.
  DATA _key   TYPE seoclskey.
  DATA o_type TYPE seoclstype.
  DATA _class      TYPE vseoclass.
  _key-clsname = name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = _key
    IMPORTING
      clstype            = o_type
      class              = _class
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  IF o_type &lt;&gt; objtype-class AND o_type &lt;&gt; objtype-interface.
    RAISE failed.
  ENDIF.
  IF o_type = objtype-class.
    IF _class-category = &apos;40&apos;.    o_type = objtype-exception_class.   ENDIF.
    codes = get_class_source( name ).
  ELSE.
    codes = get_interface_source( name ).
  ENDIF.
  codes-type = o_type.
ENDMETHOD.
METHOD HANDLE_CONTEXT.
  TYPES:
    BEGIN OF ts_object,
      name  TYPE td_name,
      type  TYPE seoclstype,
      rank  TYPE i,
      tabix TYPE sy-tabix,
      full  TYPE abap_bool,
    END OF ts_object.
  DATA t_objects TYPE STANDARD TABLE OF ts_object WITH DEFAULT KEY.
  DATA s_object  LIKE LINE OF t_objects.
  DATA s_key     TYPE seoclskey.
  DATA d_type    TYPE seoclstype.
  DATA s_class   TYPE vseoclass.
  DATA s_order   LIKE LINE OF order.
  DATA d_tabix   TYPE sy-tabix.
  DATA s_ctx     LIKE LINE OF circular_context.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objects,
    &lt;c&gt; LIKE LINE OF circular_context.
  DELETE circular_context WHERE type IS INITIAL.
  LOOP AT circular_context ASSIGNING &lt;c&gt;.
    CLEAR s_object.   s_object-tabix = sy-tabix.    s_object-name = &lt;c&gt;-context.    s_object-type = &lt;c&gt;-type.   s_object-full = &lt;c&gt;-full_def.
    IF s_object-type = objtype-interface.    s_object-rank = 1.    ELSEIF s_object-type = objtype-exception_class.   s_object-rank = 2.  s_object-type = objtype-exception_class.    ELSE.   s_object-rank = 3.    ENDIF.
    IF s_object-full IS INITIAL.
      ADD 5 TO s_object-rank.
    ENDIF.
    APPEND s_object TO t_objects.
  ENDLOOP.
  SORT t_objects BY name tabix.   DELETE ADJACENT DUPLICATES FROM t_objects COMPARING name.
  IF LINES( t_objects ) = 1.    DELETE t_objects WHERE name = current_comp.   ENDIF.
  CHECK NOT t_objects IS INITIAL.   SORT t_objects BY rank tabix.   d_tabix = LINES( order ) + 1.   REFRESH circular_context.
  LOOP AT t_objects ASSIGNING &lt;o&gt;.    CLEAR s_ctx.    s_ctx-context = &lt;o&gt;-name.   s_ctx-type = &lt;o&gt;-type.    s_ctx-full_def = &lt;o&gt;-full.    APPEND s_ctx TO circular_context.   ENDLOOP.
  LOOP AT me-&gt;context ASSIGNING &lt;c&gt; WHERE NOT type IS INITIAL.
    READ TABLE t_objects TRANSPORTING NO FIELDS WITH KEY name = &lt;c&gt;-context.
    IF sy-subrc &lt;&gt; 0.
      APPEND &lt;c&gt; TO circular_context.
    ENDIF.
  ENDLOOP.
  LOOP AT t_objects ASSIGNING &lt;o&gt;.
    CALL METHOD do_class
      EXPORTING
        name   = &lt;o&gt;-name
      EXCEPTIONS
        failed = 1
        OTHERS = 2.
    IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.
    CLEAR s_order.  s_order-name = &lt;o&gt;-name.    s_order-type = &lt;o&gt;-type.
    insert_order( s_order = s_order   context = circular_context ).   DELETE circular_context WHERE context = &lt;o&gt;-name.   &quot; &lt;=&gt; should delete index 1.
  ENDLOOP.
  CLEAR: circular_context, circular_ref_on.
ENDMETHOD.
METHOD INSERT_ORDER.
  DATA d_tabix TYPE sy-tabix.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF context.
  DELETE context WHERE type IS INITIAL.   DELETE context WHERE context = s_order-name.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = s_order-name
                type = s_order-type
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed : circular ref
  IF context IS INITIAL.    APPEND s_order TO me-&gt;order.    EXIT.   ENDIF.
  inverse_order( CHANGING order = context ).
  LOOP AT context ASSIGNING &lt;c&gt; WHERE full_def = abap_true.
    READ TABLE order TRANSPORTING NO FIELDS
         WITH KEY name = &lt;c&gt;-context
                  type = &lt;c&gt;-type
               defered = abap_false.
    IF sy-subrc = 0 AND d_tabix &gt; sy-tabix.
      d_tabix = sy-tabix.
    ENDIF.
  ENDLOOP.
  IF d_tabix IS INITIAL.
    d_tabix = LINES( order ) + 1.
    LOOP AT context ASSIGNING &lt;c&gt; WHERE full_def = abap_false.
      READ TABLE order TRANSPORTING NO FIELDS
           WITH KEY name = &lt;c&gt;-context
                    type = &lt;c&gt;-type
                 defered = abap_false.
      IF sy-subrc = 0 AND d_tabix &gt; sy-tabix.
        d_tabix = sy-tabix.
      ENDIF.
    ENDLOOP.
  ENDIF.
  INSERT s_order INTO me-&gt;order INDEX d_tabix.
  READ TABLE order TRANSPORTING NO FIELDS   &quot; for security
       WITH KEY name = s_order-name
                type = s_order-type
             defered = abap_false.
  IF sy-subrc &lt;&gt; 0.
    APPEND s_order TO me-&gt;order.
  ENDIF.
ENDMETHOD.
METHOD inverse_order.
  zaplink_tools=&gt;inverse_table_order( CHANGING my_table = order ).
ENDMETHOD.
METHOD IS_EXCLUDED_CLASS.
  DATA s_excl_c    LIKE LINE OF excluded_classes.
  clear s_comp.   result = abap_true.   READ TABLE excluded_classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.    CHECK sy-subrc &lt;&gt; 0.
  IF NOT type IS INITIAL.   mac_read_tadir type name s_comp-devclass s_comp-softcomp.
  ELSE.   mac_read_tadir &apos;CLAS&apos; name s_comp-devclass s_comp-softcomp.
  IF sy-subrc &lt;&gt; 0. mac_read_tadir &apos;INTF&apos; name s_comp-devclass s_comp-softcomp.
  ENDIF. ENDIF.
  IF s_comp-devclass IN packages AND s_comp-softcomp IN softcomponents.    result = abap_false.    ELSE.   s_excl_c-name = name.   INSERT s_excl_c INTO TABLE excluded_classes.    ENDIF.
ENDMETHOD.
METHOD PROCESS_TYPE.
  DATA _key        TYPE td_name.
  DATA _obj        TYPE string.
  DATA _type       TYPE string.
  DATA _up_src     TYPE string.
  DATA ctx         LIKE LINE OF context.
  data full        type abap_bool.
  _up_src = source.   TRANSLATE _up_src TO UPPER CASE.
  READ TABLE context INTO ctx INDEX 1.
  CASE type.
    WHEN typetype-like OR typetype-type.
      SPLIT name AT &apos;=&gt;&apos; INTO _obj _type.
      CHECK _type &lt;&gt; &apos;&apos;.
      _key = _obj.  full = abap_true.
    WHEN typetype-otype.
      _key = name.
    WHEN typetype-ref.
      _key = name.
    WHEN typetype-code.
      add_source_to_list( code = _up_src   source = ctx-context ).
      CLEAR _key.   EXIT.
  ENDCASE.
  CHECK NOT _key IS INITIAL.
  add_object_to_list( name = _key   full = full   source = ctx-context ).
ENDMETHOD.
METHOD REMOVE_DEF_LOAD.
  DATA t_upcode    TYPE td_sourcecode.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_upcode,
    &lt;m&gt; LIKE LINE OF codes-def.
  t_upcode = convert_source_upcase( codes-def ).
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*CLASS * DEFINITION LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*CLASS * DEFINITION LOAD*&apos;.
    READ TABLE codes-def ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*INTERFACE * LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*INTERFACE * LOAD*&apos;.
    READ TABLE codes-def ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.
  t_upcode = convert_source_upcase( codes-macro ).
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*CLASS * DEFINITION LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*CLASS * DEFINITION LOAD*&apos;.
    READ TABLE codes-macro ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*INTERFACE * LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*INTERFACE * LOAD*&apos;.
    READ TABLE codes-macro ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.
ENDMETHOD.
METHOD RESOLVE.
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF new_order,
    &lt;c&gt; LIKE LINE OF classes.
  _clean_up( ).
  remain_classes = classes.
  WHILE add_without_requirements( ) = abap_true.  ENDWHILE.
  WHILE add_defered_ok( ) = abap_true.  ENDWHILE.
  IF requirements IS INITIAL.
    LOOP AT remain_classes ASSIGNING &lt;c&gt;.   CLEAR s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    DELETE remain_classes.    ENDLOOP.
    order = new_order.
  ELSE.
    LOOP AT new_order ASSIGNING &lt;o&gt;.    WRITE:/ &lt;o&gt;-name.   ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD SEARCH_FOR_INCLUDE.
  DATA t_includes TYPE td_sourcecode.
  DATA d_softcomp TYPE tdevc-dlvunit.
  DATA d_devclass TYPE tdevc-devclass.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF t_includes,
    &lt;l&gt; LIKE LINE OF codes-macro.
  LOOP AT codes-macro ASSIGNING &lt;l&gt;.
    t_includes = extract_strings(
        forward     = abap_true
        search_term = &apos;INCLUDE &apos;
        code        = &lt;l&gt;
        ).
    IF NOT t_includes IS INITIAL.
      LOOP AT t_includes ASSIGNING &lt;i&gt;.
        SELECT SINGLE devclass dlvunit INTO (d_devclass, d_softcomp)
          FROM v_tralan
          WHERE pgmid = &apos;R3TR&apos;
            AND object = &apos;PROG&apos;
            AND obj_name = &lt;i&gt;.
        CHECK d_devclass IN packages.
        CHECK d_softcomp IN softcomponents. &quot; customer components
        APPEND &lt;i&gt; TO includes.
      ENDLOOP.
      DELETE codes-macro.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD SOURCE_2_STRING.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF data.
  LOOP AT data ASSIGNING &lt;l&gt;.
    IF result IS INITIAL.
      result = &lt;l&gt;.
    ELSE.
      CONCATENATE result line_separator &lt;l&gt; INTO result.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD STACK.
  DATA s_ctx LIKE LINE OF context.
  s_ctx-context = context.   s_ctx-type = type.    s_ctx-full_def = full.   INSERT s_ctx INTO me-&gt;context INDEX 1.
ENDMETHOD.
METHOD UNSTACK.
  IF NOT context IS INITIAL. DELETE context INDEX 1. ENDIF.
  IF context IS INITIAL. CLEAR: circular_ref_on, circular_context. ENDIF.
ENDMETHOD.
METHOD _CLEAN_UP.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF requirements,
    &lt;c&gt; LIKE LINE OF classes,
    &lt;i&gt; LIKE LINE OF includes,
    &lt;t&gt; LIKE LINE OF typegroups,
    &lt;m&gt; LIKE LINE OF messages.
  SORT requirements BY ori_name name full_def.    DELETE ADJACENT DUPLICATES FROM requirements COMPARING ori_name name full_def.
  LOOP AT requirements ASSIGNING &lt;r&gt;.   CHECK &lt;r&gt;-ori_name = &lt;r&gt;-name.    DELETE requirements.    ENDLOOP.
  inverse_order( CHANGING order = order ).     DELETE ADJACENT DUPLICATES FROM order COMPARING type name.   inverse_order( CHANGING order = order ).
  SORT typegroups.    DELETE ADJACENT DUPLICATES FROM typegroups.
  SORT includes.      DELETE ADJACENT DUPLICATES FROM includes.
  SORT messages.      DELETE ADJACENT DUPLICATES FROM messages.
  REFRESH all_components.
  LOOP AT classes ASSIGNING &lt;c&gt;.    CLEAR s_comp.   if &lt;c&gt;-type = 0. s_comp-type = &apos;CLAS&apos;.  else.   s_comp-type = &apos;INTF&apos;.   ENDIF.   s_comp-name = &lt;c&gt;-name.   mac_add_comp.    ENDLOOP.
  LOOP AT typegroups ASSIGNING &lt;t&gt;.    CLEAR s_comp.   s_comp-type = &apos;TYPE&apos;.   s_comp-name = &lt;t&gt;-name.   mac_add_comp.    ENDLOOP.
  LOOP AT includes ASSIGNING &lt;i&gt;.    CLEAR s_comp.   s_comp-type = &apos;PROG&apos;.   s_comp-name = &lt;i&gt;.   mac_add_comp.    ENDLOOP.
  LOOP AT messages ASSIGNING &lt;m&gt;.    CLEAR s_comp.   s_comp-type = &apos;MSAG&apos;.   s_comp-name = &lt;m&gt;-name.   mac_add_comp.    ENDLOOP.
ENDMETHOD.
endclass. &quot;ZAPLINK_DEPENDENCIES_ANALYSER implementation
class ZAPLINK_DEVC_RAW implementation.
METHOD constructor.
  DATA o_raw TYPE REF TO zaplink_devc_data.
  CALL METHOD super-&gt;constructor
    EXPORTING
      o_comp = o_comp.
  CREATE OBJECT o_raw.
  raw ?= o_raw. &quot; Issue 50
ENDMETHOD.
endclass. &quot;ZAPLINK_DEVC_RAW implementation
class ZAPLINK_DICTIONARY implementation.
DEFINE mac_obj_data.
  data o_typegroup type to_typegroup.
  data o_domain    type to_domain.
  data o_data_e    type to_data_element.
  data o_view      type to_view.
  data o_table     type to_table.
  data o_tab_type  type to_table_type.
  data o_s_help    type to_search_help.
  data o_lock_obj  type to_lock_object.
END-OF-DEFINITION.
method CONSTRUCTOR.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = supportedtypes-type_group.    INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-domain.        INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-data_element.  INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-view.          INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-table.         INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-table_type.    INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-search_help.   INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-lock_object.   INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  mac_obj_data.
  DEFINE mac_do_obj.
    &amp;1 ?= object-&gt;raw.
    &amp;1-&gt;anonymize( ).
  END-OF-DEFINITION.
  CASE object-&gt;type.
    WHEN supportedtypes-type_group.
      o_typegroup ?= object-&gt;raw.
    WHEN supportedtypes-domain.         mac_do_obj o_domain.
    WHEN supportedtypes-data_element.   mac_do_obj o_data_e.
    WHEN supportedtypes-view.           mac_do_obj o_view.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = object-&gt;type
          connclass = &apos;ZAPLINK_DICTIONARY&apos;.
  ENDCASE.
ENDMETHOD.
method ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE.
endmethod.
METHOD zaplink_connector~create_new_raw.
  mac_obj_data.
  DEFINE mac_obj_create.
    create object &amp;1.
    object-&gt;raw = &amp;1.
  END-OF-DEFINITION.
  CREATE OBJECT object.
  CASE type.
    WHEN supportedtypes-type_group.     mac_obj_create o_typegroup.
    WHEN supportedtypes-domain.         mac_obj_create o_domain.
    WHEN supportedtypes-data_element.   mac_obj_create o_data_e.
    WHEN supportedtypes-view.           mac_obj_create o_view.
    WHEN supportedtypes-table.          mac_obj_create o_table.
    WHEN supportedtypes-table_type.     mac_obj_create o_tab_type.
    WHEN supportedtypes-search_help.    mac_obj_create o_s_help.
    WHEN supportedtypes-lock_object.    mac_obj_create o_lock_obj.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_DICTIONARY&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA d_name TYPE rsedd0-ddobjname.
  DATA d_type TYPE rsedd0-ddobjtype.
  DATA type  TYPE td_comptype.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN supportedtypes-type_group.
          d_type = dd_eu_type-type_group.
        WHEN supportedtypes-domain.
          d_type = dd_eu_type-domain.
        WHEN supportedtypes-data_element.
          d_type = dd_eu_type-data_element.
        WHEN supportedtypes-table_type.
          d_type = dd_eu_type-table_type.
        WHEN supportedtypes-search_help.
          d_type = dd_eu_type-search_help.
        WHEN supportedtypes-mactchcode_id.
          d_type = dd_eu_type-mactchcode_id.
        WHEN supportedtypes-lock_object.
          d_type = dd_eu_type-lock_object.
        WHEN supportedtypes-matchcode_obj.
          d_type = dd_eu_type-matchcode_obj.
        WHEN supportedtypes-table_index.
          d_type = dd_eu_type-table_index.
        WHEN supportedtypes-ext_index.
          d_type = dd_eu_type-ext_index.
        WHEN supportedtypes-view.
          d_type = dd_eu_type-view.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_DICTIONARY&apos;.
      ENDCASE.
      d_name = component-&gt;get_name( ).
      IF NOT d_type IS INITIAL.
        CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
          EXPORTING
            objname                    = d_name
            objtype                    = d_type
          EXCEPTIONS
            not_executed               = 1
            object_not_found           = 2
            object_not_specified       = 3
            permission_failure         = 4
            dialog_needed              = 5
            OTHERS                     = 6.
        IF sy-subrc &lt;&gt; 0. &quot; SAP NameSpace
          CASE sy-subrc.
            WHEN 2.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
          ENDCASE.
        ENDIF.
      ENDIF.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA d_name TYPE rsedd0-ddobjname.
  DATA d_type TYPE rsedd0-ddobjtype.
  DATA type        TYPE td_comptype.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN supportedtypes-type_group.
          d_type = dd_eu_type-type_group.
        WHEN supportedtypes-domain.
          d_type = dd_eu_type-domain.
        WHEN supportedtypes-data_element.
          d_type = dd_eu_type-data_element.
        WHEN supportedtypes-table_type.
          d_type = dd_eu_type-table_type.
        WHEN supportedtypes-search_help.
          d_type = dd_eu_type-search_help.
        WHEN supportedtypes-mactchcode_id.
          d_type = dd_eu_type-mactchcode_id.
        WHEN supportedtypes-lock_object.
          d_type = dd_eu_type-lock_object.
        WHEN supportedtypes-matchcode_obj.
          d_type = dd_eu_type-matchcode_obj.
        WHEN supportedtypes-table_index.
          d_type = dd_eu_type-table_index.
        WHEN supportedtypes-ext_index.
          d_type = dd_eu_type-ext_index.
        WHEN supportedtypes-table.
          d_type = dd_eu_type-transp_table.
        WHEN supportedtypes-view.
          d_type = dd_eu_type-view.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
      d_name = component-&gt;get_name( ).
      IF NOT d_type IS INITIAL AND NOT d_name IS INITIAL.
        CALL FUNCTION &apos;INTERN_DD_CHECK_EXIST&apos;
          EXPORTING
            objname                     = d_name
            objtype                     = d_type
            err_message                 = abap_false
            exists                      = abap_true
          EXCEPTIONS
            object_not_found            = 1
            other_object_class          = 2
            invalid_parameter           = 3
            object_already_exists       = 4
            OTHERS                      = 5.
        IF sy-subrc = 0. &quot; SAP NameSpace
          exists = me-&gt;exists-exists.
        ELSE.
          CASE sy-subrc.
            WHEN 1  or 2.
            WHEN OTHERS.
              mac_add_mf_and_raise &apos;INTERN_DD_CHECK_EXIST&apos; sy-subrc.
          ENDCASE.
        ENDIF.
      ENDIF.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.    result = abap_true.   endif.
endmethod.
METHOD zaplink_connector~read_from_sap.
  mac_obj_data.
  DATA d_type       TYPE td_comptype.
  DEFINE mac_catch_local_cx.
    catch zaplink_cx_connector into o_mycx.
      if not o_mycx-&gt;messages is bound.
        o_mycx-&gt;messages = application_log.
        o_mycx-&gt;update( ).
      endif.
      raise exception o_mycx.
  END-OF-DEFINITION.
  TRY.
    d_type = component-&gt;get_type( ).
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    CASE d_type.
      WHEN supportedtypes-type_group.
        TRY.
          o_typegroup = export_type_group( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_typegroup-&gt;a0_maindata-name.
        object-&gt;raw = o_typegroup.
      WHEN supportedtypes-domain.
        TRY.
          o_domain = export_domain( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_domain-&gt;a0_maindata-domname.
        object-&gt;raw = o_domain.
      WHEN supportedtypes-data_element.
        TRY.
          o_data_e = export_data_element( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_data_e-&gt;a0_maindata-rollname.
        object-&gt;raw = o_data_e.
      WHEN supportedtypes-view.
        TRY.
          o_view = export_view( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_view-&gt;a0_maindata-viewname.
        object-&gt;raw = o_view.
      WHEN supportedtypes-table.
        TRY.
          o_table = export_table( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_table-&gt;a0_maindata-tabname.
        object-&gt;raw = o_table.
      WHEN supportedtypes-table_type.
        TRY.
          o_tab_type = export_table_type( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_tab_type-&gt;a0_maindata-typename.
        object-&gt;raw = o_tab_type.
      WHEN supportedtypes-search_help.
        TRY.
          o_s_help = export_search_help( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_s_help-&gt;a0_maindata-shlpname.
        object-&gt;raw = o_s_help.
      WHEN supportedtypes-lock_object.
        TRY.
          o_lock_obj = export_lock_object( component ).
          mac_catch_local_cx.
        ENDTRY.
        CLEAR o_lock_obj-&gt;a0_maindata-viewname.
        object-&gt;raw = o_lock_obj.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_DICTIONARY&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  mac_obj_data.
  DATA o_comp       TYPE to_component.
  DEFINE mac_catch_local_cx.
    catch zaplink_cx_connector into o_mycx.
      if not o_mycx-&gt;messages is bound.
        o_mycx-&gt;messages = application_log.
        o_mycx-&gt;update( ).
      endif.
      raise exception o_mycx.
  END-OF-DEFINITION.
  TRY.
      CASE object-&gt;type.
        WHEN supportedtypes-type_group.
          o_typegroup ?= object-&gt;raw.
          o_typegroup-&gt;a0_maindata-name = object-&gt;name.
          TRY.
            components = import_type_group( o_typegroup ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-domain.
          o_domain ?= object-&gt;raw.
          o_domain-&gt;a0_maindata-domname = object-&gt;name.
          TRY.
            components = import_domain( o_domain ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-data_element.
          o_data_e ?= object-&gt;raw.
          o_data_e-&gt;a0_maindata-rollname = object-&gt;name.
          TRY.
            components = import_data_element( o_data_e ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-view.
          o_view ?= object-&gt;raw.
          o_view-&gt;a0_maindata-viewname = object-&gt;name.
          TRY.
            components = import_view( o_view ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-table.
          o_table ?= object-&gt;raw.
          o_table-&gt;a0_maindata-tabname = object-&gt;name.
          TRY.
            components = import_table( o_table ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-table_type.
          o_tab_type ?= object-&gt;raw.
          o_tab_type-&gt;a0_maindata-typename = object-&gt;name.
          TRY.
            components = import_table_type( o_tab_type ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-search_help.
          o_s_help ?= object-&gt;raw.
          o_s_help-&gt;a0_maindata-shlpname = object-&gt;name.
          TRY.
            components = import_search_help( o_s_help ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN supportedtypes-lock_object.
          o_lock_obj ?= object-&gt;raw.
          o_lock_obj-&gt;a0_maindata-viewname = object-&gt;name.
          TRY.
            components = import_lock_object( o_lock_obj ).
            mac_catch_local_cx.
          ENDTRY.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_DICTIONARY&apos;.
      ENDCASE.
      CREATE OBJECT o_comp.
      o_comp-&gt;set_type( object-&gt;type ).
      o_comp-&gt;set_name( object-&gt;name ).
      IF NOT components IS BOUND. CREATE OBJECT components. ENDIF.
      components-&gt;add( o_comp ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD export_type_group.
  DATA d_type     TYPE td_typegroup.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA t_source   TYPE tt_abaprawsource.
  DATA o_src      TYPE REF TO cl_wb_source.
  TRY.
    d_type = component-&gt;get_name( ).
    o_src = get_type_group( d_type ).
    CHECK o_src IS BOUND.
    o_src-&gt;get_source_old( IMPORTING old_source = t_source ).
    CREATE OBJECT object.
    object-&gt;a0_maindata-name = d_type.
    object-&gt;a0_maindata-uccheck = o_src-&gt;l_progdir_entry-uccheck.
    SELECT SINGLE masterlang FROM tadir
                             INTO object-&gt;a0_maindata-lang
         WHERE  pgmid       = &apos;R3TR&apos;
         AND    object      = &apos;TYPE&apos;
         AND    obj_name    = object-&gt;a0_maindata-name.
    SELECT SINGLE ddtext FROM ddtypet INTO object-&gt;a0_maindata-text
           WHERE typegroup  = object-&gt;a0_maindata-name
             AND ddlanguage = object-&gt;a0_maindata-lang.
    object-&gt;set_source( t_source ).
    object-&gt;_code_signature = get_typegroup_signature( d_type ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_type_group.
  DATA d_typegroup    TYPE td_typegroup.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA t_source       TYPE zaplink_type_data=&gt;tt_string.
  DATA d_program      TYPE progdir.
  DATA str            TYPE string.
  FIELD-SYMBOLS:
    &lt;prog&gt; TYPE sy-repid.          &quot;Typgruppeninclude
  TRY.
    d_typegroup = o_data-&gt;a0_maindata-name.
    PERFORM tygr_exists IN PROGRAM saplsd31
          USING    d_typegroup
          CHANGING d_subrc.
    IF d_subrc = 0.
      d_name = d_typegroup.
      CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
        EXPORTING
          objname                    = d_name
          objtype                    = dd_eu_type-type_group
        EXCEPTIONS
          not_executed               = 1
          object_not_found           = 0
          object_not_specified       = 3
          permission_failure         = 4
          dialog_needed              = 5
          OTHERS                     = 6.
      IF sy-subrc &lt;&gt; 0.
        mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
      ENDIF.
    ENDIF.
    t_source = o_data-&gt;get_source( ).
    CALL FUNCTION &apos;RS_DD_TYGR_INSERT_SOURCES&apos;
      EXPORTING
        typegroupname        = o_data-&gt;a0_maindata-name
        ddtext               = o_data-&gt;a0_maindata-text
        corrnum              = space
        devclass             = space
      TABLES
        SOURCE               = t_source
      EXCEPTIONS
        already_exists       = 1
        not_executed         = 2
        permission_failure   = 3
        object_not_specified = 4
        illegal_name         = 5
        OTHERS               = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_TYGR_INSERT_SOURCES&apos; sy-subrc.
    ENDIF.
    PERFORM tygr_exists IN PROGRAM saplsd31
            USING    d_typegroup
            CHANGING d_subrc.
    IF d_subrc &lt;&gt; 0.
      EXIT.
    ENDIF.
    str = &apos;(SAPLSD31)PROGNAME&apos;.
    ASSIGN (str) TO &lt;prog&gt;.
    IF sy-subrc &lt;&gt; 0.
      EXIT.
    ENDIF.
    CALL FUNCTION &apos;READ_PROGDIR&apos;
      EXPORTING
        i_progname          = &lt;prog&gt;
      IMPORTING
        e_progdir           = d_program
      EXCEPTIONS
        not_exists          = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;READ_PROGDIR&apos; sy-subrc.
    ENDIF.
    IF d_program-uccheck &lt;&gt; o_data-&gt;a0_maindata-uccheck.
      d_program-uccheck = o_data-&gt;a0_maindata-uccheck.
      CALL FUNCTION &apos;UPDATE_PROGDIR&apos;
        EXPORTING
          i_progdir    = d_program
          i_progname   = &lt;prog&gt;
          i_state      = d_program-state
        EXCEPTIONS
          not_executed = 1
          OTHERS       = 2.
      IF sy-subrc &lt;&gt; 0.
        mac_add_mf_and_raise &apos;UPDATE_PROGDIR&apos; sy-subrc.
      ENDIF.
    ENDIF.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_domain.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_doma_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd01t WITH DEFAULT KEY.
  DATA t_vtexts   TYPE STANDARD TABLE OF dd07t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_DOMA_GET&apos;
      EXPORTING
        name                = d_name
        state               = &apos;M&apos;
      IMPORTING
        dd01v_wa            = s_fm_data-header
      TABLES
        dd07v_tab           = s_fm_data-values
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_DOMA_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd01t
      WHERE domname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    SELECT *
      INTO TABLE t_vtexts
      FROM dd07t
      WHERE domname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_vtexts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_vtexts COMPARING ddlanguage.
    s_fm_data-values_texts = t_vtexts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_doma_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_domain.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_doma_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-domname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-domain
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_DOMA_PUT&apos;
      EXPORTING
        name              = d_name
        dd01v_wa          = s_fm_data-header
      TABLES
        dd07v_tab         = s_fm_data-values
      EXCEPTIONS
        doma_not_found    = 1
        name_inconsistent = 2
        doma_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_DOMA_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd01t WHERE domname = s_fm_data-header-domname.
    MODIFY dd01t FROM TABLE s_fm_data-texts.
    DELETE FROM dd07t WHERE domname = s_fm_data-header-domname.
    MODIFY dd07t FROM TABLE s_fm_data-values_texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_data_element.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_dtel_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd04t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_DTEL_GET&apos;
      EXPORTING
        name                = d_name
        state               = &apos;M&apos;
        langu               = &apos; &apos;
      IMPORTING
        dd04v_wa            = s_fm_data-header
        tpara_wa            = s_fm_data-param
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_DTEL_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd04t
      WHERE rollname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_dtel_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_data_element.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_dtel_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-rollname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-data_element
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_DTEL_PUT&apos;
      EXPORTING
        name              = d_name
        dd04v_wa          = s_fm_data-header
      EXCEPTIONS
        dtel_not_found    = 1
        name_inconsistent = 2
        dtel_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_DTEL_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd04t WHERE rollname = s_fm_data-header-rollname.
    MODIFY dd04t FROM TABLE s_fm_data-texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_view.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_view_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd25t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_VIEW_GET&apos;
      EXPORTING
        name                = d_name
        state               = &apos;M&apos;
        langu               = &apos; &apos;
      IMPORTING
        dd25v_wa            = s_fm_data-header
        dd09l_wa            = s_fm_data-tech
      TABLES
        dd26v_tab           = s_fm_data-tables
        dd27p_tab           = s_fm_data-fields
        dd28j_tab           = s_fm_data-joins
        dd28v_tab           = s_fm_data-wheres
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_VIEW_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd25t
      WHERE viewname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_view_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_view.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_view_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-viewname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-view
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_VIEW_PUT&apos;
      EXPORTING
        name              = d_name
        dd25v_wa          = s_fm_data-header
        dd09l_wa          = s_fm_data-tech
      TABLES
        dd26v_tab         = s_fm_data-tables
        dd27p_tab         = s_fm_data-fields
        dd28j_tab         = s_fm_data-joins
        dd28v_tab         = s_fm_data-wheres
      EXCEPTIONS
        view_not_found    = 1
        name_inconsistent = 2
        view_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_VIEW_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd25t WHERE viewname = s_fm_data-header-viewname.
    MODIFY dd25t FROM TABLE s_fm_data-texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_table.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_tabl_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd02t WITH DEFAULT KEY.
  DATA t_ftexts   TYPE STANDARD TABLE OF dd03t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_TABL_GET&apos;
      EXPORTING
        name                = d_name
        state               = &apos;M&apos;
      IMPORTING
        dd02v_wa            = s_fm_data-header
        dd09l_wa            = s_fm_data-tech
      TABLES
        dd03p_tab           = s_fm_data-fields
        dd05m_tab           = s_fm_data-fk_fields
        dd08v_tab           = s_fm_data-forein_keys
        dd12v_tab           = s_fm_data-indexes
        dd17v_tab           = s_fm_data-idx_fields
        dd35v_tab           = s_fm_data-search_helps
        dd36m_tab           = s_fm_data-sh_fields
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_TABL_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd02t
      WHERE tabname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    SELECT *
      INTO TABLE t_ftexts
      FROM dd03t
      WHERE tabname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_ftexts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_ftexts COMPARING ddlanguage.
    s_fm_data-texts = t_ftexts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_tabl_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_table.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_tabl_data=&gt;ts_fm_data.
  DATA t_idx_flds     TYPE zaplink_tabl_data=&gt;tt_dd17v.
  FIELD-SYMBOLS: &lt;i&gt; LIKE LINE OF s_fm_data-indexes.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-tabname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-transp_table
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_TABL_PUT&apos;
      EXPORTING
        name                    = d_name
        dd02v_wa                = s_fm_data-header
        dd09l_wa                = s_fm_data-tech
      TABLES
          dd03p_tab           = s_fm_data-fields
          dd05m_tab           = s_fm_data-fk_fields
          dd08v_tab           = s_fm_data-forein_keys
          dd35v_tab           = s_fm_data-search_helps
          dd36m_tab           = s_fm_data-sh_fields
      EXCEPTIONS
        tabl_not_found          = 1
        name_inconsistent       = 2
        tabl_inconsistent       = 3
        put_failure             = 4
        put_refused             = 5
        OTHERS                  = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_TABL_PUT&apos; sy-subrc.
    ENDIF.
    LOOP AT s_fm_data-indexes ASSIGNING &lt;i&gt;.
      t_idx_flds = s_fm_data-idx_fields.    DELETE t_idx_flds WHERE indexname &lt;&gt; &lt;i&gt;-indexname.
      CALL FUNCTION &apos;DDIF_INDX_PUT&apos;
        EXPORTING
          name              = d_name
          id                = &lt;i&gt;-indexname
          dd12v_wa          = &lt;i&gt;
        TABLES
          dd17v_tab         = t_idx_flds
        EXCEPTIONS
          indx_not_found    = 1
          name_inconsistent = 2
          indx_inconsistent = 3
          put_failure       = 4
          put_refused       = 5
          OTHERS            = 6.
      IF sy-subrc &lt;&gt; 0.
        mac_add_mf_and_raise &apos;DDIF_INDX_PUT&apos; sy-subrc.
      ENDIF.
    ENDLOOP.
    DELETE FROM dd02t WHERE tabname = s_fm_data-header-tabname.
    MODIFY dd02t FROM TABLE s_fm_data-texts.
    DELETE FROM dd03t WHERE tabname = s_fm_data-header-tabname.
    MODIFY dd03t FROM TABLE s_fm_data-fields_texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD EXPORT_TABLE_TYPE.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_ttyp_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd40t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_TTYP_GET&apos;
      EXPORTING
        name                = d_name
        STATE               = space
      IMPORTING
        DD40V_WA            = s_fm_data-header
      TABLES
        DD42V_TAB           = s_fm_data-keys
      EXCEPTIONS
        ILLEGAL_INPUT       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_TTYP_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd40t
      WHERE typename = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_ttyp_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_table_type.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_ttyp_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-typename.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-table_type
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_TTYP_PUT&apos;
      EXPORTING
        name              = d_name
        dd40v_wa          = s_fm_data-header
      TABLES
        dd42v_tab         = s_fm_data-keys
      EXCEPTIONS
        ttyp_not_found    = 1
        name_inconsistent = 2
        ttyp_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_TTYP_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd40t WHERE typename = s_fm_data-header-typename.
    MODIFY dd40t FROM TABLE s_fm_data-texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_search_help.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_shlp_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd30t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_SHLP_GET&apos;
      EXPORTING
        name                = d_name
        state               = space
      IMPORTING
        dd30v_wa            = s_fm_data-header
      TABLES
        dd31v_tab           = s_fm_data-sub_sh
        dd32p_tab           = s_fm_data-fields
        dd33v_tab           = s_fm_data-ssh_params
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_SHLP_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd30t
      WHERE shlpname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_shlp_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_search_help.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_shlp_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-shlpname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-search_help
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_SHLP_PUT&apos;
      EXPORTING
        name              = d_name
        dd30v_wa          = s_fm_data-header
      TABLES
        dd31v_tab         = s_fm_data-sub_sh
        dd32p_tab         = s_fm_data-fields
        dd33v_tab         = s_fm_data-ssh_params
      EXCEPTIONS
        shlp_not_found    = 1
        name_inconsistent = 2
        shlp_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_SHLP_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd30t WHERE shlpname = s_fm_data-header-shlpname.
    MODIFY dd30t FROM TABLE s_fm_data-texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD export_lock_object.
  DATA d_name     TYPE ddobjname.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA s_fm_data  TYPE zaplink_enqu_data=&gt;ts_fm_data.
  DATA d_mask     TYPE doku_obj.
  DATA t_texts    TYPE STANDARD TABLE OF dd25t WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  TRY.
    d_name = component-&gt;get_name( ).
    CALL FUNCTION &apos;DDIF_ENQU_GET&apos;
      EXPORTING
        name                = d_name
      IMPORTING
        dd25v_wa            = s_fm_data-header
      TABLES
        dd26e_tab           = s_fm_data-tables
        dd27p_tab           = s_fm_data-fields
      EXCEPTIONS
        illegal_input       = 1
        OTHERS              = 2.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_ENQU_GET&apos; sy-subrc.
    ENDIF.
    SELECT *
      INTO TABLE t_texts
      FROM dd25t
      WHERE viewname = d_name
        AND ddtext &lt;&gt; space.
    SORT t_texts BY ddlanguage as4local.
    DELETE ADJACENT DUPLICATES FROM t_texts COMPARING ddlanguage.
    s_fm_data-texts = t_texts.
    d_mask = d_name.
    s_fm_data-docs = zaplink_documentation=&gt;get( ids = zaplink_enqu_data=&gt;r_doc_ids
                                              object = d_mask ).
    CREATE OBJECT object.
    object-&gt;from_data( s_fm_data ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD import_lock_object.
  DATA d_name         TYPE rsedd0-ddobjname.
  DATA d_subrc        TYPE sy-subrc.
  DATA s_fm_data      TYPE zaplink_enqu_data=&gt;ts_fm_data.
  TRY.
    s_fm_data = o_data-&gt;to_data( ).
    d_name = s_fm_data-header-viewname.
    CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
      EXPORTING
        no_ask                     = abap_true
        objname                    = d_name
        objtype                    = dd_eu_type-lock_object
      EXCEPTIONS
        not_executed               = 1
        object_not_found           = 0
        object_not_specified       = 3
        permission_failure         = 4
        dialog_needed              = 5
        OTHERS                     = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_DD_DELETE_OBJ&apos; sy-subrc.
    ENDIF.
    CALL FUNCTION &apos;DDIF_ENQU_PUT&apos;
      EXPORTING
        name              = d_name
        dd25v_wa          = s_fm_data-header
      TABLES
        dd26e_tab         = s_fm_data-tables
        dd27p_tab         = s_fm_data-fields
      EXCEPTIONS
        enqu_not_found    = 1
        name_inconsistent = 2
        enqu_inconsistent = 3
        put_failure       = 4
        put_refused       = 5
        OTHERS            = 6.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;DDIF_ENQU_PUT&apos; sy-subrc.
    ENDIF.
    DELETE FROM dd25t WHERE viewname = s_fm_data-header-viewname.
    MODIFY dd25t FROM TABLE s_fm_data-texts.
    zaplink_documentation=&gt;set( s_fm_data-docs ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_cnx_ext_code_signature~get_signature.
  DATA d_type   TYPE td_comptype.
  DATA d_tgrp   TYPE td_typegroup.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN supportedtypes-type_group.
        d_tgrp = component-&gt;get_name( ).
        result = get_typegroup_signature( d_tgrp ).
      WHEN supportedtypes-domain OR supportedtypes-data_element OR supportedtypes-table_type OR supportedtypes-search_help OR supportedtypes-mactchcode_id OR
           supportedtypes-lock_object OR supportedtypes-matchcode_obj OR supportedtypes-table_index OR supportedtypes-ext_index OR supportedtypes-table  OR supportedtypes-view.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_DICTIONARY&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD get_type_group.
  DATA d_type     TYPE td_typegroup.
  DATA str        TYPE string.
  DATA subrc      TYPE sy-subrc.
  DATA t_source   TYPE TABLE OF string.
  FIELD-SYMBOLS:
    &lt;o_s&gt; TYPE REF TO cl_wb_source.
  PERFORM xx_first_get IN PROGRAM saplsd31
          USING    type_group space dd_eu_type-type_group &apos;S&apos; space &apos;X&apos;
          CHANGING subrc.
  str = &apos;(SAPLSD31)SOURCE_INSTANCE&apos;.
  ASSIGN (str) TO &lt;o_s&gt;.
  IF sy-subrc &lt;&gt; 0.
    EXIT.
  ENDIF.
  result = &lt;o_s&gt;.
ENDMETHOD.
METHOD get_typegroup_signature.
  DATA t_src    TYPE tt_abaprawsource.
  DATA s_src    TYPE td_abapsource.
  DATA o_src    TYPE REF TO cl_wb_source.
  o_src = get_type_group( type_group ).
  CHECK o_src IS BOUND.
  o_src-&gt;get_source_old( IMPORTING old_source = t_src ).
  zaplink_tools=&gt;pretty_printer( CHANGING table = t_src ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = t_src ).
  s_src = zaplink_tools=&gt;table_2_string( t_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( s_src ).
ENDMETHOD.
endclass. &quot;ZAPLINK_DICTIONARY implementation
class ZAPLINK_INTF_DATA implementation.
METHOD from_data.
  DATA _t   LIKE LINE OF a0_maindata-texts.
  DATA _in  LIKE LINE OF interfaces.
  FIELD-SYMBOLS:
    &lt;co&gt;  LIKE LINE OF fm_data-comprisings,
    &lt;ec&gt;  LIKE LINE OF fm_data-explore_comprisings.
  FIELD-SYMBOLS:
    &lt;desc&gt; LIKE LINE OF fm_data-class_desc,
    &lt;doc&gt;  LIKE LINE OF fm_data-documentation,
    &lt;dt&gt;   LIKE LINE OF &lt;doc&gt;-texts.
  DATA s_txt  LIKE LINE OF a0_maindata-texts.
  DATA s_key  TYPE ts_doc_key.
  a0_maindata-hdr = fm_data-interface.
  obj_name = a0_maindata-clsname.
  obj_version = a0_maindata-version.
  obj_langu = a0_maindata-langu.
  obj_type = object_types-interface.
  CLEAR a0_maindata-uuid.                                   &quot; Issue 59
  a0_maindata-texts = fd_text( descriptions  = fm_data-class_desc
                                   classname = obj_name
                                          id = doc_ids-interface-header
                               documentation = fm_data-documentation ).
  IF NOT a0_maindata-texts IS INITIAL. CLEAR a0_maindata-descript. ENDIF.
  CALL METHOD super-&gt;from_data
    EXPORTING
      fm_data = fm_data.
  LOOP AT fm_data-comprisings ASSIGNING &lt;co&gt;
    WHERE clsname = a0_maindata-clsname.
    CLEAR _in.
    MOVE-CORRESPONDING &lt;co&gt; TO _in.
    CLEAR _in-clsname.
    INSERT _in INTO TABLE interfaces.
  ENDLOOP.
  clear_tags( ).
ENDMETHOD.
METHOD to_data.
  DATA _t   LIKE LINE OF a0_maindata-texts.
  DATA _ct  LIKE LINE OF fm_data-class_desc.
  DATA _co  LIKE LINE OF fm_data-comprisings.
  DATA _ec  LIKE LINE OF fm_data-explore_comprisings.
  DATA _d   LIKE LINE OF documentation.
  DATA _dt  LIKE LINE OF _d-texts.
  FIELD-SYMBOLS:
    &lt;t&gt;   LIKE LINE OF a0_maindata-texts,
    &lt;in&gt;  LIKE LINE OF interfaces.
  obj_name = a0_maindata-clsname.
  obj_version = a0_maindata-version.
  obj_langu = a0_maindata-langu.
  obj_type = object_types-interface.
  CALL METHOD super-&gt;to_data
    RECEIVING
      fm_data = fm_data.
  fm_data-interface = a0_maindata-hdr.
  READ TABLE a0_maindata-texts INTO _t
       WITH TABLE KEY langu = a0_maindata-langu.
  IF sy-subrc = 0.
    fm_data-interface-descript = _t-descript.
  ENDIF.
  CALL METHOD td_text
    EXPORTING
      classname     = a0_maindata-clsname
      texts         = a0_maindata-texts
      id            = doc_ids-interface-header
    CHANGING
      documentation = fm_data-documentation
      descriptions  = fm_data-class_desc.
  LOOP AT interfaces ASSIGNING &lt;in&gt;.
    CLEAR: _co.
    MOVE-CORRESPONDING &lt;in&gt; TO _co.
    _co-clsname = a0_maindata-clsname.
    INSERT _co INTO TABLE fm_data-comprisings.
  ENDLOOP.
  clear_tags( ).
ENDMETHOD.
METHOD anonymize.
  super-&gt;anonymize( ).
  CLEAR:
    a0_maindata-author,
    a0_maindata-createdon,
    a0_maindata-changedby,
    a0_maindata-changedon,
    a0_maindata-chgdanyby,
    a0_maindata-chgdanyon,
    a0_maindata-r3release.
ENDMETHOD.
METHOD complete_data.
  obj_name = fm_data-interface-clsname.
  super-&gt;complete_data( CHANGING fm_data = fm_data ).
ENDMETHOD.
endclass. &quot;ZAPLINK_INTF_DATA implementation
class ZAPLINK_OBJECT implementation.
METHOD constructor.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  application_log-&gt;msgid = &apos;ZAPLINK_OBJECT&apos;.
  type-type = zaplink_object_data=&gt;object_types-class.       INSERT type INTO TABLE supported_types.
  type-type = zaplink_object_data=&gt;object_types-interface.    INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
  CALL FUNCTION &apos;SEO_BUFFER_INIT&apos;.        &quot; Init buffers
ENDMETHOD.
METHOD export_from_sap_class.
  DATA obj_mask   TYPE doku_obj.
  DATA docu_key   TYPE zaplink_object_data=&gt;ts_doc_key.
  DATA classkey   TYPE seoclskey.
  DATA _d         TYPE t_fm_data.
  TRY.
      CHECK component-&gt;get_type( ) = zaplink_object_data=&gt;object_types-class.
      classkey-clsname = component-&gt;get_name( ).
      CALL FUNCTION &apos;SEO_BUFFER_REFRESH&apos;.
      CALL FUNCTION &apos;SEO_CLASS_GET&apos;
        EXPORTING
          clskey       = classkey
        IMPORTING
          class        = _d-class
        EXCEPTIONS
          not_existing = 1
          deleted      = 2
          is_interface = 3
          model_only   = 4
          OTHERS       = 5.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_GET&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      load_clas( EXPORTING classkey = classkey
                        CHANGING _d = _d ).
      _d-includes = get_includes( _d-class-clsname ).
      check_clas_sections( _d ).
      DATA code      TYPE tt_abaprawsource.
      DATA new_code  TYPE tt_abaprawsource.
      DATA t_typegrp TYPE seot_typepusages_r.
      DATA s_tgroup  LIKE LINE OF t_typegrp.
      DATA d_flag    TYPE abap_bool.
      DATA s_grp_key TYPE seotpukey.
      code = get_prog_rawsource( _d-includes-pubsec ).
      search_type_pool( EXPORTING sourcecode = code
                                         typepools = _d-typeusages
                                            public = abap_true
                          IMPORTING new_sourcecode = new_code
                                     new_typepools = t_typegrp ).
      IF NOT new_code IS INITIAL.
        set_prog_rawsource( program = _d-includes-pubsec
                                raw = new_code ).
        d_flag = abap_true.
      ENDIF.
      IF NOT t_typegrp IS INITIAL.
        SORT t_typegrp BY typegroup.  DELETE ADJACENT DUPLICATES FROM t_typegrp COMPARING typegroup.
        LOOP AT t_typegrp INTO s_tgroup.
          s_tgroup-clsname = _d-class-clsname.
          s_tgroup-version = _d-class-version.
          READ TABLE _d-typeusages TRANSPORTING NO FIELDS WITH KEY typegroup = s_tgroup-typegroup.
          IF sy-subrc = 0.
            MOVE-CORRESPONDING s_tgroup TO s_grp_key.
            CALL FUNCTION &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
              EXPORTING
                tplkey        = s_grp_key
                save          = seox_false
              EXCEPTIONS
                not_existing  = 1
                is_clsdeferrd = 2
                is_intdeferrd = 3
                not_deleted   = 4
                db_error      = 5
                OTHERS        = 6.
            IF sy-subrc &lt;&gt; 0.
              o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
                                                          subrc = sy-subrc
                                                      classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
              application_log-&gt;add_symsg( ).
              RAISE EXCEPTION o_mycx.
            ENDIF.
          ENDIF.
          CALL FUNCTION &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
            EXPORTING
              save                    = seox_false
            CHANGING
              typepusage              = s_tgroup
            EXCEPTIONS
              existing                = 1
              is_clsdeferrd           = 2
              is_intdeferrd           = 3
              not_created             = 4
              db_error                = 5
              OTHERS                  = 6.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
                                                        subrc = sy-subrc
                                                    classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
            application_log-&gt;add_symsg( ).
            RAISE EXCEPTION o_mycx.
          ENDIF.
          INSERT s_tgroup INTO TABLE _d-typeusages.
          SET EXTENDED CHECK OFF.
          IF 1 = 2. MESSAGE w002 WITH s_tgroup-typegroup _d-class-clsname text-pub. ENDIF.
          SET EXTENDED CHECK ON.
          CALL METHOD application_log-&gt;add_warning
            EXPORTING
              id_msgno     = &apos;002&apos;
              id_msgv1     = s_tgroup-typegroup
              id_msgv2     = _d-class-clsname
              id_msgv3     = &apos;Public section&apos;(pub)
              .
          d_flag = abap_true.
        ENDLOOP.
      ENDIF.
      code = get_prog_rawsource( _d-includes-prosec ).
      search_type_pool( EXPORTING sourcecode = code
                                   typepools = _d-typeusages
                    IMPORTING new_sourcecode = new_code
                               new_typepools = t_typegrp ).
      IF NOT new_code IS INITIAL.
        set_prog_rawsource( program = _d-includes-prosec
                                raw = new_code ).
        d_flag = abap_true.
      ENDIF.
      IF NOT t_typegrp IS INITIAL.
        SORT t_typegrp BY typegroup.  DELETE ADJACENT DUPLICATES FROM t_typegrp COMPARING typegroup.
        LOOP AT t_typegrp INTO s_tgroup.
          s_tgroup-clsname = _d-class-clsname.
          s_tgroup-version = _d-class-version.
          READ TABLE _d-typeusages TRANSPORTING NO FIELDS WITH KEY typegroup = s_tgroup-typegroup.
          IF sy-subrc = 0.
            MOVE-CORRESPONDING s_tgroup TO s_grp_key.
            CALL FUNCTION &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
              EXPORTING
                tplkey        = s_grp_key
                save          = seox_false
              EXCEPTIONS
                not_existing  = 1
                is_clsdeferrd = 2
                is_intdeferrd = 3
                not_deleted   = 4
                db_error      = 5
                OTHERS        = 6.
            IF sy-subrc &lt;&gt; 0.
              o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
                                                          subrc = sy-subrc
                                                      classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
              application_log-&gt;add_symsg( ).
              RAISE EXCEPTION o_mycx.
            ENDIF.
          ENDIF.
          CALL FUNCTION &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
            EXPORTING
              save                    = seox_false
            CHANGING
              typepusage              = s_tgroup
            EXCEPTIONS
              existing                = 1
              is_clsdeferrd           = 2
              is_intdeferrd           = 3
              not_created             = 4
              db_error                = 5
              OTHERS                  = 6.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
                                                        subrc = sy-subrc
                                                    classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
            application_log-&gt;add_symsg( ).
            RAISE EXCEPTION o_mycx.
          ENDIF.
          INSERT s_tgroup INTO TABLE _d-typeusages.
          SET EXTENDED CHECK OFF.
          IF 1 = 2. MESSAGE w002 WITH s_tgroup-typegroup _d-class-clsname text-pro. ENDIF.
          SET EXTENDED CHECK ON.
          CALL METHOD application_log-&gt;add_warning
            EXPORTING
              id_msgno     = &apos;002&apos;
              id_msgv1     = s_tgroup-typegroup
              id_msgv2     = _d-class-clsname
              id_msgv3     = &apos;Protected section&apos;(pro)
              .
          d_flag = abap_true.
        ENDLOOP.
      ENDIF.
      code = get_prog_rawsource( _d-includes-prisec ).
      search_type_pool( EXPORTING sourcecode = code
                                   typepools = _d-typeusages
                    IMPORTING new_sourcecode = new_code
                               new_typepools = t_typegrp ).
      IF NOT new_code IS INITIAL.
        set_prog_rawsource( program = _d-includes-prisec
                                raw = new_code ).
        d_flag = abap_true.
      ENDIF.
      IF NOT t_typegrp IS INITIAL.
        SORT t_typegrp BY typegroup.  DELETE ADJACENT DUPLICATES FROM t_typegrp COMPARING typegroup.
        LOOP AT t_typegrp INTO s_tgroup.
          s_tgroup-clsname = _d-class-clsname.
          s_tgroup-version = _d-class-version.
          READ TABLE _d-typeusages TRANSPORTING NO FIELDS WITH KEY typegroup = s_tgroup-typegroup.
          IF sy-subrc = 0.
            MOVE-CORRESPONDING s_tgroup TO s_grp_key.
            CALL FUNCTION &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
              EXPORTING
                tplkey        = s_grp_key
                save          = seox_false
              EXCEPTIONS
                not_existing  = 1
                is_clsdeferrd = 2
                is_intdeferrd = 3
                not_deleted   = 4
                db_error      = 5
                OTHERS        = 6.
            IF sy-subrc &lt;&gt; 0.
              o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_DELETE_W_DEPS&apos;
                                                          subrc = sy-subrc
                                                      classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
              application_log-&gt;add_symsg( ).
              RAISE EXCEPTION o_mycx.
            ENDIF.
          ENDIF.
          CALL FUNCTION &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
            EXPORTING
              save                    = seox_false
            CHANGING
              typepusage              = s_tgroup
            EXCEPTIONS
              existing                = 1
              is_clsdeferrd           = 2
              is_intdeferrd           = 3
              not_created             = 4
              db_error                = 5
              OTHERS                  = 6.
          IF sy-subrc &lt;&gt; 0.
            o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_TYPEPUSAGE_CREATE_F_DATA&apos;
                                                        subrc = sy-subrc
                                                    classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
            application_log-&gt;add_symsg( ).
            RAISE EXCEPTION o_mycx.
          ENDIF.
          INSERT s_tgroup INTO TABLE _d-typeusages.
          SET EXTENDED CHECK OFF.
          IF 1 = 2. MESSAGE w002 WITH s_tgroup-typegroup _d-class-clsname text-pri. ENDIF.
          SET EXTENDED CHECK ON.
          CALL METHOD application_log-&gt;add_warning
            EXPORTING
              id_msgno     = &apos;002&apos;
              id_msgv1     = s_tgroup-typegroup
              id_msgv2     = _d-class-clsname
              id_msgv3     = &apos;Private section&apos;(pri)
              .
          d_flag = abap_true.
        ENDLOOP.
      ENDIF.
      IF NOT d_flag IS INITIAL.
        CALL FUNCTION &apos;SEO_CLIF_SAVE_ALL&apos;
          EXPORTING
            cifkey                              = classkey
          EXCEPTIONS
            not_existing                        = 1
            nothing_to_do                       = 2
            access_error                        = 3
            db_error                            = 4
            error_in_code_generation            = 5
            OTHERS                              = 6.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLIF_SAVE_ALL&apos;
                                                      subrc = sy-subrc
                                                  classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
          application_log-&gt;add_symsg( ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
        load_clas( EXPORTING classkey = classkey
                          CHANGING _d = _d ).
      ENDIF.
      docu_key-name = component-&gt;get_name( ).
      docu_key-other = &apos;*&apos;.
      obj_mask = docu_key.
      _d-documentation = zaplink_documentation=&gt;get( ids = zaplink_object_data=&gt;r_doc_ids-class
                                                  object = obj_mask ).
      CREATE OBJECT object.
      object-&gt;complete_data( CHANGING fm_data = _d ).
      _d-dynpros = get_dynpros( _d-includes-classpool ).    &quot; Issue 8
      _d-menupainter = get_menus( _d-includes-classpool ).  &quot; Issue 9
      _d-textspool = get_prog_textpool( _d-includes-classpool ). &quot; Issue 1
      object-&gt;from_data( _d ).
      object-&gt;_code_signature = get_class_signature( classkey ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD export_from_sap_interface.
  DATA obj_mask       TYPE doku_obj.
  DATA docu_key       TYPE zaplink_object_data=&gt;ts_doc_key.
  DATA classkey TYPE seoclskey.
  DATA _d       TYPE t_fm_data.
  TRY.
      CHECK component-&gt;get_type( ) = zaplink_object_data=&gt;object_types-interface.
      classkey-clsname = component-&gt;get_name( ).
      CALL FUNCTION &apos;SEO_INTERFACE_TYPEINFO_GET&apos;
        EXPORTING
          intkey                        = classkey
          with_master_language          = seox_true
          with_enhancements             = seox_true
        IMPORTING
          interface                     = _d-interface
          attributes                    = _d-attributes
          methods                       = _d-methods
          events                        = _d-events
          PARAMETERS                    = _d-parameters
          exceps                        = _d-exceps
          comprisings                   = _d-comprisings
          typepusages                   = _d-typeusages
          clsdeferrds                   = _d-clsdeferrds
          intdeferrds                   = _d-intdeferrds
          explore_comprisings           = _d-explore_comprisings
          aliases                       = _d-aliases
          types                         = _d-types
          enhancement_methods           = _d-enhancement_methods
          enhancement_attributes        = _d-enhancement_attributes
          enhancement_events            = _d-enhancement_events
          enhancement_comprisings       = _d-enhancement_comprisings
        EXCEPTIONS
          not_existing                  = 1
          is_class                      = 2
          model_only                    = 3
          OTHERS                        = 4.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_INTERFACE_TYPEINFO_GET&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.
      _d-includes = get_includes( _d-interface-clsname ).
      check_intf_section( _d ).
      docu_key-name = component-&gt;get_name( ).
      docu_key-other = &apos;*&apos;.
      obj_mask = docu_key.
      _d-documentation = zaplink_documentation=&gt;get( ids = zaplink_object_data=&gt;r_doc_ids-interface
                                                  object = obj_mask ).
      CREATE OBJECT object.
      object-&gt;complete_data( CHANGING fm_data = _d ).
      object-&gt;from_data( _d ).
      object-&gt;_code_signature = get_interface_signature( classkey ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_class.
  DATA _d               TYPE t_fm_data.
  DATA i_korrnr         TYPE trkorr.              &quot;#EC NEEDED for debug
  DATA _component       TYPE to_component.
  DATA _name            TYPE td_compname.
  TRY.
      _d = o_data-&gt;to_data( ).
      IF NOT _d-exceptions_texts IS INITIAL.
        zaplink_clas_data=&gt;update_concept( EXPORTING msg_col = application_log
                                           CHANGING  fm_data = _d ).
      ENDIF.
      CALL FUNCTION &apos;SEO_CLASS_CREATE_COMPLETE&apos;
       EXPORTING
         overwrite                          = &apos;X&apos;                   &quot;overwrite
         method_sources                     = _d-method_sources    &quot; Methods source
         locals_def                         = _d-locals_def        &quot; LOCAL_TYPES
         locals_imp                         = _d-locals_imp        &quot; LOCAL_IMP
         locals_mac                         = _d-locals_mac        &quot; MACROS
       IMPORTING
         korrnr                             = i_korrnr
       TABLES
         class_descriptions                 = _d-class_desc
         component_descriptions             = _d-component_desc
         subcomponent_descriptions          = _d-subcomponent_desc
       CHANGING
         class                              = _d-class
         inheritance                        = _d-inheritance
         redefinitions                      = _d-redefinitions
         implementings                      = _d-implementings
         impl_details                       = _d-impl_details
         attributes                         = _d-attributes
         methods                            = _d-methods
         events                             = _d-events
         types                              = _d-types
         PARAMETERS                         = _d-parameters
         exceps                             = _d-exceps
         aliases                            = _d-aliases
         typepusages                        = _d-typeusages
         clsdeferrds                        = _d-clsdeferrds
         intdeferrds                        = _d-intdeferrds
         friendships                        = _d-friendships
       EXCEPTIONS
         existing                           = 1
         is_interface                       = 2
         db_error                           = 3
         component_error                    = 4
         no_access                          = 5
         other                              = 6
         OTHERS                             = 7.
      CASE sy-subrc.
        WHEN 0.
        WHEN OTHERS.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_CREATE_COMPLETE&apos;
                                                      subrc = sy-subrc
                                                  classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
          application_log-&gt;add_symsg( ).
          RAISE EXCEPTION o_mycx.
      ENDCASE.
      _d-includes = get_includes( _d-class-clsname ).
      set_dynpros( program = _d-includes-classpool          &quot; Issue 8
                   dynpros = _d-dynpros ).
      set_menus( program = _d-includes-classpool            &quot; Issue 9
                   menus = _d-menupainter ).
      set_prog_textpool( program = _d-includes-classpool    &quot; Issue 1
                        textpool = _d-textspool ).
      zaplink_documentation=&gt;set( _d-documentation ).
      CREATE OBJECT _component.
      _component-&gt;set_type( zaplink_object_data=&gt;object_types-class ).
      _name = _d-class-clsname.
      _component-&gt;set_name( _name ).
      CREATE OBJECT components.
      components-&gt;add( _component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_interface.
  DATA _d           TYPE t_fm_data.
  DATA i_korrnr     TYPE trkorr.                  &quot;#EC NEEDED for debug
  DATA _component   TYPE to_component.
  DATA _name        TYPE td_compname.
  TRY.
      _d = o_data-&gt;to_data( ).
      CALL FUNCTION &apos;SEO_INTERFACE_CREATE_COMPLETE&apos;
        EXPORTING
          overwrite                          = seox_true
        IMPORTING
          korrnr                             = i_korrnr
        TABLES
          class_descriptions                 = _d-class_desc
          component_descriptions             = _d-component_desc
          subcomponent_descriptions          = _d-subcomponent_desc
        CHANGING
          interface                          = _d-interface
          comprisings                        = _d-comprisings
          attributes                         = _d-attributes
          methods                            = _d-methods
          events                             = _d-events
          PARAMETERS                         = _d-parameters
          exceps                             = _d-exceps
          aliases                            = _d-aliases
          typepusages                        = _d-typeusages
          clsdeferrds                        = _d-clsdeferrds
          intdeferrds                        = _d-intdeferrds
          types                              = _d-types
        EXCEPTIONS
          existing                           = 1
          is_class                           = 2
          db_error                           = 3
          component_error                    = 4
          no_access                          = 5
          other                              = 6
          OTHERS                             = 7.
      CASE sy-subrc.
        WHEN &apos;0&apos;.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.
      DATA  intkey TYPE seoclskey.
      DATA  type   TYPE vseotype.
      FIELD-SYMBOLS &lt;alias&gt; LIKE LINE OF _d-aliases.
      LOOP AT _d-aliases ASSIGNING &lt;alias&gt;
              WHERE cmptype = seoo_cmptype_type.
        MOVE-CORRESPONDING &lt;alias&gt; TO type.
        type-alias = seox_true.
        type-state = seoc_state_implemented.
        CALL FUNCTION &apos;SEO_TYPE_CREATE_F_DATA&apos;
          EXPORTING
            save   = seox_false
          CHANGING
            type   = type
          EXCEPTIONS
            OTHERS = 1.
        IF sy-subrc &lt;&gt; 0.
          CALL METHOD application_log-&gt;add_symsg
            EXPORTING
              id_msgty = &apos;W&apos;.
        ENDIF.
      ENDLOOP.
      MOVE-CORRESPONDING _d-interface TO intkey.
      CALL FUNCTION &apos;SEO_CLIF_SAVE_ALL&apos;
        EXPORTING
          cifkey                        = intkey
          suppress_refactoring_entries  = seox_true
          suppress_modification_support = seox_true
        EXCEPTIONS
          db_error                      = 1
          OTHERS                        = 2.
      IF sy-subrc &lt;&gt; 0.
        CALL METHOD application_log-&gt;add_symsg
          EXPORTING
            id_msgty = &apos;W&apos;.
      ENDIF.
      zaplink_documentation=&gt;set( o_data-&gt;documentation ).
      CREATE OBJECT _component.
      _component-&gt;set_type( zaplink_object_data=&gt;object_types-interface ).
      _name = _d-interface-clsname.
      _component-&gt;set_name( _name ).
      CREATE OBJECT components.
      components-&gt;add( _component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~create_new_raw.
  DATA o_clas TYPE to_class.
  DATA o_intf TYPE to_interface.
  CREATE OBJECT object.
  CASE type.
    WHEN zaplink_object_data=&gt;object_types-class.
      CREATE OBJECT o_clas.
      object-&gt;raw = o_clas.
    WHEN zaplink_object_data=&gt;object_types-interface.
      CREATE OBJECT o_intf.
      object-&gt;raw = o_intf.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; type.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).
        CALL FUNCTION &apos;SEO_CLASS_DELETE_W_DEPS&apos;
          EXPORTING
            clskey       = clskey
          EXCEPTIONS
            not_existing = 1
            is_interface = 2
            not_deleted  = 3
            db_error     = 4
            OTHERS       = 5.
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN 1.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).
        CALL FUNCTION &apos;SEO_INTERFACE_DELETE_COMPLETE&apos;
          EXPORTING
            intkey                     = clskey
            authority_check            = seox_true
            suppress_docu_delete       = seox_true
          EXCEPTIONS
            not_existing               = 1
            is_class                   = 2
            db_error                   = 3
            no_access                  = 4
            other                      = 5
            OTHERS                     = 6
                  .
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN 1.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).
        CALL FUNCTION &apos;SEO_CLASS_EXISTENCE_CHECK&apos;
          EXPORTING
            clskey        = clskey
          EXCEPTIONS
            not_specified = 1
            not_existing  = 2
            is_interface  = 3
            no_text       = 4
            inconsistent  = 5
            OTHERS        = 6.
        IF sy-subrc = 0.
          exists = &apos;X&apos;.
        ENDIF.
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).
        CALL FUNCTION &apos;SEO_INTERFACE_EXISTENCE_CHECK&apos;
          EXPORTING
            intkey              = clskey
         EXCEPTIONS
           not_specified       = 1
           not_existing        = 2
           is_class            = 3
           no_text             = 4
           inconsistent        = 5
           OTHERS              = 6.
        IF sy-subrc = 0.
          exists = &apos;X&apos;.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~read_from_sap.
  DATA o_clas TYPE to_class.
  DATA o_intf TYPE to_interface.
  DATA d_type TYPE td_comptype.
  TRY.
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        TRY.
            o_clas = export_from_sap_class( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_clas-&gt;a0_maindata-clsname.
        object-&gt;raw = o_clas.
      WHEN zaplink_object_data=&gt;object_types-interface.
        TRY.
            o_intf = export_from_sap_interface( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_intf-&gt;a0_maindata-clsname.
        object-&gt;raw = o_intf.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.
  TRY.
    CASE object-&gt;type.
      WHEN zaplink_object_data=&gt;object_types-class.
        _o_class ?= object-&gt;raw.
        _o_class-&gt;a0_maindata-clsname = object-&gt;name.
        TRY.
            components = import_to_sap_class( _o_class ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN zaplink_object_data=&gt;object_types-interface.
        _o_interface ?= object-&gt;raw.
        _o_interface-&gt;a0_maindata-clsname = object-&gt;name.
        TRY.
            components = import_to_sap_interface( _o_interface ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; object-&gt;type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver OR version = &apos;1.0&apos;.   &quot; version 1.01 is downward compatible with version 1.0
    result = abap_true.
  endif.
endmethod.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  CASE object-&gt;type.
    WHEN zaplink_object_data=&gt;object_types-class.
      _o_class ?= object-&gt;raw.
      _o_class-&gt;anonymize( ).
    WHEN zaplink_object_data=&gt;object_types-interface.
      _o_interface ?= object-&gt;raw.
      _o_interface-&gt;anonymize( ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~unanonymize.
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  CASE object-&gt;type.
    WHEN zaplink_object_data=&gt;object_types-class.
      _o_class ?= object-&gt;raw.
      _o_class-&gt;unanonymize( ).
    WHEN zaplink_object_data=&gt;object_types-interface.
      _o_interface ?= object-&gt;raw.
      _o_interface-&gt;unanonymize( ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_cnx_ext_code_signature~get_signature.
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).
        result = get_class_signature( clskey ).
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).
        result = get_interface_signature( clskey ).
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD get_class_globalsource.
  DATA t_upcode    TYPE td_sourcecode.
  DATA _line       LIKE LINE OF t_upcode.
  DATA d_class     TYPE  vseoclass.
  DATA t_attrs     TYPE  seoo_attributes_r.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF result,
    &lt;a&gt; LIKE LINE OF t_attrs.
  CALL FUNCTION &apos;SEO_CLASS_GET&apos;
    EXPORTING
      clskey       = class_name
      version      = seoc_version_inactive
      state        = &apos;0&apos;
    IMPORTING
      class        = d_class
    EXCEPTIONS
      not_existing = 1
      deleted      = 2
      is_interface = 3
      model_only   = 4
      OTHERS       = 5.
  IF sy-subrc &lt;&gt; 0.
    RAISE not_a_class.
  ENDIF.
  result = get_class_globalsource_( class_name ).
  zaplink_tools=&gt;pretty_printer( CHANGING table = result ).
  IF d_class-category = &apos;40&apos;.  &quot; 40 Exception Class
    CALL FUNCTION &apos;SEO_CLASS_TYPEINFO_GET&apos;
      EXPORTING
        clskey                              = class_name
      IMPORTING
        attributes                          = t_attrs
      EXCEPTIONS
        not_existing                        = 1
        is_interface                        = 2
        model_only                          = 3
        OTHERS                              = 4.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.
    DELETE t_attrs
           WHERE   exposure &lt;&gt; 2    &quot; Public
              OR attdecltyp &lt;&gt; 2    &quot; Cosntant
              OR NOT type CP &apos;SOTR_CONC&apos;.
    LOOP AT t_attrs ASSIGNING &lt;a&gt;.
      REPLACE ALL OCCURRENCES OF &lt;a&gt;-attvalue IN TABLE result WITH space.   &quot; Issue 71, remove SOTR GUID values when calculating code signature
    ENDLOOP.
  ENDIF.
  LOOP AT result ASSIGNING &lt;t&gt;.
    REPLACE FIRST OCCURRENCE OF REGEX &apos;\.$&apos; IN &lt;t&gt; WITH &apos; .&apos;.   &quot; change &apos;.&apos; to &apos; .&apos;
  ENDLOOP.
  zaplink_tools=&gt;condense_abap_source( CHANGING table = result ).
  t_upcode = result.
  zaplink_tools=&gt;conv_table_2upcase( CHANGING table = t_upcode ).
  CONCATENATE &apos;CLASS&apos; class_name &apos;DEFINITION&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS  FROM _line.
  CHECK sy-subrc = 0.
  SUBTRACT 1 FROM sy-tabix.   CHECK sy-tabix &gt;= 1.    DELETE result TO sy-tabix.
ENDMETHOD.
METHOD get_class_signature.
  DATA d_type    TYPE td_comptype.
  DATA t_code    TYPE td_sourcecode.
  DATA d_src     TYPE string.
  t_code = get_class_globalsource( class_name ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).
ENDMETHOD.
METHOD get_interface_globalsource.
  DATA d_prog     TYPE program.
  DATA t_upcode   TYPE td_sourcecode.
  DATA _line      LIKE LINE OF t_upcode.
  d_prog = cl_oo_classname_service=&gt;get_intfsec_name( interface_name-clsname ).
  READ REPORT d_prog INTO result.
  zaplink_tools=&gt;pretty_printer( CHANGING table = result ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = result ).
  t_upcode = result.    zaplink_tools=&gt;conv_table_2upcase( CHANGING table = t_upcode ).
  CONCATENATE &apos;INTERFACE&apos; interface_name INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS  FROM _line.
  CHECK sy-subrc = 0.
  SUBTRACT 1 FROM sy-tabix.   CHECK sy-tabix &gt;= 1.   DELETE result TO sy-tabix.
ENDMETHOD.
METHOD get_interface_signature.
  DATA d_type    TYPE td_comptype.
  DATA t_code    TYPE td_sourcecode.
  DATA d_src     TYPE string.
  t_code = get_interface_globalsource( interface_name ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).
ENDMETHOD.
METHOD get_class_globalsource_.
  DATA cpool TYPE seo_section_source.
  DATA pubsec TYPE seo_section_source.
  DATA prisec TYPE seo_section_source.
  DATA prosec TYPE seo_section_source.
  DATA cl TYPE seo_section_source.
  DATA ccdef TYPE seop_source_string.
  DATA ccimp TYPE seop_source_string.
  DATA ccmac TYPE seop_source_string.
  DATA incname TYPE program.
  DATA pubsec_incname TYPE program.
  DATA prisec_incname TYPE program.
  DATA prosec_incname TYPE program.
  DATA cl_incname TYPE program.
  DATA ccdef_incname TYPE program.
  DATA ccimp_incname TYPE program.
  DATA ccmac_incname TYPE program.
  DATA meth_inc TYPE seop_method_w_include.
  DATA meth_incs TYPE seop_methods_w_include.
  DATA source_tmp TYPE seop_source_string.
  FIELD-SYMBOLS &lt;source_line&gt; TYPE seo_section_source_line.
  incname = cl_oo_classname_service=&gt;get_classpool_name( class_name-clsname ).
  cpool = get_prog_rawsource( incname ).                                          &quot; Issue 73
  pubsec_incname = cl_oo_classname_service=&gt;get_pubsec_name( class_name-clsname ).
  pubsec = get_prog_rawsource( pubsec_incname ).                                  &quot; Issue 73
  prosec_incname = cl_oo_classname_service=&gt;get_prosec_name( class_name-clsname ).
  prosec = get_prog_rawsource( prosec_incname ).                                  &quot; Issue 73
  prisec_incname = cl_oo_classname_service=&gt;get_prisec_name( class_name-clsname ).
  prisec = get_prog_rawsource( prisec_incname ).                                  &quot; Issue 73
  cl_incname = cl_oo_classname_service=&gt;get_cl_name( class_name-clsname ).
  cl = get_prog_rawsource( cl_incname ).                                          &quot; Issue 73
  ccdef_incname = cl_oo_classname_service=&gt;get_ccdef_name( class_name-clsname ).
  ccdef = get_prog_rawsource( ccdef_incname ).                                    &quot; Issue 73
  ccimp_incname = cl_oo_classname_service=&gt;get_ccimp_name( class_name-clsname ).
  ccimp = get_prog_rawsource( ccimp_incname ).                                    &quot; Issue 73
  ccmac_incname = cl_oo_classname_service=&gt;get_ccmac_name( class_name-clsname ).
  ccmac = get_prog_rawsource( ccmac_incname ).                                    &quot; Issue 73
  meth_incs = cl_oo_classname_service=&gt;get_all_method_includes( class_name-clsname ).
  SORT meth_incs BY cpdkey.         &quot; Issue 68 : Force alphabetic order
  LOOP AT cpool ASSIGNING &lt;source_line&gt;.
    IF &lt;source_line&gt; CS pubsec_incname.
      APPEND LINES OF pubsec TO result.
    ELSEIF &lt;source_line&gt; CS prosec_incname.
      APPEND LINES OF prosec TO result.
    ELSEIF &lt;source_line&gt; CS prisec_incname.
      APPEND LINES OF prisec TO result.
    ELSEIF &lt;source_line&gt; CS cl_incname.
      APPEND LINES OF cl TO result.
    ELSEIF &lt;source_line&gt; CS ccdef_incname.
      APPEND LINES OF ccdef TO result.
    ELSEIF &lt;source_line&gt; CS ccimp_incname.
      APPEND LINES OF ccimp TO result.
    ELSEIF &lt;source_line&gt; CS ccmac_incname.
      APPEND LINES OF ccmac TO result.
    ELSEIF &lt;source_line&gt; CS &apos;include methods&apos;.
      LOOP AT meth_incs INTO meth_inc.
        source_tmp = get_prog_rawsource( meth_inc-incname ).                     &quot; Issue 73
        IF NOT source_tmp IS INITIAL.
          APPEND LINES OF source_tmp TO result.
        ENDIF.
      ENDLOOP.
    ELSE.
      APPEND &lt;source_line&gt; TO result.
    ENDIF .
  ENDLOOP.
ENDMETHOD.
METHOD search_type_pool.
  DATA d_tabix TYPE sy-tabix.
  DATA t_tokens TYPE STANDARD TABLE OF stokes.
  DATA t_statments TYPE STANDARD TABLE OF sstmnt.
  DATA s_tp     LIKE LINE OF new_typepools.
  DATA d_flag TYPE abap_bool.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF new_sourcecode,
    &lt;t&gt; LIKE LINE OF t_tokens,
    &lt;n&gt; LIKE LINE OF t_tokens.
  CHECK NOT sourcecode IS INITIAL.
  new_sourcecode = sourcecode.
  SCAN ABAP-SOURCE sourcecode
                   TOKENS INTO t_tokens
                   STATEMENTS INTO t_statments.
  LOOP AT t_tokens ASSIGNING &lt;t&gt;
    WHERE str CP &apos;TYPE-POOLS&apos;.
    d_tabix = sy-tabix + 1.
    READ TABLE t_tokens ASSIGNING &lt;n&gt; INDEX d_tabix.
    CHECK sy-subrc = 0.
    CHECK &lt;n&gt;-row = &lt;t&gt;-row.    &quot; TYPE-POOLS ABAP.
    READ TABLE typepools TRANSPORTING NO FIELDS
         WITH KEY typegroup = &lt;n&gt;-str
                   explicit = abap_true.
    CHECK sy-subrc &lt;&gt; 0 OR public IS INITIAL.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_tp.
      s_tp-typegroup = &lt;n&gt;-str.
      s_tp-tputype = 0.     &quot; Type group use                (TYPE-POOLS tp)
      s_tp-explicit = abap_true.
      s_tp-implicit = abap_false.
      APPEND s_tp TO new_typepools.
    ENDIF.
    READ TABLE new_sourcecode ASSIGNING &lt;s&gt; INDEX &lt;n&gt;-row.
    CONCATENATE &apos;*&apos; &lt;s&gt; &apos;&quot;Auto commented by ZAPLINK_OBJECT connector and added as Explicit type group&apos;(cmt) INTO &lt;s&gt;.
    d_flag = abap_true.
  ENDLOOP.
  IF d_flag IS INITIAL. CLEAR new_sourcecode. ENDIF.
ENDMETHOD.
METHOD load_clas.
  CALL FUNCTION &apos;SEO_CLASS_TYPEINFO_GET&apos;
    EXPORTING
      clskey                              = classkey
      version                             = _d-class-version
      state                               = _d-class-state
      resolve_eventhandler_typeinfo       = seox_true
      with_master_language                = seox_true
      with_enhancements                   = seox_true
    IMPORTING
      class                               = _d-class
      attributes                          = _d-attributes
      methods                             = _d-methods
      events                              = _d-events
      types                               = _d-types
      PARAMETERS                          = _d-parameters
      exceps                              = _d-exceps
      implementings                       = _d-implementings
      inheritance                         = _d-inheritance
      redefinitions                       = _d-redefinitions
      impl_details                        = _d-impl_details
      friendships                         = _d-friendships
      typepusages                         = _d-typeusages
      clsdeferrds                         = _d-clsdeferrds
      intdeferrds                         = _d-intdeferrds
      explore_inheritance                 = _d-explore_inheritance
      explore_implementings               = _d-explore_implementings
      aliases                             = _d-aliases
      enhancement_methods                 = _d-enhancement_methods
      enhancement_attributes              = _d-enhancement_attributes
      enhancement_events                  = _d-enhancement_events
      enhancement_implementings           = _d-enhancement_implementings
    EXCEPTIONS
      not_existing                        = 1
      is_interface                        = 2
      model_only                          = 3
      OTHERS                              = 4.
  IF sy-subrc &lt;&gt; 0.
    o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_TYPEINFO_GET&apos;
                                                subrc = sy-subrc
                                            classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
    application_log-&gt;add_symsg( ).
    RAISE EXCEPTION o_mycx.
  ENDIF.
ENDMETHOD.
METHOD get_includes.
  data d_CIFKEY  TYPE SEOCLSKEY.
  DATA d_clstype TYPE seoclstype.
  d_cifkey-clsname = clsname.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = d_cifkey
    IMPORTING
      clstype            = d_clstype
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 3
      OTHERS             = 4.
  IF sy-subrc = 0.
    IF d_clstype EQ 0.
      includes-classpool = cl_oo_classname_service=&gt;get_classpool_name( clsname ).
      includes-pubsec    = cl_oo_classname_service=&gt;get_pubsec_name( clsname ).
      includes-prosec    = cl_oo_classname_service=&gt;get_prosec_name( clsname ).
      includes-prisec    = cl_oo_classname_service=&gt;get_prisec_name( clsname ).
      includes-cl        = cl_oo_classname_service=&gt;get_cl_name( clsname ).
      includes-ccdef     = cl_oo_classname_service=&gt;get_ccdef_name( clsname ).
      includes-ccimp     = cl_oo_classname_service=&gt;get_ccimp_name( clsname ).
      includes-ccmac     = cl_oo_classname_service=&gt;get_ccmac_name( clsname ).
      CALL METHOD cl_oo_classname_service=&gt;get_all_method_includes
        EXPORTING
          clsname            = clsname
        RECEIVING
          result             = includes-methods
        EXCEPTIONS
          class_not_existing = 0
          OTHERS             = 0.   &quot; Ignore exception : Class may not exits
    ELSEIF d_clstype EQ 1.
      includes-interfacepool = cl_oo_classname_service=&gt;get_interfacepool_name( clsname ).
      includes-intfsec       = cl_oo_classname_service=&gt;get_intfsec_name( clsname ).
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD check_clas_sections.
  DATA pubsec_source TYPE seo_section_source.
  DATA prosec_source TYPE seo_section_source.
  DATA prisec_source TYPE seo_section_source.
  DATA code          TYPE tt_abaprawsource.
  DATA classkey      TYPE seoclskey.
  classkey-clsname = class-class-clsname.
  CALL FUNCTION &apos;SEO_CLASS_GENERATE_SECTIONS&apos;
    EXPORTING
      clskey                               = classkey
      public                               = seox_true
      protected                            = seox_true
      private                              = seox_true
      return_generated_sections_only       = seox_true
    IMPORTING
      pubsec_source                        = pubsec_source
      prosec_source                        = prosec_source
      prisec_source                        = prisec_source
    EXCEPTIONS
      not_existing                         = 1
      model_only                           = 2
      public_sec_not_generated             = 3
      protected_sec_not_generated          = 4
      private_sec_not_generated            = 5
      public_sec_not_initialised           = 6
      protected_sec_not_initialised        = 7
      private_sec_not_initialised          = 8
      _internal_class_not_existing         = 9
      OTHERS                               = 10.
  IF sy-subrc &lt;&gt; 0.
    o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_GENERATE_SECTIONS&apos;
                                                subrc = sy-subrc
                                            classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
    application_log-&gt;add_symsg( ).
    RAISE EXCEPTION o_mycx.
  ENDIF.
  code = get_prog_rawsource( class-includes-pubsec ).
  IF pubsec_source = code.
    CLEAR pubsec_source.
  ELSE.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE w003 WITH text-pub classkey. ENDIF.
    SET EXTENDED CHECK ON.
    CALL METHOD application_log-&gt;add_warning
      EXPORTING
        id_msgno     = &apos;003&apos;
          id_msgv1     = &apos;Public section&apos;(pub)
        id_msgv2     = classkey.
  ENDIF.
  code = get_prog_rawsource( class-includes-prosec ).
  IF prosec_source = code.
    CLEAR prosec_source.
  ELSE.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE w003 WITH text-pro classkey. ENDIF.
    SET EXTENDED CHECK ON.
    CALL METHOD application_log-&gt;add_warning
      EXPORTING
        id_msgno     = &apos;003&apos;
        id_msgv1     = &apos;Protected section&apos;(pro)
        id_msgv2     = classkey.
  ENDIF.
  code = get_prog_rawsource( class-includes-prisec ).
  IF prisec_source = code.
    CLEAR prisec_source.
  ELSE.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE w003 WITH text-pri classkey. ENDIF.
    SET EXTENDED CHECK ON.
    CALL METHOD application_log-&gt;add_warning
      EXPORTING
        id_msgno     = &apos;003&apos;
        id_msgv1     = &apos;Private section&apos;(pri)
        id_msgv2     = classkey.
  ENDIF.
  IF NOT pubsec_source IS INITIAL OR NOT prosec_source IS INITIAL OR NOT prisec_source IS INITIAL.
    CALL FUNCTION &apos;SEO_CLASS_GENERATE_SECTIONS&apos;
      EXPORTING
        clskey                               = classkey
        public                               = seox_true
        protected                            = seox_true
        private                              = seox_true
      EXCEPTIONS
        not_existing                         = 1
        model_only                           = 2
        public_sec_not_generated             = 3
        protected_sec_not_generated          = 4
        private_sec_not_generated            = 5
        public_sec_not_initialised           = 6
        protected_sec_not_initialised        = 7
        private_sec_not_initialised          = 8
        _internal_class_not_existing         = 9
        OTHERS                               = 10.
    IF sy-subrc &lt;&gt; 0.
      o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_GENERATE_SECTIONS&apos;
                                                  subrc = sy-subrc
                                              classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
      application_log-&gt;add_symsg( ).
      RAISE EXCEPTION o_mycx.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD check_intf_section.
  DATA pubsec_source TYPE seo_section_source.
  DATA code          TYPE tt_abaprawsource.
  DATA intkey        TYPE seoclskey.
  intkey-clsname = interface-interface-clsname.
  CALL FUNCTION &apos;SEO_INTERFACE_GENERATE_SECTION&apos;
    EXPORTING
      intkey                               = intkey
      return_generated_sections_only       = seox_true
    IMPORTING
      interface_source                     = pubsec_source
    EXCEPTIONS
      not_existing                         = 1
      model_only                           = 2
      interf_section_not_generated         = 3
      interf_section_not_initialised       = 4
      OTHERS                               = 5.
  IF sy-subrc &lt;&gt; 0.
    o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_INTERFACE_GENERATE_SECTION&apos;
                                                subrc = sy-subrc
                                            classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
    application_log-&gt;add_symsg( ).
    RAISE EXCEPTION o_mycx.
  ENDIF.
  code = get_prog_rawsource( interface-includes-intfsec ).
  IF pubsec_source = code.
    CLEAR pubsec_source.
  ELSE.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE w003 WITH text-pub intkey. ENDIF.
    SET EXTENDED CHECK ON.
    CALL METHOD application_log-&gt;add_warning
      EXPORTING
        id_msgno     = &apos;003&apos;
        id_msgv1     = &apos;Public section&apos;(pub)
        id_msgv2     = intkey.
  ENDIF.
  IF NOT pubsec_source IS INITIAL.
    CALL FUNCTION &apos;SEO_INTERFACE_GENERATE_SECTION&apos;
      EXPORTING
        intkey                               = intkey
        return_generated_sections_only       = seox_false
      EXCEPTIONS
        not_existing                         = 1
        model_only                           = 2
        interf_section_not_generated         = 3
        interf_section_not_initialised       = 4
        OTHERS                               = 5.
    IF sy-subrc &lt;&gt; 0.
      o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_INTERFACE_GENERATE_SECTION&apos;
                                                  subrc = sy-subrc
                                              classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
      application_log-&gt;add_symsg( ).
      RAISE EXCEPTION o_mycx.
    ENDIF.
  ENDIF.
ENDMETHOD.
endclass. &quot;ZAPLINK_OBJECT implementation
class ZAPLINK_PACKAGE implementation.
METHOD add_elements_list.
  DATA _err       TYPE scomeldata.
  DATA _err_lst   TYPE scomeldata.
  DATA alv_data   TYPE tt_ele.
  DATA a_data     LIKE LINE OF alv_data.
  DATA exception  TYPE REF TO zaplink_cx_connector.
  DATA title      TYPE lvc_title.
  DATA errormsg   TYPE string.
  FIELD-SYMBOLS &lt;e&gt; LIKE LINE OF _err.
  FIELD-SYMBOLS &lt;l&gt; LIKE LINE OF interface-&gt;elements.
  CALL METHOD interface-&gt;if-&gt;add_elements
    EXPORTING
      i_elements_data        = interface-&gt;elements
    IMPORTING
      e_mismatched_elem_data = _err &quot; Should be empty if all OK
    EXCEPTIONS
      object_invalid         = 1
      intern_err             = 2
      OTHERS                 = 3
          .
  IF sy-subrc &lt;&gt; 0 OR NOT _err IS INITIAL.
    IF _err IS INITIAL.
      errormsg = &apos;Package interface elements creation failed !&apos;(e91).
    ELSEIF sy-batch = &apos;X&apos; OR ask_user IS INITIAL.
      errormsg = build_error_msg( _err ).
      CONCATENATE &apos;Package interface elements failed to add : &apos;(e92) errormsg INTO errormsg.
    ELSE. &quot; ask user
      LOOP AT _err ASSIGNING &lt;e&gt;.
        READ TABLE interface-&gt;elements ASSIGNING &lt;l&gt;
             WITH KEY intf_name = &lt;e&gt;-intf_name
                      elem_type = &lt;e&gt;-elem_type
                       elem_key = &lt;e&gt;-elem_key.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;system_error.
        ENDIF.
        &lt;e&gt; = &lt;l&gt;. &quot; back to original value
      ENDLOOP.
      alv_data = elements2alv( _err ).
      a_data-elem_pack = interface-&gt;if-&gt;publisher_package_name.
      MODIFY alv_data FROM a_data TRANSPORTING elem_pack WHERE elem_pack IS INITIAL.   &quot;update package
      title = &apos;Incosistant TADIR entries please select elements that will change package. All unselected entries won&apos;&apos;t be in this interface&apos;(alv).
      CALL FUNCTION &apos;REUSE_ALV_GRID_DISPLAY&apos;
        EXPORTING
          i_grid_title                      = title
          is_layout                         = cat_layout
          it_fieldcat                       = cat_ele
        TABLES
          t_outtab                          = alv_data
        EXCEPTIONS
         program_error                     = 1
         OTHERS                            = 2.
      IF sy-subrc &lt;&gt; 0.
        errormsg = build_error_msg( _err ).
        CONCATENATE &apos;Package interface elements failed to add : &apos;(e92) errormsg INTO errormsg.
      ELSE.
        change_tadir( CHANGING alv_data = alv_data ).
        LOOP AT _err ASSIGNING &lt;e&gt;.
          CLEAR a_data.
          READ TABLE alv_data INTO a_data WITH KEY elem_type = &lt;e&gt;-elem_type
                                                    elem_key = &lt;e&gt;-elem_key.
          IF sy-subrc &lt;&gt; 0 OR a_data-select IS INITIAL.
            APPEND &lt;e&gt; TO _err_lst.
            DELETE _err.
          ENDIF.
        ENDLOOP.
        TRY.
            interface-&gt;elements = _err.
            CALL METHOD add_elements_list
              EXPORTING
                interface = interface
                .
          CATCH zaplink_cx_connector INTO exception.
            RAISE EXCEPTION exception.
        ENDTRY.
        IF _err_lst IS INITIAL.
          EXIT. &quot; if every thing is OK
        ELSE.
          errormsg = build_error_msg( _err_lst ).
          CONCATENATE &apos;Package interface elements failed to add : &apos;(e92) errormsg INTO errormsg.
        ENDIF.
      ENDIF.
    ENDIF.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error
       cx_name = errormsg.
  ENDIF.
  CALL METHOD interface-&gt;if-&gt;save_elements
    EXPORTING
      i_transport_request   = transport_request
    IMPORTING
      e_transport_request   = transport_request
    EXCEPTIONS
      object_not_changeable = 1
      object_invalid        = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error
       cx_name = &apos;Package interface save failed !&apos;.
  ENDIF.
ENDMETHOD.
METHOD build_error_msg.
  DATA obj_key    TYPE string.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF elements.
  LOOP AT elements ASSIGNING &lt;e&gt;.
    CONCATENATE &lt;e&gt;-elem_key &apos;(&apos; &lt;e&gt;-elem_type &apos;)&apos; INTO obj_key.
    IF errormsg IS INITIAL.
      errormsg = obj_key.
    ELSE.
      CONCATENATE errormsg &apos;, &apos; obj_key INTO errormsg.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD change_tadir.
  DATA :
    object TYPE tadir-object,
    obj_name TYPE tadir-obj_name,
    korrnum TYPE tadir-korrnum.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF alv_data.
  korrnum = transport_request.
  LOOP AT alv_data ASSIGNING &lt;e&gt;
          WHERE NOT select IS INITIAL.
    object = &lt;e&gt;-elem_type.
    obj_name = &lt;e&gt;-elem_key.
    CALL FUNCTION &apos;TRINT_TADIR_INTERFACE&apos;
      EXPORTING
        wi_test_modus                        = &apos; &apos;
        wi_tadir_pgmid                       = &apos;R3TR&apos;
        wi_tadir_object                      = object
        wi_tadir_obj_name                    = obj_name
        wi_tadir_korrnum                     = korrnum
        wi_tadir_devclass                    = &lt;e&gt;-elem_pack
     EXCEPTIONS
        tadir_entry_not_existing             = 1
        tadir_entry_ill_type                 = 2
        no_systemname                        = 3
        no_systemtype                        = 4
        original_system_conflict             = 5
        object_reserved_for_devclass         = 6
        object_exists_global                 = 7
        object_exists_local                  = 8
        object_is_distributed                = 9
        obj_specification_not_unique         = 10
        no_authorization_to_delete           = 11
        devclass_not_existing                = 12
        simultanious_set_remove_repair       = 13
        order_missing                        = 14
        no_modification_of_head_syst         = 15
        pgmid_object_not_allowed             = 16
        masterlanguage_not_specified         = 17
        devclass_not_specified               = 18
        specify_owner_unique                 = 19
        loc_priv_objs_no_repair              = 20
        gtadir_not_reached                   = 21
        object_locked_for_order              = 22
        change_of_class_not_allowed          = 23
        no_change_from_sap_to_tmp            = 24
        OTHERS                               = 25
              .
    IF sy-subrc &lt;&gt; 0.
      CLEAR &lt;e&gt;-select.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
method CLASS_CONSTRUCTOR.
  DATA ls_fieldcat  LIKE LINE OF  cat_ele.
  ls_fieldcat-fieldname = &apos;ELEM_TYPE&apos;.
  ls_fieldcat-seltext_l = &apos;Object Type&apos;(c01).
  APPEND ls_fieldcat TO cat_ele.
  ls_fieldcat-fieldname = &apos;ELEM_KEY&apos;.
  ls_fieldcat-seltext_l = &apos;Object Name&apos;(c02).
  APPEND ls_fieldcat TO cat_ele.
  ls_fieldcat-fieldname = &apos;TD_PACK&apos;.
  ls_fieldcat-seltext_l = &apos;TADIR Package&apos;(c03).
  APPEND ls_fieldcat TO cat_ele.
  ls_fieldcat-fieldname = &apos;ELEM_PACK&apos;.
  ls_fieldcat-seltext_s = &apos;New package&apos;(c04).
  ls_fieldcat-seltext_l = &apos;New package when validated&apos;(l04).
  APPEND ls_fieldcat TO cat_ele.
  cat_layout-box_fieldname     = &apos;SELECT&apos;.
  cat_layout-colwidth_optimize = &apos;X&apos;.
endmethod.
method CONSTRUCTOR.
  DATA type LIKE LINE OF supported_types.
  call method super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.      &quot; create my application before parent do the same
  application_log-&gt;msgid = &apos;ZAPLINK_PACKAGE&apos;.
  type-type = st_package. INSERT type INTO TABLE supported_types.
  type-type = st_interface. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
METHOD conv_interface.
  DATA elements   TYPE tpak_package_interf_elem_list.
  DATA elem       LIKE LINE OF o_data-&gt;elements.
  DATA _component  TYPE to_component.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF elements.
  TRY.
      CREATE OBJECT o_data.
      CALL METHOD interface-&gt;get_all_attributes
        IMPORTING
          e_package_interface_data = o_data-&gt;a0_maindata
        EXCEPTIONS
          object_invalid           = 1
          OTHERS                   = 2.
      IF sy-subrc &lt;&gt; 0.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid  = zaplink_cx_connector=&gt;system_error
            cx_name = &apos;error in interface-&gt;get_all_attributes&apos;.
      ENDIF.
      CREATE OBJECT _component.
      _component-&gt;set_type( st_interface ).
      _component-&gt;set_name( o_data-&gt;a0_maindata-intf_name ).
      subcomponents-&gt;add( _component ).
      CALL METHOD interface-&gt;get_elements
        EXPORTING
          i_with_deleted_elements = &apos;X&apos;
        IMPORTING
          e_elements              = elements
        EXCEPTIONS
          object_invalid          = 1
          intern_err              = 2
          OTHERS                  = 3.
      IF sy-subrc &lt;&gt; 0.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid  = zaplink_cx_connector=&gt;system_error
            cx_name = &apos;interface-&gt;get_elements&apos;.
      ELSEIF NOT elements IS INITIAL.
        LOOP AT elements ASSIGNING &lt;e&gt;.
          CALL METHOD &lt;e&gt;-&gt;get_all_attributes
            IMPORTING
              e_element_data = elem
            EXCEPTIONS
              object_invalid = 1
              OTHERS         = 2.
          IF sy-subrc &lt;&gt; 0.
            RAISE EXCEPTION TYPE zaplink_cx_connector
              EXPORTING
                textid  = zaplink_cx_connector=&gt;system_error
                cx_name = &apos;error in interface-&gt;get_all_attributes&apos;.
          ENDIF.
          APPEND elem TO o_data-&gt;elements.
        ENDLOOP.
      ENDIF.
      IF NOT o_data-&gt;a0_maindata-acl_flag IS INITIAL.
        CALL METHOD interface-&gt;get_access_control_list
          IMPORTING
            e_user_list    = o_data-&gt;acls
          EXCEPTIONS
            object_invalid = 1
            no_acl         = 0
            intern_err     = 3
            OTHERS         = 4.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid  = zaplink_cx_connector=&gt;system_error
              cx_name = &apos;interface-&gt;get_access_control_list&apos;.
        ENDIF.
      ENDIF.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD conv_package.
  DATA perm_data   LIKE LINE OF o_data-&gt;acls.
  DATA permissions TYPE tpak_permission_to_use_list.
  DATA interfaces  TYPE tpak_package_interface_list.
  DATA intf        LIKE LINE OF o_data-&gt;interfaces.
  DATA packages    TYPE scompaklis.
  DATA pack        LIKE LINE OF o_data-&gt;packages.
  DATA _component  TYPE to_component.
  FIELD-SYMBOLS:
    &lt;pack&gt; LIKE LINE OF packages,
    &lt;itf&gt; LIKE LINE OF interfaces,
    &lt;p&gt; LIKE LINE OF permissions.
  TRY.
      CLEAR o_mycx.
      CREATE OBJECT o_data.
      CALL METHOD package-&gt;get_all_attributes
        IMPORTING
          e_package_data  = o_data-&gt;a0_maindata
        EXCEPTIONS
          object_invalid  = 1
          package_deleted = 2
          intern_err      = 3
          OTHERS          = 4.
      IF sy-subrc &lt;&gt; 0.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid  = zaplink_cx_connector=&gt;system_error
            cx_name = &apos;error in package-&gt;get_all_attributes&apos;.
      ENDIF.
      CREATE OBJECT _component.
      _component-&gt;set_type( st_package ).
      _component-&gt;set_name( o_data-&gt;a0_maindata-devclass ).
      subcomponents-&gt;add( _component ).
      CALL METHOD package-&gt;get_permissions_to_use
        IMPORTING
          e_permissions    = permissions
        EXCEPTIONS
          object_invalid   = 1
          unexpected_error = 2
          OTHERS           = 3.
      IF sy-subrc &lt;&gt; 0.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid  = zaplink_cx_connector=&gt;system_error
            cx_name = &apos;package-&gt;get_permissions_to_use&apos;.
      ELSEIF NOT permissions IS INITIAL.
        LOOP AT permissions ASSIGNING &lt;p&gt;.
          CHECK &lt;p&gt;-&gt;deleted_in_memory IS INITIAL.
          perm_data-intf_name = &lt;p&gt;-&gt;package_interface_name.
          perm_data-err_sever = &lt;p&gt;-&gt;error_severity.
          APPEND perm_data TO o_data-&gt;acls.
        ENDLOOP.
      ENDIF.
      IF with_subcomp = abap_true.
        CALL METHOD package-&gt;get_interfaces
          IMPORTING
            e_package_interfaces = interfaces
          EXCEPTIONS
            object_invalid       = 1
            unexpected_error     = 2
            intern_err           = 3
            OTHERS               = 4.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;system_error.
        ELSEIF NOT interfaces IS INITIAL.
          LOOP AT interfaces ASSIGNING &lt;itf&gt;.
            TRY.
                intf-zl_object = conv_interface_raw( interface = &lt;itf&gt;
                                                 subcomponents = subcomponents ).
              CATCH zaplink_cx_connector INTO o_mycx.
                application_log-&gt;add_exception( o_mycx ).
            ENDTRY.
            APPEND intf TO o_data-&gt;interfaces.
          ENDLOOP.
        ENDIF.
        CALL METHOD package-&gt;get_sub_packages
          IMPORTING
            e_sub_packages   = packages
          EXCEPTIONS
            object_invalid   = 1
            leaf_package     = 0   &quot; 053(PAK) : Package &amp;1 does not contain any sub-packages
            unexpected_error = 3
            OTHERS           = 4.
        IF sy-subrc &lt;&gt; 0.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;system_error.
        ELSEIF NOT packages IS INITIAL.
          LOOP AT packages ASSIGNING &lt;pack&gt;.
            TRY.
                pack-zl_object = conv_package_raw( package = &lt;pack&gt;
                                             subcomponents = subcomponents ).
              CATCH zaplink_cx_connector INTO o_mycx.
                application_log-&gt;add_exception( o_mycx ).
            ENDTRY.
            APPEND pack TO o_data-&gt;packages.
          ENDLOOP.
        ENDIF.
      ENDIF.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
  IF o_mycx IS BOUND.
    RAISE EXCEPTION o_mycx.
  ENDIF.
ENDMETHOD.
METHOD create_interface.
  DATA _component      TYPE to_component.
  DATA name       TYPE td_interface.
  DATA transport_request  TYPE  e070-trkorr.
  name = interface-&gt;a0_maindata-intf_name.
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE e013 WITH name. ENDIF.
  SET EXTENDED CHECK ON.
  application_log-&gt;add_info( id_msgno = 013
                             id_msgv1 = name ).
  TRY.
      CALL METHOD update_interface
        EXPORTING
          data      = interface-&gt;a0_maindata
        CHANGING
          interface = interface-&gt;if.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  IF NOT interface-&gt;if IS BOUND.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid  = zaplink_cx_connector=&gt;system_error
        cx_name = &apos;Failed to create package interface&apos;.
  ENDIF.
  CALL METHOD interface-&gt;if-&gt;save
    EXPORTING
      i_transport_request   = transport_request
    IMPORTING
      e_transport_request   = transport_request
    EXCEPTIONS
      object_invalid        = 1
      object_not_changeable = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid  = zaplink_cx_connector=&gt;system_error
        cx_name = &apos;Package interface save failed !&apos;.
  ELSE.
    TRY.
        CREATE OBJECT _component.
        _component-&gt;set_type( st_interface ).
        _component-&gt;set_name( name ).
        components-&gt;add( _component ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
  ENDIF.
ENDMETHOD.
METHOD create_package.
  DATA name               TYPE td_package.
  DATA transport_request  TYPE  e070-trkorr.
  DATA _component         TYPE to_component.
  DATA o_intf             TYPE to_interface.
  DATA o_package          TYPE to_package.
  FIELD-SYMBOLS:
    &lt;p&gt; LIKE LINE OF package-&gt;packages,
    &lt;i&gt; LIKE LINE OF package-&gt;interfaces.
  name = package-&gt;a0_maindata-devclass.
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE e003 WITH space. ENDIF.
  SET EXTENDED CHECK ON.
  application_log-&gt;add_info( id_msgno = 003
                             id_msgv1 = name ).
  TRY.
      CALL METHOD update_package
        EXPORTING
          data    = package-&gt;a0_maindata
        CHANGING
          package = package-&gt;if.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  IF NOT package-&gt;if IS BOUND.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid  = zaplink_cx_connector=&gt;system_error
        cx_name = &apos;Failed to create package&apos;.
  ENDIF.
  CALL METHOD package-&gt;if-&gt;save
    EXPORTING
      i_transport_request   = transport_request
    IMPORTING
      e_transport_request   = transport_request
    EXCEPTIONS
      object_invalid        = 1
      object_not_changeable = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7.
  IF sy-subrc &lt;&gt; 0.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE e009 WITH space. ENDIF.
    SET EXTENDED CHECK ON.
    application_log-&gt;add_error( id_msgno = 009
                                id_msgv1 = name ).
    application_log-&gt;add_symsg( ).
  ELSE.
    TRY.
        CREATE OBJECT _component.
        _component-&gt;set_type( st_package ).
        _component-&gt;set_name( name ).
        components-&gt;add( _component ).
      CATCH zaplink_cx INTO o_cx.
        mac_cascade_raise o_mycx o_cx.
    ENDTRY.
  ENDIF.
  LOOP AT package-&gt;interfaces ASSIGNING &lt;i&gt;.
    TRY.
        o_intf ?= &lt;i&gt;-zl_object-&gt;raw.
        CALL METHOD create_interface
          EXPORTING
            interface  = o_intf
            overwrite  = overwrite
            components = components.
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
  ENDLOOP.
  LOOP AT package-&gt;packages ASSIGNING &lt;p&gt;.
    TRY.
        o_package ?= &lt;p&gt;-zl_object-&gt;raw.
        o_package-&gt;a0_maindata-devclass = &lt;p&gt;-zl_object-&gt;name.    o_package-&gt;a0_maindata-parentcl = package-&gt;a0_maindata-devclass. &quot; Issue 48
        CALL METHOD create_package
          EXPORTING
            package    = o_package
            overwrite  = overwrite
            components = components.
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
  ENDLOOP.
ENDMETHOD.
METHOD elements2alv.
  DATA _wa LIKE LINE OF alv_data.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF elements.
  LOOP AT elements ASSIGNING &lt;e&gt;.
    MOVE-CORRESPONDING &lt;e&gt; TO _wa.
    SELECT SINGLE devclass
      INTO _wa-td_pack
      FROM tadir
      WHERE pgmid = &apos;R3TR&apos;
        AND object = _wa-elem_type
        AND obj_name = _wa-elem_key.
    IF sy-subrc &lt;&gt; 0.
      CONTINUE.
    ENDIF.
    IF _wa-td_pack = _wa-elem_pack. CONTINUE. ENDIF.
    IF _wa-td_pack = &apos;$TMP&apos;. _wa-select = abap_true. ENDIF.
    APPEND _wa TO alv_data.
  ENDLOOP.
ENDMETHOD.
METHOD export_from_sap_interface.
  DATA sap_obj   TYPE REF TO if_package_interface.
  DATA name       TYPE td_interface.
  DATA o_list     TYPE to_list.
  TRY.
      CHECK component-&gt;get_type( ) = st_interface.
      name = component-&gt;get_name( ).
      CREATE OBJECT o_list.
      component-&gt;set_subcomponents( o_list ).
      sap_obj = load_intf( name ).
      object = conv_interface( interface = sap_obj
                           subcomponents = o_list ).
      o_list-&gt;remove( component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD export_from_sap_package.
  DATA sap_obj    TYPE REF TO if_package.
  DATA devclass   TYPE devclass.
  DATA o_list     TYPE to_list.
  DATA f_subcomp  TYPE td_with_subcomp.
  TRY.
      CHECK component-&gt;get_type( ) = st_package.
      f_subcomp = component-&gt;get_with_subcomp( ).
      devclass = component-&gt;get_name( ).
      CREATE OBJECT o_list.
      component-&gt;set_subcomponents( o_list ).
      sap_obj = load_devc( devclass ).
      object = conv_package( package = sap_obj
                        with_subcomp = f_subcomp
                       subcomponents = o_list ).
      o_list-&gt;remove( component ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_interface.
  TRY.
      CREATE OBJECT components.
      create_interface( overwrite = &apos;X&apos;
                        interface = o_data
                       components = components ).
      set_interface_attrib( interface = o_data ).
      application_log-&gt;raise_on_error( ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD import_to_sap_package.
  TRY.
      CREATE OBJECT components.
      create_package( overwrite = &apos;X&apos;
                        package = o_data
                     components = components ).
      set_package_attrib( package = o_data ).
      application_log-&gt;raise_on_error( ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD load_devc.
  CALL METHOD cl_package=&gt;if_package~load_package
    EXPORTING
      i_package_name             = key
      i_force_reload             = &apos;X&apos;
    IMPORTING
      e_package                  = obj
    EXCEPTIONS
      object_not_existing        = 1
      unexpected_error           = 2
      intern_err                 = 3
      object_locked_and_modified = 4
      OTHERS                     = 5.
  IF sy-subrc &lt;&gt; 0.
    CLEAR obj.
    CASE sy-subrc.
      WHEN OTHERS.
        SET EXTENDED CHECK OFF.
        IF 1 = 2. MESSAGE e008 WITH space. ENDIF.
        SET EXTENDED CHECK ON.
        application_log-&gt;add_warning( id_msgno = 008
                     id_msgv1 = &apos;ZAPLINK_PACKAGE&apos;
                     id_msgv2 = &apos;LOAD_DEVC&apos; ).
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = zaplink_cx_connector=&gt;system_error.
    ENDCASE.
  ENDIF.
ENDMETHOD.
method LOAD_INTF.
  CALL METHOD cl_package_interface=&gt;if_package_interface~load_package_interface
    EXPORTING
      i_package_interface_name   = key
      i_force_reload             = &apos;X&apos;
    IMPORTING
      e_package_interface        = obj
    EXCEPTIONS
      db_read_error              = 1
      unexpected_error           = 2
      object_not_existing        = 3
      shorttext_not_existing     = 4
      object_locked_and_modified = 5
      OTHERS                     = 6.
  IF sy-subrc &lt;&gt; 0.
    CLEAR obj.
    CASE sy-subrc.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = ZAPLINK_CX_CONNECTOR=&gt;system_error.
    ENDCASE.
  ENDIF.
endmethod.
METHOD set_interface_attrib.
  DATA name       TYPE scomifnam.
  DATA csubrc     TYPE string.
  DATA transport_request  TYPE  e070-trkorr.
  name = interface-&gt;a0_maindata-intf_name.
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE i014 WITH space. ENDIF.
  SET EXTENDED CHECK ON.
  application_log-&gt;add_info( id_msgno = 014
                             id_msgv1 = name ).
  IF NOT interface-&gt;if IS BOUND.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE a016 WITH space space space. ENDIF.
    SET EXTENDED CHECK ON.
    application_log-&gt;add_abend( id_msgno = 016
                                id_msgv1 = &apos;ZAPLINK_PACKAGE&apos;
                                id_msgv2 = &apos;SET_INTERFACE_ATTRIB&apos;
                                id_msgv3 = &apos;interface-&gt;if&apos;
                            id_probclass = &apos;1&apos; ).
    EXIT.
  ENDIF.
  IF NOT interface-&gt;acls IS INITIAL.
    CALL METHOD interface-&gt;if-&gt;add_access_control_elements
      EXPORTING
        i_user_list            = interface-&gt;acls
      EXCEPTIONS
        no_acl                 = 1
        entry_already_existing = 2
        object_not_changeable  = 3
        object_invalid         = 4
        local_package          = 5
        intern_err             = 6
        OTHERS                 = 7.
    IF sy-subrc &lt;&gt; 0.
      csubrc = sy-subrc.
      SET EXTENDED CHECK OFF.
      IF 1 = 2. MESSAGE e017 WITH space space space space. ENDIF.
      SET EXTENDED CHECK ON.
      application_log-&gt;add_error( id_msgno = 017
                                  id_msgv1 = &apos;ZAPLINK_PACKAGE&apos;
                                  id_msgv2 = &apos;SET_INTERFACE_ATTRIB&apos;
                                  id_msgv3 = &apos;add_access_control_elements&apos;
                                  id_msgv4 = csubrc ).
    ENDIF.
  ENDIF.
  TRY.
      CALL METHOD add_elements_list
        EXPORTING
          interface  = interface
          ask_user   = abap_true
          add_remain = abap_true.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  CALL METHOD interface-&gt;if-&gt;save
    EXPORTING
      i_transport_request   = transport_request
    IMPORTING
      e_transport_request   = transport_request
    EXCEPTIONS
      object_invalid        = 1
      object_not_changeable = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid  = zaplink_cx_connector=&gt;system_error
        cx_name = &apos;Package interface save failed !&apos;.
  ENDIF.
ENDMETHOD.
METHOD set_package_attrib.
  DATA name       TYPE scomifnam.
  DATA csubrc     TYPE string.
  DATA o_intf     TYPE to_interface.
  DATA o_package  TYPE to_package.
  FIELD-SYMBOLS:
    &lt;a&gt; LIKE LINE OF package-&gt;acls,
    &lt;p&gt; LIKE LINE OF package-&gt;packages,
    &lt;i&gt; LIKE LINE OF package-&gt;interfaces.
  name = package-&gt;a0_maindata-devclass.
  SET EXTENDED CHECK OFF.
  IF 1 = 2. MESSAGE e015 WITH space. ENDIF.
  SET EXTENDED CHECK ON.
  application_log-&gt;add_info( id_msgno = 015
                             id_msgv1 = name ).
  IF NOT package-&gt;if IS BOUND.
    SET EXTENDED CHECK OFF.
    IF 1 = 2. MESSAGE e016 WITH space space space. ENDIF.
    SET EXTENDED CHECK ON.
    application_log-&gt;add_abend( id_msgno = 016
                                id_msgv1 = &apos;ZAPLINK_PACKAGE&apos;
                                id_msgv2 = &apos;SET_PACKAGE_ATTRIB&apos;
                                id_msgv3 = &apos;package-&gt;if&apos;
                                id_probclass = &apos;1&apos; ).
    EXIT.
  ENDIF.
  LOOP AT package-&gt;acls ASSIGNING &lt;a&gt;.
    CALL METHOD package-&gt;if-&gt;add_permission_to_use
      EXPORTING
        i_pkg_permission_data   = &lt;a&gt;
      EXCEPTIONS
        object_not_changeable   = 1
        object_access_error     = 2
        object_already_existing = 3
        object_invalid          = 4
        unexpected_error        = 5
        OTHERS                  = 6
            .
    IF sy-subrc &lt;&gt; 0.
      csubrc = sy-subrc.
      SET EXTENDED CHECK OFF.
      IF 1 = 2. MESSAGE e017 WITH space space space space. ENDIF.
      SET EXTENDED CHECK ON.
      application_log-&gt;add_error( id_msgno = 017
                                  id_msgv1 = &apos;ZAPLINK_PACKAGE&apos;
                                  id_msgv2 = &apos;SET_PACKAGE_ATTRIB&apos;
                                  id_msgv3 = &apos;add_permission_to_use&apos;
                                  id_msgv4 = csubrc ).
    ENDIF.
  ENDLOOP.
  LOOP AT package-&gt;interfaces ASSIGNING &lt;i&gt;.
    TRY.
        o_intf ?= &lt;i&gt;-zl_object-&gt;raw.
        CALL METHOD set_interface_attrib
          EXPORTING
            interface = o_intf.
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
  ENDLOOP.
  LOOP AT package-&gt;packages ASSIGNING &lt;p&gt;.
    TRY.
        o_package ?= &lt;p&gt;-zl_object-&gt;raw.
        CALL METHOD set_package_attrib
          EXPORTING
            package = o_package.
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
  ENDLOOP.
ENDMETHOD.
method UPDATE_INTERFACE.
DATA _data      TYPE scompidtln.
  DATA _data_f    TYPE scompisign.
  _data = data.
  IF interface IS BOUND.
    _data_f = sy-uline.
    CALL METHOD interface-&gt;set_changeable
      EXPORTING
        i_changeable                = &apos;X&apos;
      EXCEPTIONS
        object_locked_by_other_user = 1
        permission_failure          = 2
        object_already_changeable   = 0
        object_already_unlocked     = 0
        object_just_created         = 5
        object_deleted              = 6
        object_modified             = 7
        object_not_existing         = 8
        object_invalid              = 9
        unexpected_error            = 10
        OTHERS                      = 11.
    IF sy-subrc &lt;&gt; 0.
      CASE sy-subrc.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.
    ENDIF.
    CALL METHOD interface-&gt;set_all_attributes
      EXPORTING
        i_package_interface_data = _data
        i_data_sign              = _data_f
      EXCEPTIONS
        object_deleted           = 1
        object_not_changeable    = 2
        interface_not_empty      = 3
        acl_not_empty            = 4
        author_not_existing      = 5
        object_type_mismatch     = 6
        object_invalid           = 7
        OTHERS                   = 8.
  ELSE.
    CALL METHOD cl_package_interface=&gt;if_package_interface~create_new_package_interface
      EXPORTING
        i_pkg_interface_name    = _data-intf_name
        i_publisher_pkg_name    = _data-pack_name
        i_pkg_interface_data    = _data
      IMPORTING
        e_package_interface     = interface
      EXCEPTIONS
        object_already_existing = 101
        object_just_created     = 102
        interface_name_invalid  = 103
        unexpected_error        = 104
        no_changes_allowed      = 2
        OTHERS                  = 8
            .
  ENDIF.
  IF sy-subrc &lt;&gt; 0.
    CASE sy-subrc.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = zaplink_cx_connector=&gt;system_error.
    ENDCASE.
  ENDIF.
endmethod.
method UPDATE_PACKAGE.
  DATA _data      TYPE scompkdtln.
  DATA _data_f    TYPE scompksign.
  _data = data.
  IF package IS BOUND.
    _data_f = sy-uline.
    CALL METHOD package-&gt;set_changeable
      EXPORTING
        i_changeable                = &apos;X&apos;
      EXCEPTIONS
        object_locked_by_other_user = 1
        permission_failure          = 2
        object_already_changeable   = 0
        object_already_unlocked     = 0
        object_just_created         = 5
        object_deleted              = 6
        object_modified             = 7
        object_not_existing         = 8
        object_invalid              = 9
        unexpected_error            = 10
        OTHERS                      = 11.
    IF sy-subrc &lt;&gt; 0.
      CASE sy-subrc.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.
    ENDIF.
    CALL METHOD package-&gt;set_all_attributes
      EXPORTING
        i_package_data             = _data
        i_data_sign                = _data_f
      EXCEPTIONS
        object_not_changeable      = 101
        object_deleted             = 102
        object_invalid             = 103
        short_text_missing         = 8
        author_not_existing        = 11
        local_package              = 6
        software_component_invalid = 9
        layer_invalid              = 10
        korrflag_invalid           = 109
        component_not_existing     = 12
        component_missing          = 13
        authorize_failure          = 3
        prefix_in_use              = 4
        unexpected_error           = 15
        intern_err                 = 16
        OTHERS                     = 17.
  ELSE.
    CALL METHOD cl_package=&gt;if_package~create_new_package
      IMPORTING
        e_package                  = package
      CHANGING
        c_package_data             = _data
      EXCEPTIONS
        object_already_existing    = 1
        object_just_created        = 2
        not_authorized             = 3
        wrong_name_prefix          = 4
        undefined_name             = 5
        reserved_local_name        = 6
        invalid_package_name       = 7
        short_text_missing         = 8
        software_component_invalid = 9
        layer_invalid              = 10
        author_not_existing        = 11
        component_not_existing     = 12
        component_missing          = 13
        prefix_in_use              = 14
        unexpected_error           = 15
        intern_err                 = 16
        OTHERS                     = 17
            .
  ENDIF.
  IF sy-subrc = 11 AND _data-as4user &lt;&gt; sy-uname.           &quot;#EC *
    _data-as4user = sy-uname.
    TRY.
        CALL METHOD update_package
          EXPORTING
            data    = _data
          CHANGING
            package = package.
      CATCH zaplink_cx_connector INTO o_mycx.
        RAISE EXCEPTION o_mycx.
    ENDTRY.
  ELSEIF sy-subrc &lt;&gt; 0.
    CASE sy-subrc.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = zaplink_cx_connector=&gt;system_error.
    ENDCASE.
  ENDIF.
endmethod.
METHOD _delete_devc.
  DATA interfaces  TYPE tpak_package_interface_list.
  DATA packages    TYPE scompaklis.
  DATA cx_name     TYPE string.
  FIELD-SYMBOLS:
    &lt;pack&gt; LIKE LINE OF packages,
    &lt;itf&gt; LIKE LINE OF interfaces.
  CALL METHOD package-&gt;set_changeable
    EXPORTING
      i_changeable                = &apos;X&apos;
    EXCEPTIONS
      object_locked_by_other_user = 1
      permission_failure          = 2
      object_already_changeable   = 0
      object_already_unlocked     = 0
      object_just_created         = 5
      object_deleted              = 6
      object_modified             = 7
      object_not_existing         = 8
      object_invalid              = 9
      unexpected_error            = 10
      OTHERS                      = 11.
  IF sy-subrc &lt;&gt; 0.
    CASE sy-subrc.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = zaplink_cx_connector=&gt;system_error.
    ENDCASE.
  ENDIF.
  CALL METHOD package-&gt;get_interfaces
    IMPORTING
      e_package_interfaces = interfaces
    EXCEPTIONS
      object_invalid       = 1
      unexpected_error     = 2
      intern_err           = 3
      OTHERS               = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error.
  ELSEIF NOT interfaces IS INITIAL.
    LOOP AT interfaces ASSIGNING &lt;itf&gt;.
      TRY.
          _delete_intf( &lt;itf&gt; ).
        CATCH zaplink_cx_connector INTO o_mycx.
          RAISE EXCEPTION o_mycx.
      ENDTRY.
    ENDLOOP.
  ENDIF.
  CALL METHOD package-&gt;get_sub_packages
    IMPORTING
      e_sub_packages   = packages
    EXCEPTIONS
      object_invalid   = 1
      leaf_package     = 0   &quot; has no sub packages
      unexpected_error = 3
      OTHERS           = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error.
  ELSEIF NOT packages IS INITIAL.
    LOOP AT packages ASSIGNING &lt;pack&gt;.
      TRY.
          _delete_devc( &lt;pack&gt; ).
        CATCH zaplink_cx_connector INTO o_mycx.
          RAISE EXCEPTION o_mycx.
      ENDTRY.
    ENDLOOP.
  ENDIF.
  _delete_elements( package ). &quot; try to delete TADIR entries that prevent package deletion
  CALL METHOD package-&gt;delete
    EXCEPTIONS
      object_not_empty      = 1
      object_not_changeable = 2
      object_invalid        = 3
      intern_err            = 4
      OTHERS                = 5.
  IF sy-subrc &lt;&gt; 0.
    CALL METHOD application_log-&gt;add_symsg( ).
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4
            INTO cx_name.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        cx_name = cx_name
        textid  = zaplink_cx_connector=&gt;system_error.
  ENDIF.
  CALL METHOD package-&gt;save
    EXPORTING
      i_transport_request   = space
    EXCEPTIONS
      object_invalid        = 1
      object_not_changeable = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error.
  ENDIF.
ENDMETHOD.
method _DELETE_INTF.
  CALL METHOD interface-&gt;set_changeable
    EXPORTING
      i_changeable                = &apos;X&apos;
    EXCEPTIONS
      object_locked_by_other_user = 1
      permission_failure          = 2
      object_already_changeable   = 0
      object_already_unlocked     = 0
      object_just_created         = 5
      object_deleted              = 6
      object_modified             = 7
      object_not_existing         = 8
      object_invalid              = 9
      unexpected_error            = 10
      OTHERS                      = 11.
  IF sy-subrc &lt;&gt; 0.
    CASE sy-subrc.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE zaplink_cx_connector
          EXPORTING
            textid = zaplink_cx_connector=&gt;system_error.
    ENDCASE.
  ENDIF.
  CALL METHOD interface-&gt;delete
    EXCEPTIONS
      object_not_empty      = 1
      object_not_changeable = 2
      object_invalid        = 3
      intern_err            = 4
      OTHERS                = 5.
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error.
  ENDIF.
  CALL METHOD interface-&gt;save
    EXPORTING
      i_transport_request   = space
    EXCEPTIONS
      object_invalid        = 1
      object_not_changeable = 2
      cancelled_in_corr     = 3
      permission_failure    = 4
      unexpected_error      = 5
      intern_err            = 6
      OTHERS                = 7
          .
  IF sy-subrc &lt;&gt; 0.
    RAISE EXCEPTION TYPE zaplink_cx_connector
      EXPORTING
        textid = zaplink_cx_connector=&gt;system_error.
  ENDIF.
endmethod.
METHOD zaplink_connector~create_new_raw.
  DATA o_devc TYPE to_package.
  DATA o_pinf TYPE to_interface.
  CREATE OBJECT object.
  CASE type.
    WHEN st_package.
      CREATE OBJECT o_devc.
      object-&gt;raw = o_devc.
    WHEN st_interface.
      CREATE OBJECT o_pinf.
      object-&gt;raw = o_pinf.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = ZAPLINK_CX_CONNECTOR=&gt;TYPE_NOT_SUPPORTED
          type   = type
          connclass = &apos;ZAPLINK_PACKAGE&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA key_devc TYPE devclass.
  DATA key_intf TYPE scomifnam.
  DATA package  TYPE REF TO if_package.
  DATA interface  TYPE REF TO if_package_interface.
  DATA d_type TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_package.
        key_devc = component-&gt;get_name( ).
        TRY.
            package = load_devc( key_devc ).
            _delete_devc( package ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN st_interface.
        key_intf = component-&gt;get_name( ).
        TRY.
            interface = load_intf( key_intf ).
            _delete_intf( interface ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_PACKAGE&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD zaplink_connector~do_exists.
  DATA key   TYPE scomifnam.
  DATA _devc TYPE REF TO if_package.              &quot;#EC NEEDED for debug
  DATA _pinf TYPE REF TO if_package_interface.    &quot;#EC NEEDED for debug
  DATA type  TYPE td_comptype.
  TRY.
      key = component-&gt;get_name( ).
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_package.
          CALL METHOD cl_package=&gt;if_package~load_package
            EXPORTING
              i_package_name             = key
              i_force_reload             = &apos;X&apos;
            IMPORTING
              e_package                  = _devc
            EXCEPTIONS
              object_not_existing        = 1
              object_locked_and_modified = 0
                  .
          IF sy-subrc = 0.
            exists = &apos;X&apos;.
          ENDIF.
        WHEN st_interface.
          CALL METHOD cl_package_interface=&gt;if_package_interface~load_package_interface
            EXPORTING
              i_package_interface_name   = key
              i_force_reload             = &apos;X&apos;
            IMPORTING
              e_package_interface        = _pinf
            EXCEPTIONS
              object_not_existing        = 3
              shorttext_not_existing     = 0
              object_locked_and_modified = 0
                  .
          IF sy-subrc = 0.
            exists = &apos;X&apos;.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_PACKAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~read_from_sap.
  DATA o_package   TYPE to_package.
  DATA o_interface TYPE to_interface.
  DATA type  TYPE td_comptype.
  TRY.
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    type = component-&gt;get_type( ).
    CASE type.
      WHEN st_package.
        TRY.
            o_package = export_from_sap_package( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_package-&gt;a0_maindata-devclass.
        object-&gt;raw = o_package.
      WHEN st_interface.
        TRY.
            o_interface = export_from_sap_interface( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_interface-&gt;a0_maindata-intf_name.
        object-&gt;raw = o_interface.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_PACKAGE&apos; type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  DATA _o_class       TYPE to_package.
  DATA _o_interface   TYPE to_interface.
  CASE object-&gt;type.
    WHEN st_package.
      _o_class ?= object-&gt;raw.
      _o_class-&gt;a0_maindata-devclass = object-&gt;name.
      TRY.
          components = import_to_sap_package( _o_class ).
        CATCH zaplink_cx_connector INTO o_mycx.
          IF NOT o_mycx-&gt;messages IS BOUND.
            o_mycx-&gt;messages = application_log.
            o_mycx-&gt;update( ).
          ENDIF.
          RAISE EXCEPTION o_mycx.
      ENDTRY.
    WHEN st_interface.
      _o_interface ?= object-&gt;raw.
      _o_interface-&gt;a0_maindata-intf_name = object-&gt;name.
      TRY.
          components = import_to_sap_interface( _o_interface ).
        CATCH zaplink_cx_connector INTO o_mycx.
          IF NOT o_mycx-&gt;messages IS BOUND.
            o_mycx-&gt;messages = application_log.
            o_mycx-&gt;update( ).
          ENDIF.
          RAISE EXCEPTION o_mycx.
      ENDTRY.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = object-&gt;type
          connclass = &apos;ZAPLINK_MESSAGE&apos;.
  ENDCASE.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.
    result = abap_true.
  endif.
endmethod.
METHOD conv_interface_raw.
  DATA o_comp     TYPE to_component.
  DATA _data      TYPE to_interface.
  DATA _cx        TYPE REF TO zaplink_cx.
  TRY.
      _data = conv_interface( interface = interface
                          subcomponents = subcomponents ).
      CREATE OBJECT o_comp.
      o_comp-&gt;set_type( st_interface ).
      o_comp-&gt;set_name( _data-&gt;a0_maindata-intf_name ).
      CREATE OBJECT o_data
        EXPORTING
          o_comp = o_comp.
      o_data-&gt;raw = _data.
    CATCH zaplink_cx INTO _cx.
      create OBJECT o_mycx EXPORTING
             textid = zaplink_cx=&gt;system_error
            prev_cx = _cx.
      o_mycx-&gt;update( ).
      raise EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD conv_package_raw.
  DATA o_comp     TYPE to_component.
  DATA _data      TYPE to_package.
  DATA _cx        TYPE REF TO zaplink_cx.
  TRY.
      _data = conv_package( package = package
                      subcomponents = subcomponents ).
      CREATE OBJECT o_comp.
      o_comp-&gt;set_type( st_package ).
      o_comp-&gt;set_name( _data-&gt;a0_maindata-devclass ).
      CREATE OBJECT o_data
        EXPORTING
          o_comp = o_comp.
      o_data-&gt;raw = _data.
      CLEAR: _data-&gt;a0_maindata-devclass, _data-&gt;a0_maindata-parentcl.    &quot; Issue 48
    CATCH zaplink_cx INTO _cx.
      CREATE OBJECT o_mycx
        EXPORTING
          textid  = zaplink_cx=&gt;system_error
          prev_cx = _cx.
      o_mycx-&gt;update( ).
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
METHOD _delete_elements.
  DATA t_elements TYPE pakdevelemtab.
  DATA f_errors   TYPE abap_bool.
  DATA d_name     TYPE tadir-obj_name.
  DATA s_tadir    TYPE tadir.
  DATA f_exists   TYPE saus_dpara-tadirexist.
  FIELD-SYMBOLS:
    &lt;e&gt; LIKE LINE OF t_elements.
  f_errors = abap_false.
  CALL METHOD package-&gt;get_elements
     IMPORTING
       e_elements        = t_elements.
  LOOP AT t_elements ASSIGNING &lt;e&gt;.
    IF &lt;e&gt;-&gt;dev_elem_type = st_package.   &quot; do not try to remove DEVC
      DELETE t_elements.
      CONTINUE.
    ENDIF.
    d_name = &lt;e&gt;-&gt;dev_elem_key.
    CALL FUNCTION &apos;TRINT_TADIR_DELETE&apos;
      EXPORTING
        object                   = &lt;e&gt;-&gt;dev_elem_type
        obj_name                 = d_name
        pgmid                    = &lt;e&gt;-&gt;dev_elem_pgmid
        iv_test_mode             = abap_true
      EXCEPTIONS
        tadir_entry_not_existing = 1
        object_exists            = 2
        object_locked            = 3
        object_distributed       = 4
        OTHERS                   = 5.
    IF sy-subrc &lt;&gt; 0.
      CASE sy-subrc.
        WHEN 2 OR 3.
          CALL METHOD application_log-&gt;add_symsg( ).
          SET EXTENDED CHECK OFF.
          IF 1 = 2. MESSAGE i020(zaplink_package) WITH &lt;e&gt;-&gt;dev_elem_pgmid &lt;e&gt;-&gt;dev_elem_type d_name. ENDIF.
          SET EXTENDED CHECK ON.
          CALL METHOD application_log-&gt;add
             EXPORTING
               id_msgty     = &apos;I&apos;
               id_msgid     = &apos;ZAPLINK_PACKAGE&apos;
               id_msgno     = &apos;020&apos;
               id_msgv1     = &lt;e&gt;-&gt;dev_elem_pgmid
               id_msgv2     = &lt;e&gt;-&gt;dev_elem_type
               id_msgv3     = d_name
              .
        WHEN OTHERS.
          CALL METHOD application_log-&gt;add_symsg( ).
      ENDCASE.
      f_errors = abap_true.
    ENDIF.
  ENDLOOP.
  IF f_errors = abap_false.
    LOOP AT t_elements ASSIGNING &lt;e&gt;.
      d_name = &lt;e&gt;-&gt;dev_elem_key.
      CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
        EXPORTING
          iv_pgmid           = &lt;e&gt;-&gt;dev_elem_pgmid
          iv_object          = &lt;e&gt;-&gt;dev_elem_type
          iv_obj_name        = d_name
        IMPORTING
          ev_srcsystem       = s_tadir-srcsystem
          ev_author          = s_tadir-author
          ev_genflag         = s_tadir-genflag
          ev_exist           = f_exists.
      CALL FUNCTION &apos;TRINT_TADIR_DELETE&apos;
        EXPORTING
          object                   = &lt;e&gt;-&gt;dev_elem_type
          obj_name                 = d_name
          pgmid                    = &lt;e&gt;-&gt;dev_elem_pgmid
          iv_test_mode             = abap_false
        EXCEPTIONS
          tadir_entry_not_existing = 1
          object_exists            = 2
          object_locked            = 3
          object_distributed       = 4
          OTHERS                   = 5.
      IF sy-subrc &lt;&gt; 0.
        ROLLBACK WORK.
        CALL METHOD application_log-&gt;add_symsg( ).
        EXIT.
      ELSEIF NOT f_exists IS INITIAL.
        SET EXTENDED CHECK OFF.
        IF 1 = 2. MESSAGE w018(zaplink_package) WITH &lt;e&gt;-&gt;dev_elem_pgmid &lt;e&gt;-&gt;dev_elem_type d_name. ENDIF.
        SET EXTENDED CHECK ON.
        CALL METHOD application_log-&gt;add
           EXPORTING
             id_msgty     = &apos;W&apos;
             id_msgid     = &apos;ZAPLINK_PACKAGE&apos;
             id_msgno     = &apos;018&apos;
             id_msgv1     = &lt;e&gt;-&gt;dev_elem_pgmid
             id_msgv2     = &lt;e&gt;-&gt;dev_elem_type
             id_msgv3     = d_name
            .
        SET EXTENDED CHECK OFF.
        IF 1 = 2. MESSAGE i019(zaplink_package) WITH &lt;e&gt;-&gt;dev_elem_pgmid &lt;e&gt;-&gt;dev_elem_type d_name. ENDIF.
        SET EXTENDED CHECK ON.
        CALL METHOD application_log-&gt;add
           EXPORTING
             id_msgty     = &apos;I&apos;
             id_msgid     = &apos;ZAPLINK_PACKAGE&apos;
             id_msgno     = &apos;019&apos;
             id_msgv1     = s_tadir-srcsystem
             id_msgv2     = s_tadir-author
             id_msgv3     = s_tadir-genflag
            .
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~anonymize.
  DATA o_package   TYPE to_package.
  DATA o_interface TYPE to_interface.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  CASE object-&gt;type.
    WHEN st_package.
      o_package ?= object-&gt;raw.
      anonymize_package( o_package ).
    WHEN st_interface.
      o_interface ?= object-&gt;raw.
      anonymize_interface( o_interface ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD anonymize_package.
  DATA o_raw_i     LIKE LINE OF object-&gt;interfaces.
  DATA o_interface TYPE to_interface.
  DATA o_raw_p     LIKE LINE OF object-&gt;packages.
  DATA o_package   TYPE to_package.
  CLEAR:
    object-&gt;a0_maindata-created_by,
    object-&gt;a0_maindata-created_on,
    object-&gt;a0_maindata-changed_by,
    object-&gt;a0_maindata-changed_on.
  LOOP AT object-&gt;interfaces INTO o_raw_i.
    o_interface ?= o_raw_i-zl_object-&gt;raw.
    anonymize_interface( o_interface ).
  ENDLOOP.
  LOOP AT object-&gt;packages INTO o_raw_p.
    o_package ?= o_raw_p-zl_object-&gt;raw.
    anonymize_package( o_package ).
  ENDLOOP.
ENDMETHOD.
METHOD anonymize_interface.
  CLEAR:
    object-&gt;a0_maindata-created_by,
    object-&gt;a0_maindata-created_on,
    object-&gt;a0_maindata-changed_by,
    object-&gt;a0_maindata-changed_on.
ENDMETHOD.
METHOD UNANONYMIZE_INTERFACE.
  If object-&gt;a0_maindata-created_by is INITIAL. object-&gt;a0_maindata-created_by = sy-uname. endif.
  If object-&gt;a0_maindata-created_on is INITIAL. object-&gt;a0_maindata-created_on = sy-datum. endif.
ENDMETHOD.
METHOD UNANONYMIZE_PACKAGE.
  DATA o_raw_i     LIKE LINE OF object-&gt;interfaces.
  DATA o_interface TYPE to_interface.
  DATA o_raw_p     LIKE LINE OF object-&gt;packages.
  DATA o_package   TYPE to_package.
  If object-&gt;a0_maindata-created_by is INITIAL. object-&gt;a0_maindata-created_by = sy-uname. endif.
  If object-&gt;a0_maindata-created_on is INITIAL. object-&gt;a0_maindata-created_on = sy-datum. endif.
  If object-&gt;a0_maindata-as4user is INITIAL. object-&gt;a0_maindata-as4user = sy-uname. endif. &quot; Person responsible
  LOOP AT object-&gt;interfaces INTO o_raw_i.
    o_interface ?= o_raw_i-zl_object-&gt;raw.
    unanonymize_interface( o_interface ).
  ENDLOOP.
  LOOP AT object-&gt;packages INTO o_raw_p.
    o_package ?= o_raw_p-zl_object-&gt;raw.
    unanonymize_package( o_package ).
  ENDLOOP.
ENDMETHOD.
METHOD zaplink_cnx_ext_cleaner~unanonymize.
  DATA o_package   TYPE to_package.
  DATA o_interface TYPE to_interface.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
  CASE object-&gt;type.
    WHEN st_package.
      o_package ?= object-&gt;raw.
      unanonymize_package( o_package ).
    WHEN st_interface.
      o_interface ?= object-&gt;raw.
      unanonymize_interface( o_interface ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
endclass. &quot;ZAPLINK_PACKAGE implementation
class ZAPLINK_PINF_RAW implementation.
METHOD constructor.
  DATA o_raw TYPE REF TO zaplink_pinf_data.
  CALL METHOD super-&gt;constructor
    EXPORTING
      o_comp = o_comp.
  CREATE OBJECT o_raw.
  raw ?= o_raw.
ENDMETHOD.
endclass. &quot;ZAPLINK_PINF_RAW implementation
class ZAPLINK_TRANSACTION implementation.
method CLASS_CONSTRUCTOR.
  DATA _id LIKE LINE OF r_doc_id.
  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = C_MSG_ID. APPEND _id TO r_doc_id.
endmethod.
method CONSTRUCTOR.
  DATA type LIKE LINE OF supported_types.
  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_transaction. INSERT type INTO TABLE supported_types.
  uuid = _uuid.
  version = _ver.
endmethod.
METHOD ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE.
  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE.
endmethod.
METHOD ZAPLINK_CONNECTOR~CREATE_NEW_RAW.
  DATA o_data TYPE to_data.
  CREATE OBJECT object.
  CASE type.
    WHEN st_transaction.
      CREATE OBJECT o_data.
      object-&gt;raw = o_data.
    WHEN OTHERS.
      CLEAR object.
      RAISE EXCEPTION TYPE zaplink_cx_connector
        EXPORTING
          textid = zaplink_cx_connector=&gt;type_not_supported
          type   = type
          connclass = &apos;ZAPLINK_MESSAGE&apos;.
  ENDCASE.
ENDMETHOD.
METHOD zaplink_connector~delete_from_sap.
  DATA d_name TYPE tstc-tcode.
  DATA d_type   TYPE td_comptype.
  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_transaction.
        d_name = component-&gt;get_name( ).
        CALL FUNCTION &apos;RPY_TRANSACTION_DELETE&apos;
          EXPORTING
            transaction                    = d_name
          EXCEPTIONS
            not_excecuted                  = 1
            object_not_found               = 2
            OTHERS                         = 3.
        IF sy-subrc &lt;&gt; 0. &quot; SAP NameSpace
          CASE sy-subrc.
            WHEN 2.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_MESSAGE&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DO_EXISTS.
  DATA d_name TYPE tstc-tcode.
  DATA type  TYPE td_comptype.
  exists = me-&gt;exists-not_exists.
  TRY.
      type = component-&gt;get_type( ).
      CASE type.
        WHEN st_transaction.
          d_name = component-&gt;get_name( ).
          SELECT SINGLE tcode INTO d_name      &quot; From MF RPY_TRANSACTION_READ
            FROM tstc
            WHERE tcode = d_name.
          IF sy-subrc = 0.
            exists = me-&gt;exists-exists.
          ENDIF.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
method ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  result = abap_false.
  if version = _ver.
    result = abap_true.
  endif.
endmethod.
METHOD zaplink_connector~read_from_sap.
  DATA o_data  TYPE to_data.
  DATA d_name  TYPE tstc-tcode.
  DATA s_fm_data TYPE zaplink_tran_data=&gt;ts_fm_data.
  DATA t_tstc  TYPE STANDARD TABLE OF tstc WITH DEFAULT KEY.
  DATA t_tstcc TYPE STANDARD TABLE OF tstcc WITH DEFAULT KEY.
  DATA d_remotedata TYPE string.
  DATA t_param TYPE STANDARD TABLE OF rsparam.
  DATA o_conn  TYPE to_connector.
  DATA o_comp  TYPE to_component.
  DATA _name   TYPE td_compname.
  DATA d_type TYPE td_comptype.
  FIELD-SYMBOLS:
    &lt;param&gt; TYPE STANDARD TABLE,
    &lt;scr&gt; TYPE rsstcd,
    &lt;g&gt; TYPE s_gui_inhe,
    &lt;t&gt; LIKE LINE OF t_tstc,
    &lt;a&gt; LIKE LINE OF t_tstcc.
  DATA f_subcomp  TYPE td_with_subcomp.
  TRY.
    CREATE OBJECT object.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_transaction.
        f_subcomp = component-&gt;get_with_subcomp( ).
        d_name = component-&gt;get_name( ).
        PERFORM refresh_global_data IN PROGRAM saplseuk.    &quot; to initialize data : Issue 67
        CALL FUNCTION &apos;RPY_TRANSACTION_READ&apos;
          EXPORTING
            transaction            = d_name
          TABLES
            tcodes                 = t_tstc
            gui_attributes         = t_tstcc
          EXCEPTIONS
            permission_error       = 1
            cancelled              = 2
            not_found              = 3
            object_not_found       = 4
            OTHERS                 = 5.
        IF sy-subrc &lt;&gt; 0.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;RPY_TRANSACTION_READ&apos;
                                                      subrc = sy-subrc
                                                  classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
          application_log-&gt;add_symsg( ).
          RAISE EXCEPTION o_mycx.
        ENDIF.
        READ TABLE t_tstc ASSIGNING &lt;t&gt;
             WITH KEY tcode = d_name.
        CHECK sy-subrc = 0.
        CREATE OBJECT o_data.
        s_fm_data-tstc = &lt;t&gt;.
        PERFORM select_tstc_tables_new IN PROGRAM saplseuk USING d_name space space.
        d_remotedata = &apos;(SAPLSEUK)G_GUI_INHE&apos;.
        ASSIGN (d_remotedata) TO &lt;g&gt;.
        IF sy-subrc = 0. s_fm_data-gui_inh = &lt;g&gt;. ENDIF.
        d_remotedata = &apos;(SAPLSEUK)param[]&apos;.
        ASSIGN (d_remotedata) TO &lt;param&gt;.
        IF sy-subrc = 0. s_fm_data-t_params = &lt;param&gt;. ENDIF.
        d_remotedata = &apos;(SAPLSEUK)RSSTCD&apos;.
        ASSIGN (d_remotedata) TO &lt;scr&gt;.
        IF sy-subrc = 0. s_fm_data-rsstcd = &lt;scr&gt;. ENDIF.
        SELECT * INTO TABLE s_fm_data-tstct
          FROM tstct
          WHERE tcode = d_name.
        SELECT * INTO TABLE s_fm_data-tstca
          FROM tstca
          WHERE tcode = d_name.
        READ TABLE t_tstcc ASSIGNING &lt;a&gt;
             WITH KEY tcode = d_name.
        IF sy-subrc = 0.
          s_fm_data-tstcc = &lt;a&gt;.
        ENDIF.
        IF s_fm_data-tstc-cinfo O transaction_types-prog_variant.    SUBTRACT transaction_types-prog_variant FROM s_fm_data-tstc-cinfo.   ENDIF.    &quot; Issue 67 : Transaction of program with variant
        CREATE OBJECT o_data.
        o_data-&gt;from_data( s_fm_data ).
        IF f_subcomp = abap_true.
          IF o_data-&gt;a0_maindata-cinfo O transaction_types-object.
            _name = o_data-&gt;a0_maindata-classname.
            IF NOT _name IS INITIAL.
              o_conn = zaplink_connectors=&gt;create_connector( type = t_component-object ).
              IF o_conn IS BOUND.
                CREATE OBJECT o_comp.
                o_comp-&gt;set_type( t_component-object ).
                o_comp-&gt;set_name( _name ).
                o_data-&gt;zl_object = o_conn-&gt;read_from_sap( o_comp ).
                IF o_data-&gt;zl_object IS BOUND.
                  CLEAR o_data-&gt;a0_maindata-classname.
                ENDIF.
              ENDIF.
            ENDIF.
          ELSEIF o_data-&gt;a0_maindata-cinfo O transaction_types-program.
            _name = o_data-&gt;a0_maindata-pgmna.
            IF NOT _name IS INITIAL.
              o_conn = zaplink_connectors=&gt;create_connector( type = t_component-program ).
              IF o_conn IS BOUND.
                CREATE OBJECT o_comp.
                o_comp-&gt;set_type( t_component-program ).
                o_comp-&gt;set_name( _name ).
                o_data-&gt;zl_object = o_conn-&gt;read_from_sap( o_comp ).
                IF o_data-&gt;zl_object IS BOUND.
                  CLEAR o_data-&gt;a0_maindata-pgmna.
                ENDIF.
              ENDIF.
            ENDIF.
          ELSEIF o_data-&gt;a0_maindata-cinfo O transaction_types-transaction.
            _name = o_data-&gt;a0_maindata-call_tcode.
            IF NOT _name IS INITIAL AND _name &lt;&gt; d_name.
              CREATE OBJECT o_comp.
              o_comp-&gt;set_type( st_transaction ).
              o_comp-&gt;set_name( _name ).
              o_data-&gt;zl_object = zaplink_connector~read_from_sap( o_comp ).
              IF o_data-&gt;zl_object IS BOUND.
                CLEAR o_data-&gt;a0_maindata-call_tcode.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.
        object-&gt;set_component( component ).
        CLEAR o_data-&gt;a0_maindata-tcode.
        object-&gt;raw = o_data.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_TRANSACTION&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
ENDMETHOD.
METHOD zaplink_connector~write_to_sap.
  TYPES:              &quot; FROM LSEUKTOP(82)
    BEGIN OF cobj,
      field TYPE tstca-field,
      value TYPE tstca-value,
      olen  TYPE dfies-outputlen,
    END OF cobj.
  DATA t_cobj TYPE STANDARD TABLE OF cobj.
  DATA s_cobj LIKE LINE OF t_cobj.
  DATA o_data TYPE to_data.
  DATA o_comp TYPE to_component.
  DATA d_name TYPE td_compname.
  DATA s_fm_data TYPE zaplink_tran_data=&gt;ts_fm_data.
  DATA d_remotedata TYPE string.
  DATA s_tstca LIKE LINE OF s_fm_data-tstca.
  DATA s_tstct LIKE LINE OF s_fm_data-tstct.
  DATA o_conn  TYPE to_connector.
  DATA o_list  TYPE to_list.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF s_fm_data-tstct,
    &lt;st&gt; TYPE STANDARD TABLE,
    &lt;v&gt; LIKE LINE OF s_fm_data-tstca,
    &lt;a&gt; TYPE ANY.
  DEFINE mac_assign.
    d_remotedata = &amp;1.
    assign (d_remotedata) to &lt;a&gt;.
    if sy-subrc = 0. &lt;a&gt; = &amp;2. endif.
  END-OF-DEFINITION.
  DEFINE mac_assign_table.
    d_remotedata = &amp;1.
    assign (d_remotedata) to &lt;st&gt;.
    if sy-subrc = 0. &lt;st&gt; = &amp;2. endif.
  END-OF-DEFINITION.
  TRY.
      CREATE OBJECT components.
      CASE object-&gt;type.
        WHEN st_transaction.
          o_data ?= object-&gt;raw.
          o_data-&gt;a0_maindata-tcode = object-&gt;name.
          IF o_data-&gt;zl_object IS BOUND.
            IF o_data-&gt;a0_maindata-cinfo O transaction_types-object.
              o_data-&gt;a0_maindata-classname = o_data-&gt;zl_object-&gt;name.
              o_conn = zaplink_connectors=&gt;create_connector( type = t_component-object ).
            ELSEIF o_data-&gt;a0_maindata-cinfo O transaction_types-program.
              o_data-&gt;a0_maindata-pgmna = o_data-&gt;zl_object-&gt;name.
              o_conn = zaplink_connectors=&gt;create_connector( type = t_component-program ).
            ELSEIF o_data-&gt;a0_maindata-cinfo O transaction_types-transaction.
              o_data-&gt;a0_maindata-call_tcode = o_data-&gt;zl_object-&gt;name.
              o_conn = me.
            ENDIF.
            IF o_conn IS BOUND.
              o_list = o_conn-&gt;write_to_sap( o_data-&gt;zl_object ).
              components-&gt;add_list( o_list ).
            ENDIF.
          ENDIF.
          s_fm_data = o_data-&gt;to_data( ).
          PERFORM refresh_global_data IN PROGRAM saplseuk.    &quot; to load program in memory
          LOOP AT s_fm_data-tstca ASSIGNING &lt;v&gt;.
            IF sy-tabix = 1. mac_assign &apos;(SAPLSEUK)TSTCA&apos; &lt;v&gt;. ENDIF.
            s_cobj-field = &lt;v&gt;-field.
            s_cobj-value = &lt;v&gt;-value.
            APPEND s_cobj TO t_cobj.
          ENDLOOP.
          mac_assign &apos;(SAPLSEUK)COBJ[]&apos; t_cobj.
          mac_assign &apos;(SAPLSEUK)TSTCC&apos; s_fm_data-tstcc.
          IF s_fm_data-tstc-cinfo O transaction_types-check. mac_assign &apos;(SAPLSEUK)TC_CHK&apos; transaction_types-check. SUBTRACT transaction_types-check FROM s_fm_data-tstc-cinfo .  ENDIF.
          IF s_fm_data-tstc-cinfo O transaction_types-enqueue. mac_assign &apos;(SAPLSEUK)TC_ENQ&apos; transaction_types-enqueue. SUBTRACT transaction_types-enqueue FROM s_fm_data-tstc-cinfo .  ENDIF.
          mac_assign &apos;(SAPLSEUK)TC_TYP&apos; s_fm_data-tstc-cinfo.
          mac_assign &apos;(SAPLSEUK)RSSTCD&apos; s_fm_data-rsstcd.
          IF NOT s_fm_data-rsstcd-call_tcode IS INITIAL. mac_assign &apos;(SAPLSEUK)PARAM_VARI&apos; abap_true. ENDIF.      &quot; For transaction parameter @*
          mac_assign &apos;(SAPLSEUK)TSTC&apos; s_fm_data-tstc.
          IF NOT s_fm_data-tstct IS INITIAL.
            READ TABLE s_fm_data-tstct INTO s_tstct INDEX 1.
            mac_assign &apos;(SAPLSEUK)TRAN_LANGU&apos; s_tstct-sprsl.
            mac_assign &apos;(SAPLSEUK)TSTCT&apos; s_tstct.
          ENDIF.
          mac_assign_table &apos;(SAPLSEUK)param[]&apos; s_fm_data-t_params.
          mac_assign &apos;(SAPLSEUK)G_GUI_INHE&apos; s_fm_data-gui_inh.
          IF s_fm_data-tstcc-s_webgui = &apos;2&apos;.    &quot; LSEUKF01(426-427)
            mac_assign &apos;(SAPLSEUK)G_IAC_EWT&apos; &apos;X&apos;.
          ENDIF.
          PERFORM save_tcode IN PROGRAM saplseuk.
          PERFORM save_classification IN PROGRAM saplseuk.
          MODIFY tstct FROM TABLE s_fm_data-tstct.
          CREATE OBJECT o_comp.
          o_comp-&gt;set_type( st_transaction ).
          d_name = o_data-&gt;a0_maindata-tcode.
          o_comp-&gt;set_name( d_name ).
          CREATE OBJECT components.
          components-&gt;add( o_comp ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING
              textid = zaplink_cx_connector=&gt;type_not_supported
              type   = object-&gt;type
              connclass = &apos;ZAPLINK_MESSAGE&apos;.
      ENDCASE.
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
ENDMETHOD.
endclass. &quot;ZAPLINK_TRANSACTION implementation
class ZAPLINK_TRAN_DATA implementation.
METHOD from_data.
  DATA s_text  LIKE LINE OF texts.
  DATA s_auth  TYPE ts_authority.
  DATA s_value LIKE LINE OF s_auth-values.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF fm_data-tstca,
    &lt;t&gt; LIKE LINE OF fm_data-tstct.
  MOVE-CORRESPONDING fm_data-tstc TO a0_maindata.
  MOVE-CORRESPONDING fm_data-tstcc TO a0_maindata.
  MOVE-CORRESPONDING fm_data-rsstcd TO a0_maindata.
  a0_maindata-gui_inh = fm_data-gui_inh.
  clear a0_maindata-tc_type.          &quot; transaction type in text
  parameters = fm_data-t_params.
  LOOP AT fm_data-tstct ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-langu = &lt;t&gt;-sprsl.
    s_text-short_txt = &lt;t&gt;-ttext.
    INSERT s_text INTO TABLE texts.
  ENDLOOP.
  CLEAR authorization.
  LOOP AT fm_data-tstca ASSIGNING &lt;o&gt;.
    AT NEW objct.
      CLEAR s_auth.
      s_auth-object = &lt;o&gt;-objct.
    ENDAT.
    CLEAR s_value.
    s_value-field = &lt;o&gt;-field.
    s_value-value = &lt;o&gt;-value.
    INSERT s_value INTO TABLE s_auth-values.
    AT END OF objct.
      IF NOT authorization IS INITIAL.
      ENDIF.
      authorization = s_auth.
    ENDAT.
  ENDLOOP.
ENDMETHOD.
method DATA_2_TYPE.
endmethod.
METHOD to_data.
  DATA s_text  LIKE LINE OF fm_data-tstct.
  DATA s_value LIKE LINE OF fm_data-tstca.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF authorization-values,
    &lt;t&gt; LIKE LINE OF texts.
  MOVE-CORRESPONDING a0_maindata TO fm_data-tstc.
  MOVE-CORRESPONDING a0_maindata TO fm_data-tstcc.
  MOVE-CORRESPONDING a0_maindata TO fm_data-rsstcd.
  fm_data-gui_inh = a0_maindata-gui_inh.
  fm_data-t_params = parameters.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_text.
    s_text-tcode = a0_maindata-tcode.
    s_text-sprsl = &lt;t&gt;-langu.
    s_text-ttext = &lt;t&gt;-short_txt.
    INSERT s_text INTO TABLE fm_data-tstct.
  ENDLOOP.
  LOOP AT authorization-values ASSIGNING &lt;o&gt;.
    CLEAR s_value.
    s_value-tcode = a0_maindata-tcode.
    s_value-objct = authorization-object.
    s_value-field = &lt;o&gt;-field.
    s_value-value = &lt;o&gt;-value.
    INSERT s_value INTO TABLE fm_data-tstca.
  ENDLOOP.
ENDMETHOD.
endclass. &quot;ZAPLINK_TRAN_DATA implementation
class ZAPLINK_INFOS implementation.
METHOD constructor.
  me-&gt;get_sap_data( ).
  me-&gt;get_zl_data( ).
ENDMETHOD.
method GET_SAP_DATA.
  TYPES:
    BEGIN OF ts_ver_tab,
      line(80) TYPE c,
    END OF ts_ver_tab.
  DATA version_info TYPE STANDARD TABLE OF ts_ver_tab.
  FIELD-SYMBOLS:
    &lt;v&gt; LIKE LINE OF version_info.
  TYPES:
    BEGIN OF ts_ver_info,
      name TYPE string,
      value TYPE string,
    END OF ts_ver_info.
  DATA t_values_ver TYPE STANDARD TABLE OF ts_ver_info.
  DATA s_value LIKE LINE OF t_values_ver.
  DATA d_char(255) TYPE c.
  DATA it_comptab    TYPE STANDARD TABLE OF spam_cvers.
  DATA s_comp        LIKE LINE OF sap-_components.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF it_comptab.
  DEFINE mac_read_val.
    read table t_values_ver into s_value
         with key name = &amp;1.
    if sy-subrc = 0.    &amp;2 = s_value-value.   endif.
  END-OF-DEFINITION.
  CALL &apos;SAPCORE&apos; ID &apos;ID&apos; FIELD &apos;VERSION&apos;
                 ID &apos;TABLE&apos; FIELD version_info.
  LOOP AT version_info ASSIGNING &lt;v&gt;.
    CLEAR s_value.
    s_value-name = &lt;v&gt;(21).   s_value-value = &lt;v&gt;+21.
    APPEND s_value TO t_values_ver.
  ENDLOOP.
  mac_read_val:
    &apos;SAP version&apos; sap-status-sap_ver,
    &apos;operating system&apos; sap-status-os,
    &apos;machine type&apos; sap-status-machine_type,
    &apos;database system&apos; sap-status-db_sys,
    &apos;kernel release&apos; sap-status-kernel,
    &apos;database library&apos; sap-status-db_lib,
    &apos;ABAP load version&apos; sap-status-abap_ver,
    &apos;CUA load version&apos; sap-status-cua_ver.
  CALL FUNCTION &apos;DB_GET_RELEASE&apos;
    IMPORTING
      release = d_char.
  sap-status-db_release = d_char.
  IF cl_abap_char_utilities=&gt;charsize = 1.
    sap-status-unicode = &apos;Yes&apos;(oui).
  ELSE.
    sap-status-unicode = &apos;No&apos;(non).
  ENDIF.
  CALL FUNCTION &apos;SPAM_READ_PAT03&apos;
    TABLES
      tt_pat03_selected                = sap-_hot_packages
    EXCEPTIONS
      wrong_release_string             = 0
      wrong_patch_type                 = 0
      no_component_available           = 0
      wrong_component_id_release       = 0
      wrong_addon_id_release           = 0
      OTHERS                           = 0.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
            WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.
  SORT sap-_hot_packages BY component  ASCENDING
                            addon_id   ASCENDING
                            imple_date ASCENDING
                            imple_time ASCENDING.
  CALL FUNCTION &apos;OCS_GET_INSTALLED_COMPS&apos;
    TABLES
      tt_comptab = it_comptab
    EXCEPTIONS
      OTHERS     = 0.
  CALL FUNCTION &apos;OCS_SORT_COMPS_HIERARCHICAL&apos;
    TABLES
      tt_comptab = it_comptab
    EXCEPTIONS
      OTHERS     = 0.
  LOOP AT it_comptab ASSIGNING &lt;c&gt;.
    CLEAR s_comp.   s_comp-hdr = &lt;c&gt;.
    CALL FUNCTION &apos;OCS_GET_COMPONENT_STATE&apos;
      EXPORTING
        iv_component  = &lt;c&gt;-component
      IMPORTING
        ev_comp_rel             = s_comp-release
        ev_comp_type            = s_comp-comp_type
        ev_comp_level           = s_comp-level
        ev_comp_spp_level       = s_comp-spp_level
        ev_last_patch           = s_comp-high_package
        ev_last_spp             = s_comp-high_spp
        ev_comp_active          = s_comp-active
        ev_comp_patchable       = s_comp-patchable
        ev_is_subcomp           = s_comp-state
      EXCEPTIONS
        unknown_component       = 0
        OTHERS                  = 0.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.
    APPEND s_comp TO sap-_components.
  ENDLOOP.
endmethod.
METHOD get_zl_data.
  DATA t_comps      TYPE tt_compkeys.
  DATA r_packages   TYPE tr_packages.
  DATA s_package    LIKE LINE OF r_packages.
  DATA s_comp       LIKE LINE OF zaplink-components.
  DATA o_list       TYPE to_list.
  DATA o_cnx        TYPE to_connector.
  DATA o_raw        TYPE to_raw.
  DATA o_ref        TYPE REF TO cl_abap_classdescr.
  DATA o_comp       TYPE to_component.
  DATA o_c_n        TYPE to_component.
  DATA i_sign       TYPE ti_code_signature.
  DATA s_cnx        LIKE LINE OF zaplink-connectors.
  DATA s_subcomp    LIKE LINE OF s_cnx-_components.
  DATA _comp        TYPE ts_component.
  DATA cnx_name     TYPE seoclskey.
  DATA o_generator  TYPE to_generator.
  DATA d_classname  TYPE td_classname.
  DATA o_cnxcomp    TYPE to_component.
  DATA t_global_c   TYPE tt_zl_comps.
  DATA t_commun_c   TYPE tt_zl_comps.
  DATA d_cnx        LIKE LINE OF t_global_c.
  FIELD-SYMBOLS:
    &lt;st&gt; LIKE LINE OF o_cnx-&gt;supported_types,
    &lt;x&gt; LIKE LINE OF zaplink-connectors,
    &lt;sc&gt; LIKE LINE OF &lt;x&gt;-_components,
    &lt;o&gt; LIKE LINE OF o_generator-&gt;all_components,
    &lt;c&gt; LIKE LINE OF t_comps.
  zaplink-framework_version = framework_version.
  o_list = zaplink_connectors_4inst=&gt;get_connectorlist( ).
  o_list-&gt;select_default( zaplink_list=&gt;sel_actions-export ).
  o_list-&gt;order_kind = zaplink_list=&gt;order_kinds-no_order.
  o_list-&gt;init_sel_iter( ).
  o_list-&gt;display_progress = abap_true.
  o_c_n = o_list-&gt;get_next( ).
  WHILE o_c_n IS BOUND.
    o_comp = o_c_n.     o_c_n = o_list-&gt;get_next( ).
    CLEAR: s_cnx, _comp.
    _comp = o_comp-&gt;get_key( ).
    CREATE OBJECT o_cnx TYPE (_comp-name).
    s_cnx-hdr = _comp.    s_cnx-uuid = o_cnx-&gt;uuid.     s_cnx-version = o_cnx-&gt;version.   s_cnx-supported_types = o_cnx-&gt;supported_types.
    cnx_name-clsname = _comp-name.  s_cnx-signature = zaplink_object=&gt;get_class_signature( cnx_name ).
    SELECT SINGLE devclass INTO s_cnx-devclass
      FROM tadir
      WHERE    pgmid = &apos;R3TR&apos;
        AND   object = _comp-type
        AND obj_name = _comp-name.
    CREATE OBJECT o_generator.
    o_generator-&gt;packages = cnx_packages.
    d_classname = _comp-name.
    o_generator-&gt;add_object( d_classname ).
    LOOP AT o_generator-&gt;all_components ASSIGNING &lt;o&gt;.
      CHECK &lt;o&gt;-type &lt;&gt; _comp-type OR &lt;o&gt;-name &lt;&gt; _comp-name.
      CLEAR s_subcomp.    s_subcomp-name = &lt;o&gt;-name.    s_subcomp-type = &lt;o&gt;-type.    s_subcomp-devclass = &lt;o&gt;-devclass.
      READ TABLE t_commun_c TRANSPORTING NO FIELDS
           WITH TABLE KEY type = s_subcomp-type
                          name = s_subcomp-name.
      CHECK sy-subrc &lt;&gt; 0.    &quot; not commun comp
      READ TABLE t_global_c TRANSPORTING NO FIELDS
           WITH TABLE KEY type = s_subcomp-type
                          name = s_subcomp-name.
      IF sy-subrc = 0.
        INSERT s_subcomp INTO TABLE t_commun_c.   &quot; component is present twice time on 2 differents connectors
        CONTINUE.
      ENDIF.
      INSERT s_subcomp INTO TABLE s_cnx-_components.
      CLEAR d_cnx. d_cnx-name = s_subcomp-name.   d_cnx-type = s_subcomp-type.
      INSERT d_cnx INTO TABLE t_global_c.
    ENDLOOP.
    TRY.
      LOOP AT o_cnx-&gt;supported_types ASSIGNING &lt;st&gt;.
        o_raw = o_cnx-&gt;create_new_raw( &lt;st&gt;-type ).
        CHECK o_raw-&gt;raw IS BOUND.
        CLEAR s_subcomp.    s_subcomp-name = cl_abap_classdescr=&gt;get_class_name( o_raw-&gt;raw ).    s_subcomp-type = &apos;CLAS&apos;.
        REPLACE FIRST OCCURRENCE OF REGEX &apos;\\CLASS=&apos; IN s_subcomp-name WITH ``.
        SELECT SINGLE devclass INTO s_subcomp-devclass
          FROM v_tralan
          WHERE pgmid = &apos;R3TR&apos;
            AND object = s_subcomp-type
            AND obj_name = s_subcomp-name.
        s_subcomp-raw_data_type = abap_true.
        MODIFY TABLE s_cnx-_components FROM s_subcomp.
        IF sy-subrc &lt;&gt; 0.   INSERT s_subcomp INTO TABLE s_cnx-_components.    ENDIF.
        CLEAR d_cnx. d_cnx-name = s_subcomp-name.   d_cnx-type = s_subcomp-type.
        INSERT d_cnx INTO TABLE t_global_c.
      ENDLOOP.
    ENDTRY.
    IF NOT s_cnx IS INITIAL.  INSERT s_cnx INTO TABLE zaplink-connectors.   ENDIF.
    CLEAR d_cnx. d_cnx-name = _comp-name.
    IF NOT d_cnx IS INITIAL.  d_cnx-type = &apos;CLAS&apos;.  INSERT d_cnx INTO TABLE t_global_c.   ENDIF.
  ENDWHILE.
  LOOP AT zaplink-connectors ASSIGNING &lt;x&gt;.
    LOOP AT &lt;x&gt;-_components ASSIGNING &lt;sc&gt;
            WHERE raw_data_type = abap_false.
      READ TABLE t_commun_c TRANSPORTING NO FIELDS
           WITH TABLE KEY type = &lt;sc&gt;-type
                          name = &lt;sc&gt;-name.
      CHECK sy-subrc = 0.                 &quot; component is a commun comp
      DELETE TABLE &lt;x&gt;-_components FROM &lt;sc&gt;.
    ENDLOOP.
    LOOP AT &lt;x&gt;-_components ASSIGNING &lt;sc&gt;.
      o_comp = zaplink_component_4inst=&gt;create_new( &lt;sc&gt;-hdr ).
      CHECK o_comp IS BOUND.    o_cnx = o_comp-&gt;connector( ).
      CHECK o_cnx IS BOUND.
      CHECK o_cnx-&gt;do_exists( o_comp ) = abap_true.
      TRY.
          i_sign ?= o_cnx.
          &lt;sc&gt;-signature = i_sign-&gt;get_signature( o_comp ).
        CATCH cx_root.
      ENDTRY.
      DELETE TABLE t_commun_c FROM &lt;sc&gt;.
    ENDLOOP.
    DELETE TABLE t_commun_c
           WITH TABLE KEY type = &lt;x&gt;-type
                          name = &lt;x&gt;-name.
  ENDLOOP.
  s_package-sign = &apos;I&apos;. s_package-option = &apos;EQ&apos;.    s_package-low = &apos;ZAPLINK&apos;.
  APPEND s_package TO r_packages.
  t_comps = zaplink_tools=&gt;get_keys_from_package( packages = r_packages ).
  SORT t_comps BY type name.
  LOOP AT t_comps ASSIGNING &lt;c&gt;.
    READ TABLE t_global_c TRANSPORTING NO FIELDS
         WITH TABLE KEY type = &lt;c&gt;-type
                        name = &lt;c&gt;-name.
    IF sy-subrc = 0.
      READ TABLE t_commun_c TRANSPORTING NO FIELDS
           WITH TABLE KEY type = &lt;sc&gt;-type
                          name = &lt;sc&gt;-name.
      IF sy-subrc &lt;&gt; 0.
        CONTINUE.
      ENDIF.
    ENDIF.
    CLEAR s_comp.   s_comp-hdr = &lt;c&gt;.
    o_comp = zaplink_component_4inst=&gt;create_new( &lt;c&gt; ).
    CHECK o_comp IS BOUND.    o_cnx = o_comp-&gt;connector( ).
    CHECK o_cnx IS BOUND.
    CHECK o_cnx-&gt;do_exists( o_comp ) = abap_true.
    SELECT SINGLE devclass INTO s_comp-devclass
      FROM tadir
      WHERE    pgmid = &apos;R3TR&apos;
        AND   object = &lt;c&gt;-type
        AND obj_name = &lt;c&gt;-name.
    TRY.
        i_sign ?= o_cnx.
      CATCH cx_root.
    ENDTRY.
    IF i_sign IS BOUND.   s_comp-signature = i_sign-&gt;get_signature( o_comp ).     ENDIF.
    APPEND s_comp TO zaplink-components.
  ENDLOOP.
ENDMETHOD.
method CLASS_CONSTRUCTOR.
  data s_pack like LINE OF cnx_packages.
  s_pack-sign = &apos;I&apos;.    s_pack-option = &apos;EQ&apos;.
  s_pack-low = &apos;$TMP&apos;.      append s_pack to cnx_packages.
  s_pack-low = &apos;ZAPLINK-CONNECTORS&apos;.      append s_pack to cnx_packages.
  s_pack-low = &apos;ZAPLINK-CONNECTORS-MAIN&apos;.      append s_pack to cnx_packages.
  s_pack-low = &apos;ZAPLINK-CONNECTORS-OTHERS&apos;.      append s_pack to cnx_packages.
endmethod.
endclass. &quot;ZAPLINK_INFOS implementation
class ZAPLINK_SXCI_DATA implementation.
method FROM_DATA.
def_name = fm_data-implementation-exit_name.
  CALL METHOD super-&gt;from_data
    EXPORTING
      fm_data = fm_data.
  a0_maindata-main = fm_data-implementation.
  a0_maindata-mast_langu = fm_data-mast_langu.
  filter-enhanceable = fm_data-impl_w_filter.
  filter-datatype = fm_data-filter_datatype.
  filter-values = fm_data-filter_values.
endmethod.
method TO_DATA.
def_name = a0_maindata-exit_name.
  CALL METHOD super-&gt;to_data
    RECEIVING
      fm_data = fm_data.
  fm_data-implementation = a0_maindata-main.
  fm_data-mast_langu = a0_maindata-mast_langu.
  fm_data-impl_w_filter = filter-enhanceable.
  fm_data-filter_datatype = filter-datatype.
  fm_data-filter_values = filter-values.
endmethod.
endclass. &quot;ZAPLINK_SXCI_DATA implementation
class ZAPLINK_SXSD_DATA implementation.
method FROM_DATA.
  DATA _fc    LIKE LINE OF functions_codes.
  DATA _cc    LIKE LINE OF controls_composites.
  DATA _scr   LIKE LINE OF subscreens.
  DATA _t     LIKE LINE OF tables.
  FIELD-SYMBOLS:
    &lt;fc&gt;  LIKE LINE OF fm_data-fcodes,
    &lt;cc&gt;  LIKE LINE OF fm_data-cocos,
    &lt;in&gt;  LIKE LINE OF fm_data-intas,
    &lt;scr&gt; LIKE LINE OF fm_data-scrns,
    &lt;me&gt;  LIKE LINE OF fm_data-methods,
    &lt;it&gt;  LIKE LINE OF fm_data-inactive_tabstrips.
  a0_maindata-main = fm_data-definition.
  a0_maindata-mast_langu = fm_data-mast_langu.
  a0_maindata-ext_clname = fm_data-ext_clname.
  LOOP AT fm_data-intas ASSIGNING &lt;in&gt;
    WHERE exit_name = a0_maindata-exit_name.
    CLEAR _t.
    _t = &lt;in&gt;.
    CLEAR: _t-exit_name. &quot; VERSION
    INSERT _t INTO TABLE tables.
  ENDLOOP.
  LOOP AT fm_data-cocos ASSIGNING &lt;cc&gt;
    WHERE exit_name = a0_maindata-exit_name.
    CLEAR _cc.
    _cc = &lt;cc&gt;.
    CLEAR: _cc-exit_name. &quot; VERSION
    INSERT _cc INTO TABLE controls_composites.
  ENDLOOP.
  LOOP AT fm_data-fcodes ASSIGNING &lt;fc&gt;
    WHERE exit_name = a0_maindata-exit_name.
    CLEAR _fc.
    _fc = &lt;fc&gt;.
    CLEAR: _fc-exit_name. &quot; VERSION
    INSERT _fc INTO TABLE functions_codes.
  ENDLOOP.
  LOOP AT fm_data-scrns ASSIGNING &lt;scr&gt;
    WHERE exit_name = a0_maindata-exit_name.
    CLEAR _scr.
    _scr = &lt;scr&gt;.
    CLEAR: _scr-exit_name. &quot; VERSION
    INSERT _scr INTO TABLE subscreens.
  ENDLOOP.
endmethod.
method TO_DATA.
  DATA _in  LIKE LINE OF fm_data-intas.
  DATA _cc  LIKE LINE OF fm_data-cocos.
  DATA _fc  LIKE LINE OF fm_data-fcodes.
  DATA _scr LIKE LINE OF fm_data-scrns.
  FIELD-SYMBOLS:
    &lt;t&gt;   LIKE LINE OF tables,
    &lt;scr&gt; LIKE LINE OF subscreens,
    &lt;fc&gt;  LIKE LINE OF functions_codes,
    &lt;cc&gt;  LIKE LINE OF controls_composites.
  fm_data-definition = a0_maindata-main.
  fm_data-mast_langu = a0_maindata-mast_langu.
  fm_data-ext_clname = a0_maindata-ext_clname.
  LOOP AT tables ASSIGNING &lt;t&gt;.
    CLEAR _in.
    _in = &lt;t&gt;.
    _in-exit_name = a0_maindata-exit_name.
    INSERT _in INTO TABLE fm_data-intas.
  ENDLOOP.
  LOOP AT controls_composites ASSIGNING &lt;cc&gt;.
    CLEAR _cc.
    _cc = &lt;cc&gt;.
    _cc-exit_name = a0_maindata-exit_name.
    INSERT _cc INTO TABLE fm_data-cocos.
  ENDLOOP.
  LOOP AT functions_codes ASSIGNING &lt;fc&gt;.
    CLEAR _fc.
    _fc = &lt;fc&gt;.
    _fc-exit_name = a0_maindata-exit_name.
    INSERT _fc INTO TABLE fm_data-fcodes.
  ENDLOOP.
  LOOP AT subscreens ASSIGNING &lt;scr&gt;.
    CLEAR _scr.
    _scr = &lt;scr&gt;.
    _scr-exit_name = a0_maindata-exit_name.
    INSERT _scr INTO TABLE fm_data-scrns.
  ENDLOOP.
endmethod.
METHOD constructor.
  super-&gt;constructor( ).
ENDMETHOD.
endclass. &quot;ZAPLINK_SXSD_DATA implementation

PARAMETERS p_file LOWER CASE TYPE string DEFAULT &apos;C:\ZAPLink.info.xml&apos;.

DATA o_file     TYPE REF TO zaplink_file.
DATA o_cx_file  TYPE REF TO zaplink_cx_file.

INITIALIZATION.
ZAPLINK_CONNECTORS=&gt;clear_connectors( ).
DATA _cx_90335e5d44316adf4805a732f type ref to ZAPLINK_CX_COMPONENT.
TRY.
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_OBJECT&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_PACKAGE&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_DOCUMENTATION&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_DICTIONARY&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_OS_COMMAND&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_FUNCTION_GROUP&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_MESSAGE&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_PROGRAM&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_BADI&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_TRANSACTION&apos;).
CATCH ZAPLINK_CX_COMPONENT INTO _cx_90335e5d44316adf4805a732f.
_cx_90335e5d44316adf4805a732f-&gt;write( ).
BREAK-POINT.
RAISE EXCEPTION _cx_90335e5d44316adf4805a732f.
ENDTRY.
  CREATE OBJECT o_file.
  o_file-&gt;set_filetype( zaplink_file=&gt;filetypes-local ).

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_file.
*  DATA l_file TYPE zaplink_file=&gt;t_filename.
  DATA d_msg  TYPE string.

  TRY.
      o_file-&gt;load_dialog( p_file ).
      p_file = o_file-&gt;get_filename( ).
    CATCH zaplink_cx_file INTO o_cx_file.
      CHECK o_cx_file-&gt;textid &lt;&gt; zaplink_cx_file=&gt;dialog_canceled.
      d_msg = o_cx_file-&gt;get_text( ).
      MESSAGE d_msg TYPE &apos;W&apos;.
  ENDTRY.

START-OF-SELECTION.
  DATA o_infos TYPE REF TO zaplink_infos.
  DATA o_ezxml TYPE REF TO zaplink_easyxml.
  DATA o_xml   TYPE REF TO if_ixml_document.
  DATA o_xmlengine  TYPE REF TO if_ixml.
  DATA o_streamfactory TYPE REF TO if_ixml_stream_factory.
  DATA o_outputstream TYPE REF TO if_ixml_ostream.
  DATA o_renderer TYPE REF TO if_ixml_renderer.
  DATA d_tempstr TYPE string.
  DATA o_printxmldoc TYPE REF TO cl_xml_document.
  DATA t_xml TYPE STANDARD TABLE OF string.
  FIELD-SYMBOLS &lt;l&gt; LIKE LINE OF t_xml.

  o_xmlengine = cl_ixml=&gt;create( ).
  o_streamfactory = o_xmlengine-&gt;create_stream_factory( ).
  o_outputstream = o_streamfactory-&gt;create_ostream_cstring( d_tempstr ).
  CREATE OBJECT o_infos.
  CREATE OBJECT o_ezxml.
  o_xml = o_ezxml-&gt;any2xml( any = o_infos
                           type = &apos;INFOS&apos; ).
  o_renderer = o_xmlengine-&gt;create_renderer( document = o_xml
                                              ostream = o_outputstream ).
  o_renderer-&gt;set_normalizing( ).
  o_renderer-&gt;render( ).
  CREATE OBJECT o_printxmldoc.
  o_printxmldoc-&gt;parse_string( d_tempstr ).

  WHILE d_tempstr(1) &lt;&gt; &apos;&lt;&apos;.    SHIFT d_tempstr LEFT BY 1 PLACES.   ENDWHILE.
  SPLIT d_tempstr AT cl_abap_char_utilities=&gt;newline INTO TABLE t_xml.
  LOOP AT t_xml ASSIGNING &lt;l&gt;.  WRITE:/ &lt;l&gt;.  ENDLOOP.
  o_file-&gt;set_filename( p_file ).
  o_file-&gt;set_filecontent( d_tempstr ).
  o_file-&gt;save( ).</SOURCE>
  <TEXTSPOOL>
   <ITEM ID="R">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="ZAPLink Informations : SAP Status &amp; Framework version (as stand alone)" LENGTH="70 "/>
    </TEXTS>
   </ITEM>
  </TEXTSPOOL>
 </RAW>
</ZL_OBJECT>
