<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="FFEB2A16F3F8DB5C8B553D74BF3D268A" CODE_SIGNATURE="829509A37E04DD19A5B6C936528FA409" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_DEPENDENCIES_ANALYSER" TYPE="CLAS" VERSION="1.01">
 <DIRECTORY DEVCLASS="ZAPLINK-FRAMEWORK-CORE" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X">
   <TEXTS>
    <ITEM LANGU="E" DESCRIPT="ZAPLink : Stand Alone Generator (local class&amp;intf)">
     <DOCUMENTATION TDFRELES="700" TDLINESIZE="072">U1&amp;FUNCTIONALITY&amp;
ASTools used to maps dependencies of :
AS,,- Programs
AS,,- Classes
AS,,- Interfaces
ASTo build a &quot;standalone&quot; version with every class, interface and include
  in the right order to compile.
ASThis tools is used to build the ZAPLink installer used to install the
  framework. This tools is not part of the framework.
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AS</DOCUMENTATION>
    </ITEM>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="LINE_SEPARATOR" EXPOSURE="1" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="LINE_SEPARATOR"/>
   <ITEM CMPNAME="TD_COMPNAME" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPNAME"/>
   <ITEM CMPNAME="TD_DEVCLASS" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DEVCLASS"/>
   <ITEM CMPNAME="TD_SOFTCOMP" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_SOFTCOMP"/>
   <ITEM CMPNAME="TO_COMPONENT" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_KERNEL_TYPES" REFCMPNAME="TO_COMPONENT"/>
   <ITEM CMPNAME="TO_RAW" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_KERNEL_TYPES" REFCMPNAME="TO_RAW"/>
   <ITEM CMPNAME="TS_COMPKEY" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_COMPKEY"/>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="ALL_COMPONENTS" EXPOSURE="2" STATE="1" EDITORDER="12 " ATTRDONLY="X" TYPTYPE="1" TYPE="TT_COMPS">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="All components required"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="CIRCULAR_CONTEXT" STATE="1" EDITORDER="4 " TYPTYPE="1" TYPE="TT_CONTEXT">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="CIRCULAR_REF_ON" STATE="1" EDITORDER="3 " TYPTYPE="1" TYPE="TD_NAME">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface where circular ref"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="CLASSES" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTRDONLY="X" TYPTYPE="1" TYPE="TT_SOURCES">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Classes/interfaces codes"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="CONTEXT" STATE="1" EDITORDER="2 " TYPTYPE="1" TYPE="TT_CONTEXT">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="CURRENT_COMP" STATE="1" EDITORDER="6 " TYPTYPE="1" TYPE="TD_NAME">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="DEFERRED_DECLARATION" EXPOSURE="1" STATE="1" EDITORDER="1 " TYPTYPE="1" TYPE="TT_CLASSLIST">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Indexed list of class"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="EXCLUDED_CLASSES" STATE="1" EDITORDER="7 " TYPTYPE="1" TYPE="TT_CLASSLIST">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class excluded"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="INCLUDES" EXPOSURE="2" STATE="1" EDITORDER="7 " TYPTYPE="1" TYPE="TD_SOURCECODE">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Include list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="MESSAGES" EXPOSURE="2" STATE="1" EDITORDER="9 " ATTRDONLY="X" TYPTYPE="1" TYPE="TT_MESSAGE_IDS"/>
   <ITEM CMPNAME="NEW_ORDER" EXPOSURE="2" STATE="1" EDITORDER="10 " TYPTYPE="1" TYPE="TT_ORDER">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface Order"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="OBJTYPE" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="2" TYPTYPE="4">
    BEGIN OF objtype,
            class             TYPE td_classtype VALUE &apos;0&apos;, &quot;#EC NOTEXT      Object Type : Class
            exception_class   TYPE td_classtype VALUE &apos;5&apos;, &quot;#EC NOTEXT      Local Object type : Exception_Class
            interface         TYPE td_classtype VALUE &apos;1&apos;, &quot;#EC NOTEXT      Object Type : Interface
          END OF objtype
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Object types"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="ORDER" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTRDONLY="X" TYPTYPE="1" TYPE="TT_ORDER">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface Order"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="O_OBJECT" STATE="1" EDITORDER="1 " ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_OBJECT">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPLink Class &amp; Interface connector"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="PACKAGES" EXPOSURE="2" STATE="1" EDITORDER="8 " TYPTYPE="1" TYPE="TR_PACKAGES">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Packages accepted"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="REMAIN_CLASSES" EXPOSURE="2" STATE="1" EDITORDER="11 " TYPTYPE="1" TYPE="TT_SOURCES">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Classes/interfaces codes"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="REQUIRED_OBJECTS" STATE="1" EDITORDER="5 " TYPTYPE="1" TYPE="TT_REQ_OBJECTS">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface requirement"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="REQUIREMENTS" STATE="1" EDITORDER="8 " TYPTYPE="1" TYPE="TT_REQ_OBJECTS"/>
   <ITEM CMPNAME="SOFTCOMPONENTS" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="1" ATTRDONLY="X" TYPTYPE="1" TYPE="TR_DLVUNIT">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Software component accepted"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="S_COMP" STATE="1" EDITORDER="9 " TYPTYPE="1" TYPE="TS_COMP"/>
   <ITEM CMPNAME="TYPEGROUPS" EXPOSURE="2" STATE="1" EDITORDER="5 " TYPTYPE="1" TYPE="TT_TYPEGROUPS">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Type Groups list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TYPETYPE" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="2" TYPTYPE="4">
    BEGIN OF typetype,
            like    TYPE seotyptype VALUE &apos;0&apos;, &quot;#EC NOTEXT      Attribute reference (LIKE)
            type    TYPE seotyptype VALUE &apos;1&apos;, &quot;#EC NOTEXT      Type reference (TYPE)
            otype   TYPE seotyptype VALUE &apos;2&apos;, &quot;#EC NOTEXT      Object (TYPE)
            ref     TYPE seotyptype VALUE &apos;3&apos;, &quot;#EC NOTEXT      Object reference (TYPE REF TO)
            code    TYPE seotyptype VALUE &apos;4&apos;, &quot;#EC NOTEXT      See coding
          END OF typetype
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Types of type definition"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <INTERFACES>
   <ITEM REFCLSNAME="ZAPLINK_DATATYPES" EXPOSURE="2" STATE="1" RELTYPE="1"/>
   <ITEM REFCLSNAME="ZAPLINK_KERNEL_TYPES" EXPOSURE="2" STATE="1" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

  DEFINE mac_read_tadir.
    select single devclass dlvunit into (&amp;3, &amp;4)
      from v_tralan
      where pgmid = &apos;R3TR&apos;
        and object = &amp;1
        and obj_name = &amp;2.
  END-OF-DEFINITION.

  DEFINE mac_add_comp.
    if not s_comp-type is initial and not s_comp-name is initial.
      mac_read_tadir s_comp-type s_comp-name s_comp-devclass s_comp-softcomp.
      if s_comp-devclass in packages and s_comp-softcomp in softcomponents.
        insert s_comp into table all_components.
      endif.
    endif.
  END-OF-DEFINITION.</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="ADD_ATTRIBUTS" EXPOSURE="1" STATE="1" EDITORDER="1 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add Attributs"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ATTRIBUTS" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;TT_ATTRIBUTS"/>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
DATA _name TYPE string.
  FIELD-SYMBOLS:
    &lt;a&gt; LIKE LINE OF attributs.

  LOOP AT attributs ASSIGNING &lt;a&gt;.
    CONCATENATE &apos;Attributs-&gt;&apos; &lt;a&gt;-cmpname INTO _name.   &quot;#EC NOTEXT
    stack( _name ).
    CALL METHOD process_type( type = &lt;a&gt;-typtype
                              name = &lt;a&gt;-type ).
    unstack( ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_CLASS_DEP" EXPOSURE="1" STATE="1" EDITORDER="3 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add class dependenties"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FULL" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_FALSE" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Full definition required"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="EXISTS" LANGU="E" EDITORDER="2 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object already in list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Failed to add"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NOT_EXISTING" LANGU="E" EDITORDER="3 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object does not exists in SAP"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _codes      LIKE LINE OF classes.
  DATA o_raw       TYPE to_raw.
  DATA o_data      TYPE to_class.
  DATA _component  TYPE to_component.
  DATA _key        TYPE td_name.
  DATA d_softcomp  TYPE tdevc-dlvunit.
  DATA d_devclass  TYPE tdevc-devclass.
  DATA _order      LIKE LINE OF order.
  DATA _name       TYPE td_compname.
  DATA f_before    TYPE xfeld.
  DATA d_tabix     TYPE sy-tabix.
  DATA _class      TYPE vseoclass.
  DATA s_key       TYPE seoclskey.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF circular_context,
    &lt;f&gt; LIKE LINE OF o_data-&gt;friends.

  CHECK IS_EXCLUDED_CLASS( type = &apos;CLAS&apos;  name = name ) = ABAP_false.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = name
*                type = _order-type   &quot; for perf reason
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do

  s_key-clsname = name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = s_key
*     VERSION            = SEOC_VERSION_INACTIVE
*     STATE              = &apos;0&apos;
    IMPORTING
*      clstype            = o_type
      class              = _class
*     INTERFACE          =
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.

  _order-name = name.
  IF _class-category = &apos;40&apos;.    _order-type = objtype-exception_class.   ELSE.   _order-type = objtype-class.   ENDIF.

  READ TABLE context TRANSPORTING NO FIELDS
       WITH KEY context = name
                   type = _order-type.
  IF sy-subrc = 0.    &quot; Circular reference =&gt; Use defered
    stack( context = name   type = _order-type    full = full ).
    d_tabix = sy-tabix + 1.   circular_context = context.   DELETE circular_context FROM d_tabix.
    current_comp = name.    handle_context( ).        &quot; CLEAR:  circular_ref_on, circular_context.
    unstack( ).
    EXIT.
  ENDIF.

  READ TABLE classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do

  stack( context = name   type = _order-type    full = full ).
  CALL METHOD do_class
    EXPORTING
      name   = name
    EXCEPTIONS
      failed = 1
      OTHERS = 2.
  IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.

  CREATE OBJECT _component.
  _component-&gt;set_type( &apos;CLAS&apos; ).   _name = name.   _component-&gt;set_name( _name ).
  o_raw = o_object-&gt;zaplink_connector~read_from_sap( _component ).    o_data ?= o_raw-&gt;raw.

  append_typegroups( o_data-&gt;typegroups ).
  append_message( o_data-&gt;a0_maindata-msg_id ).

  IF NOT o_data-&gt;a0_maindata-inheritance-refclsname IS INITIAL.
    _key = o_data-&gt;a0_maindata-inheritance-refclsname.
    add_object_to_list( name = _key
                        full = abap_true
                      source = &apos;=&gt;inheritance-refclsname&apos; ).
  ENDIF.

  CALL METHOD add_types( o_data-&gt;types ).

  CALL METHOD add_interfaces( o_data-&gt;interfaces ).

  CALL METHOD add_attributs( o_data-&gt;attributs ).

  CALL METHOD add_methods( o_data-&gt;methods ).

  LOOP AT o_data-&gt;friends ASSIGNING &lt;f&gt;.
    _key = &lt;f&gt;-refclsname.    CALL METHOD add_object_to_list( name = _key   SOURCE = &apos;=&gt;friends&apos; ).
  ENDLOOP.

  do_object_list( name = name ).

  unstack( ).

  insert_order( s_order = _order   context = context ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_DEFERED_OK" EXPOSURE="2" STATE="1" EDITORDER="5 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Generate ABAP Source Code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="3" TYPTYPE="1" TYPE="ABAP_BOOL">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="has changed"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  TYPES:
    BEGIN OF ts_dep,
      ori_name  TYPE td_name,
      type      TYPE td_classtype,    &quot; 0 Class 1 interface
      full_def  TYPE flag,          &quot; Full definition required
      count     TYPE i,
    END OF ts_dep.
  DATA t_tmp     TYPE STANDARD TABLE OF ts_dep WITH DEFAULT KEY.
  DATA s_dep     LIKE LINE OF t_tmp.
  DATA t_deps    TYPE SORTED TABLE OF ts_dep WITH UNIQUE KEY ori_name TYPE full_def.
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF requirements,
    &lt;c&gt; LIKE LINE OF remain_classes.

  LOOP AT requirements ASSIGNING &lt;r&gt;.
    CLEAR s_dep.    MOVE-CORRESPONDING &lt;r&gt; TO s_dep.    s_dep-count = 1.
    COLLECT s_dep INTO t_tmp.
  ENDLOOP.
  t_deps = t_tmp.
* intf/class with only defered dependences any dependances
  LOOP AT remain_classes ASSIGNING &lt;c&gt;.
    LOOP AT t_deps INTO s_dep
         WHERE ori_name = &lt;c&gt;-name
           AND (   type = objtype-exception_class   &quot; Exception are full required
            OR full_def = abap_true ).
      EXIT.
    ENDLOOP.
    IF sy-subrc &lt;&gt; 0.   clear s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    result = abap_true.   DELETE remain_classes.    ENDIF.
  ENDLOOP.
  add_without_requirements( ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_DEFERRED_CODE" EXPOSURE="1" STATE="1" EDITORDER="4 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get deferred declaration code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ABAPCODE" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TYPE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CLASSTYPE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class type"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA _obj      LIKE LINE OF deferred_declaration.
  DATA _line     LIKE LINE OF abapcode.

  READ TABLE deferred_declaration TRANSPORTING NO FIELDS
       WITH TABLE KEY name = name.
  IF sy-subrc = 0.
    EXIT.
  ENDIF.
  CASE type.
    WHEN objtype-class OR objtype-exception_class.
      CONCATENATE &apos;CLASS&apos; name &apos;DEFINITION DEFERRED.&apos; INTO _line SEPARATED BY space.
      APPEND _line TO abapcode.
      _obj-name = name.
      INSERT _obj INTO TABLE deferred_declaration.
    WHEN objtype-interface.
      CONCATENATE &apos;INTERFACE&apos; name &apos;DEFERRED.&apos; INTO _line SEPARATED BY space.
      APPEND _line TO abapcode.
      _obj-name = name.
      INSERT _obj INTO TABLE deferred_declaration.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_INTERFACES" EXPOSURE="1" STATE="1" EDITORDER="5 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add interfaces"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="INTERFACES" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;TT_INTERFACES"/>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF interfaces.

  LOOP AT interfaces ASSIGNING &lt;i&gt;.
    _key = &lt;i&gt;-refclsname.
    add_object_to_list( name = _key
                        full = abap_true
                      source = &apos;=&gt;interface&apos; ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_INTERFACE_DEP" EXPOSURE="1" STATE="1" EDITORDER="6 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add Interface dependenties"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FULL" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_FALSE" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Full definition required"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="EXISTS" LANGU="E" EDITORDER="2 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object already in list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Failed to add"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NOT_EXISTING" LANGU="E" EDITORDER="3 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object does not exists in SAP"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _codes      LIKE LINE OF classes.
  DATA o_raw       TYPE to_raw.
  DATA o_data      TYPE to_interface.
  DATA _component  TYPE zaplink_connector=&gt;to_component.
  DATA d_softcomp  TYPE tdevc-dlvunit.
  DATA d_devclass  TYPE tdevc-devclass.
  DATA _order      LIKE LINE OF order.
  DATA _name       TYPE zaplink_connector=&gt;td_compname.
  DATA d_tabix     TYPE sy-tabix.

  CHECK IS_EXCLUDED_CLASS( type = &apos;INTF&apos;  name = name ) = ABAP_false.
  _order-name = name.   _order-type = objtype-interface.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = _order-name
                type = _order-type
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do

  READ TABLE context TRANSPORTING NO FIELDS
       WITH KEY context = name
                   type = _order-type.
  IF sy-subrc = 0.      &quot; Circular reference =&gt; Use defered
    stack( context = name   type = _order-type    full = full ).
    d_tabix = sy-tabix + 1.   circular_context = context.   DELETE circular_context FROM d_tabix.
    current_comp = name.    handle_context( ).        &quot; CLEAR:  circular_ref_on, circular_context.
    unstack( ).
    EXIT.
  ENDIF.

  READ TABLE classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed =&gt; nothing to do

  stack( context = name   type = _order-type    full = full ).
  CALL METHOD do_class
    EXPORTING
      name   = name
    EXCEPTIONS
      failed = 1
      OTHERS = 2.
  IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.

  CREATE OBJECT _component.
  _component-&gt;set_type( &apos;INTF&apos; ).   _name = name.   _component-&gt;set_name( _name ).
  o_raw = o_object-&gt;zaplink_connector~read_from_sap( _component ).
  o_data ?= o_raw-&gt;raw.

  append_typegroups( o_data-&gt;typegroups ).

  CALL METHOD add_types( o_data-&gt;types ).

  CALL METHOD add_interfaces( o_data-&gt;interfaces ).

  CALL METHOD add_attributs( o_data-&gt;attributs ).

  CALL METHOD add_methods( o_data-&gt;methods ).

  do_object_list( name = name ).

  unstack( ).

  insert_order( s_order = _order   context = context ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_METHODS" EXPOSURE="1" STATE="1" EDITORDER="7 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add méthods"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="METHODS" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;TT_METHODS"/>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _name       TYPE string.
  DATA t_objs      TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objs,
    &lt;m&gt; LIKE LINE OF methods,
    &lt;p&gt; LIKE LINE OF &lt;m&gt;-parameters,
    &lt;e&gt; LIKE LINE OF &lt;m&gt;-exceptions.

  LOOP AT methods ASSIGNING &lt;m&gt;.
    CONCATENATE &apos;Method-&gt;&apos; &lt;m&gt;-cmpname INTO _name.    &quot;#EC NOTEXT
    stack( _name ).
* Check parameters
    LOOP AT &lt;m&gt;-parameters ASSIGNING &lt;p&gt;.
      CALL METHOD process_type( type = &lt;p&gt;-typtype
                                name = &lt;p&gt;-type ).
    ENDLOOP.

    IF NOT &lt;m&gt;-mtdnewexc IS INITIAL.
* Check exceptions class
      LOOP AT &lt;m&gt;-exceptions ASSIGNING &lt;e&gt;.
        _key = &lt;e&gt;-sconame.   add_object_to_list( name = _key   source = _name ).
      ENDLOOP.
    ENDIF.

    add_source_to_list( code = &lt;m&gt;-source-_   source = _name ).

    unstack( ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_METHOD_SOURCE" EXPOSURE="1" STATE="1" EDITORDER="8 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add object use in ABAP Code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP source code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA ref_objs    TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF ref_objs.

  CHECK NOT code IS INITIAL.
  ref_objs = analyse_method_source( code ).
  LOOP AT ref_objs ASSIGNING &lt;o&gt;.
    _key = &lt;o&gt;.
    CALL METHOD add_object
      EXPORTING
        name         = _key
      EXCEPTIONS
        failed       = 1
        exists       = 2
        not_existing = 3
        OTHERS       = 4.
    IF sy-subrc &lt;&gt; 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_OBJECT" EXPOSURE="2" STATE="1" EDITORDER="1 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add class/interface to the list"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="EXISTS" LANGU="E" EDITORDER="2 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object already in list"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Failed to add"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NOT_EXISTING" LANGU="E" EDITORDER="3 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object does not exists in SAP"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key   TYPE seoclskey.
  DATA o_type TYPE seoclstype.
  DATA o_desc TYPE REF TO cl_abap_typedescr.
  DATA _name  TYPE td_name.
  DATA _class TYPE vseoclass.

  _name = name. TRANSLATE _name TO UPPER CASE.            &quot;#EC SYNTCHAR
  CALL FUNCTION &apos;SEO_CLIF_CHECK_NAME&apos;
    EXPORTING
      clsname                   = _name
    EXCEPTIONS
      reserved                  = 1
      space_not_allowed         = 2
      small_letters_not_allowed = 3
      symbols_not_allowed       = 4
      first_character_no_number = 5
      namespace_error           = 6
      OTHERS                    = 7.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.

  CALL METHOD cl_abap_typedescr=&gt;describe_by_name
    EXPORTING
      p_name         = _name
    RECEIVING
      p_descr_ref    = o_desc
    EXCEPTIONS
      type_not_found = 1
      OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
    RAISE not_existing.
  ENDIF.

  CHECK o_desc-&gt;kind = cl_abap_typedescr=&gt;kind_class
     OR o_desc-&gt;kind = cl_abap_typedescr=&gt;kind_intf.

  _key-clsname = _name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = _key
*     VERSION            = SEOC_VERSION_INACTIVE
*     STATE              = &apos;0&apos;
    IMPORTING
      clstype            = o_type
      class              = _class
*     INTERFACE          =
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    CHECK _key &lt;&gt; &apos;OBJECT&apos;. &quot; reserved word
    RAISE not_existing.
  ENDIF.

  IF o_type &lt;&gt; objtype-class AND o_type &lt;&gt; objtype-interface.
    RAISE failed.
  ENDIF.

  IF o_type = objtype-class.
    add_class_dep( _name ).
  ELSE.
    add_interface_dep( _name ).
  ENDIF.

  IF context IS INITIAL.
* Main call
    CALL METHOD _clean_up( ).
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_OBJECT_TO_LIST" EXPOSURE="1" STATE="1" EDITORDER="9 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add object to dependenties list"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FULL" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_FALSE" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Full component is requiered"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SOURCE" CMPTYPE="1" EDITORDER="3 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Where component is used"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA s_obj       LIKE LINE OF required_objects.
  DATA s_key       TYPE seoclskey.
  DATA o_type      TYPE seoclstype.
  DATA s_class     TYPE vseoclass.

  s_key-clsname = name.   TRANSLATE s_key-clsname TO UPPER CASE.    s_obj-name = s_key-clsname.
  CHECK is_excluded_class( name = s_key-clsname ) = abap_false.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = s_key
*     VERSION            = SEOC_VERSION_INACTIVE
*     STATE              = &apos;0&apos;
    IMPORTING
      clstype            = o_type
      class              = s_class
*     INTERFACE          =
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    EXIT.
  ENDIF.

  s_obj-type = o_type.    s_obj-full_def = full.    s_obj-source = source.
  IF s_class-category = &apos;40&apos;.    s_obj-type = objtype-exception_class.   ENDIF.
  APPEND s_obj TO required_objects.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_SOURCE" EXPOSURE="2" STATE="1" EDITORDER="2 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Scan ABAP Code for object use"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP source code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA _code TYPE string.
  FIELD-SYMBOLS:
    &lt;f&gt; LIKE LINE OF code.
  LOOP AT code ASSIGNING &lt;f&gt;.   CONCATENATE _code &lt;f&gt; line_separator INTO _code.    ENDLOOP.
  add_method_source( _code ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_SOURCE_TO_LIST" STATE="1" EDITORDER="1 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add object use in ABAP Code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP source code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SOURCE" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Source of the code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_objs      TYPE td_sourcecode.
  DATA _key        TYPE td_name.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objs.

  t_objs = analyse_method_source( code ).
  LOOP AT t_objs ASSIGNING &lt;o&gt;.
    _key = &lt;o&gt;.   add_object_to_list( name = _key   source = source ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_TYPES" EXPOSURE="1" STATE="1" EDITORDER="10 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add types"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="TYPES" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;TT_TYPES"/>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
DATA _name TYPE string.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF types.

  LOOP AT types ASSIGNING &lt;t&gt;.
    CONCATENATE &apos;Type=&gt;&apos; &lt;t&gt;-cmpname INTO _name.    &quot;#EC NOTEXT
    stack( _name ).
    CALL METHOD process_type( type = &lt;t&gt;-typtype
                              name = &lt;t&gt;-type
                            SOURCE = &lt;t&gt;-_ ).
    unstack( ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ADD_WITHOUT_REQUIREMENTS" EXPOSURE="2" STATE="1" EDITORDER="6 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Generate ABAP Source Code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="3" TYPTYPE="1" TYPE="ABAP_BOOL">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="has changed"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS &lt;c&gt; LIKE LINE OF remain_classes.

* intf/class without any dependances
  LOOP AT remain_classes ASSIGNING &lt;c&gt;.
    READ TABLE requirements TRANSPORTING NO FIELDS
         WITH KEY ori_name = &lt;c&gt;-name.
    IF sy-subrc &lt;&gt; 0.   clear s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    result = abap_true.   DELETE remain_classes.    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ANALYSE_METHOD_SOURCE" EXPOSURE="1" STATE="1" EDITORDER="11 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Scan ABAP Code for object use"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP source code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECTS_LIST" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA static_objs TYPE td_sourcecode.
  DATA _code       TYPE string.

  CHECK NOT code IS INITIAL.
  _code = convert_line( code ).

  objects_list = extract_strings(
      forward     = &apos;X&apos;
      search_term = &apos;TYPE REF TO &apos;
      code        = _code
      ).

  static_objs = extract_strings(
*      forward     =
      search_term = &apos;=&gt;&apos;
      code        = _code
      ).

  APPEND LINES OF static_objs TO objects_list.
  SORT objects_list.
  DELETE ADJACENT DUPLICATES FROM objects_list.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="APPEND_MESSAGE" EXPOSURE="1" STATE="1" EDITORDER="12 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add message"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="DATA" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_MESSAGE"/>
    </PARAMETERS>
    <SOURCE>`
  DATA s_msg LIKE LINE OF messages.
  check not data is INITIAL.
  s_msg-name = data.    APPEND s_msg TO messages.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="APPEND_TYPEGROUPS" EXPOSURE="1" STATE="1" EDITORDER="13 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add type groups"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="TYPEGROUPS" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;TT_TYPEGROUPS"/>
    </PARAMETERS>
    <SOURCE>`
  DATA _tg LIKE LINE OF me-&gt;typegroups.
  FIELD-SYMBOLS &lt;t&gt; LIKE LINE OF typegroups.
  LOOP AT typegroups ASSIGNING &lt;t&gt;.
    _tg-name = &lt;t&gt;-typegroup.
    APPEND _tg TO me-&gt;typegroups.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CLASS_CONSTRUCTOR" EXPOSURE="2" STATE="1" EDITORDER="3 " MTDTYPE="2" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="CLASS_CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>`
  DATA _softcomp LIKE LINE OF softcomponents.

  _softcomp-sign = &apos;I&apos;. _softcomp-option = &apos;EQ&apos;.
  _softcomp-low = space. APPEND _softcomp TO softcomponents.
  _softcomp-low = &apos;HOME&apos;. APPEND _softcomp TO softcomponents.
  _softcomp-low = &apos;LOCAL&apos;. APPEND _softcomp TO softcomponents.

  CREATE OBJECT o_object.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CLEAN_CODE" EXPOSURE="2" STATE="1" EDITORDER="4 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Clean ABAP Source Code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
*  DATA d_line LIKE LINE OF code.
  result = code.
  DELETE result WHERE table_line IS INITIAL. &quot; DELETE result WHERE table_line = space.
*  LOOP AT code INTO d_line.
*    CONDENSE d_line.
*    IF d_line IS INITIAL. DELETE code. ENDIF.
*  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONVERT_LINE" EXPOSURE="1" STATE="1" EDITORDER="14 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Convert code line : remove tabs"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="SOURCE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TARGET" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  target = zaplink_tools=&gt;conv_abap_line( source ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONVERT_SOURCE" EXPOSURE="1" STATE="1" EDITORDER="15 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Convert source code : remove tabs"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="SOURCECODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TARGETCODE" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF targetcode.
  targetcode = sourcecode.
  LOOP AT targetcode ASSIGNING &lt;l&gt;.
    IF &lt;l&gt; IS INITIAL. DELETE targetcode. CONTINUE. ENDIF.  &quot; Condense
    IF &lt;l&gt;(1) = &apos;*&apos;.   DELETE targetcode. CONTINUE. ENDIF.  &quot; Condense
    &lt;l&gt; = convert_line( &lt;l&gt; ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONVERT_SOURCE_UPCASE" EXPOSURE="1" STATE="1" EDITORDER="16 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Convert source code to upcase"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="SOURCECODE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TARGETCODE" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF targetcode.
  targetcode = sourcecode.
  LOOP AT targetcode ASSIGNING &lt;l&gt;.
    TRANSLATE &lt;l&gt; TO UPPER CASE.  &quot;#EC SYNTCHAR
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="DO_CLASS" STATE="1" EDITORDER="2 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add class dependenties"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Failed to add"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _codes      LIKE LINE OF classes.

  TRY.
      _codes = get_source( name ).
    CATCH cx_root.
      RAISE failed.
  ENDTRY.

  search_for_include( CHANGING codes = _codes ).

  INSERT _codes INTO TABLE classes.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="DO_OBJECT_LIST" STATE="1" EDITORDER="3 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add required object stored in the list"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CONSTANTS c_intftype TYPE td_classtype VALUE &apos;9&apos;.
  DATA t_objects TYPE tt_req_objects.
  DATA s_object  LIKE LINE OF required_objects.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objects.

  SORT required_objects BY name full_def DESCENDING.   DELETE ADJACENT DUPLICATES FROM required_objects COMPARING name.
  s_object-type = c_intftype.    MODIFY required_objects FROM s_object TRANSPORTING type WHERE type = objtype-interface.   SORT required_objects BY full_def DESCENDING type DESCENDING name.
  t_objects = required_objects.    CLEAR required_objects.   &quot; memorize object list for recursive calls
  LOOP AT t_objects ASSIGNING &lt;o&gt;.
    stack( context = &lt;o&gt;-source ).    &lt;o&gt;-ori_name = name.    APPEND &lt;o&gt; TO requirements.
    IF &lt;o&gt;-type = c_intftype.   add_interface_dep( name = &lt;o&gt;-name  full = &lt;o&gt;-full_def ).    ELSE.   add_class_dep( name = &lt;o&gt;-name  full = &lt;o&gt;-full_def ).    ENDIF.
    unstack( ).
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXTRACT_STRINGS" EXPOSURE="1" STATE="1" EDITORDER="17 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Extract strings from source code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODE" CMPTYPE="1" EDITORDER="3 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP source code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FORWARD" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="FLAG" PAROPTIONL="X" PARPREFERD="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="String is forward search term ?"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULTS" CMPTYPE="1" EDITORDER="4 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Results"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SEARCH_TERM" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Search term"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CONSTANTS:
    c_crlf TYPE string VALUE line_separator,
    c_commentedline TYPE string VALUE &apos;*&apos;,
    c_commentscheme TYPE string VALUE &apos;*&quot;*&apos;,
    c_commentchar TYPE string VALUE &apos;&quot;&apos;.

  DATA _objects    TYPE STANDARD TABLE OF string WITH DEFAULT KEY.
  DATA _max        TYPE sy-tabix.
  DATA _pos        TYPE sy-tabix.
  DATA _idx        TYPE sy-tabix.
  DATA _lines      TYPE STANDARD TABLE OF string WITH DEFAULT KEY.
  DATA _line       TYPE string.
  DATA _tmp        TYPE string.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF _objects,
    &lt;l2&gt; LIKE LINE OF _objects.

  DEFINE mac_split.
    split _line at &amp;1 into table _lines. &quot; split line into words
    check not _lines is initial.
    read table _lines into _line index 1.
  END-OF-DEFINITION.

  CHECK search_term &lt;&gt; c_crlf.

  IF forward IS INITIAL.
    SPLIT code AT search_term INTO TABLE _objects.
    CHECK NOT _objects IS INITIAL.
    _pos = LINES( _objects ).
    DELETE _objects INDEX _pos.  &quot; remove last line (unwanted) because backward search
* Table _ojects contains at the end of each line the searched string
    LOOP AT _objects ASSIGNING &lt;l&gt;.
      SPLIT &lt;l&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
* Table _lines contains all lines, searched string is in the last line at the end
      WHILE NOT _lines IS INITIAL.
        _pos = LINES( _lines ).
        READ TABLE _lines INTO _line INDEX _pos.
        _tmp = _line.
        CONDENSE _tmp NO-GAPS.
        IF NOT _tmp IS INITIAL.
          EXIT.
        ENDIF.
        DELETE _lines INDEX _pos.  &quot; empty line
      ENDWHILE.
* _Line contains the code line with searched string at the end
      CHECK _line(1) &lt;&gt; c_commentedline.      &quot; code line is a comment
      CHECK NOT _line CP c_commentscheme.     &quot; Check line for line comment
      SPLIT _line AT space INTO TABLE _lines. &quot; split line into words
      _pos = LINES( _lines ).
      READ TABLE _lines INTO _line INDEX _pos.
      APPEND _line TO results.
    ENDLOOP.
  ELSE.
*  X TYPE REF TO
*     YYYY.
*  X TYPE REF TO
*  * Old type
*     YYYY.
*  X
*  TYPE REF TO
*  * Old type
*     YYYY.
*  X TYPE REF TO Z
*  *X tYPE REF TO K
*  *X tYPE REF TO
*     &quot; X TYPE REF TO K
*     &quot; X TYPE REF TO K
    SPLIT code AT search_term INTO TABLE _objects.
    CHECK NOT _objects IS INITIAL.
* Table _ojects contains at the begining of each line the searched string
    _max = LINES( _objects ) - 1.
    LOOP AT _objects ASSIGNING &lt;l&gt; TO _max.
* &lt;l&gt; is the text before the recherched text to check for comment
      _idx = sy-tabix.
      SPLIT &lt;l&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
* Table _lines contains all lines, searched string is in the last line at the end
      _pos = LINES( _lines ).
      READ TABLE _lines INTO _line INDEX _pos.
      IF NOT _line IS INITIAL.
* process line where search_term was found. Check that line is valid
        CHECK _line(1) &lt;&gt; c_commentedline.        &quot; code line is a comment =&gt; ignore
        CHECK NOT _line CP c_commentscheme.       &quot; Check line for line comment
      ENDIF.
* Line is not a commented line
      ADD 1 TO _idx.
      READ TABLE _objects ASSIGNING &lt;l2&gt; INDEX _idx.
* NOW &lt;l2&gt; is the text just after the recherched text =&gt; so the text to be extracted
      SPLIT &lt;l2&gt; AT c_crlf INTO TABLE _lines. &quot; split string into lines
* remove blank and commented lines
      DELETE _lines WHERE table_line IS INITIAL.
      LOOP AT _lines ASSIGNING &lt;l2&gt;.
        IF &lt;l2&gt;(1) = c_commentedline.
          DELETE _lines.
        ENDIF.
      ENDLOOP.
* Searche for the &quot;good&quot; line
      LOOP AT _lines INTO _line.
        CLEAR _pos.
        FIND FIRST OCCURRENCE OF c_commentchar IN _line MATCH OFFSET _pos.
        IF NOT _pos IS INITIAL.
          _line = _line(_pos).      &quot; remove comment
        ENDIF.
        _tmp = _line.
        CONDENSE _tmp NO-GAPS.
        IF NOT _tmp IS INITIAL.
          EXIT.
        ENDIF.
      ENDLOOP.
* _Line contains the code line with searched string at the end
      CONDENSE _line.
      CHECK NOT _line IS INITIAL.
      mac_split space. mac_split &apos;,&apos;. mac_split &apos;.&apos;.
      APPEND _line TO results.
    ENDLOOP.

  ENDIF.

  SORT results.
  DELETE ADJACENT DUPLICATES FROM results.
  DELETE results WHERE table_line IS INITIAL.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_CLASS_SOURCE" EXPOSURE="1" STATE="1" EDITORDER="18 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get Class source codes"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODES" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TS_SOURCE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  DATA o_source    TYPE REF TO cl_oo_source.
  DATA _clskey     TYPE seoclskey.
  DATA _pos        TYPE sy-tabix.
  DATA t_code      TYPE td_sourcecode.
  DATA t_upcode    TYPE td_sourcecode.
  DATA t_lines     TYPE td_sourcecode.
  DATA _line       LIKE LINE OF t_upcode.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_upcode.

  _clskey = name.

  CREATE OBJECT o_source
    EXPORTING
      clskey             = _clskey
    EXCEPTIONS
      class_not_existing = 1
      OTHERS             = 2.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  t_code = convert_source( o_source-&gt;source ).
  t_upcode = convert_source_upcase( t_code ).
  CLEAR o_source.

*Remove text before CLASS Zxxx DEFINITION
  CONCATENATE &apos;CLASS&apos; _clskey &apos;DEFINITION&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc = 0.
    _pos = sy-tabix.
    APPEND LINES OF t_code FROM _pos TO t_lines.
*class ZAPLINK_MESSAGE_COLLECTOR definition
*  public
*  create public .
    SUBTRACT 1 FROM _pos.
    IF _pos &gt;= 1. DELETE t_upcode TO _pos. ENDIF.
    READ TABLE t_upcode INDEX 2 INTO _line.
    CONDENSE _line NO-GAPS.
    IF _line = &apos;PUBLIC&apos;.
      DELETE t_lines INDEX 2.
      DELETE t_upcode INDEX 2.
    ENDIF.
  ELSE.
* anormal case
    t_lines = t_code.
  ENDIF.

* Get implementation
* class XXXXX implementation.
  CONCATENATE &apos;CLASS&apos; _clskey &apos;IMPLEMENTATION.&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc = 0.
* Class
    _pos = sy-tabix.
    APPEND LINES OF t_lines  FROM _pos TO codes-impl.
    DELETE t_lines FROM _pos.
    DELETE t_upcode FROM _pos.
* endclass. &quot;ZAPLINK_MESSAGE_COLLECTOR definition
    CONCATENATE &apos;ENDCLASS. &quot;&apos; _clskey &apos; DEFINITION&apos; INTO _line.
    READ TABLE t_upcode TRANSPORTING NO FIELDS
         FROM _line.
    IF sy-subrc &lt;&gt; 0.
      RAISE failed.
    ENDIF.
    _pos = sy-tabix.
    APPEND LINES OF t_lines TO _pos TO codes-def.
    DELETE t_lines TO _pos.
    DELETE t_upcode to _pos.
    codes-macro = t_lines.
  ELSE.
* normal case for interfaces
    codes-def = t_lines.
  ENDIF.

* CONVERT GLOBAL FRIENDS =&gt; FRIENDS
  t_upcode = convert_source_upcase( codes-def ).
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*GLOBAL FRIENDS*&apos;.
    REPLACE FIRST OCCURRENCE OF &apos;GLOBAL FRIENDS&apos; IN &lt;l&gt; WITH &apos;FRIENDS&apos;.
    modify codes-def from &lt;l&gt; index sy-tabix.
  ENDLOOP.

  remove_def_load( CHANGING codes = codes ).

  codes-name = name.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INTERFACE_SOURCE" EXPOSURE="1" STATE="1" EDITORDER="19 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get interface source codes"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODES" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TS_SOURCE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key    TYPE seoclsname.
  DATA _prog   TYPE program.
  DATA _line   LIKE LINE OF codes-def.
  DATA _pos        TYPE sy-tabix.
  DATA t_upcode    TYPE td_sourcecode.

  _key = name.
  _prog = cl_oo_classname_service=&gt;get_intfsec_name( _key ).

  READ REPORT _prog INTO codes-def.
  codes-def = convert_source( codes-def ).
  t_upcode = convert_source_upcase( codes-def ).

*Remove text public after : interface xxxx
  CONCATENATE &apos;INTERFACE&apos; _key INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS
       FROM _line.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
  _pos = sy-tabix.
  CONCATENATE _line &apos;.&apos; INTO _line.
  MODIFY codes-def FROM _line INDEX _pos.
  ADD 1 TO _pos.
  READ TABLE t_upcode INTO _line INDEX _pos.
  CONDENSE _line NO-GAPS.
  IF _line = &apos;PUBLIC.&apos;.
    DELETE codes-def INDEX _pos.
  ENDIF.

  remove_def_load( CHANGING codes = codes ).

  codes-name = name.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_SOURCE" EXPOSURE="2" STATE="1" EDITORDER="8 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get class/interface source codes"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODES" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TS_SOURCE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key   TYPE seoclskey.
  DATA o_type TYPE seoclstype.
  DATA _class      TYPE vseoclass.

  _key-clsname = name.
  CALL FUNCTION &apos;SEO_CLIF_GET&apos;
    EXPORTING
      cifkey             = _key
*     VERSION            = SEOC_VERSION_INACTIVE
*     STATE              = &apos;0&apos;
    IMPORTING
      clstype            = o_type
      class              = _class
*     INTERFACE          =
    EXCEPTIONS
      not_existing       = 1
      deleted            = 2
      model_only         = 0
      OTHERS             = 4.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.

  IF o_type &lt;&gt; objtype-class AND o_type &lt;&gt; objtype-interface.
    RAISE failed.
  ENDIF.

  IF o_type = objtype-class.
    IF _class-category = &apos;40&apos;.    o_type = objtype-exception_class.   ENDIF.
    codes = get_class_source( name ).
  ELSE.
    codes = get_interface_source( name ).
  ENDIF.
  codes-type = o_type.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="HANDLE_CONTEXT" EXPOSURE="1" STATE="1" EDITORDER="20 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Handle circular context"/>
    </TEXTS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E" EDITORDER="1 "/>
    </EXCEPTIONS>
    <SOURCE>`
  TYPES:
    BEGIN OF ts_object,
      name  TYPE td_name,
      type  TYPE seoclstype,
      rank  TYPE i,
      tabix TYPE sy-tabix,
      full  TYPE abap_bool,
    END OF ts_object.
  DATA t_objects TYPE STANDARD TABLE OF ts_object WITH DEFAULT KEY.
  DATA s_object  LIKE LINE OF t_objects.
  DATA s_key     TYPE seoclskey.
  DATA d_type    TYPE seoclstype.
  DATA s_class   TYPE vseoclass.
  DATA s_order   LIKE LINE OF order.
  DATA d_tabix   TYPE sy-tabix.
  DATA s_ctx     LIKE LINE OF circular_context.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF t_objects,
    &lt;c&gt; LIKE LINE OF circular_context.

  DELETE circular_context WHERE type IS INITIAL.
  LOOP AT circular_context ASSIGNING &lt;c&gt;.
*    CLEAR s_object.   s_object-tabix = sy-tabix.
*    s_key-clsname = &lt;c&gt;-context.    CHECK s_key-clsname = &lt;c&gt;-context.    &quot; field might be too long
*    CALL FUNCTION &apos;SEO_CLIF_GET&apos;
*      EXPORTING
*        cifkey             = s_key
**     VERSION            = SEOC_VERSION_INACTIVE
**     STATE              = &apos;0&apos;
*      IMPORTING
*        clstype            = d_type
*        class              = s_class
**     INTERFACE          =
*      EXCEPTIONS
*        not_existing       = 1
*        deleted            = 2
*        model_only         = 0
*        OTHERS             = 4.
*    IF sy-subrc &lt;&gt; 0.   CONTINUE.   ENDIF.
*    s_object-name = s_key-clsname.    s_object-type = d_type.
*    IF d_type = objtype-interface.    s_object-rank = 1.    ELSEIF s_class-category = &apos;40&apos;.   s_object-rank = 2.  s_object-type = objtype-exception_class.    ELSE.   s_object-rank = 3.    ENDIF.
    CLEAR s_object.   s_object-tabix = sy-tabix.    s_object-name = &lt;c&gt;-context.    s_object-type = &lt;c&gt;-type.   s_object-full = &lt;c&gt;-full_def.
    IF s_object-type = objtype-interface.    s_object-rank = 1.    ELSEIF s_object-type = objtype-exception_class.   s_object-rank = 2.  s_object-type = objtype-exception_class.    ELSE.   s_object-rank = 3.    ENDIF.
    IF s_object-full IS INITIAL.
      ADD 5 TO s_object-rank.
    ENDIF.
    APPEND s_object TO t_objects.
  ENDLOOP.

  SORT t_objects BY name tabix.   DELETE ADJACENT DUPLICATES FROM t_objects COMPARING name.
  IF LINES( t_objects ) = 1.    DELETE t_objects WHERE name = current_comp.   ENDIF.
  CHECK NOT t_objects IS INITIAL.   SORT t_objects BY rank tabix.   d_tabix = LINES( order ) + 1.   REFRESH circular_context.
  LOOP AT t_objects ASSIGNING &lt;o&gt;.    CLEAR s_ctx.    s_ctx-context = &lt;o&gt;-name.   s_ctx-type = &lt;o&gt;-type.    s_ctx-full_def = &lt;o&gt;-full.    APPEND s_ctx TO circular_context.   ENDLOOP.
  LOOP AT me-&gt;context ASSIGNING &lt;c&gt; WHERE NOT type IS INITIAL.
    READ TABLE t_objects TRANSPORTING NO FIELDS WITH KEY name = &lt;c&gt;-context.
    IF sy-subrc &lt;&gt; 0.
      APPEND &lt;c&gt; TO circular_context.
    ENDIF.
  ENDLOOP.
  LOOP AT t_objects ASSIGNING &lt;o&gt;.
*    CLEAR s_object.   s_object-tabix = sy-tabix.
*    READ TABLE order TRANSPORTING NO FIELDS
*         WITH KEY name = &lt;o&gt;-name
*                  type = &lt;o&gt;-type
*               defered = abap_false.
*    IF sy-subrc = 0.    d_tabix = s_object-tabix.   ENDIF.    &quot; already processed : circular ref
    CALL METHOD do_class
      EXPORTING
        name   = &lt;o&gt;-name
      EXCEPTIONS
        failed = 1
        OTHERS = 2.
    IF sy-subrc &lt;&gt; 0.   RAISE failed.   ENDIF.
    CLEAR s_order.  s_order-name = &lt;o&gt;-name.    s_order-type = &lt;o&gt;-type.
    insert_order( s_order = s_order   context = circular_context ).   DELETE circular_context WHERE context = &lt;o&gt;-name.   &quot; &lt;=&gt; should delete index 1.
*    insert s_order inTO order index d_tabix.
  ENDLOOP.
  CLEAR: circular_context, circular_ref_on.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="INSERT_ORDER" STATE="1" EDITORDER="4 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="insert order at the right position"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CONTEXT" CMPTYPE="1" EDITORDER="2 " TYPTYPE="1" TYPE="TT_CONTEXT">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Context Stack"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="S_ORDER" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TS_ORDER">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface, type and flag"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA d_tabix TYPE sy-tabix.
  FIELD-SYMBOLS:
    &lt;c&gt; LIKE LINE OF context.

  DELETE context WHERE type IS INITIAL.   DELETE context WHERE context = s_order-name.
  READ TABLE order TRANSPORTING NO FIELDS
       WITH KEY name = s_order-name
                type = s_order-type
             defered = abap_false.
  IF sy-subrc = 0.    EXIT.   ENDIF.    &quot; already processed : circular ref
  IF context IS INITIAL.    APPEND s_order TO me-&gt;order.    EXIT.   ENDIF.
  inverse_order( CHANGING order = context ).
  LOOP AT context ASSIGNING &lt;c&gt; WHERE full_def = abap_true.
    READ TABLE order TRANSPORTING NO FIELDS
         WITH KEY name = &lt;c&gt;-context
                  type = &lt;c&gt;-type
               defered = abap_false.
    IF sy-subrc = 0 AND d_tabix &gt; sy-tabix.
      d_tabix = sy-tabix.
    ENDIF.
  ENDLOOP.
  IF d_tabix IS INITIAL.
    d_tabix = LINES( order ) + 1.
    LOOP AT context ASSIGNING &lt;c&gt; WHERE full_def = abap_false.
      READ TABLE order TRANSPORTING NO FIELDS
           WITH KEY name = &lt;c&gt;-context
                    type = &lt;c&gt;-type
                 defered = abap_false.
      IF sy-subrc = 0 AND d_tabix &gt; sy-tabix.
        d_tabix = sy-tabix.
      ENDIF.
    ENDLOOP.
  ENDIF.
  INSERT s_order INTO me-&gt;order INDEX d_tabix.
  READ TABLE order TRANSPORTING NO FIELDS   &quot; for security
       WITH KEY name = s_order-name
                type = s_order-type
             defered = abap_false.
  IF sy-subrc &lt;&gt; 0.
    APPEND s_order TO me-&gt;order.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="INVERSE_ORDER" EXPOSURE="1" STATE="1" EDITORDER="27 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Inverse table order"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ORDER" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="STANDARD TABLE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface Order"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  zaplink_tools=&gt;inverse_table_order( CHANGING my_table = order ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="IS_EXCLUDED_CLASS" EXPOSURE="1" STATE="1" EDITORDER="2 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Is excluded class"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_NAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="3" TYPTYPE="1" TYPE="ABAP_BOOL">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class is excluded"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TYPE" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TADIR-OBJECT" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA s_excl_c    LIKE LINE OF excluded_classes.

  clear s_comp.   result = abap_true.   READ TABLE excluded_classes TRANSPORTING NO FIELDS WITH TABLE KEY name = name.    CHECK sy-subrc &lt;&gt; 0.
  IF NOT type IS INITIAL.   mac_read_tadir type name s_comp-devclass s_comp-softcomp.
  ELSE.   mac_read_tadir &apos;CLAS&apos; name s_comp-devclass s_comp-softcomp.
  IF sy-subrc &lt;&gt; 0. mac_read_tadir &apos;INTF&apos; name s_comp-devclass s_comp-softcomp.
  ENDIF. ENDIF.
* customer components
  IF s_comp-devclass IN packages AND s_comp-softcomp IN softcomponents.    result = abap_false.    ELSE.   s_excl_c-name = name.   INSERT s_excl_c INTO TABLE excluded_classes.    ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="PROCESS_TYPE" EXPOSURE="1" STATE="1" EDITORDER="21 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Process type."/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="RS38L_TYP">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Associated Type of an Interface Parameter"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SOURCE" CMPTYPE="1" EDITORDER="3 " PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Type definition"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TYPE" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOTYPTYPE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Typing"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA _key        TYPE td_name.
  DATA _obj        TYPE string.
  DATA _type       TYPE string.
  DATA _up_src     TYPE string.
  DATA ctx         LIKE LINE OF context.
  data full        type abap_bool.

  _up_src = source.   TRANSLATE _up_src TO UPPER CASE.

  READ TABLE context INTO ctx INDEX 1.
  CASE type.
    WHEN typetype-like OR typetype-type.
      SPLIT name AT &apos;=&gt;&apos; INTO _obj _type.
      CHECK _type &lt;&gt; &apos;&apos;.
      _key = _obj.  full = abap_true.
    WHEN typetype-otype.
      _key = name.
    WHEN typetype-ref.
      _key = name.
    WHEN typetype-code.
      add_source_to_list( code = _up_src   source = ctx-context ).
      CLEAR _key.   EXIT.
  ENDCASE.
  CHECK NOT _key IS INITIAL.
  add_object_to_list( name = _key   full = full   source = ctx-context ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="REMOVE_DEF_LOAD" EXPOSURE="1" STATE="1" EDITORDER="22 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Remove definition load"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODES" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_SOURCE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_upcode    TYPE td_sourcecode.
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF t_upcode,
    &lt;m&gt; LIKE LINE OF codes-def.

  t_upcode = convert_source_upcase( codes-def ).
* Comment CLASS xxx DEFINITION LOAD.
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*CLASS * DEFINITION LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*CLASS * DEFINITION LOAD*&apos;.
    READ TABLE codes-def ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.

* Comment INTERFACE xxx LOAD .
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*INTERFACE * LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*INTERFACE * LOAD*&apos;.
    READ TABLE codes-def ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.

  t_upcode = convert_source_upcase( codes-macro ).
* Comment CLASS xxx DEFINITION LOAD.
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*CLASS * DEFINITION LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*CLASS * DEFINITION LOAD*&apos;.
    READ TABLE codes-macro ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.

* Comment INTERFACE xxx LOAD .
  LOOP AT t_upcode ASSIGNING &lt;l&gt;
     WHERE table_line CP &apos;*INTERFACE * LOAD*&apos;.
    CHECK &lt;l&gt;(1) &lt;&gt; &apos;*&apos;.
    CHECK NOT &lt;l&gt; CP &apos;*&quot;*INTERFACE * LOAD*&apos;.
    READ TABLE codes-macro ASSIGNING &lt;m&gt; index sy-tabix.
    CONCATENATE &apos;*&apos; &lt;m&gt; INTO &lt;m&gt;.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RESOLVE" EXPOSURE="2" STATE="1" EDITORDER="7 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Generate ABAP Source Code"/>
    </TEXTS>
    <SOURCE>`
  DATA s_order   LIKE LINE OF new_order.
  FIELD-SYMBOLS:
    &lt;o&gt; LIKE LINE OF new_order,
    &lt;c&gt; LIKE LINE OF classes.

  _clean_up( ).
*  loop at classes ASSIGNING &lt;c&gt;.
  remain_classes = classes.
* intf/class without any dependances
  WHILE add_without_requirements( ) = abap_true.  ENDWHILE.
  WHILE add_defered_ok( ) = abap_true.  ENDWHILE.

  IF requirements IS INITIAL.
    LOOP AT remain_classes ASSIGNING &lt;c&gt;.   CLEAR s_order.    s_order-name = &lt;c&gt;-name.    s_order-type = &lt;c&gt;-type.    APPEND s_order TO new_order.    DELETE requirements WHERE name = &lt;c&gt;-name.    DELETE remain_classes.    ENDLOOP.
    order = new_order.
  ELSE.
    LOOP AT new_order ASSIGNING &lt;o&gt;.    WRITE:/ &lt;o&gt;-name.   ENDLOOP.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SEARCH_FOR_INCLUDE" EXPOSURE="1" STATE="1" EDITORDER="23 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Search include into source code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CODES" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_SOURCE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA t_includes TYPE td_sourcecode.
  DATA d_softcomp TYPE tdevc-dlvunit.
  DATA d_devclass TYPE tdevc-devclass.
  FIELD-SYMBOLS:
    &lt;i&gt; LIKE LINE OF t_includes,
    &lt;l&gt; LIKE LINE OF codes-macro.

  LOOP AT codes-macro ASSIGNING &lt;l&gt;.
    t_includes = extract_strings(
        forward     = abap_true
        search_term = &apos;INCLUDE &apos;
        code        = &lt;l&gt;
        ).

    IF NOT t_includes IS INITIAL.
      LOOP AT t_includes ASSIGNING &lt;i&gt;.
        SELECT SINGLE devclass dlvunit INTO (d_devclass, d_softcomp)
          FROM v_tralan
          WHERE pgmid = &apos;R3TR&apos;
            AND object = &apos;PROG&apos;
            AND obj_name = &lt;i&gt;.

        CHECK d_devclass IN packages.
        CHECK d_softcomp IN softcomponents. &quot; customer components

        APPEND &lt;i&gt; TO includes.
      ENDLOOP.
      DELETE codes-macro.
    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SOURCE_2_STRING" EXPOSURE="2" STATE="1" EDITORDER="9 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Convert source code : remove tabs"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="DATA" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="STRING">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code as string"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS:
    &lt;l&gt; LIKE LINE OF data.
  LOOP AT data ASSIGNING &lt;l&gt;.
    IF result IS INITIAL.
      result = &lt;l&gt;.
    ELSE.
      CONCATENATE result line_separator &lt;l&gt; INTO result.
    ENDIF.
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="STACK" EXPOSURE="1" STATE="1" EDITORDER="24 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add context to context stack"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CONTEXT" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="ANY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Name to stack"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FULL" CMPTYPE="1" EDITORDER="3 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_FALSE" PAROPTIONL="X"/>
     <ITEM SCONAME="TYPE" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CLASSTYPE" PAROPTIONL="X"/>
    </PARAMETERS>
    <SOURCE>`
  DATA s_ctx LIKE LINE OF context.
  s_ctx-context = context.   s_ctx-type = type.    s_ctx-full_def = full.   INSERT s_ctx INTO me-&gt;context INDEX 1.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="UNSTACK" EXPOSURE="1" STATE="1" EDITORDER="25 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Remove stack entry"/>
    </TEXTS>
    <SOURCE>`
  IF NOT context IS INITIAL. DELETE context INDEX 1. ENDIF.
  IF context IS INITIAL. CLEAR: circular_ref_on, circular_context. ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_CLEAN_UP" EXPOSURE="1" STATE="1" EDITORDER="26 ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Clean up data"/>
    </TEXTS>
    <SOURCE>`
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF requirements,
    &lt;c&gt; LIKE LINE OF classes,
    &lt;i&gt; LIKE LINE OF includes,
    &lt;t&gt; LIKE LINE OF typegroups,
    &lt;m&gt; LIKE LINE OF messages.

  SORT requirements BY ori_name name full_def.    DELETE ADJACENT DUPLICATES FROM requirements COMPARING ori_name name full_def.
  LOOP AT requirements ASSIGNING &lt;r&gt;.   CHECK &lt;r&gt;-ori_name = &lt;r&gt;-name.    DELETE requirements.    ENDLOOP.
  inverse_order( CHANGING order = order ).     DELETE ADJACENT DUPLICATES FROM order COMPARING type name.   inverse_order( CHANGING order = order ).
  SORT typegroups.    DELETE ADJACENT DUPLICATES FROM typegroups.
  SORT includes.      DELETE ADJACENT DUPLICATES FROM includes.
  SORT messages.      DELETE ADJACENT DUPLICATES FROM messages.

* Update all components list
  REFRESH all_components.
  LOOP AT classes ASSIGNING &lt;c&gt;.    CLEAR s_comp.   if &lt;c&gt;-type = 0. s_comp-type = &apos;CLAS&apos;.  else.   s_comp-type = &apos;INTF&apos;.   ENDIF.   s_comp-name = &lt;c&gt;-name.   mac_add_comp.    ENDLOOP.
  LOOP AT typegroups ASSIGNING &lt;t&gt;.    CLEAR s_comp.   s_comp-type = &apos;TYPE&apos;.   s_comp-name = &lt;t&gt;-name.   mac_add_comp.    ENDLOOP.
  LOOP AT includes ASSIGNING &lt;i&gt;.    CLEAR s_comp.   s_comp-type = &apos;PROG&apos;.   s_comp-name = &lt;i&gt;.   mac_add_comp.    ENDLOOP.
  LOOP AT messages ASSIGNING &lt;m&gt;.    CLEAR s_comp.   s_comp-type = &apos;MSAG&apos;.   s_comp-name = &lt;m&gt;-name.   mac_add_comp.    ENDLOOP.</SOURCE>
   </ITEM>
  </METHODS>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="ABAP" EXPLICIT="X" IMPLICIT="X"/>
   <ITEM TYPEGROUP="SEOP" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TD_CLASSTYPE" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="1" TYPE="CHAR01">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class type (SEOCLSTYPE)"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TD_MESSAGE" EXPOSURE="2" STATE="1" EDITORDER="20 " TYPTYPE="1" TYPE="SEOCLASSDF-MSG_ID"/>
   <ITEM CMPNAME="TD_NAME" EXPOSURE="2" STATE="1" EDITORDER="4 " TYPTYPE="1" TYPE="SEOCLSNAME">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TD_SOURCECODE" EXPOSURE="2" STATE="1" EDITORDER="5 " TYPTYPE="1" TYPE="SEOP_SOURCE_STRING">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_CLASS" EXPOSURE="1" STATE="1" EDITORDER="2 " TYPTYPE="3" TYPE="ZAPLINK_CLAS_DATA">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Data for Class"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_INTERFACE" EXPOSURE="1" STATE="1" EDITORDER="4 " TYPTYPE="3" TYPE="ZAPLINK_INTF_DATA">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Data for ABAP Object Interface"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_OBJECT" EXPOSURE="1" STATE="1" EDITORDER="3 " TYPTYPE="3" TYPE="ZAPLINK_OBJECT">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPLink Class &amp; Interface connector"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TR_DLVUNIT" EXPOSURE="2" STATE="1" EDITORDER="3 " TYPTYPE="4">
    tr_dlvunit TYPE RANGE OF tdevc-dlvunit
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Software component accepted"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TR_PACKAGES" EXPOSURE="2" STATE="1" EDITORDER="2 " TYPTYPE="4">
    tr_packages TYPE RANGE OF tdevc-devclass
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Range of package"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_COMP" EXPOSURE="2" STATE="1" EDITORDER="18 " TYPTYPE="4">BEGIN OF ts_comp.
    INCLUDE TYPE ts_compkey AS hdr.
    TYPES:
        devclass TYPE td_devclass,
        softcomp TYPE td_softcomp,
      END OF ts_comp
`</ITEM>
   <ITEM CMPNAME="TS_CONTEXT" EXPOSURE="2" STATE="1" EDITORDER="13 " TYPTYPE="4">BEGIN OF ts_context,
          context   TYPE string,
          type      TYPE td_classtype,    &quot; 0 Class 1 interface
          full_def  TYPE flag,          &quot; Full definition required
        END OF ts_context
`</ITEM>
   <ITEM CMPNAME="TS_LIST" EXPOSURE="2" STATE="1" EDITORDER="8 " TYPTYPE="4">
    BEGIN OF ts_list,
        name      TYPE td_name,
      END OF ts_list
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface name"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_MESSAGE" EXPOSURE="2" STATE="1" EDITORDER="21 " TYPTYPE="4">BEGIN OF ts_message,
              name TYPE td_message,
            END OF ts_message
`</ITEM>
   <ITEM CMPNAME="TS_ORDER" EXPOSURE="2" STATE="1" EDITORDER="11 " TYPTYPE="4">
    BEGIN OF ts_order.
    INCLUDE TYPE ts_list.
    TYPES:
      type    TYPE td_classtype,    &quot; 0 Class 1 interface
      defered TYPE flag,          &quot; &apos;X&apos; if defered load required
    END OF ts_order
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface, type and flag"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_REQ_OBJECT" EXPOSURE="2" STATE="1" EDITORDER="9 " TYPTYPE="4">BEGIN OF ts_req_object,
        ori_name  TYPE td_name,
        name      TYPE td_name,
        type      TYPE td_classtype,    &quot; 0 Class 1 interface
        full_def  TYPE flag,          &quot; Full definition required
        source    TYPE string,
      END OF ts_req_object
`</ITEM>
   <ITEM CMPNAME="TS_SOURCE" EXPOSURE="2" STATE="1" EDITORDER="6 " TYPTYPE="4">
    BEGIN OF ts_source,
        name  TYPE td_name,
        type  TYPE td_classtype,    &quot; 0 Class 1 interface
        def   TYPE td_sourcecode,
        macro TYPE td_sourcecode,
        impl  TYPE td_sourcecode,
      END OF ts_source
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface sources codes"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_TYPEGROUP" EXPOSURE="2" STATE="1" EDITORDER="16 " TYPTYPE="4">
    BEGIN OF ts_typegroup,
              name TYPE seotpuname,
            END OF ts_typegroup
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="a Type Group"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_CLASSLIST" EXPOSURE="1" STATE="1" EDITORDER="1 " TYPTYPE="4">
    tt_classlist TYPE SORTED TABLE OF ts_list WITH UNIQUE KEY name
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Indexed list of class"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_COMPS" EXPOSURE="2" STATE="1" EDITORDER="19 " TYPTYPE="4">tt_comps type SORTED TABLE OF ts_comp with UNIQUE KEY type name
`</ITEM>
   <ITEM CMPNAME="TT_CONTEXT" EXPOSURE="2" STATE="1" EDITORDER="14 " TYPTYPE="4">
    tt_context TYPE STANDARD TABLE OF ts_context WITH DEFAULT KEY
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Context Stack"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_LIST" EXPOSURE="2" STATE="1" EDITORDER="12 " TYPTYPE="4">
    tt_list TYPE STANDARD TABLE OF ts_order WITH DEFAULT KEY
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface list"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_MESSAGE_IDS" EXPOSURE="2" STATE="1" EDITORDER="22 " TYPTYPE="4">tt_message_ids TYPE STANDARD TABLE OF ts_message WITH DEFAULT KEY
`</ITEM>
   <ITEM CMPNAME="TT_ORDER" EXPOSURE="2" STATE="1" EDITORDER="15 " TYPTYPE="4">
    tt_order TYPE STANDARD TABLE OF ts_order WITH NON-UNIQUE KEY name
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class/interface Order"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_REQ_OBJECTS" EXPOSURE="2" STATE="1" EDITORDER="10 " TYPTYPE="4">tt_req_objects TYPE STANDARD TABLE OF ts_req_object WITH NON-UNIQUE KEY name
`</ITEM>
   <ITEM CMPNAME="TT_SOURCES" EXPOSURE="2" STATE="1" EDITORDER="7 " TYPTYPE="4">
    tt_sources TYPE SORTED TABLE OF ts_source WITH UNIQUE KEY name
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Classes/interfaces codes"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_TYPEGROUPS" EXPOSURE="2" STATE="1" EDITORDER="17 " TYPTYPE="4">
    tt_typegroups TYPE STANDARD TABLE OF ts_typegroup WITH DEFAULT KEY
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Table of type group"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
