<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="3D3CE466AE22B555E32BBF68A8F2EAA9" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_GUI" TYPE="CLAS" VERSION="1.0">
 <DIRECTORY DEVCLASS="ZAPLINK-FRAMEWORK-CORE" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" UUID="05F9034B756EB95AE1000000AC120173" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X" MSG_ID="ZAPLINK_GUI">
   <TEXTS>
    <ITEM LANGU="E" DESCRIPT="ZapLink Kernel"/>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="BALLOG_OBJECT" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="BALLOG_OBJECT"/>
   <ITEM CMPNAME="COMP_NODENAME" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="COMP_NODENAME"/>
   <ITEM CMPNAME="EXISTS" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="EXISTS"/>
   <ITEM CMPNAME="EXT_SEP" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="EXT_SEP"/>
   <ITEM CMPNAME="FILE_EXT" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="FILE_EXT"/>
   <ITEM CMPNAME="LINE_SEPARATOR" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="LINE_SEPARATOR"/>
   <ITEM CMPNAME="TD_ABAPSOURCE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_ABAPSOURCE"/>
   <ITEM CMPNAME="TD_CHECKSUM" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CHECKSUM"/>
   <ITEM CMPNAME="TD_CLASSNAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CLASSNAME"/>
   <ITEM CMPNAME="TD_COMPEXISTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPEXISTS"/>
   <ITEM CMPNAME="TD_COMPNAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPNAME"/>
   <ITEM CMPNAME="TD_COMPTEXT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPTEXT"/>
   <ITEM CMPNAME="TD_COMPTYPE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPTYPE"/>
   <ITEM CMPNAME="TD_CONNCLASS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONNCLASS"/>
   <ITEM CMPNAME="TD_CONNEXISTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONNEXISTS"/>
   <ITEM CMPNAME="TD_CONNUUID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONNUUID"/>
   <ITEM CMPNAME="TD_CONNVER" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONNVER"/>
   <ITEM CMPNAME="TD_CONTNAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONTNAME"/>
   <ITEM CMPNAME="TD_CONTVER" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_CONTVER"/>
   <ITEM CMPNAME="TD_DEVCLASS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DEVCLASS"/>
   <ITEM CMPNAME="TD_DOC_ID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DOC_ID"/>
   <ITEM CMPNAME="TD_EXISTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_EXISTS"/>
   <ITEM CMPNAME="TD_FILENAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_FILENAME"/>
   <ITEM CMPNAME="TD_FILETYPE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_FILETYPE"/>
   <ITEM CMPNAME="TD_LANG" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_LANG"/>
   <ITEM CMPNAME="TD_LIGHT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_LIGHT"/>
   <ITEM CMPNAME="TD_OBJ_TYPE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_OBJ_TYPE"/>
   <ITEM CMPNAME="TD_ORDERKIND" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_ORDERKIND"/>
   <ITEM CMPNAME="TD_PROGNAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_PROGNAME"/>
   <ITEM CMPNAME="TD_SEL_ACTION" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_SEL_ACTION"/>
   <ITEM CMPNAME="TD_SUBSTITUTIONKIND" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_SUBSTITUTIONKIND"/>
   <ITEM CMPNAME="TD_TRANSPORT_REQUEST" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TRANSPORT_REQUEST"/>
   <ITEM CMPNAME="TD_TXTP_ID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TXTP_ID"/>
   <ITEM CMPNAME="TD_TXTP_KIND" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TXTP_KIND"/>
   <ITEM CMPNAME="TD_TXTP_LEN" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TXTP_LEN"/>
   <ITEM CMPNAME="TD_TXTP_TEXT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TXTP_TEXT"/>
   <ITEM CMPNAME="TD_TYPEORDER" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TYPEORDER"/>
   <ITEM CMPNAME="TD_TYPE_AS_TEXT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TYPE_AS_TEXT"/>
   <ITEM CMPNAME="TD_WITH_SUBCOMP" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_WITH_SUBCOMP"/>
   <ITEM CMPNAME="TEXTPOOL_KINDS" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TEXTPOOL_KINDS"/>
   <ITEM CMPNAME="TO_COMPONENT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_COMPONENT"/>
   <ITEM CMPNAME="TO_CONTAINER" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_CONTAINER"/>
   <ITEM CMPNAME="TO_FILE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_FILE"/>
   <ITEM CMPNAME="TO_GUI" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_GUI"/>
   <ITEM CMPNAME="TO_LIST" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_LIST"/>
   <ITEM CMPNAME="TO_MSG_COLL" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_MSG_COLL"/>
   <ITEM CMPNAME="TO_OPTIONS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_OPTIONS"/>
   <ITEM CMPNAME="TO_OPT_DEVCLASS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_OPT_DEVCLASS"/>
   <ITEM CMPNAME="TO_RAW" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_TYPES" REFCMPNAME="TO_RAW"/>
   <ITEM CMPNAME="TO_XML" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TO_XML"/>
   <ITEM CMPNAME="TR_DLVUNIT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_DLVUNIT"/>
   <ITEM CMPNAME="TR_DOCID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_DOCID"/>
   <ITEM CMPNAME="TR_PACKAGES" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_PACKAGES"/>
   <ITEM CMPNAME="TR_TR" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_TR"/>
   <ITEM CMPNAME="TS_BASE_ATTRIBUTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_BASE_ATTRIBUTS"/>
   <ITEM CMPNAME="TS_COMPKEY" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_COMPKEY"/>
   <ITEM CMPNAME="TS_COMPONENT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_COMPONENT"/>
   <ITEM CMPNAME="TS_CONNDATA" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_CONNDATA"/>
   <ITEM CMPNAME="TS_CONN_CLASS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_CONN_CLASS"/>
   <ITEM CMPNAME="TS_CONN_DEF" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_CONN_DEF"/>
   <ITEM CMPNAME="TS_CONTDATA" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_CONTDATA"/>
   <ITEM CMPNAME="TS_DIRECTORY" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_DIRECTORY"/>
   <ITEM CMPNAME="TS_DOC" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_DOC"/>
   <ITEM CMPNAME="TS_HEAD" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_HEAD"/>
   <ITEM CMPNAME="TS_LANG" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_LANG"/>
   <ITEM CMPNAME="TS_TXTP_TEXT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_TXTP_TEXT"/>
   <ITEM CMPNAME="TS_TXTP_TEXTPOOL" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_TXTP_TEXTPOOL"/>
   <ITEM CMPNAME="TS_TYPE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_TYPE"/>
   <ITEM CMPNAME="TT_ABAPRAWSOURCE" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_ABAPRAWSOURCE"/>
   <ITEM CMPNAME="TT_COMPKEYS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_COMPKEYS"/>
   <ITEM CMPNAME="TT_CONN_CLASSES" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_CONN_CLASSES"/>
   <ITEM CMPNAME="TT_DOCS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_DOCS"/>
   <ITEM CMPNAME="TT_RAWTEXT" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_RAWTEXT"/>
   <ITEM CMPNAME="TT_TXTP_TEXTPOOLS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TXTP_TEXTPOOLS"/>
   <ITEM CMPNAME="TT_TXTP_TEXTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TXTP_TEXTS"/>
   <ITEM CMPNAME="TT_TYPES" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TYPES"/>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="APPLICATION_LOG" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_MSG_COLL">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Application Log IDs"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="BALLOG_SUBOBJECT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="2" ATTVALUE="&apos;GUI&apos;" TYPTYPE="1" TYPE="BALSUBOBJ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Application Log: Subobject"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="C_LIGHT" VERSION="1" STATE="1" EDITORDER="1 " ATTDECLTYP="2" TYPTYPE="4" SRCROW1="6 " SRCCOLUMN1="4 " SRCROW2="15 " SRCCOLUMN2="19 " TYPESRC_LENG="426 " TYPESRC="BEGIN OF c_light,
*        no_light TYPE t_light VALUE 0,
*        red      TYPE t_light VALUE 1,
*        yellow   TYPE t_light VALUE 2,
*        green    TYPE t_light VALUE 3,
        no       TYPE td_light VALUE ICON_LIGHT_OUT,
        red      TYPE td_light VALUE ICON_RED_LIGHT,
        yellow   TYPE td_light VALUE ICON_YELLOW_LIGHT,
        green    TYPE td_light VALUE ICON_GREEN_LIGHT,
      END OF c_light
"/>
   <ITEM CMPNAME="O_CX" VERSION="1" STATE="1" EDITORDER="3 " ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_ROOT_EXCEPTION">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="O_MYCX" VERSION="1" STATE="1" EDITORDER="2 " ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_EXCEPTION">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for GUI"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="O_OPTIONS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_OPTIONS">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Options"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <INTERFACES>
   <ITEM REFCLSNAME="ZAPLINK_DATATYPES" VERSION="1" EXPOSURE="2" STATE="1" RELTYPE="1"/>
   <ITEM REFCLSNAME="ZAPLINK_TYPES" VERSION="1" EXPOSURE="2" STATE="1" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

INCLUDE ZAPLINK_MACROS.</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="ADD_OBJECT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Add object to container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_COMPNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJTYPE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_COMPTYPE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Object Type"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="WITH_SUBCOMP" VERSION="1" CMPTYPE="1" EDITORDER="4 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP" PARVALUE="ABAP_TRUE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="with sub components"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_cont   TYPE to_container.
  DATA obj_list TYPE to_list.
  DATA obj      TYPE to_component.
  DATA _objname TYPE string.
  DATA _cx      TYPE REF TO zaplink_cx.

  IF objtype IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_gui EXPORTING textid = zaplink_cx_gui=&gt;missing_objtype.
  ELSEIF name IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_gui EXPORTING textid = zaplink_cx_gui=&gt;missing_name.
  ENDIF.

  TRY.
      CALL METHOD _load
        EXPORTING
          file      = file
        IMPORTING
          container = o_cont.

      CREATE OBJECT obj.
      obj-&gt;set_type( objtype ).
      _objname = name.
      obj-&gt;set_name( _objname ).
      obj-&gt;set_with_subcomp( with_subcomp ).

      IF obj-&gt;connector_exists( ) = zaplink_component=&gt;connexists-not_exists. &quot; OR NOT obj-&gt;connector( ) IS BOUND.
        RAISE EXCEPTION TYPE zaplink_cx_gui EXPORTING
              textid = zaplink_cx_gui=&gt;connector_not_exists
                type = objtype.
      ENDIF.

      CREATE OBJECT obj_list.
      obj_list-&gt;add( obj ).
      obj_list-&gt;select( obj ).

      IF o_options IS BOUND.
        o_cont-&gt;set_options( o_options ).
      ENDIF.

      o_cont-&gt;add_components( obj_list ).

      CALL METHOD _save
        EXPORTING
          file      = file
        IMPORTING
          container = o_cont.

      IF o_cont-&gt;log-&gt;has_messages_of_msgt( id_msgty = &apos;E&apos; ) = abap_true.
        o_mycx ?= zaplink_cx=&gt;create_from_application_log( cx_name = &apos;ZAPLINK_CX_GUI&apos;
                                                 message_collector = o_cont-&gt;log ).
        RAISE EXCEPTION o_mycx.
      ENDIF.

    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CHANGE_SELECTION" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="8 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Let user change selection"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ACTION" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SEL_ACTION">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Action : Export or Import"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LIST" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List to allow user to change selected"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  TRY.
      IF NOT action IS INITIAL.
        list-&gt;select_default( action ).
      ENDIF.
      list-&gt;change_selection( ).
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CLASS_CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " MTDTYPE="2" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="CLASS_CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>

*==============================================
*==========     APPLICATION_LOG     ===========
*==============================================
  CREATE OBJECT application_log.
  CALL METHOD application_log-&gt;init
    EXPORTING
      id_object      = ballog_object
      id_subobject   = ballog_subobject
*      id_extnumber   =
      auto_upd_custo = abap_true
      id_activity    = zaplink_message_collector=&gt;actions-create
     EXCEPTIONS
       error          = 1
       OTHERS         = 2.
  IF sy-subrc &lt;&gt; 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONTAINERFILE_SELECT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="11 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Open dialog to select container&apos;s file"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILENAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Container&apos;s filename"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>
  DATA o_file    TYPE to_file.
  DATA o_cx_file TYPE REF TO zaplink_cx_file.
  DATA d_msg     TYPE string.

  TRY.
      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( zaplink_file=&gt;filetypes-local ).
      o_file-&gt;load_dialog( filename ).
      filename = o_file-&gt;get_filename( ).
    CATCH zaplink_cx_file INTO o_cx_file.
      CHECK o_cx_file-&gt;textid &lt;&gt; zaplink_cx_file=&gt;dialog_canceled.
      d_msg = o_cx_file-&gt;get_text( ).
      MESSAGE d_msg TYPE &apos;W&apos;.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONV_LIMU_2_R3TR" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Convert LIMU entries to R3TR Entries"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="E071" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TT_E071">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Transport Request entries"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS"/>
    </PARAMETERS>
    <SOURCE>
* From TRINT_OBJECT_TABLE
* HINT TRINT_OLE_SORT_COMPRESS
* HINT TR_SORT_OBJECT_AND_KEY_LIST
  DATA:
    _objlist LIKE LINE OF result,
    w_tadir TYPE tadir.
  FIELD-SYMBOLS:
    &lt;limu&gt; LIKE LINE OF e071.

  LOOP AT e071 ASSIGNING &lt;limu&gt;.
    CLEAR: _objlist.
    IF &lt;limu&gt;-pgmid = &apos;R3TR&apos;.
      _objlist-type = &lt;limu&gt;-object.
      _objlist-name = &lt;limu&gt;-obj_name.
    ELSE.
      CALL FUNCTION &apos;TR_CHECK_TYPE&apos;
        EXPORTING
          wi_e071                              = &lt;limu&gt;
*       IV_TRANSLATE_OBJNAME                 = &apos; &apos;
        IMPORTING
*       PE_RESULT                            =
*       WE_E071                              =
*       WE_LOCK_KEY                          =
          we_tadir                             = w_tadir
*       WE_COMPLETE_ONLY                     =
*       WE_CATEGORY                          =
*       WE_CLI_DEP                           =
*       WE_TABLE_TYP                         =
*       WE_TABLE_CONTFLAG                    =
*       PE_NAME_TOO_LONG                     =
*       EV_NO_OBJECT_NAME                    =
*       EV_R3TRTEXT_SYNTAXERROR              =
*       EV_LANGTYP                           =
*       EV_LANGTYPA                          =
*       EV_LOGO_OBJ                          =
*       EV_CURR_SETTING                      =
*       EV_NAME_TOO_LONG_FOR_OLD             =
*       EV_NAME_WITH_NONSTANDARD_CHARS       =
*       EV_NAMESPACE                         =
*       EV_INVALID_PREFIX_SYNTAX             =
*       EV_PREFIX_NOT_ALLOWED                =
*       EV_CASE_SENSITIVE                    =
*       EV_OBJLEN                            =
*       EV_INVALID_LANGUAGE_FIELD            =
                .
      _objlist-type = w_tadir-object.
      _objlist-name = w_tadir-obj_name.
    ENDIF.
    IF _objlist IS NOT INITIAL. APPEND _objlist TO result. ENDIF.
  ENDLOOP.

  SORT result BY type name.
  DELETE ADJACENT DUPLICATES FROM result COMPARING type name.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CREATE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Create empty container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILENAME" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CONTNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Container name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA s_info    TYPE ts_contdata.
  DATA container TYPE to_container.
  DATA def_fn    TYPE td_filename.
  DATA o_file    TYPE to_file.

  IF name IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_gui EXPORTING textid = zaplink_cx_gui=&gt;missing_container_name.
  ENDIF.

  TRY.
      CONCATENATE name ext_sep file_ext INTO def_fn.
      IF filename IS INITIAL.
        o_file = create_file( filename = def_fn ).
      ELSE.
        o_file = create_file( filename = filename ).
      ENDIF.
      o_file-&gt;save_dialog( def_fn ).

      s_info-name = name.
      container = zaplink_container=&gt;create_new( o_file = o_file
                                                   data = s_info ).
      container-&gt;save_to_file( ).
    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CREATE_FILE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Create File Manager"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILENAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Filename"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FILETYPE" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILETYPE" PARVALUE="ZAPLINK_FILE=&gt;C_FT_LOCAL" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Filetype : Local or Server"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="O_FILE" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_FILE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File Manager"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
DATA _cx TYPE REF TO zaplink_cx_file.
  TRY.
      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( filetype ).
      o_file-&gt;set_filename( filename ).
    CATCH zaplink_cx_file INTO _cx.
      mac_cascade_raise o_mycx _cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXPORT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Export object list to container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJLIST" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List to export"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="WITH_SUBCOMP" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP" PARVALUE="ABAP_TRUE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="With sub component"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_cont     TYPE to_container.

  TRY.
      CALL METHOD _get_objlist
        EXPORTING
          file      = file
        IMPORTING
*          list      = o_list
          container = o_cont.

      IF o_options IS BOUND.
        o_cont-&gt;set_options( o_options ).
      ENDIF.

      _update_subobj( o_list = objlist
                       f_sub = with_subcomp ).
      o_cont-&gt;add_components( objlist ).

      CALL METHOD _save
        EXPORTING
          file      = file
        IMPORTING
          container = o_cont.

    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_KEYS_FROM_PACKAGE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="10 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get object list from Package"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="EXT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_TRUE" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Extend to sub package"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PACKAGES" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TR_PACKAGES"/>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS"/>
    </PARAMETERS>
    <SOURCE>
  TYPES: tt_pack TYPE STANDARD TABLE OF tdevc-devclass.
  DATA r_exclu TYPE tr_packages.
  DATA t_devc  TYPE tt_pack.
  DATA t_level TYPE tt_pack.

  r_exclu = packages.
  DELETE r_exclu WHERE sign &lt;&gt; &apos;E&apos;. &quot; Keep only Devcclass to remove

* Package selection
  SELECT devclass
      FROM tdevc
      INTO TABLE t_devc
      WHERE devclass IN packages.

* Package extention
  IF ext = abap_true.
    t_level = t_devc .
    WHILE NOT t_level[] IS INITIAL.
      SORT t_level.
      DELETE ADJACENT DUPLICATES FROM t_level.

      SELECT devclass
          FROM tdevc
          INTO TABLE t_level
             FOR ALL ENTRIES IN t_level
          WHERE parentcl = t_level-table_line.

      APPEND LINES OF t_level TO t_devc.
    ENDWHILE.
    IF NOT r_exclu IS INITIAL.
      DELETE t_devc WHERE NOT table_line IN r_exclu.
    ENDIF.
  ENDIF.

  SORT t_devc.
  DELETE ADJACENT DUPLICATES FROM t_devc.

  IF NOT t_devc IS INITIAL.
    SELECT object obj_name
      INTO TABLE result
      FROM tadir
        FOR ALL ENTRIES IN t_devc
      WHERE devclass = t_devc-table_line.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_KEYS_FROM_TR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="9 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get object list from Transport request"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TT_COMPKEYS"/>
     <ITEM SCONAME="TR" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TR_TR"/>
    </PARAMETERS>
    <SOURCE>
DATA objlist TYPE tt_e071.
*  data keys    TYPE TT_COMPKEYS.
  data r_trs   TYPE tr_tr.

* TR
  SELECT trkorr trkorr trkorr
      FROM e070
      INTO TABLE r_trs
      WHERE trkorr IN tr.

* TR Tasks if not released
  SELECT trkorr trkorr trkorr
      FROM e070
      APPENDING TABLE r_trs
      WHERE strkorr IN tr
        AND ( trstatus = &apos;D&apos;    &quot; Modifiable
           OR trstatus = &apos;O&apos;    &quot; Release started
           OR trstatus = &apos;L&apos; ). &quot; Modifiable locked

* Alternative : direct but 2 range
*  SELECT trkorr trkorr trkorr
*    INTO TABLE r_trs
*    from V_E071EU
*    where TRKORR in tr OR (
*              STRKORR in tr
*          and ( TRSTATUS = &apos;D&apos; OR &quot; Modifiable
*                TRSTATUS = &apos;O&apos; OR &quot; Release started
*                TRSTATUS = &apos;L&apos;) &quot; Modifiable locked
*          ).

  SORT r_trs BY low.
  DELETE ADJACENT DUPLICATES FROM r_trs COMPARING low.

  IF NOT r_trs IS INITIAL.
    SELECT *
      FROM  e071
      INTO TABLE objlist
      FOR ALL ENTRIES IN r_trs
      WHERE  trkorr = r_trs-low.

*    keys = CONV_LIMU_2_R3TR( objlist ).
*  create OBJECT result.
*    result-&gt;add_keys( keys  ).
    result = CONV_LIMU_2_R3TR( objlist ).
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_OBJLIST" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get container content"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LIST" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List of container"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
*  DATA o_cont TYPE to_container.

  TRY.
      CALL METHOD _get_objlist
        EXPORTING
          file         = file
         IMPORTING
           list        = list
*           container   = o_cont
*           cont_name   =
          .
    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.
</SOURCE>
   </ITEM>
   <ITEM CMPNAME="IMPORT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Import container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LIST" VERSION="1" CMPTYPE="1" EDITORDER="4 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List to import"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CONTNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="For info : Container&apos;s name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="WITH_SUBCOMP" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP" PARVALUE="ABAP_TRUE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="with sub components"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_cont TYPE to_container.
  DATA _cx    TYPE REF TO zaplink_cx.

  TRY.
      CALL METHOD _get_objlist
        EXPORTING
          file      = file
        IMPORTING
          list      = list
          container = o_cont
          cont_name = name.

*  IF my_badi IS BOUND.
*    TRY.
*        CALL METHOD my_badi-&gt;cont_imp_at_load
*          EXPORTING
*            file = file
*          CHANGING
*            list   = list.
*      CATCH zaplink_cx INTO o_mycx.
*        RAISE EXCEPTION o_mycx.
*    ENDTRY.
*  ENDIF.

      _update_subobj( o_list = list
                       f_sub = with_subcomp ).
      list-&gt;select_default( zaplink_list=&gt;sel_actions-import ).
      list-&gt;change_selection( ).

*  IF my_badi IS BOUND.
*    TRY.
*        CALL METHOD my_badi-&gt;cont_imp_before
*          EXPORTING
*            file = file
*          CHANGING
*            list   = list.
*      CATCH zaplink_cx INTO o_mycx.
*        RAISE EXCEPTION o_mycx.
*    ENDTRY.
*  ENDIF.

      IF o_options IS BOUND.
        o_cont-&gt;set_options( o_options ).
      ENDIF.
      o_cont-&gt;transport_to_sap( list ).

*  IF my_badi IS BOUND.
*    TRY.
*        CALL METHOD my_badi-&gt;cont_imp_after
*          EXPORTING
*            file = file
*          CHANGING
*            list   = list.
*      CATCH zaplink_cx INTO o_mycx.
*        RAISE EXCEPTION o_mycx.
*    ENDTRY.
*  ENDIF.
*  raise event after_file_import
*    exporting
*      file     =
*      filename =
*      list       =
*      .

    CATCH zaplink_cx INTO _cx.
      CREATE OBJECT o_mycx
        EXPORTING
          textid  = zaplink_cx_gui=&gt;system_error
          prev_cx = _cx.
      o_mycx-&gt;update( ).
      RAISE EXCEPTION o_mycx.

  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="UNINSTALL" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="7 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Uninstall container content is system"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LIST" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List of container"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NAME" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CONTNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="For info : Container&apos;s name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="WITH_SUBCOMP" VERSION="1" CMPTYPE="1" EDITORDER="4 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP" PARVALUE="ABAP_TRUE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="with sub components"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_list TYPE to_list.
  DATA o_cont TYPE to_container.

  TRY.
      CALL METHOD _get_objlist
        EXPORTING
          file      = file
        IMPORTING
          list      = o_list
          container = o_cont
          cont_name = name.

      IF list IS BOUND.
        o_list-&gt;keep_commun_list( list ).
      ENDIF.

      _update_subobj( o_list = o_list
                       f_sub = with_subcomp ).
      o_list-&gt;select_default( zaplink_list=&gt;sel_actions-uninstall ).
      o_list-&gt;change_selection( ).

      o_cont-&gt;uninstall_from_sap( o_list ).

      list = o_list.
    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_GET_OBJLIST" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get container content (protected)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CONTAINER" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_CONTAINER">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPLink Container"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="CONT_NAME" VERSION="1" CMPTYPE="1" EDITORDER="4 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CONTNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Container&apos;s name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LIST" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List of container"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>

  TRY.
      CALL METHOD _load
        EXPORTING
          file      = file
        IMPORTING
          container = container
          cont_name = cont_name.

      CHECK container IS BOUND.
      list = container-&gt;get_content( ).
    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.
</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_LOAD" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Load and create container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CONTAINER" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_CONTAINER">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPLink : Container"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="CONT_NAME" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CONTNAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Container&apos;s name"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_file TYPE to_file.

  IF file IS INITIAL.
    RAISE EXCEPTION TYPE zaplink_cx_gui EXPORTING textid = zaplink_cx_gui=&gt;missing_filename.
  ENDIF.

  TRY.
      CALL METHOD application_log-&gt;add
        EXPORTING
*      is_message   =
           id_msgty     = &apos;I&apos;
           id_msgid     = &apos;ZAPLINK_GUI&apos;
           id_msgno     = &apos;002&apos;
           id_msgv1     = file
*      id_msgv2     =
*      id_msgv3     =
*      id_msgv4     =
          .

      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( zaplink_file=&gt;c_ft_local ).
      o_file-&gt;set_filename( file ).
*  o_file-&gt;set_filekind( zaplink_file_zip=&gt;filekinds-zipped ).
      CREATE OBJECT container
        EXPORTING
          o_file = o_file.

      container-&gt;load_from_file( ).

    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_SAVE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Save container"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CONTAINER" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_CONTAINER">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPLink Container"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FILE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_FILENAME">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="File name"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_GUI" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>
  DATA o_file TYPE to_file.
  DATA _fn    TYPE td_filename.

  TRY.
      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( zaplink_file=&gt;c_ft_local ).
      _fn = file.
      IF _fn IS INITIAL.
        CALL METHOD o_file-&gt;save_dialog
          EXPORTING
            filename = _fn.
      ENDIF.
      o_file-&gt;set_filename( _fn ).

      container-&gt;save_to_file( o_file ).
    CATCH zaplink_cx_gui INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_UPDATE_SUBOBJ" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Update sub object in list"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="F_SUB" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Also sub objects"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="O_LIST" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component List to export"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>
  DATA o_comp TYPE to_component.

  o_list-&gt;init_iter( ).
  o_list-&gt;display_progress = abap_false.
  o_comp = o_list-&gt;get_next( ).
  WHILE o_comp IS BOUND.
    o_comp-&gt;set_with_subcomp( f_sub ).
    o_comp = o_list-&gt;get_next( ).
  ENDWHILE.</SOURCE>
   </ITEM>
  </METHODS>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="ABAP" VERSION="1" IMPLICIT="X"/>
   <ITEM TYPEGROUP="ICON" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SLIS" VERSION="1" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TO_EXCEPTION" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="3" TYPE="ZAPLINK_CX_GUI">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for GUI"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_ROOT_EXCEPTION" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " TYPTYPE="3" TYPE="ZAPLINK_CX">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_OBJECT_OFF" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " TYPTYPE="4" SRCROW1="11 " SRCCOLUMN1="4 " SRCROW2="21 " SRCCOLUMN2="28 " TYPESRC_LENG="452 ">
    BEGIN OF ts_object_off,
            select     TYPE flag,
            type       TYPE td_comptype,
            typ_txt    TYPE string,
            name       TYPE td_compname,
            connector  TYPE td_light, &quot;type pools ICON
            status     TYPE td_light, &quot;type pools ICON
            msg        TYPE string,
            devclass   TYPE tadir-devclass,
            srcsystem  TYPE tadir-srcsystem,
         END OF ts_object_off

    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ALV Line"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_E071" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " TYPTYPE="4" SRCROW1="25 " SRCCOLUMN1="4 " SRCROW2="25 " SRCCOLUMN2="55 " TYPESRC_LENG="54 ">
    TT_E071 type STANDARD TABLE OF e071 with DEFAULT KEY

    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Request entries"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_OBJ_LIST_OFF" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " TYPTYPE="4" SRCROW1="23 " SRCCOLUMN1="4 " SRCROW2="23 " SRCCOLUMN2="72 " TYPESRC_LENG="71 ">tt_obj_list_off TYPE STANDARD TABLE OF ts_object_off with DEFAULT KEY
</ITEM>
   <ITEM CMPNAME="T_ALV" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="6 " SRCCOLUMN1="4 " SRCROW2="9 " SRCCOLUMN2="15 " TYPESRC_LENG="111 ">
    BEGIN OF t_alv,
      fields TYPE slis_t_fieldcat_alv,
      layout TYPE slis_layout_alv,
    END OF t_alv

    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ALV Data"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
